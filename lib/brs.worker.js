/*! For license information please see brs.worker.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("brs-worker",[],t):"object"==typeof exports?exports["brs-worker"]=t():e["brs-worker"]=t()}("undefined"!=typeof self?self:this,()=>(()=>{var __webpack_modules__={5045:function(e,t){var n,r;void 0===(r="function"==typeof(n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WebPDecoder=function(){function e(){a(55)}function l(e,t){for(var n=1<<t-1>>>0;e&n;)n>>>=1;return n?(e&n-1)+n:e}function u(e,t,r,i,s){n(!(i%r));do{e[t+(i-=r)]=s}while(0<i)}function h(e,t,r,i,s){if(n(2328>=s),512>=s)var o=a(512);else if(null==(o=a(s)))return 0;return function(e,t,r,i,s,o){var c,h,f=t,p=1<<r,g=a(16),m=a(16);for(n(0!=s),n(null!=i),n(null!=e),n(0<r),h=0;h<s;++h){if(15<i[h])return 0;++g[i[h]]}if(g[0]==s)return 0;for(m[1]=0,c=1;15>c;++c){if(g[c]>1<<c)return 0;m[c+1]=m[c]+g[c]}for(h=0;h<s;++h)c=i[h],0<i[h]&&(o[m[c]++]=h);if(1==m[15])return(i=new d).g=0,i.value=o[0],u(e,f,1,p,i),p;var y,b=-1,w=p-1,v=0,S=1,x=1,E=1<<r;for(h=0,c=1,s=2;c<=r;++c,s<<=1){if(S+=x<<=1,0>(x-=g[c]))return 0;for(;0<g[c];--g[c])(i=new d).g=c,i.value=o[h++],u(e,f+v,s,E,i),v=l(v,c)}for(c=r+1,s=2;15>=c;++c,s<<=1){if(S+=x<<=1,0>(x-=g[c]))return 0;for(;0<g[c];--g[c]){if(i=new d,(v&w)!=b){for(f+=E,y=1<<(b=c)-r;15>b&&!(0>=(y-=g[b]));)++b,y<<=1;p+=E=1<<(y=b-r),e[t+(b=v&w)].g=y+r,e[t+b].value=f-t-b}i.g=c-r,i.value=o[h++],u(e,f+(v>>r),s,E,i),v=l(v,c)}}return S!=2*m[15]-1?0:p}(e,t,r,i,s,o)}function d(){this.value=this.g=0}function f(){this.value=this.g=0}function p(){this.G=o(5,d),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Vn,f)}function g(e,t,r,i){n(null!=e),n(null!=t),n(2147483648>i),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=t,e.pa=r,e.Jd=t,e.Yc=r+i,e.Zc=4<=i?r+i-4+1:r,_(e)}function m(e,t){for(var n=0;0<t--;)n|=A(e,128)<<t;return n}function y(e,t){var n=m(e,t);return C(e)?-n:n}function b(e,t,r,i){var s,a=0;for(n(null!=e),n(null!=t),n(4294967288>i),e.Sb=i,e.Ra=0,e.u=0,e.h=0,4<i&&(i=4),s=0;s<i;++s)a+=t[r+s]<<8*s;e.Ra=a,e.bb=i,e.oa=t,e.pa=r}function w(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<Gn-8>>>0,++e.bb,e.u-=8;I(e)&&(e.h=1,e.u=0)}function v(e,t){if(n(0<=t),!e.h&&t<=zn){var r=E(e)&jn[t];return e.u+=t,w(e),r}return e.h=1,e.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function x(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function E(e){return e.Ra>>>(e.u&Gn-1)>>>0}function I(e){return n(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>Gn}function k(e,t){e.u=t,e.h=I(e)}function T(e){e.u>=Hn&&(n(e.u>=Hn),w(e))}function _(e){n(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(n(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function C(e){return m(e,1)}function A(e,t){var n=e.Ca;0>e.b&&_(e);var r=e.b,i=n*t>>>8,s=(e.I>>>r>i)+0;for(s?(n-=i,e.I-=i+1<<r>>>0):n=i+1,r=n,i=0;256<=r;)i+=8,r>>=8;return r=7^i+$n[r],e.b-=r,e.Ca=(n<<r)-1,s}function F(e,t,n){e[t+0]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n}function R(e,t){return e[t+0]|e[t+1]<<8}function M(e,t){return R(e,t)|e[t+2]<<16}function D(e,t){return R(e,t)|R(e,t+2)<<16}function O(e,t){var r=1<<t;return n(null!=e),n(0<t),e.X=a(r),null==e.X?0:(e.Mb=32-t,e.Xa=t,1)}function P(e,t){n(null!=e),n(null!=t),n(e.Xa==t.Xa),i(t.X,0,e.X,0,1<<t.Xa)}function N(){this.X=[],this.Xa=this.Mb=0}function L(e,t,r,i){n(null!=r),n(null!=i);var s=r[0],a=i[0];return 0==s&&(s=(e*a+t/2)/t),0==a&&(a=(t*s+e/2)/e),0>=s||0>=a?0:(r[0]=s,i[0]=a,1)}function B(e,t){return e+(1<<t)-1>>>t}function U(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function V(e,n){t[n]=function(n,r,i,s,a,o,c){var l;for(l=0;l<a;++l){var u=t[e](o[c+l-1],i,s+l);o[c+l]=U(n[r+l],u)}}}function j(){this.ud=this.hd=this.jd=0}function z(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function G(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function H(e,t){return G(e+(e-t+.5>>1))}function $(e,t,n){return Math.abs(t-n)-Math.abs(e-n)}function W(e,t,n,r,i,s,a){for(r=s[a-1],n=0;n<i;++n)s[a+n]=r=U(e[t+n],r)}function q(e,t,n,r,i){var s;for(s=0;s<n;++s){var a=e[t+s],o=a>>8&255,c=16711935&(c=(c=16711935&a)+((o<<16)+o));r[i+s]=(4278255360&a)+c>>>0}}function X(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function Y(e,t,n,r,i,s){var a;for(a=0;a<r;++a){var o=t[n+a],c=o>>>8,l=o,u=255&(u=(u=o>>>16)+((e.jd<<24>>24)*(c<<24>>24)>>>5));l=255&(l=(l+=(e.hd<<24>>24)*(c<<24>>24)>>>5)+((e.ud<<24>>24)*(u<<24>>24)>>>5)),i[s+a]=(4278255360&o)+(u<<16)+l}}function K(e,n,r,i,s){t[n]=function(e,t,n,r,a,o,c,l,u){for(r=c;r<l;++r)for(c=0;c<u;++c)a[o++]=s(n[i(e[t++])])},t[e]=function(e,n,a,o,c,l,u){var h=8>>e.b,d=e.Ea,f=e.K[0],p=e.w;if(8>h)for(e=(1<<e.b)-1,p=(1<<h)-1;n<a;++n){var g,m=0;for(g=0;g<d;++g)g&e||(m=i(o[c++])),l[u++]=s(f[m&p]),m>>=h}else t["VP8LMapColor"+r](o,c,f,p,l,u,n,a,d)}}function J(e,t,n,r,i){for(n=t+n;t<n;){var s=e[t++];r[i++]=s>>16&255,r[i++]=s>>8&255,r[i++]=255&s}}function Z(e,t,n,r,i){for(n=t+n;t<n;){var s=e[t++];r[i++]=s>>16&255,r[i++]=s>>8&255,r[i++]=255&s,r[i++]=s>>24&255}}function Q(e,t,n,r,i){for(n=t+n;t<n;){var s=(a=e[t++])>>16&240|a>>12&15,a=240&a|a>>28&15;r[i++]=s,r[i++]=a}}function ee(e,t,n,r,i){for(n=t+n;t<n;){var s=(a=e[t++])>>16&248|a>>13&7,a=a>>5&224|a>>3&31;r[i++]=s,r[i++]=a}}function te(e,t,n,r,i){for(n=t+n;t<n;){var s=e[t++];r[i++]=255&s,r[i++]=s>>8&255,r[i++]=s>>16&255}}function ne(e,t,n,r,s,a){if(0==a)for(n=t+n;t<n;)F(r,((a=e[t++])[0]>>24|a[1]>>8&65280|a[2]<<8&16711680|a[3]<<24)>>>0),s+=32;else i(r,s,e,t,n)}function re(e,n){t[n][0]=t[e+"0"],t[n][1]=t[e+"1"],t[n][2]=t[e+"2"],t[n][3]=t[e+"3"],t[n][4]=t[e+"4"],t[n][5]=t[e+"5"],t[n][6]=t[e+"6"],t[n][7]=t[e+"7"],t[n][8]=t[e+"8"],t[n][9]=t[e+"9"],t[n][10]=t[e+"10"],t[n][11]=t[e+"11"],t[n][12]=t[e+"12"],t[n][13]=t[e+"13"],t[n][14]=t[e+"0"],t[n][15]=t[e+"0"]}function ie(e){return e==Hr||e==$r||e==Wr||e==qr}function se(){this.eb=[],this.size=this.A=this.fb=0}function ae(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function oe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new se,this.f.kb=new ae,this.sd=null}function ce(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ue(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function he(e,t){var n=e.T,r=t.ba.f.RGBA,s=r.eb,a=r.fb+e.ka*r.A,o=bi[t.ba.S],c=e.y,l=e.O,u=e.f,h=e.N,d=e.ea,f=e.W,p=t.cc,g=t.dc,m=t.Mc,y=t.Nc,b=e.ka,w=e.ka+e.T,v=e.U,S=v+1>>1;for(0==b?o(c,l,null,null,u,h,d,f,u,h,d,f,s,a,null,null,v):(o(t.ec,t.fc,c,l,p,g,m,y,u,h,d,f,s,a-r.A,s,a,v),++n);b+2<w;b+=2)p=u,g=h,m=d,y=f,h+=e.Rc,f+=e.Rc,a+=2*r.A,o(c,(l+=2*e.fa)-e.fa,c,l,p,g,m,y,u,h,d,f,s,a-r.A,s,a,v);return l+=e.fa,e.j+w<e.o?(i(t.ec,t.fc,c,l,v),i(t.cc,t.dc,u,h,S),i(t.Mc,t.Nc,d,f,S),n--):1&w||o(c,l,null,null,u,h,d,f,u,h,d,f,s,a+r.A,null,null,v),n}function de(e,t,r){var i=e.F,s=[e.J];if(null!=i){var a=e.U,o=t.ba.S,c=o==jr||o==Wr;t=t.ba.f.RGBA;var l=[0],u=e.ka;l[0]=e.T,e.Kb&&(0==u?--l[0]:(--u,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(l[0]=e.o-e.j-u));var h=t.eb;u=t.fb+u*t.A,e=Tr(i,s[0],e.width,a,l,h,u+(c?0:3),t.A),n(r==l),e&&ie(o)&&Ir(h,u,c,a,l,t.A)}return 0}function fe(e){var t=e.ma,n=t.ba.S,r=11>n,i=n==Br||n==Vr||n==jr||n==zr||12==n||ie(n);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Ln(t.Oa,e,i?11:12))return 0;if(i&&ie(n)&&vn(),e.da)alert("todo:use_scaling");else{if(r){if(t.Ib=ue,e.Kb){if(n=e.U+1>>1,t.memory=a(e.U+2*n),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+n,t.Ib=he,vn()}}else alert("todo:EmitYUV");i&&(t.Jb=de,r&&bn())}if(r&&!Mi){for(e=0;256>e;++e)Di[e]=89858*(e-128)+_i>>Ti,Ni[e]=-22014*(e-128)+_i,Pi[e]=-45773*(e-128),Oi[e]=113618*(e-128)+_i>>Ti;for(e=Ci;e<Ai;++e)t=76283*(e-16)+_i>>Ti,Li[e-Ci]=We(t,255),Bi[e-Ci]=We(t+8>>4,15);Mi=1}return 1}function pe(e){var t=e.ma,r=e.U,i=e.T;return n(!(1&e.ka)),0>=r||0>=i?0:(r=t.Ib(e,t),null!=t.Jb&&t.Jb(e,t,r),t.Dc+=r,1)}function ge(e){e.ma.memory=null}function me(e,t,n,r){return 47!=v(e,8)?0:(t[0]=v(e,14)+1,n[0]=v(e,14)+1,r[0]=v(e,1),0!=v(e,3)?0:!e.h)}function ye(e,t){if(4>e)return e+1;var n=e-2>>1;return(2+(1&e)<<n)+v(t,n)+1}function be(e,t){return 120<t?t-120:1<=(n=((n=Qr[t-1])>>4)*e+(8-(15&n)))?n:1;var n}function we(e,t,n){var r=E(n),i=e[t+=255&r].g-8;return 0<i&&(k(n,n.u+8),r=E(n),t+=e[t].value,t+=r&(1<<i)-1),k(n,n.u+e[t].g),e[t].value}function ve(e,t,r){return r.g+=e.g,r.value+=e.value<<t>>>0,n(8>=r.g),e.g}function Se(e,t,r){var i=e.xc;return n((t=0==i?0:e.vc[e.md*(r>>i)+(t>>i)])<e.Wb),e.Ya[t]}function xe(e,t,r,s){var a=e.ab,o=e.c*t,c=e.C;t=c+t;var l=r,u=s;for(s=e.Ta,r=e.Ua;0<a--;){var h=e.gc[a],d=c,f=t,p=l,g=u,m=(u=s,l=r,h.Ea);switch(n(d<f),n(f<=h.nc),h.hc){case 2:Xn(p,g,(f-d)*m,u,l);break;case 0:var y=d,b=f,w=u,v=l,S=(T=h).Ea;0==y&&(Wn(p,g,null,null,1,w,v),W(p,g+1,0,0,S-1,w,v+1),g+=S,v+=S,++y);for(var x=1<<T.b,E=x-1,I=B(S,T.b),k=T.K,T=T.w+(y>>T.b)*I;y<b;){var _=k,C=T,A=1;for(qn(p,g,w,v-S,1,w,v);A<S;){var F=(A&~E)+x;F>S&&(F=S),(0,Qn[_[C++]>>8&15])(p,g+ +A,w,v+A-S,F-A,w,v+A),A=F}g+=S,v+=S,++y&E||(T+=I)}f!=h.nc&&i(u,l-m,u,l+(f-d-1)*m,m);break;case 1:for(m=p,b=g,S=(p=h.Ea)-(v=p&~(w=(g=1<<h.b)-1)),y=B(p,h.b),x=h.K,h=h.w+(d>>h.b)*y;d<f;){for(E=x,I=h,k=new j,T=b+v,_=b+p;b<T;)X(E[I++],k),er(k,m,b,g,u,l),b+=g,l+=g;b<_&&(X(E[I++],k),er(k,m,b,S,u,l),b+=S,l+=S),++d&w||(h+=y)}break;case 3:if(p==u&&g==l&&0<h.b){for(b=u,p=m=l+(f-d)*m-(v=(f-d)*B(h.Ea,h.b)),g=u,w=l,y=[],v=(S=v)-1;0<=v;--v)y[v]=g[w+v];for(v=S-1;0<=v;--v)b[p+v]=y[v];Yn(h,d,f,u,m,u,l)}else Yn(h,d,f,p,g,u,l)}l=s,u=r}u!=r&&i(s,r,l,u,o)}function Ee(e,t){var r=e.V,i=e.Ba+e.c*e.C,s=t-e.C;if(n(t<=e.l.o),n(16>=s),0<s){var a=e.l,o=e.Ta,c=e.Ua,l=a.width;if(xe(e,s,r,i),s=c=[c],n((r=e.C)<(i=t)),n(a.v<a.va),i>a.o&&(i=a.o),r<a.j){var u=a.j-r;r=a.j,s[0]+=u*l}if(r>=i?r=0:(s[0]+=4*a.v,a.ka=r-a.j,a.U=a.va-a.v,a.T=i-r,r=1),r){if(c=c[0],11>(r=e.ca).S){var h=r.f.RGBA,d=(i=r.S,s=a.U,a=a.T,u=h.eb,h.A),f=a;for(h=h.fb+e.Ma*h.A;0<f--;){var p=o,g=c,m=s,y=u,b=h;switch(i){case Lr:tr(p,g,m,y,b);break;case Br:nr(p,g,m,y,b);break;case Hr:nr(p,g,m,y,b),Ir(y,b,0,m,1,0);break;case Ur:sr(p,g,m,y,b);break;case Vr:ne(p,g,m,y,b,1);break;case $r:ne(p,g,m,y,b,1),Ir(y,b,0,m,1,0);break;case jr:ne(p,g,m,y,b,0);break;case Wr:ne(p,g,m,y,b,0),Ir(y,b,1,m,1,0);break;case zr:rr(p,g,m,y,b);break;case qr:rr(p,g,m,y,b),kr(y,b,m,1,0);break;case Gr:ir(p,g,m,y,b);break;default:n(0)}c+=l,h+=d}e.Ma+=a}else alert("todo:EmitRescaledRowsYUVA");n(e.Ma<=r.height)}}e.C=t,n(e.C<=e.i)}function Ie(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var n=e.Ya[t].G,r=e.Ya[t].H;if(0<n[1][r[1]+0].g||0<n[2][r[2]+0].g||0<n[3][r[3]+0].g)return 0}return 1}function ke(e,t,r,i,s,a){if(0!=e.Z){var o=e.qd,c=e.rd;for(n(null!=yi[e.Z]);t<r;++t)yi[e.Z](o,c,i,s,i,s,a),o=i,c=s,s+=a;e.qd=o,e.rd=c}}function Te(e,t){var r=e.l.ma,i=0==r.Z||1==r.Z?e.l.j:e.C;if(i=e.C<i?i:e.C,n(t<=e.l.o),t>i){var s=e.l.width,a=r.ca,o=r.tb+s*i,c=e.V,l=e.Ba+e.c*i,u=e.gc;n(1==e.ab),n(3==u[0].hc),Jn(u[0],i,t,c,l,a,o),ke(r,i,t,a,o,s)}e.C=e.Ma=t}function _e(e,t,r,i,s,a,o){var c=e.$/i,l=e.$%i,u=e.m,h=e.s,d=r+e.$,f=d;s=r+i*s;var p=r+i*a,g=280+h.ua,m=e.Pb?c:16777216,y=0<h.ua?h.Wa:null,b=h.wc,w=d<p?Se(h,l,c):null;n(e.C<a),n(p<=s);var v=!1;e:for(;;){for(;v||d<p;){var S=0;if(c>=m){var x=d-r;n((m=e).Pb),m.wd=m.m,m.xd=x,0<m.s.ua&&P(m.s.Wa,m.s.vb),m=c+ti}if(l&b||(w=Se(h,l,c)),n(null!=w),w.Qb&&(t[d]=w.qb,v=!0),!v)if(T(u),w.jc){S=u,x=t;var _=d,C=w.pd[E(S)&Vn-1];n(w.jc),256>C.g?(k(S,S.u+C.g),x[_]=C.value,S=0):(k(S,S.u+C.g-256),n(256<=C.value),S=C.value),0==S&&(v=!0)}else S=we(w.G[0],w.H[0],u);if(u.h)break;if(v||256>S){if(!v)if(w.nd)t[d]=(w.qb|S<<8)>>>0;else{if(T(u),v=we(w.G[1],w.H[1],u),T(u),x=we(w.G[2],w.H[2],u),_=we(w.G[3],w.H[3],u),u.h)break;t[d]=(_<<24|v<<16|S<<8|x)>>>0}if(v=!1,++d,++l>=i&&(l=0,++c,null!=o&&c<=a&&!(c%16)&&o(e,c),null!=y))for(;f<d;)S=t[f++],y.X[(506832829*S&4294967295)>>>y.Mb]=S}else if(280>S){if(S=ye(S-256,u),x=we(w.G[4],w.H[4],u),T(u),x=be(i,x=ye(x,u)),u.h)break;if(d-r<x||s-d<S)break e;for(_=0;_<S;++_)t[d+_]=t[d+_-x];for(d+=S,l+=S;l>=i;)l-=i,++c,null!=o&&c<=a&&!(c%16)&&o(e,c);if(n(d<=s),l&b&&(w=Se(h,l,c)),null!=y)for(;f<d;)S=t[f++],y.X[(506832829*S&4294967295)>>>y.Mb]=S}else{if(!(S<g))break e;for(v=S-280,n(null!=y);f<d;)S=t[f++],y.X[(506832829*S&4294967295)>>>y.Mb]=S;S=d,n(!(v>>>(x=y).Xa)),t[S]=x.X[v],v=!0}v||n(u.h==I(u))}if(e.Pb&&u.h&&d<s)n(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&P(e.s.vb,e.s.Wa);else{if(u.h)break e;null!=o&&o(e,c>a?a:c),e.a=0,e.$=d-r}return 1}return e.a=3,0}function Ce(e){n(null!=e),e.vc=null,e.yc=null,e.Ya=null;var t=e.Wa;null!=t&&(t.X=null),e.vb=null,n(null!=e)}function Ae(){var e=new cn;return null==e?null:(e.a=0,e.xb=mi,re("Predictor","VP8LPredictors"),re("Predictor","VP8LPredictors_C"),re("PredictorAdd","VP8LPredictorsAdd"),re("PredictorAdd","VP8LPredictorsAdd_C"),Xn=q,er=Y,tr=J,nr=Z,rr=Q,ir=ee,sr=te,t.VP8LMapColor32b=Kn,t.VP8LMapColor8b=Zn,e)}function Fe(e,t,r,i,c){var l=1,u=[e],f=[t],g=i.m,m=i.s,y=null,b=0;e:for(;;){if(r)for(;l&&v(g,1);){var w=u,S=f,x=i,I=1,_=x.m,C=x.gc[x.ab],A=v(_,2);if(x.Oc&1<<A)l=0;else{switch(x.Oc|=1<<A,C.hc=A,C.Ea=w[0],C.nc=S[0],C.K=[null],++x.ab,n(4>=x.ab),A){case 0:case 1:C.b=v(_,3)+2,I=Fe(B(C.Ea,C.b),B(C.nc,C.b),0,x,C.K),C.K=C.K[0];break;case 3:var F,R=v(_,8)+1,M=16<R?0:4<R?1:2<R?2:3;if(w[0]=B(C.Ea,M),C.b=M,F=I=Fe(R,1,0,x,C.K)){var D,P=R,N=C,L=1<<(8>>N.b),V=a(L);if(null==V)F=0;else{var j=N.K[0],z=N.w;for(V[0]=N.K[0][0],D=1;D<1*P;++D)V[D]=U(j[z+D],V[D-1]);for(;D<4*L;++D)V[D]=0;N.K[0]=null,N.K[0]=V,F=1}}I=F;break;case 2:break;default:n(0)}l=I}}if(u=u[0],f=f[0],l&&v(g,1)&&!(l=1<=(b=v(g,4))&&11>=b)){i.a=3;break e}var G;if(G=l)t:{var H,$,W,q=i,X=u,Y=f,K=b,J=r,Z=q.m,Q=q.s,ee=[null],te=1,ne=0,re=ei[K];n:for(;;){if(J&&v(Z,1)){var ie=v(Z,3)+2,se=B(X,ie),ae=B(Y,ie),oe=se*ae;if(!Fe(se,ae,0,q,ee))break n;for(ee=ee[0],Q.xc=ie,H=0;H<oe;++H){var ce=ee[H]>>8&65535;ee[H]=ce,ce>=te&&(te=ce+1)}}if(Z.h)break n;for($=0;5>$;++$){var le=Kr[$];!$&&0<K&&(le+=1<<K),ne<le&&(ne=le)}var ue=o(te*re,d),he=te,de=o(he,p);if(null==de)var fe=null;else n(65536>=he),fe=de;var pe=a(ne);if(null==fe||null==pe||null==ue){q.a=1;break n}var ge=ue;for(H=W=0;H<te;++H){var me=fe[H],ye=me.G,be=me.H,we=0,Se=1,xe=0;for($=0;5>$;++$){le=Kr[$],ye[$]=ge,be[$]=W,!$&&0<K&&(le+=1<<K);r:{var Ee,Ie=le,ke=q,Te=pe,Ae=ge,Re=W,Me=0,De=ke.m,Oe=v(De,1);if(s(Te,0,0,Ie),Oe){var Pe=v(De,1)+1,Ne=v(De,1),Le=v(De,0==Ne?1:8);Te[Le]=1,2==Pe&&(Te[Le=v(De,8)]=1);var Be=1}else{var Ue=a(19),Ve=v(De,4)+4;if(19<Ve){ke.a=3;var je=0;break r}for(Ee=0;Ee<Ve;++Ee)Ue[Zr[Ee]]=v(De,3);var ze=void 0,Ge=void 0,He=ke,$e=Ue,We=Ie,qe=Te,Xe=0,Ye=He.m,Ke=8,Je=o(128,d);i:for(;h(Je,0,7,$e,19);){if(v(Ye,1)){var Ze=2+2*v(Ye,3);if((ze=2+v(Ye,Ze))>We)break i}else ze=We;for(Ge=0;Ge<We&&ze--;){T(Ye);var Qe=Je[0+(127&E(Ye))];k(Ye,Ye.u+Qe.g);var et=Qe.value;if(16>et)qe[Ge++]=et,0!=et&&(Ke=et);else{var tt=16==et,nt=et-16,rt=Yr[nt],it=v(Ye,Xr[nt])+rt;if(Ge+it>We)break i;for(var st=tt?Ke:0;0<it--;)qe[Ge++]=st}}Xe=1;break i}Xe||(He.a=3),Be=Xe}(Be=Be&&!De.h)&&(Me=h(Ae,Re,8,Te,Ie)),Be&&0!=Me?je=Me:(ke.a=3,je=0)}if(0==je)break n;if(Se&&1==Jr[$]&&(Se=0==ge[W].g),we+=ge[W].g,W+=je,3>=$){var at,ot=pe[0];for(at=1;at<le;++at)pe[at]>ot&&(ot=pe[at]);xe+=ot}}if(me.nd=Se,me.Qb=0,Se&&(me.qb=(ye[3][be[3]+0].value<<24|ye[1][be[1]+0].value<<16|ye[2][be[2]+0].value)>>>0,0==we&&256>ye[0][be[0]+0].value&&(me.Qb=1,me.qb+=ye[0][be[0]+0].value<<8)),me.jc=!me.Qb&&6>xe,me.jc){var ct,lt=me;for(ct=0;ct<Vn;++ct){var ut=ct,ht=lt.pd[ut],dt=lt.G[0][lt.H[0]+ut];256<=dt.value?(ht.g=dt.g+256,ht.value=dt.value):(ht.g=0,ht.value=0,ut>>=ve(dt,8,ht),ut>>=ve(lt.G[1][lt.H[1]+ut],16,ht),ut>>=ve(lt.G[2][lt.H[2]+ut],0,ht),ve(lt.G[3][lt.H[3]+ut],24,ht))}}}Q.vc=ee,Q.Wb=te,Q.Ya=fe,Q.yc=ue,G=1;break t}G=0}if(!(l=G)){i.a=3;break e}if(0<b){if(m.ua=1<<b,!O(m.Wa,b)){i.a=1,l=0;break e}}else m.ua=0;var ft=i,pt=u,gt=f,mt=ft.s,yt=mt.xc;if(ft.c=pt,ft.i=gt,mt.md=B(pt,yt),mt.wc=0==yt?-1:(1<<yt)-1,r){i.xb=gi;break e}if(null==(y=a(u*f))){i.a=1,l=0;break e}l=(l=_e(i,y,0,u,f,f,null))&&!g.h;break e}return l?(null!=c?c[0]=y:(n(null==y),n(r)),i.$=0,r||Ce(m)):Ce(m),l}function Re(e,t){var r=e.c*e.i,i=r+t+16*t;return n(e.c<=t),e.V=a(i),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+r+t,1)}function Me(e,t){var r=e.C,i=t-r,s=e.V,a=e.Ba+e.c*r;for(n(t<=e.l.o);0<i;){var o=16<i?16:i,c=e.l.ma,l=e.l.width,u=l*o,h=c.ca,d=c.tb+l*r,f=e.Ta,p=e.Ua;xe(e,o,s,a),_r(f,p,h,d,u),ke(c,r,r+o,h,d,l),i-=o,s+=o*e.c,r+=o}n(r==t),e.C=e.Ma=t}function De(){this.ub=this.yd=this.td=this.Rb=0}function Oe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Pe(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Ne(){this.Yb=function(){var e=[];return function e(t,n,r){for(var i=r[n],s=0;s<i&&(t.push(r.length>n+1?[]:0),!(r.length<n+1));s++)e(t[s],n+1,r)}(e,0,[3,11]),e}()}function Le(){this.jb=a(3),this.Wc=c([4,8],Ne),this.Xc=c([4,17],Ne)}function Be(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Ue(){this.ld=this.La=this.dd=this.tc=0}function Ve(){this.Na=this.la=0}function je(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ze(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ge(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ue),this.Y=0,this.ya=Array(new ze),this.aa=0,this.l=new qe}function He(){this.y=a(16),this.f=a(8),this.ea=a(8)}function $e(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new De,this.Kc=new Oe,this.ed=new Be,this.Qa=new Pe,this.Ic=this.$c=this.Aa=0,this.D=new Ge,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,S),this.ia=0,new e,this.pb=o(4,je),this.Pa=new Le,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new He),this.Hd=0,this.rb=Array(new Ve),this.sb=0,this.wa=Array(new Ue),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ze),this.L=this.aa=0,this.gd=c([4,2],Ue),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function We(e,t){return 0>e?0:e>t?t:e}function qe(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Xe(){var e=new $e;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,ii||(ii=Ze)),e}function Ye(e,t,n){return 0==e.a&&(e.a=t,e.sc=n,e.cb=0),0}function Ke(e,t,n){return 3<=n&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function Je(e,t){if(null==e)return 0;if(e.a=0,e.sc="OK",null==t)return Ye(e,2,"null VP8Io passed to VP8GetHeaders()");var r=t.data,i=t.w,a=t.ha;if(4>a)return Ye(e,7,"Truncated header.");var o=r[i+0]|r[i+1]<<8|r[i+2]<<16,c=e.Od;if(c.Rb=!(1&o),c.td=o>>1&7,c.yd=o>>4&1,c.ub=o>>5,3<c.td)return Ye(e,3,"Incorrect keyframe parameters.");if(!c.yd)return Ye(e,4,"Frame not displayable.");i+=3,a-=3;var l=e.Kc;if(c.Rb){if(7>a)return Ye(e,7,"cannot parse picture header");if(!Ke(r,i,a))return Ye(e,3,"Bad code word");l.c=16383&(r[i+4]<<8|r[i+3]),l.Td=r[i+4]>>6,l.i=16383&(r[i+6]<<8|r[i+5]),l.Ud=r[i+6]>>6,i+=7,a-=7,e.za=l.c+15>>4,e.Ub=l.i+15>>4,t.width=l.c,t.height=l.i,t.Da=0,t.j=0,t.v=0,t.va=t.width,t.o=t.height,t.da=0,t.ib=t.width,t.hb=t.height,t.U=t.width,t.T=t.height,s((o=e.Pa).jb,0,255,o.jb.length),n(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,s(o.Zb,0,0,o.Zb.length),s(o.Lb,0,0,o.Lb)}if(c.ub>a)return Ye(e,7,"bad partition length");g(o=e.m,r,i,c.ub),i+=c.ub,a-=c.ub,c.Rb&&(l.Ld=C(o),l.Kd=C(o)),l=e.Qa;var u,h=e.Pa;if(n(null!=o),n(null!=l),l.Cb=C(o),l.Cb){if(l.Bb=C(o),C(o)){for(l.Fb=C(o),u=0;4>u;++u)l.Zb[u]=C(o)?y(o,7):0;for(u=0;4>u;++u)l.Lb[u]=C(o)?y(o,6):0}if(l.Bb)for(u=0;3>u;++u)h.jb[u]=C(o)?m(o,8):255}else l.Bb=0;if(o.Ka)return Ye(e,3,"cannot parse segment header");if((l=e.ed).zd=C(o),l.Tb=m(o,6),l.wb=m(o,3),l.Pc=C(o),l.Pc&&C(o)){for(h=0;4>h;++h)C(o)&&(l.vd[h]=y(o,6));for(h=0;4>h;++h)C(o)&&(l.od[h]=y(o,6))}if(e.L=0==l.Tb?0:l.zd?1:2,o.Ka)return Ye(e,3,"cannot parse filter header");var d=a;if(a=u=i,i=u+d,l=d,e.Xb=(1<<m(e.m,2))-1,d<3*(h=e.Xb))r=7;else{for(u+=3*h,l-=3*h,d=0;d<h;++d){var f=r[a+0]|r[a+1]<<8|r[a+2]<<16;f>l&&(f=l),g(e.Jc[+d],r,u,f),u+=f,l-=f,a+=3}g(e.Jc[+h],r,u,l),r=u<i?0:5}if(0!=r)return Ye(e,r,"cannot parse partitions");for(r=m(u=e.m,7),a=C(u)?y(u,4):0,i=C(u)?y(u,4):0,l=C(u)?y(u,4):0,h=C(u)?y(u,4):0,u=C(u)?y(u,4):0,d=e.Qa,f=0;4>f;++f){if(d.Cb){var p=d.Zb[f];d.Fb||(p+=r)}else{if(0<f){e.pb[f]=e.pb[0];continue}p=r}var b=e.pb[f];b.Sc[0]=ni[We(p+a,127)],b.Sc[1]=ri[We(p+0,127)],b.Eb[0]=2*ni[We(p+i,127)],b.Eb[1]=101581*ri[We(p+l,127)]>>16,8>b.Eb[1]&&(b.Eb[1]=8),b.Qc[0]=ni[We(p+h,117)],b.Qc[1]=ri[We(p+u,127)],b.lc=p+u}if(!c.Rb)return Ye(e,4,"Not a key frame.");for(C(o),c=e.Pa,r=0;4>r;++r){for(a=0;8>a;++a)for(i=0;3>i;++i)for(l=0;11>l;++l)h=A(o,ui[r][a][i][l])?m(o,8):ci[r][a][i][l],c.Wc[r][a].Yb[i][l]=h;for(a=0;17>a;++a)c.Xc[r][a]=c.Wc[r][hi[a]]}return e.kc=C(o),e.kc&&(e.Bd=m(o,8)),e.cb=1}function Ze(e,t,n,r,i,s,a){var o=t[i].Yb[n];for(n=0;16>i;++i){if(!A(e,o[n+0]))return i;for(;!A(e,o[n+1]);)if(o=t[++i].Yb[0],n=0,16==i)return 16;var c=t[i+1].Yb;if(A(e,o[n+2])){var l=e,u=0;if(A(l,(d=o)[(h=n)+3]))if(A(l,d[h+6])){for(o=0,h=2*(u=A(l,d[h+8]))+(d=A(l,d[h+9+u])),u=0,d=si[h];d[o];++o)u+=u+A(l,d[o]);u+=3+(8<<h)}else A(l,d[h+7])?(u=7+2*A(l,165),u+=A(l,145)):u=5+A(l,159);else u=A(l,d[h+4])?3+A(l,d[h+5]):2;o=c[2]}else u=1,o=c[1];c=a+ai[i],0>(l=e).b&&_(l);var h,d=l.b,f=(h=l.Ca>>1)-(l.I>>d)>>31;--l.b,l.Ca+=f,l.Ca|=1,l.I-=(h+1&f)<<d,s[c]=((u^f)-f)*r[(0<i)+0]}return 16}function Qe(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,s(e.zc,0,0,e.zc.length),e.ja=0}function et(e,t){if(null==e)return 0;if(null==t)return Ye(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!Je(e,t))return 0;if(n(e.cb),null==t.ac||t.ac(t)){t.ob&&(e.L=0);var r=Vi[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=t.v-r>>4,e.zb=t.j-r>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=t.o+15+r>>4,e.Hb=t.va+15+r>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var c=e.ed;for(r=0;4>r;++r){var l;if(e.Qa.Cb){var u=e.Qa.Lb[r];e.Qa.Fb||(u+=c.Tb)}else u=c.Tb;for(l=0;1>=l;++l){var h=e.gd[r][l],d=u;if(c.Pc&&(d+=c.vd[0],l&&(d+=c.od[0])),0<(d=0>d?0:63<d?63:d)){var f=d;0<c.wb&&(f=4<c.wb?f>>2:f>>1)>9-c.wb&&(f=9-c.wb),1>f&&(f=1),h.dd=f,h.tc=2*d+f,h.ld=40<=d?2:15<=d?1:0}else h.tc=0;h.La=l}}}r=0}else Ye(e,6,"Frame setup failed"),r=e.a;if(r=0==r){if(r){e.$c=0,0<e.Aa||(e.Ic=zi);e:{r=e.Ic,c=4*(f=e.za);var p=32*f,g=f+1,m=0<e.L?f*(0<e.Aa?2:1):0,y=(2==e.Aa?2:1)*f;if((h=c+832+(l=3*(16*r+Vi[e.L])/2*p)+(u=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=h)r=0;else{if(h>e.Vb){if(e.Vb=0,e.Ec=a(h),e.Fc=0,null==e.Ec){r=Ye(e,1,"no memory during frame initialization.");break e}e.Vb=h}h=e.Ec,d=e.Fc,e.Ac=h,e.Bc=d,d+=c,e.Gd=o(p,He),e.Hd=0,e.rb=o(g+1,Ve),e.sb=1,e.wa=m?o(m,Ue):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=f),n(!0),e.oc=h,e.pc=d,d+=832,e.ya=o(y,ze),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=f),e.R=16*f,e.B=8*f,f=(p=Vi[e.L])*e.R,p=p/2*e.B,e.sa=h,e.ta=d+f,e.qa=e.sa,e.ra=e.ta+16*r*e.R+p,e.Ha=e.qa,e.Ia=e.ra+8*r*e.B+p,e.$c=0,d+=l,e.mb=u?h:null,e.nb=u?d:null,n(d+u<=e.Fc+e.Vb),Qe(e),s(e.Ac,e.Bc,0,c),r=1}}if(r){if(t.ka=0,t.y=e.sa,t.O=e.ta,t.f=e.qa,t.N=e.ra,t.ea=e.Ha,t.Vd=e.Ia,t.fa=e.R,t.Rc=e.B,t.F=null,t.J=0,!Mr){for(r=-255;255>=r;++r)Cr[255+r]=0>r?-r:r;for(r=-1020;1020>=r;++r)Ar[1020+r]=-128>r?-128:127<r?127:r;for(r=-112;112>=r;++r)Fr[112+r]=-16>r?-16:15<r?15:r;for(r=-255;510>=r;++r)Rr[255+r]=0>r?0:255<r?255:r;Mr=1}ar=ut,or=at,lr=ot,ur=ct,hr=lt,cr=st,dr=Yt,fr=Kt,pr=Qt,gr=en,mr=Jt,yr=Zt,br=tn,wr=nn,vr=Gt,Sr=Ht,xr=$t,Er=Wt,fi[0]=kt,fi[1]=dt,fi[2]=Et,fi[3]=It,fi[4]=Tt,fi[5]=Ct,fi[6]=_t,fi[7]=At,fi[8]=Rt,fi[9]=Ft,di[0]=bt,di[1]=pt,di[2]=gt,di[3]=mt,di[4]=wt,di[5]=vt,di[6]=St,pi[0]=Pt,pi[1]=ft,pi[2]=Mt,pi[3]=Dt,pi[4]=Lt,pi[5]=Nt,pi[6]=Bt,r=1}else r=0}r&&(r=function(e,t){for(e.M=0;e.M<e.Va;++e.M){var r,o=e.Jc[e.M&e.Xb],c=e.m,l=e;for(r=0;r<l.za;++r){var u=c,h=l,d=h.Ac,f=h.Bc+4*r,p=h.zc,g=h.ya[h.aa+r];if(h.Qa.Bb?g.$b=A(u,h.Pa.jb[0])?2+A(u,h.Pa.jb[2]):A(u,h.Pa.jb[1]):g.$b=0,h.kc&&(g.Ad=A(u,h.Bd)),g.Za=!A(u,145)+0,g.Za){var m=g.Ob,y=0;for(h=0;4>h;++h){var b,w=p[0+h];for(b=0;4>b;++b){w=li[d[f+b]][w];for(var v=oi[A(u,w[0])];0<v;)v=oi[2*v+A(u,w[v])];w=-v,d[f+b]=w}i(m,y,d,f,4),y+=4,p[0+h]=w}}else w=A(u,156)?A(u,128)?1:3:A(u,163)?2:0,g.Ob[0]=w,s(d,f,w,4),s(p,0,w,4);g.Dd=A(u,142)?A(u,114)?A(u,183)?1:3:2:0}if(l.m.Ka)return Ye(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(l=o,u=(c=e).rb[c.sb-1],d=c.rb[c.sb+c.ja],r=c.ya[c.aa+c.ja],f=c.kc?r.Ad:0)u.la=d.la=0,r.Za||(u.Na=d.Na=0),r.Hc=0,r.Gc=0,r.ia=0;else{var S,x;if(u=d,d=l,f=c.Pa.Xc,p=c.ya[c.aa+c.ja],g=c.pb[p.$b],h=p.ad,m=0,y=c.rb[c.sb-1],w=b=0,s(h,m,0,384),p.Za)var E=0,I=f[3];else{v=a(16);var k=u.Na+y.Na;if(k=ii(d,f[1],k,g.Eb,0,v,0),u.Na=y.Na=(0<k)+0,1<k)ar(v,0,h,m);else{var T=v[0]+3>>3;for(v=0;256>v;v+=16)h[m+v]=T}E=1,I=f[0]}var _=15&u.la,C=15&y.la;for(v=0;4>v;++v){var F=1&C;for(T=x=0;4>T;++T)_=_>>1|(F=(k=ii(d,I,k=F+(1&_),g.Sc,E,h,m))>E)<<7,x=x<<2|(3<k?3:1<k?2:0!=h[m+0]),m+=16;_>>=4,C=C>>1|F<<7,b=(b<<8|x)>>>0}for(I=_,E=C>>4,S=0;4>S;S+=2){for(x=0,_=u.la>>4+S,C=y.la>>4+S,v=0;2>v;++v){for(F=1&C,T=0;2>T;++T)k=F+(1&_),_=_>>1|(F=0<(k=ii(d,f[2],k,g.Qc,0,h,m)))<<3,x=x<<2|(3<k?3:1<k?2:0!=h[m+0]),m+=16;_>>=2,C=C>>1|F<<5}w|=x<<4*S,I|=_<<4<<S,E|=(240&C)<<S}u.la=I,y.la=E,p.Hc=b,p.Gc=w,p.ia=43690&w?0:g.ia,f=!(b|w)}if(0<c.L&&(c.wa[c.Y+c.ja]=c.gd[r.$b][r.Za],c.wa[c.Y+c.ja].La|=!f),l.Ka)return Ye(e,7,"Premature end-of-file encountered.")}if(Qe(e),c=t,l=1,r=(o=e).D,u=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)e:{if(r.M=o.M,r.uc=u,Pn(o,r),l=1,r=(x=o.D).Nb,u=(w=Vi[o.L])*o.R,d=w/2*o.B,v=16*r*o.R,T=8*r*o.B,f=o.sa,p=o.ta-u+v,g=o.qa,h=o.ra-d+T,m=o.Ha,y=o.Ia-d+T,C=0==(_=x.M),b=_>=o.Va-1,2==o.Aa&&Pn(o,x),x.uc)for(F=(k=o).D.M,n(k.D.uc),x=k.yb;x<k.Hb;++x){E=x,I=F;var R=(M=(j=k).D).Nb;S=j.R;var M=M.wa[M.Y+E],D=j.sa,O=j.ta+16*R*S+16*E,P=M.dd,N=M.tc;if(0!=N)if(n(3<=N),1==j.L)0<E&&Sr(D,O,S,N+4),M.La&&Er(D,O,S,N),0<I&&vr(D,O,S,N+4),M.La&&xr(D,O,S,N);else{var L=j.B,B=j.qa,U=j.ra+8*R*L+8*E,V=j.Ha,j=j.Ia+8*R*L+8*E;R=M.ld,0<E&&(fr(D,O,S,N+4,P,R),gr(B,U,V,j,L,N+4,P,R)),M.La&&(yr(D,O,S,N,P,R),wr(B,U,V,j,L,N,P,R)),0<I&&(dr(D,O,S,N+4,P,R),pr(B,U,V,j,L,N+4,P,R)),M.La&&(mr(D,O,S,N,P,R),br(B,U,V,j,L,N,P,R))}}if(o.ia&&alert("todo:DitherRow"),null!=c.put){if(x=16*_,_=16*(_+1),C?(c.y=o.sa,c.O=o.ta+v,c.f=o.qa,c.N=o.ra+T,c.ea=o.Ha,c.W=o.Ia+T):(x-=w,c.y=f,c.O=p,c.f=g,c.N=h,c.ea=m,c.W=y),b||(_-=w),_>c.o&&(_=c.o),c.F=null,c.J=null,null!=o.Fa&&0<o.Fa.length&&x<_&&(c.J=fn(o,c,x,_-x),c.F=o.mb,null==c.F&&0==c.F.length)){l=Ye(o,3,"Could not decode alpha data.");break e}x<c.j&&(w=c.j-x,x=c.j,n(!(1&w)),c.O+=o.R*w,c.N+=o.B*(w>>1),c.W+=o.B*(w>>1),null!=c.F&&(c.J+=c.width*w)),x<_&&(c.O+=c.v,c.N+=c.v>>1,c.W+=c.v>>1,null!=c.F&&(c.J+=c.v),c.ka=x-c.j,c.U=c.va-c.v,c.T=_-x,l=c.put(c))}r+1!=o.Ic||b||(i(o.sa,o.ta-u,f,p+16*o.R,u),i(o.qa,o.ra-d,g,h+8*o.B,d),i(o.Ha,o.Ia-d,m,y+8*o.B,d))}if(!l)return Ye(e,6,"Output aborted.")}return 1}(e,t)),null!=t.bc&&t.bc(t),r&=1}return r?(e.cb=0,r):0}function tt(e,t,n,r,i){i=e[t+n+32*r]+(i>>3),e[t+n+32*r]=-256&i?0>i?0:255:i}function nt(e,t,n,r,i,s){tt(e,t,0,n,r+i),tt(e,t,1,n,r+s),tt(e,t,2,n,r-s),tt(e,t,3,n,r-i)}function rt(e){return(20091*e>>16)+e}function it(e,t,n,r){var i,s=0,o=a(16);for(i=0;4>i;++i){var c=e[t+0]+e[t+8],l=e[t+0]-e[t+8],u=(35468*e[t+4]>>16)-rt(e[t+12]),h=rt(e[t+4])+(35468*e[t+12]>>16);o[s+0]=c+h,o[s+1]=l+u,o[s+2]=l-u,o[s+3]=c-h,s+=4,t++}for(i=s=0;4>i;++i)c=(e=o[s+0]+4)+o[s+8],l=e-o[s+8],u=(35468*o[s+4]>>16)-rt(o[s+12]),tt(n,r,0,0,c+(h=rt(o[s+4])+(35468*o[s+12]>>16))),tt(n,r,1,0,l+u),tt(n,r,2,0,l-u),tt(n,r,3,0,c-h),s++,r+=32}function st(e,t,n,r){var i=e[t+0]+4,s=35468*e[t+4]>>16,a=rt(e[t+4]),o=35468*e[t+1]>>16;nt(n,r,0,i+a,e=rt(e[t+1]),o),nt(n,r,1,i+s,e,o),nt(n,r,2,i-s,e,o),nt(n,r,3,i-a,e,o)}function at(e,t,n,r,i){it(e,t,n,r),i&&it(e,t+16,n,r+4)}function ot(e,t,n,r){or(e,t+0,n,r,1),or(e,t+32,n,r+128,1)}function ct(e,t,n,r){var i;for(e=e[t+0]+4,i=0;4>i;++i)for(t=0;4>t;++t)tt(n,r,t,i,e)}function lt(e,t,n,r){e[t+0]&&ur(e,t+0,n,r),e[t+16]&&ur(e,t+16,n,r+4),e[t+32]&&ur(e,t+32,n,r+128),e[t+48]&&ur(e,t+48,n,r+128+4)}function ut(e,t,n,r){var i,s=a(16);for(i=0;4>i;++i){var o=e[t+0+i]+e[t+12+i],c=e[t+4+i]+e[t+8+i],l=e[t+4+i]-e[t+8+i],u=e[t+0+i]-e[t+12+i];s[0+i]=o+c,s[8+i]=o-c,s[4+i]=u+l,s[12+i]=u-l}for(i=0;4>i;++i)o=(e=s[0+4*i]+3)+s[3+4*i],c=s[1+4*i]+s[2+4*i],l=s[1+4*i]-s[2+4*i],u=e-s[3+4*i],n[r+0]=o+c>>3,n[r+16]=u+l>>3,n[r+32]=o-c>>3,n[r+48]=u-l>>3,r+=64}function ht(e,t,n){var r,i=t-32,s=Pr,a=255-e[i-1];for(r=0;r<n;++r){var o,c=s,l=a+e[t-1];for(o=0;o<n;++o)e[t+o]=c[l+e[i+o]];t+=32}}function dt(e,t){ht(e,t,4)}function ft(e,t){ht(e,t,8)}function pt(e,t){ht(e,t,16)}function gt(e,t){var n;for(n=0;16>n;++n)i(e,t+32*n,e,t-32,16)}function mt(e,t){var n;for(n=16;0<n;--n)s(e,t,e[t-1],16),t+=32}function yt(e,t,n){var r;for(r=0;16>r;++r)s(t,n+32*r,e,16)}function bt(e,t){var n,r=16;for(n=0;16>n;++n)r+=e[t-1+32*n]+e[t+n-32];yt(r>>5,e,t)}function wt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t-1+32*n];yt(r>>4,e,t)}function vt(e,t){var n,r=8;for(n=0;16>n;++n)r+=e[t+n-32];yt(r>>4,e,t)}function St(e,t){yt(128,e,t)}function xt(e,t,n){return e+2*t+n+2>>2}function Et(e,t){var n,r=t-32;for(r=new Uint8Array([xt(e[r-1],e[r+0],e[r+1]),xt(e[r+0],e[r+1],e[r+2]),xt(e[r+1],e[r+2],e[r+3]),xt(e[r+2],e[r+3],e[r+4])]),n=0;4>n;++n)i(e,t+32*n,r,0,r.length)}function It(e,t){var n=e[t-1],r=e[t-1+32],i=e[t-1+64],s=e[t-1+96];F(e,t+0,16843009*xt(e[t-1-32],n,r)),F(e,t+32,16843009*xt(n,r,i)),F(e,t+64,16843009*xt(r,i,s)),F(e,t+96,16843009*xt(i,s,s))}function kt(e,t){var n,r=4;for(n=0;4>n;++n)r+=e[t+n-32]+e[t-1+32*n];for(r>>=3,n=0;4>n;++n)s(e,t+32*n,r,4)}function Tt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1-32],a=e[t+0-32],o=e[t+1-32],c=e[t+2-32],l=e[t+3-32];e[t+0+96]=xt(r,i,e[t-1+96]),e[t+1+96]=e[t+0+64]=xt(n,r,i),e[t+2+96]=e[t+1+64]=e[t+0+32]=xt(s,n,r),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=xt(a,s,n),e[t+3+64]=e[t+2+32]=e[t+1+0]=xt(o,a,s),e[t+3+32]=e[t+2+0]=xt(c,o,a),e[t+3+0]=xt(l,c,o)}function _t(e,t){var n=e[t+1-32],r=e[t+2-32],i=e[t+3-32],s=e[t+4-32],a=e[t+5-32],o=e[t+6-32],c=e[t+7-32];e[t+0+0]=xt(e[t+0-32],n,r),e[t+1+0]=e[t+0+32]=xt(n,r,i),e[t+2+0]=e[t+1+32]=e[t+0+64]=xt(r,i,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=xt(i,s,a),e[t+3+32]=e[t+2+64]=e[t+1+96]=xt(s,a,o),e[t+3+64]=e[t+2+96]=xt(a,o,c),e[t+3+96]=xt(o,c,c)}function Ct(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1-32],a=e[t+0-32],o=e[t+1-32],c=e[t+2-32],l=e[t+3-32];e[t+0+0]=e[t+1+64]=s+a+1>>1,e[t+1+0]=e[t+2+64]=a+o+1>>1,e[t+2+0]=e[t+3+64]=o+c+1>>1,e[t+3+0]=c+l+1>>1,e[t+0+96]=xt(i,r,n),e[t+0+64]=xt(r,n,s),e[t+0+32]=e[t+1+96]=xt(n,s,a),e[t+1+32]=e[t+2+96]=xt(s,a,o),e[t+2+32]=e[t+3+96]=xt(a,o,c),e[t+3+32]=xt(o,c,l)}function At(e,t){var n=e[t+0-32],r=e[t+1-32],i=e[t+2-32],s=e[t+3-32],a=e[t+4-32],o=e[t+5-32],c=e[t+6-32],l=e[t+7-32];e[t+0+0]=n+r+1>>1,e[t+1+0]=e[t+0+64]=r+i+1>>1,e[t+2+0]=e[t+1+64]=i+s+1>>1,e[t+3+0]=e[t+2+64]=s+a+1>>1,e[t+0+32]=xt(n,r,i),e[t+1+32]=e[t+0+96]=xt(r,i,s),e[t+2+32]=e[t+1+96]=xt(i,s,a),e[t+3+32]=e[t+2+96]=xt(s,a,o),e[t+3+64]=xt(a,o,c),e[t+3+96]=xt(o,c,l)}function Ft(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1+96];e[t+0+0]=n+r+1>>1,e[t+2+0]=e[t+0+32]=r+i+1>>1,e[t+2+32]=e[t+0+64]=i+s+1>>1,e[t+1+0]=xt(n,r,i),e[t+3+0]=e[t+1+32]=xt(r,i,s),e[t+3+32]=e[t+1+64]=xt(i,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function Rt(e,t){var n=e[t-1+0],r=e[t-1+32],i=e[t-1+64],s=e[t-1+96],a=e[t-1-32],o=e[t+0-32],c=e[t+1-32],l=e[t+2-32];e[t+0+0]=e[t+2+32]=n+a+1>>1,e[t+0+32]=e[t+2+64]=r+n+1>>1,e[t+0+64]=e[t+2+96]=i+r+1>>1,e[t+0+96]=s+i+1>>1,e[t+3+0]=xt(o,c,l),e[t+2+0]=xt(a,o,c),e[t+1+0]=e[t+3+32]=xt(n,a,o),e[t+1+32]=e[t+3+64]=xt(r,n,a),e[t+1+64]=e[t+3+96]=xt(i,r,n),e[t+1+96]=xt(s,i,r)}function Mt(e,t){var n;for(n=0;8>n;++n)i(e,t+32*n,e,t-32,8)}function Dt(e,t){var n;for(n=0;8>n;++n)s(e,t,e[t-1],8),t+=32}function Ot(e,t,n){var r;for(r=0;8>r;++r)s(t,n+32*r,e,8)}function Pt(e,t){var n,r=8;for(n=0;8>n;++n)r+=e[t+n-32]+e[t-1+32*n];Ot(r>>4,e,t)}function Nt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t+n-32];Ot(r>>3,e,t)}function Lt(e,t){var n,r=4;for(n=0;8>n;++n)r+=e[t-1+32*n];Ot(r>>3,e,t)}function Bt(e,t){Ot(128,e,t)}function Ut(e,t,n){var r=e[t-n],i=e[t+0],s=3*(i-r)+Dr[1020+e[t-2*n]-e[t+n]],a=Or[112+(s+4>>3)];e[t-n]=Pr[255+r+Or[112+(s+3>>3)]],e[t+0]=Pr[255+i-a]}function Vt(e,t,n,r){var i=e[t+0],s=e[t+n];return Nr[255+e[t-2*n]-e[t-n]]>r||Nr[255+s-i]>r}function jt(e,t,n,r){return 4*Nr[255+e[t-n]-e[t+0]]+Nr[255+e[t-2*n]-e[t+n]]<=r}function zt(e,t,n,r,i){var s=e[t-3*n],a=e[t-2*n],o=e[t-n],c=e[t+0],l=e[t+n],u=e[t+2*n],h=e[t+3*n];return 4*Nr[255+o-c]+Nr[255+a-l]>r?0:Nr[255+e[t-4*n]-s]<=i&&Nr[255+s-a]<=i&&Nr[255+a-o]<=i&&Nr[255+h-u]<=i&&Nr[255+u-l]<=i&&Nr[255+l-c]<=i}function Gt(e,t,n,r){var i=2*r+1;for(r=0;16>r;++r)jt(e,t+r,n,i)&&Ut(e,t+r,n)}function Ht(e,t,n,r){var i=2*r+1;for(r=0;16>r;++r)jt(e,t+r*n,1,i)&&Ut(e,t+r*n,1)}function $t(e,t,n,r){var i;for(i=3;0<i;--i)Gt(e,t+=4*n,n,r)}function Wt(e,t,n,r){var i;for(i=3;0<i;--i)Ht(e,t+=4,n,r)}function qt(e,t,n,r,i,s,a,o){for(s=2*s+1;0<i--;){if(zt(e,t,n,s,a))if(Vt(e,t,n,o))Ut(e,t,n);else{var c=e,l=t,u=n,h=c[l-2*u],d=c[l-u],f=c[l+0],p=c[l+u],g=c[l+2*u],m=27*(b=Dr[1020+3*(f-d)+Dr[1020+h-p]])+63>>7,y=18*b+63>>7,b=9*b+63>>7;c[l-3*u]=Pr[255+c[l-3*u]+b],c[l-2*u]=Pr[255+h+y],c[l-u]=Pr[255+d+m],c[l+0]=Pr[255+f-m],c[l+u]=Pr[255+p-y],c[l+2*u]=Pr[255+g-b]}t+=r}}function Xt(e,t,n,r,i,s,a,o){for(s=2*s+1;0<i--;){if(zt(e,t,n,s,a))if(Vt(e,t,n,o))Ut(e,t,n);else{var c=e,l=t,u=n,h=c[l-u],d=c[l+0],f=c[l+u],p=Or[112+(4+(g=3*(d-h))>>3)],g=Or[112+(g+3>>3)],m=p+1>>1;c[l-2*u]=Pr[255+c[l-2*u]+m],c[l-u]=Pr[255+h+g],c[l+0]=Pr[255+d-p],c[l+u]=Pr[255+f-m]}t+=r}}function Yt(e,t,n,r,i,s){qt(e,t,n,1,16,r,i,s)}function Kt(e,t,n,r,i,s){qt(e,t,1,n,16,r,i,s)}function Jt(e,t,n,r,i,s){var a;for(a=3;0<a;--a)Xt(e,t+=4*n,n,1,16,r,i,s)}function Zt(e,t,n,r,i,s){var a;for(a=3;0<a;--a)Xt(e,t+=4,1,n,16,r,i,s)}function Qt(e,t,n,r,i,s,a,o){qt(e,t,i,1,8,s,a,o),qt(n,r,i,1,8,s,a,o)}function en(e,t,n,r,i,s,a,o){qt(e,t,1,i,8,s,a,o),qt(n,r,1,i,8,s,a,o)}function tn(e,t,n,r,i,s,a,o){Xt(e,t+4*i,i,1,8,s,a,o),Xt(n,r+4*i,i,1,8,s,a,o)}function nn(e,t,n,r,i,s,a,o){Xt(e,t+4,1,i,8,s,a,o),Xt(n,r+4,1,i,8,s,a,o)}function rn(){this.ba=new oe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function sn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function an(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function on(){this.ua=0,this.Wa=new N,this.vb=new N,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new p,this.yc=new d}function cn(){this.xb=this.a=0,this.l=new qe,this.ca=new oe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new x,this.Pb=0,this.wd=new x,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new on,this.ab=0,this.gc=o(4,an),this.Oc=0}function ln(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new qe,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function un(e,t,n,r,i,s,a){for(e=null==e?0:e[t+0],t=0;t<a;++t)i[s+t]=e+n[r+t]&255,e=i[s+t]}function hn(e,t,n,r,i,s,a){var o;if(null==e)un(null,null,n,r,i,s,a);else for(o=0;o<a;++o)i[s+o]=e[t+o]+n[r+o]&255}function dn(e,t,n,r,i,s,a){if(null==e)un(null,null,n,r,i,s,a);else{var o,c=e[t+0],l=c,u=c;for(o=0;o<a;++o)l=u+(c=e[t+o])-l,u=n[r+o]+(-256&l?0>l?0:255:l)&255,l=c,i[s+o]=u}}function fn(e,t,r,s){var o=t.width,c=t.o;if(n(null!=e&&null!=t),0>r||0>=s||r+s>c)return null;if(!e.Cc){if(null==e.ga){var l;if(e.ga=new ln,(l=null==e.ga)||(l=t.width*t.o,n(0==e.Gb.length),e.Gb=a(l),e.Uc=0,null==e.Gb?l=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,l=1),l=!l),!l){l=e.ga;var u=e.Fa,h=e.P,d=e.qc,f=e.mb,p=e.nb,g=h+1,m=d-1,y=l.l;if(n(null!=u&&null!=f&&null!=t),yi[0]=null,yi[1]=un,yi[2]=hn,yi[3]=dn,l.ca=f,l.tb=p,l.c=t.width,l.i=t.height,n(0<l.c&&0<l.i),1>=d)t=0;else if(l.$a=3&u[h+0],l.Z=u[h+0]>>2&3,l.Lc=u[h+0]>>4&3,h=u[h+0]>>6&3,0>l.$a||1<l.$a||4<=l.Z||1<l.Lc||h)t=0;else if(y.put=pe,y.ac=fe,y.bc=ge,y.ma=l,y.width=t.width,y.height=t.height,y.Da=t.Da,y.v=t.v,y.va=t.va,y.j=t.j,y.o=t.o,l.$a)e:{n(1==l.$a),t=Ae();t:for(;;){if(null==t){t=0;break e}if(n(null!=l),l.mc=t,t.c=l.c,t.i=l.i,t.l=l.l,t.l.ma=l,t.l.width=l.c,t.l.height=l.i,t.a=0,b(t.m,u,g,m),!Fe(l.c,l.i,1,t,null))break t;if(1==t.ab&&3==t.gc[0].hc&&Ie(t.s)?(l.ic=1,u=t.c*t.i,t.Ta=null,t.Ua=0,t.V=a(u),t.Ba=0,null==t.V?(t.a=1,t=0):t=1):(l.ic=0,t=Re(t,l.c)),!t)break t;t=1;break e}l.mc=null,t=0}else t=m>=l.c*l.i;l=!t}if(l)return null;1!=e.ga.Lc?e.Ga=0:s=c-r}n(null!=e.ga),n(r+s<=c);e:{if(t=(u=e.ga).c,c=u.l.o,0==u.$a){if(g=e.rc,m=e.Vc,y=e.Fa,h=e.P+1+r*t,d=e.mb,f=e.nb+r*t,n(h<=e.P+e.qc),0!=u.Z)for(n(null!=yi[u.Z]),l=0;l<s;++l)yi[u.Z](g,m,y,h,d,f,t),g=d,m=f,f+=t,h+=t;else for(l=0;l<s;++l)i(d,f,y,h,t),g=d,m=f,f+=t,h+=t;e.rc=g,e.Vc=m}else{if(n(null!=u.mc),t=r+s,n(null!=(l=u.mc)),n(t<=l.i),l.C>=t)t=1;else if(u.ic||bn(),u.ic){u=l.V,g=l.Ba,m=l.c;var w=l.i,v=(y=1,h=l.$/m,d=l.$%m,f=l.m,p=l.s,l.$),S=m*w,x=m*t,E=p.wc,k=v<x?Se(p,d,h):null;n(v<=S),n(t<=w),n(Ie(p));t:for(;;){for(;!f.h&&v<x;){if(d&E||(k=Se(p,d,h)),n(null!=k),T(f),256>(w=we(k.G[0],k.H[0],f)))u[g+v]=w,++v,++d>=m&&(d=0,++h<=t&&!(h%16)&&Te(l,h));else{if(!(280>w)){y=0;break t}w=ye(w-256,f);var _,C=we(k.G[4],k.H[4],f);if(T(f),!(v>=(C=be(m,C=ye(C,f)))&&S-v>=w)){y=0;break t}for(_=0;_<w;++_)u[g+v+_]=u[g+v+_-C];for(v+=w,d+=w;d>=m;)d-=m,++h<=t&&!(h%16)&&Te(l,h);v<x&&d&E&&(k=Se(p,d,h))}n(f.h==I(f))}Te(l,h>t?t:h);break t}!y||f.h&&v<S?(y=0,l.a=f.h?5:3):l.$=v,t=y}else t=_e(l,l.V,l.Ba,l.c,l.i,t,Me);if(!t){s=0;break e}}r+s>=c&&(e.Cc=1),s=1}if(!s)return null;if(e.Cc&&(null!=(s=e.ga)&&(s.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+r*o}function pn(e,t,n,r,i,s){for(;0<i--;){var a,o=e,c=t+(n?1:0),l=e,u=t+(n?0:3);for(a=0;a<r;++a){var h=l[u+4*a];255!=h&&(h*=32897,o[c+4*a+0]=o[c+4*a+0]*h>>23,o[c+4*a+1]=o[c+4*a+1]*h>>23,o[c+4*a+2]=o[c+4*a+2]*h>>23)}t+=s}}function gn(e,t,n,r,i){for(;0<r--;){var s;for(s=0;s<n;++s){var a=e[t+2*s+0],o=15&(l=e[t+2*s+1]),c=4369*o,l=(240&l|l>>4)*c>>16;e[t+2*s+0]=(240&a|a>>4)*c>>16&240|(15&a|a<<4)*c>>16>>4&15,e[t+2*s+1]=240&l|o}t+=i}}function mn(e,t,n,r,i,s,a,o){var c,l,u=255;for(l=0;l<i;++l){for(c=0;c<r;++c){var h=e[t+c];s[a+4*c]=h,u&=h}t+=n,a+=o}return 255!=u}function yn(e,t,n,r,i){var s;for(s=0;s<i;++s)n[r+s]=e[t+s]>>8}function bn(){Ir=pn,kr=gn,Tr=mn,_r=yn}function wn(e,r,i){t[e]=function(e,t,s,a,o,c,l,u,h,d,f,p,g,m,y,b,w){var v,S=w-1>>1,x=o[c+0]|l[u+0]<<16,E=h[d+0]|f[p+0]<<16;n(null!=e);var I=3*x+E+131074>>2;for(r(e[t+0],255&I,I>>16,g,m),null!=s&&(I=3*E+x+131074>>2,r(s[a+0],255&I,I>>16,y,b)),v=1;v<=S;++v){var k=o[c+v]|l[u+v]<<16,T=h[d+v]|f[p+v]<<16,_=x+k+E+T+524296,C=_+2*(k+E)>>3;I=C+x>>1,x=(_=_+2*(x+T)>>3)+k>>1,r(e[t+2*v-1],255&I,I>>16,g,m+(2*v-1)*i),r(e[t+2*v-0],255&x,x>>16,g,m+(2*v-0)*i),null!=s&&(I=_+E>>1,x=C+T>>1,r(s[a+2*v-1],255&I,I>>16,y,b+(2*v-1)*i),r(s[a+2*v+0],255&x,x>>16,y,b+(2*v+0)*i)),x=k,E=T}1&w||(I=3*x+E+131074>>2,r(e[t+w-1],255&I,I>>16,g,m+(w-1)*i),null!=s&&(I=3*E+x+131074>>2,r(s[a+w-1],255&I,I>>16,y,b+(w-1)*i)))}}function vn(){bi[Lr]=wi,bi[Br]=Si,bi[Ur]=vi,bi[Vr]=xi,bi[jr]=Ei,bi[zr]=Ii,bi[Gr]=ki,bi[Hr]=Si,bi[$r]=xi,bi[Wr]=Ei,bi[qr]=Ii}function Sn(e){return e&~Ri?0>e?0:255:e>>Fi}function xn(e,t){return Sn((19077*e>>8)+(26149*t>>8)-14234)}function En(e,t,n){return Sn((19077*e>>8)-(6419*t>>8)-(13320*n>>8)+8708)}function In(e,t){return Sn((19077*e>>8)+(33050*t>>8)-17685)}function kn(e,t,n,r,i){r[i+0]=xn(e,n),r[i+1]=En(e,t,n),r[i+2]=In(e,t)}function Tn(e,t,n,r,i){r[i+0]=In(e,t),r[i+1]=En(e,t,n),r[i+2]=xn(e,n)}function _n(e,t,n,r,i){var s=En(e,t,n);t=s<<3&224|In(e,t)>>3,r[i+0]=248&xn(e,n)|s>>5,r[i+1]=t}function Cn(e,t,n,r,i){var s=240&In(e,t)|15;r[i+0]=240&xn(e,n)|En(e,t,n)>>4,r[i+1]=s}function An(e,t,n,r,i){r[i+0]=255,kn(e,t,n,r,i+1)}function Fn(e,t,n,r,i){Tn(e,t,n,r,i),r[i+3]=255}function Rn(e,t,n,r,i){kn(e,t,n,r,i),r[i+3]=255}function We(e,t){return 0>e?0:e>t?t:e}function Mn(e,n,r){t[e]=function(e,t,i,s,a,o,c,l,u){for(var h=l+(-2&u)*r;l!=h;)n(e[t+0],i[s+0],a[o+0],c,l),n(e[t+1],i[s+0],a[o+0],c,l+r),t+=2,++s,++o,l+=2*r;1&u&&n(e[t+0],i[s+0],a[o+0],c,l)}}function Dn(e,t,n){return 0==n?0==e?0==t?6:5:0==t?4:0:n}function On(e,t,n,r,i){switch(e>>>30){case 3:or(t,n,r,i,0);break;case 2:cr(t,n,r,i);break;case 1:ur(t,n,r,i)}}function Pn(e,t){var n,r,a=t.M,o=t.Nb,c=e.oc,l=e.pc+40,u=e.oc,h=e.pc+584,d=e.oc,f=e.pc+600;for(n=0;16>n;++n)c[l+32*n-1]=129;for(n=0;8>n;++n)u[h+32*n-1]=129,d[f+32*n-1]=129;for(0<a?c[l-1-32]=u[h-1-32]=d[f-1-32]=129:(s(c,l-32-1,127,21),s(u,h-32-1,127,9),s(d,f-32-1,127,9)),r=0;r<e.za;++r){var p=t.ya[t.aa+r];if(0<r){for(n=-1;16>n;++n)i(c,l+32*n-4,c,l+32*n+12,4);for(n=-1;8>n;++n)i(u,h+32*n-4,u,h+32*n+4,4),i(d,f+32*n-4,d,f+32*n+4,4)}var g=e.Gd,m=e.Hd+r,y=p.ad,b=p.Hc;if(0<a&&(i(c,l-32,g[m].y,0,16),i(u,h-32,g[m].f,0,8),i(d,f-32,g[m].ea,0,8)),p.Za){var w=c,v=l-32+16;for(0<a&&(r>=e.za-1?s(w,v,g[m].y[15],4):i(w,v,g[m+1].y,0,4)),n=0;4>n;n++)w[v+128+n]=w[v+256+n]=w[v+384+n]=w[v+0+n];for(n=0;16>n;++n,b<<=2)w=c,v=l+Ui[n],fi[p.Ob[n]](w,v),On(b,y,16*+n,w,v)}else if(w=Dn(r,a,p.Ob[0]),di[w](c,l),0!=b)for(n=0;16>n;++n,b<<=2)On(b,y,16*+n,c,l+Ui[n]);for(n=p.Gc,w=Dn(r,a,p.Dd),pi[w](u,h),pi[w](d,f),b=y,w=u,v=h,255&(p=0|n)&&(170&p?lr(b,256,w,v):hr(b,256,w,v)),p=d,b=f,255&(n>>=8)&&(170&n?lr(y,320,p,b):hr(y,320,p,b)),a<e.Ub-1&&(i(g[m].y,0,c,l+480,16),i(g[m].f,0,u,h+224,8),i(g[m].ea,0,d,f+224,8)),n=8*o*e.B,g=e.sa,m=e.ta+16*r+16*o*e.R,y=e.qa,p=e.ra+8*r+n,b=e.Ha,w=e.Ia+8*r+n,n=0;16>n;++n)i(g,m+n*e.R,c,l+32*n,16);for(n=0;8>n;++n)i(y,p+n*e.B,u,h+32*n,8),i(b,w+n*e.B,d,f+32*n,8)}}function Nn(e,t,i,s,a,o,c,l,u){var h=[0],d=[0],f=0,p=null!=u?u.kd:0,g=null!=u?u:new sn;if(null==e||12>i)return 7;g.data=e,g.w=t,g.ha=i,t=[t],i=[i],g.gb=[g.gb];e:{var m=t,y=i,w=g.gb;if(n(null!=e),n(null!=y),n(null!=w),w[0]=0,12<=y[0]&&!r(e,m[0],"RIFF")){if(r(e,m[0]+8,"WEBP")){w=3;break e}var v=D(e,m[0]+4);if(12>v||4294967286<v){w=3;break e}if(p&&v>y[0]-8){w=7;break e}w[0]=v,m[0]+=12,y[0]-=12}w=0}if(0!=w)return w;for(v=0<g.gb[0],i=i[0];;){e:{var S=e;y=t,w=i;var E=h,I=d,k=m=[0];if((C=f=[f])[0]=0,8>w[0])w=7;else{if(!r(S,y[0],"VP8X")){if(10!=D(S,y[0]+4)){w=3;break e}if(18>w[0]){w=7;break e}var T=D(S,y[0]+8),_=1+M(S,y[0]+12);if(2147483648<=_*(S=1+M(S,y[0]+15))){w=3;break e}null!=k&&(k[0]=T),null!=E&&(E[0]=_),null!=I&&(I[0]=S),y[0]+=18,w[0]-=18,C[0]=1}w=0}}if(f=f[0],m=m[0],0!=w)return w;if(y=!!(2&m),!v&&f)return 3;if(null!=o&&(o[0]=!!(16&m)),null!=c&&(c[0]=y),null!=l&&(l[0]=0),c=h[0],m=d[0],f&&y&&null==u){w=0;break}if(4>i){w=7;break}if(v&&f||!v&&!f&&!r(e,t[0],"ALPH")){i=[i],g.na=[g.na],g.P=[g.P],g.Sa=[g.Sa];e:{T=e,w=t,v=i;var C=g.gb;E=g.na,I=g.P,k=g.Sa,_=22,n(null!=T),n(null!=v),S=w[0];var A=v[0];for(n(null!=E),n(null!=k),E[0]=null,I[0]=null,k[0]=0;;){if(w[0]=S,v[0]=A,8>A){w=7;break e}var F=D(T,S+4);if(4294967286<F){w=3;break e}var R=8+F+1&-2;if(_+=R,0<C&&_>C){w=3;break e}if(!r(T,S,"VP8 ")||!r(T,S,"VP8L")){w=0;break e}if(A[0]<R){w=7;break e}r(T,S,"ALPH")||(E[0]=T,I[0]=S+8,k[0]=F),S+=R,A-=R}}if(i=i[0],g.na=g.na[0],g.P=g.P[0],g.Sa=g.Sa[0],0!=w)break}i=[i],g.Ja=[g.Ja],g.xa=[g.xa];e:if(C=e,w=t,v=i,E=g.gb[0],I=g.Ja,k=g.xa,T=w[0],S=!r(C,T,"VP8 "),_=!r(C,T,"VP8L"),n(null!=C),n(null!=v),n(null!=I),n(null!=k),8>v[0])w=7;else{if(S||_){if(C=D(C,T+4),12<=E&&C>E-12){w=3;break e}if(p&&C>v[0]-8){w=7;break e}I[0]=C,w[0]+=8,v[0]-=8,k[0]=_}else k[0]=5<=v[0]&&47==C[T+0]&&!(C[T+4]>>5),I[0]=v[0];w=0}if(i=i[0],g.Ja=g.Ja[0],g.xa=g.xa[0],t=t[0],0!=w)break;if(4294967286<g.Ja)return 3;if(null==l||y||(l[0]=g.xa?2:1),c=[c],m=[m],g.xa){if(5>i){w=7;break}l=c,p=m,y=o,null==e||5>i?e=0:5<=i&&47==e[t+0]&&!(e[t+4]>>5)?(v=[0],C=[0],E=[0],b(I=new x,e,t,i),me(I,v,C,E)?(null!=l&&(l[0]=v[0]),null!=p&&(p[0]=C[0]),null!=y&&(y[0]=E[0]),e=1):e=0):e=0}else{if(10>i){w=7;break}l=m,null==e||10>i||!Ke(e,t+3,i-3)?e=0:(p=e[t+0]|e[t+1]<<8|e[t+2]<<16,y=16383&(e[t+7]<<8|e[t+6]),e=16383&(e[t+9]<<8|e[t+8]),1&p||3<(p>>1&7)||!(p>>4&1)||p>>5>=g.Ja||!y||!e?e=0:(c&&(c[0]=y),l&&(l[0]=e),e=1))}if(!e)return 3;if(c=c[0],m=m[0],f&&(h[0]!=c||d[0]!=m))return 3;null!=u&&(u[0]=g,u.offset=t-u.w,n(4294967286>t-u.w),n(u.offset==u.ha-i));break}return 0==w||7==w&&f&&null==u?(null!=o&&(o[0]|=null!=g.na&&0<g.na.length),null!=s&&(s[0]=c),null!=a&&(a[0]=m),0):w}function Ln(e,t,n){var r=t.width,i=t.height,s=0,a=0,o=r,c=i;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,c=e.bd,s=e.v,a=e.j,11>n||(s&=-2,a&=-2),0>s||0>a||0>=o||0>=c||s+o>r||a+c>i))return 0;if(t.v=s,t.j=a,t.va=s+o,t.o=a+c,t.U=o,t.T=c,t.da=null!=e&&0<e.da,t.da){if(!L(o,c,n=[e.ib],s=[e.hb]))return 0;t.ib=n[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*r/4&&t.hb<3*i/4,t.Kb=0),1}function Bn(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Un(e,t,n,r){if(null==r||0>=e||0>=t)return 2;if(null!=n){if(n.Da){var i=n.cd,s=n.bd,o=-2&n.v,c=-2&n.j;if(0>o||0>c||0>=i||0>=s||o+i>e||c+s>t)return 2;e=i,t=s}if(n.da){if(!L(e,t,i=[n.ib],s=[n.hb]))return 2;e=i[0],t=s[0]}}r.width=e,r.height=t;e:{var l=r.width,u=r.height;if(e=r.S,0>=l||0>=u||!(e>=Lr&&13>e))e=2;else{if(0>=r.Rd&&null==r.sd){o=s=i=t=0;var h=(c=l*Gi[e])*u;if(11>e||(s=(u+1)/2*(t=(l+1)/2),12==e&&(o=(i=l)*u)),null==(u=a(h+2*s+o))){e=1;break e}r.sd=u,11>e?((l=r.f.RGBA).eb=u,l.fb=0,l.A=c,l.size=h):((l=r.f.kb).y=u,l.O=0,l.fa=c,l.Fd=h,l.f=u,l.N=0+h,l.Ab=t,l.Cd=s,l.ea=u,l.W=0+h+s,l.Db=t,l.Ed=s,12==e&&(l.F=u,l.J=0+h+2*s),l.Tc=o,l.lb=i)}if(t=1,i=r.S,s=r.width,o=r.height,i>=Lr&&13>i)if(11>i)e=r.f.RGBA,t&=(c=Math.abs(e.A))*(o-1)+s<=e.size,t&=c>=s*Gi[i],t&=null!=e.eb;else{e=r.f.kb,c=(s+1)/2,h=(o+1)/2,l=Math.abs(e.fa),u=Math.abs(e.Ab);var d=Math.abs(e.Db),f=Math.abs(e.lb),p=f*(o-1)+s;t&=l*(o-1)+s<=e.Fd,t&=u*(h-1)+c<=e.Cd,t=(t&=d*(h-1)+c<=e.Ed)&l>=s&u>=c&d>=c,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==i&&(t&=f>=s,t&=p<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=n&&n.fd&&(e=Bn(r)),e}var Vn=64,jn=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],zn=24,Gn=32,Hn=8,$n=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];V("Predictor0","PredictorAdd0"),t.Predictor0=function(){return 4278190080},t.Predictor1=function(e){return e},t.Predictor2=function(e,t,n){return t[n+0]},t.Predictor3=function(e,t,n){return t[n+1]},t.Predictor4=function(e,t,n){return t[n-1]},t.Predictor5=function(e,t,n){return z(z(e,t[n+1]),t[n+0])},t.Predictor6=function(e,t,n){return z(e,t[n-1])},t.Predictor7=function(e,t,n){return z(e,t[n+0])},t.Predictor8=function(e,t,n){return z(t[n-1],t[n+0])},t.Predictor9=function(e,t,n){return z(t[n+0],t[n+1])},t.Predictor10=function(e,t,n){return z(z(e,t[n-1]),z(t[n+0],t[n+1]))},t.Predictor11=function(e,t,n){var r=t[n+0];return 0>=$(r>>24&255,e>>24&255,(t=t[n-1])>>24&255)+$(r>>16&255,e>>16&255,t>>16&255)+$(r>>8&255,e>>8&255,t>>8&255)+$(255&r,255&e,255&t)?r:e},t.Predictor12=function(e,t,n){var r=t[n+0];return(G((e>>24&255)+(r>>24&255)-((t=t[n-1])>>24&255))<<24|G((e>>16&255)+(r>>16&255)-(t>>16&255))<<16|G((e>>8&255)+(r>>8&255)-(t>>8&255))<<8|G((255&e)+(255&r)-(255&t)))>>>0},t.Predictor13=function(e,t,n){var r=t[n-1];return(H((e=z(e,t[n+0]))>>24&255,r>>24&255)<<24|H(e>>16&255,r>>16&255)<<16|H(e>>8&255,r>>8&255)<<8|H(255&e,255&r))>>>0};var Wn=t.PredictorAdd0;t.PredictorAdd1=W,V("Predictor2","PredictorAdd2"),V("Predictor3","PredictorAdd3"),V("Predictor4","PredictorAdd4"),V("Predictor5","PredictorAdd5"),V("Predictor6","PredictorAdd6"),V("Predictor7","PredictorAdd7"),V("Predictor8","PredictorAdd8"),V("Predictor9","PredictorAdd9"),V("Predictor10","PredictorAdd10"),V("Predictor11","PredictorAdd11"),V("Predictor12","PredictorAdd12"),V("Predictor13","PredictorAdd13");var qn=t.PredictorAdd2;K("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),K("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Xn,Yn=t.ColorIndexInverseTransform,Kn=t.MapARGB,Jn=t.VP8LColorIndexInverseTransformAlpha,Zn=t.MapAlpha,Qn=t.VP8LPredictorsAdd=[];Qn.length=16,(t.VP8LPredictors=[]).length=16,(t.VP8LPredictorsAdd_C=[]).length=16,(t.VP8LPredictors_C=[]).length=16;var er,tr,nr,rr,ir,sr,ar,or,cr,lr,ur,hr,dr,fr,pr,gr,mr,yr,br,wr,vr,Sr,xr,Er,Ir,kr,Tr,_r,Cr=a(511),Ar=a(2041),Fr=a(225),Rr=a(767),Mr=0,Dr=Ar,Or=Fr,Pr=Rr,Nr=Cr,Lr=0,Br=1,Ur=2,Vr=3,jr=4,zr=5,Gr=6,Hr=7,$r=8,Wr=9,qr=10,Xr=[2,3,7],Yr=[3,3,11],Kr=[280,256,256,256,40],Jr=[0,1,1,1,0],Zr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Qr=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ei=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ti=8,ni=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],ri=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ii=null,si=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ai=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],oi=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],ci=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],li=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ui=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],hi=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],di=[],fi=[],pi=[],gi=1,mi=2,yi=[],bi=[];wn("UpsampleRgbLinePair",kn,3),wn("UpsampleBgrLinePair",Tn,3),wn("UpsampleRgbaLinePair",Rn,4),wn("UpsampleBgraLinePair",Fn,4),wn("UpsampleArgbLinePair",An,4),wn("UpsampleRgba4444LinePair",Cn,2),wn("UpsampleRgb565LinePair",_n,2);var wi=t.UpsampleRgbLinePair,vi=t.UpsampleBgrLinePair,Si=t.UpsampleRgbaLinePair,xi=t.UpsampleBgraLinePair,Ei=t.UpsampleArgbLinePair,Ii=t.UpsampleRgba4444LinePair,ki=t.UpsampleRgb565LinePair,Ti=16,_i=1<<Ti-1,Ci=-227,Ai=482,Fi=6,Ri=(256<<Fi)-1,Mi=0,Di=a(256),Oi=a(256),Pi=a(256),Ni=a(256),Li=a(Ai-Ci),Bi=a(Ai-Ci);Mn("YuvToRgbRow",kn,3),Mn("YuvToBgrRow",Tn,3),Mn("YuvToRgbaRow",Rn,4),Mn("YuvToBgraRow",Fn,4),Mn("YuvToArgbRow",An,4),Mn("YuvToRgba4444Row",Cn,2),Mn("YuvToRgb565Row",_n,2);var Ui=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Vi=[0,2,8],ji=[8,7,6,4,4,2,2,2,1,1,1,1],zi=1;this.WebPDecodeRGBA=function(e,t,r,i,s){var a=Br,o=new rn,c=new oe;o.ba=c,c.S=a,c.width=[c.width],c.height=[c.height];var l=c.width,u=c.height,h=new ce;if(null==h||null==e)var d=2;else n(null!=h),d=Nn(e,t,r,h.width,h.height,h.Pd,h.Qd,h.format,null);if(0!=d?l=0:(null!=l&&(l[0]=h.width[0]),null!=u&&(u[0]=h.height[0]),l=1),l){c.width=c.width[0],c.height=c.height[0],null!=i&&(i[0]=c.width),null!=s&&(s[0]=c.height);e:{if(i=new qe,(s=new sn).data=e,s.w=t,s.ha=r,s.kd=1,t=[0],n(null!=s),(0==(e=Nn(s.data,s.w,s.ha,null,null,null,t,null,s))||7==e)&&t[0]&&(e=4),0==(t=e)){if(n(null!=o),i.data=s.data,i.w=s.w+s.offset,i.ha=s.ha-s.offset,i.put=pe,i.ac=fe,i.bc=ge,i.ma=o,s.xa){if(null==(e=Ae())){o=1;break e}if(function(e,t){var r=[0],i=[0],s=[0];t:for(;;){if(null==e)return 0;if(null==t)return e.a=2,0;if(e.l=t,e.a=0,b(e.m,t.data,t.w,t.ha),!me(e.m,r,i,s)){e.a=3;break t}if(e.xb=mi,t.width=r[0],t.height=i[0],!Fe(r[0],i[0],1,e,null))break t;return 1}return n(0!=e.a),0}(e,i)){if(i=0==(t=Un(i.width,i.height,o.Oa,o.ba))){t:{i=e;n:for(;;){if(null==i){i=0;break t}if(n(null!=i.s.yc),n(null!=i.s.Ya),n(0<i.s.Wb),n(null!=(r=i.l)),n(null!=(s=r.ma)),0!=i.xb){if(i.ca=s.ba,i.tb=s.tb,n(null!=i.ca),!Ln(s.Oa,r,Vr)){i.a=2;break n}if(!Re(i,r.width))break n;if(r.da)break n;if((r.da||ie(i.ca.S))&&bn(),11>i.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=i.ca.f.kb.F&&bn()),i.Pb&&0<i.s.ua&&null==i.s.vb.X&&!O(i.s.vb,i.s.Wa.Xa)){i.a=1;break n}i.xb=0}if(!_e(i,i.V,i.Ba,i.c,i.i,r.o,Ee))break n;s.Dc=i.Ma,i=1;break t}n(0!=i.a),i=0}i=!i}i&&(t=e.a)}else t=e.a}else{if(null==(e=new Xe)){o=1;break e}if(e.Fa=s.na,e.P=s.P,e.qc=s.Sa,Je(e,i)){if(0==(t=Un(i.width,i.height,o.Oa,o.ba))){if(e.Aa=0,r=o.Oa,n(null!=(s=e)),null!=r){if(0<(l=0>(l=r.Md)?0:100<l?255:255*l/100)){for(u=h=0;4>u;++u)12>(d=s.pb[u]).lc&&(d.ia=l*ji[0>d.lc?0:d.lc]>>3),h|=d.ia;h&&(alert("todo:VP8InitRandom"),s.ia=1)}s.Ga=r.Id,100<s.Ga?s.Ga=100:0>s.Ga&&(s.Ga=0)}et(e,i)||(t=e.a)}}else t=e.a}0==t&&null!=o.Oa&&o.Oa.fd&&(t=Bn(o.ba))}o=t}a=0!=o?null:11>a?c.f.RGBA.eb:c.f.kb.y}else a=null;return a};var Gi=[3,4,3,4,4,2,2,4,4,4,2,1,1]},e.WebPRiffParser=function(e,t){var n,r,i={},s=0,a=!1,o=0,c=0;if(i.frames=[],!function(e,t){for(var n=0;n<4;n++)if(e[t+n]!="RIFF".charCodeAt(n))return!0;return!1}(e,t)){for(h(e,t+=4),t+=8;t<e.length;){var d=l(e,t),f=h(e,t+=4);t+=4;var p=f+(1&f);switch(d){case"VP8 ":case"VP8L":void 0===i.frames[s]&&(i.frames[s]={}),(m=i.frames[s]).src_off=a?c:t-8,m.src_size=o+f+8,s++,a&&(a=!1,o=0,c=0);break;case"VP8X":(m=i.header={}).feature_flags=e[t];var g=t+4;m.canvas_width=1+u(e,g),g+=3,m.canvas_height=1+u(e,g),g+=3;break;case"ALPH":a=!0,o=p+8,c=t-8;break;case"ANIM":(m=i.header).bgcolor=h(e,t),g=t+4,m.loop_count=(n=e)[(r=g)+0]|n[r+1]<<8,g+=2;break;case"ANMF":var m,y;(m=i.frames[s]={}).offset_x=2*u(e,t),t+=3,m.offset_y=2*u(e,t),t+=3,m.width=1+u(e,t),t+=3,m.height=1+u(e,t),t+=3,m.duration=u(e,t),t+=3,y=e[t++],m.dispose=1&y,m.blend=y>>1&1}"ANMF"!=d&&(t+=p)}return i}};var t={};function n(e){if(!e)throw Error("assert :P")}function r(e,t,n){for(var r=0;4>r;r++)if(e[t+r]!=n.charCodeAt(r))return!0;return!1}function i(e,t,n,r,i){for(var s=0;s<i;s++)e[t+s]=n[r+s]}function s(e,t,n,r){for(var i=0;i<r;i++)e[t+i]=n}function a(e){return new Int32Array(e)}function o(e,t){for(var n=[],r=0;r<e;r++)n.push(new t);return n}function c(e,t){var n=[];return function e(n,r,i){for(var s=i[r],a=0;a<s&&(n.push(i.length>r+1?[]:new t),!(i.length<r+1));a++)e(n[a],r+1,i)}(n,0,e),n}function l(e,t){for(var n="",r=0;r<4;r++)n+=String.fromCharCode(e[t++]);return n}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}})?n.apply(t,[t]):n)||(e.exports=r)},3261:(e,t,n)=>{var r;!function(){"use strict";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+|\*)?(?:\.(\d+|\*))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/,trailing_period_zero:/\.0$/,trailing_zeroes:/(\.\d*?[1-9])0+$|\.0+$/,period_zero_exp:/\.0*e/,zero_before_exp:/(\..*[^0])0*e/,exp_pos_digits:/e\+(\d)$/,exp_neg_digits:/e-(\d)$/,exp_trailing:/e([+-])(\d)$/};function s(e){return function(e,t){var n,r,a,o,c,l,u,h,d,f,p,g,m,y=2147483648,b=1,w=e.length,v="";for(r=0;r<w;r++)if("string"==typeof e[r])v+=e[r];else if("object"==typeof e[r]){if((o=e[r]).keys)for(n=t[b],a=0;a<o.keys.length;a++){if(null==n)throw new Error(s('[sprintf] Cannot access property "%s" of undefined value "%s"',o.keys[a],o.keys[a-1]));n=n[o.keys[a]]}else n=o.param_no?t[o.param_no]:("*"===o.width?o.width=parseInt(t[b++],10):"*"===o.precision&&(o.precision=parseInt(t[b++],10)),t[b++]);if(i.not_type.test(o.type)&&i.not_primitive.test(o.type)&&n instanceof Function&&(n=n()),i.numeric_arg.test(o.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(s("[sprintf] expecting number but found %T",n));switch(i.number.test(o.type)&&(h=0<=n),o.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,o.width?parseInt(o.width):0);break;case"e":n=o.precision?parseFloat(n).toExponential(o.precision):parseFloat(n).toExponential(6);break;case"f":n=o.precision?parseFloat(n).toFixed(o.precision):parseFloat(n).toFixed(6);break;case"g":n=(n=(n=(n=0===(g=parseFloat(n))?"0":Math.abs(g)<1e-4?(m=0<(m=o.precision?o.precision:6)?m-1:0,g.toExponential(m)):o.precision&&o.precision<1?g.toFixed(0):o.precision?String(Number(n.toPrecision(o.precision))):g.toPrecision(6)).replace(i.zero_before_exp,"$1e")).replace(i.period_zero_exp,"e")).replace(i.trailing_zeroes,"$1");break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=o.precision?n.substring(0,o.precision):n;break;case"t":n=String(!!n),n=o.precision?n.substring(0,o.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=o.precision?n.substring(0,o.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=o.precision?n.substring(0,o.precision):n;break;case"x":case"X":f=(parseInt(n,10)>>>0).toString(16),n&&n.high?f=(parseInt(n.high,10)>>>0).toString(16)+f.padStart(8,"0"):(parseInt(n,10)>y-1||parseInt(n,10)<-y)&&(p=BigInt.asUintN(32,BigInt(n)>>BigInt(32)).toString(16),f=0!==parseInt(p,16)?p+f.padStart(8,"0"):f),n="X"===o.type?f.toUpperCase():f}"e"!==o.type&&"g"!==o.type||(n=(n=(n=n.replace(i.exp_pos_digits,"e+$1")).replace(i.exp_neg_digits,"e-$1")).replace(i.exp_trailing,"e$10$2")),i.json.test(o.type)?v+=n:(!i.number.test(o.type)||h&&!o.sign?d="":(d=h?"+":"-",n=n.toString().replace(i.sign,"")),l=o.pad_char?"0"===o.pad_char?"0":o.pad_char.charAt(1):" ",u=o.width-(d+n).length,c=o.width&&0<u?l.repeat(u):"",v+=o.align?d+n+c:"0"===l?d+c+n:c+d+n)}return v}(function(e){if(o[e])return o[e];for(var t,n=e,r=[],s=0;n;){if(null!==(t=i.text.exec(n)))r.push(t[0]);else if(null!==(t=i.modulo.exec(n)))r.push("%");else{if(null===(t=i.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){s|=1;var a=[],c=t[2],l=[];if(null===(l=i.key.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(a.push(l[1]);""!==(c=c.substring(l[0].length));)if(null!==(l=i.key_access.exec(c)))a.push(l[1]);else{if(null===(l=i.index_access.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");a.push(l[1])}t[2]=a}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return o[e]=r}(e),arguments)}function a(e,t){return s.apply(null,[e].concat(t||[]))}var o=Object.create(null);t.sprintf=s,t.vsprintf=a,"undefined"!=typeof window&&(window.sprintf=s,window.vsprintf=a,void 0===(r=function(){return{sprintf:s,vsprintf:a}}.call(t,n,t,e))||(e.exports=r))}()},7692:(e,t,n)=>{var r;n(9907),r={},e.exports=r,function(e,t){e.toRGBA8=function(t){var n=t.width,r=t.height;if(null==t.tabs.acTL)return[e.toRGBA8.decodeImage(t.data,n,r,t).buffer];var i=[];null==t.frames[0].data&&(t.frames[0].data=t.data);for(var s,a=new Uint8Array(n*r*4),o=0;o<t.frames.length;o++){var c=t.frames[o],l=c.rect.x,u=c.rect.y,h=c.rect.width,d=c.rect.height,f=e.toRGBA8.decodeImage(c.data,h,d,t);if(0==o?s=f:0==c.blend?e._copyTile(f,h,d,s,n,r,l,u,0):1==c.blend&&e._copyTile(f,h,d,s,n,r,l,u,1),i.push(s.buffer),s=s.slice(0),0==c.dispose);else if(1==c.dispose)e._copyTile(a,h,d,s,n,r,l,u,0);else if(2==c.dispose){for(var p=o-1;2==t.frames[p].dispose;)p--;s=new Uint8Array(i[p]).slice(0)}}return i},e.toRGBA8.decodeImage=function(t,n,r,i){var s=n*r,a=e.decode._getBPP(i),o=Math.ceil(n*a/8),c=new Uint8Array(4*s),l=new Uint32Array(c.buffer),u=i.ctype,h=i.depth,d=e._bin.readUshort;if(6==u){var f=s<<2;if(8==h)for(var p=0;p<f;p++)c[p]=t[p];if(16==h)for(p=0;p<f;p++)c[p]=t[p<<1]}else if(2==u){var g=i.tabs.tRNS,m=-1,y=-1,b=-1;if(g&&(m=g[0],y=g[1],b=g[2]),8==h)for(p=0;p<s;p++){var w=3*p;c[T=p<<2]=t[w],c[T+1]=t[w+1],c[T+2]=t[w+2],c[T+3]=255,-1!=m&&t[w]==m&&t[w+1]==y&&t[w+2]==b&&(c[T+3]=0)}if(16==h)for(p=0;p<s;p++)w=6*p,c[T=p<<2]=t[w],c[T+1]=t[w+2],c[T+2]=t[w+4],c[T+3]=255,-1!=m&&d(t,w)==m&&d(t,w+2)==y&&d(t,w+4)==b&&(c[T+3]=0)}else if(3==u){var v=i.tabs.PLTE,S=i.tabs.tRNS,x=S?S.length:0;if(1==h)for(var E=0;E<r;E++){var I=E*o,k=E*n;for(p=0;p<n;p++){var T=k+p<<2,_=3*(C=t[I+(p>>3)]>>7-(7&p)&1);c[T]=v[_],c[T+1]=v[_+1],c[T+2]=v[_+2],c[T+3]=C<x?S[C]:255}}if(2==h)for(E=0;E<r;E++)for(I=E*o,k=E*n,p=0;p<n;p++)T=k+p<<2,_=3*(C=t[I+(p>>2)]>>6-((3&p)<<1)&3),c[T]=v[_],c[T+1]=v[_+1],c[T+2]=v[_+2],c[T+3]=C<x?S[C]:255;if(4==h)for(E=0;E<r;E++)for(I=E*o,k=E*n,p=0;p<n;p++)T=k+p<<2,_=3*(C=t[I+(p>>1)]>>4-((1&p)<<2)&15),c[T]=v[_],c[T+1]=v[_+1],c[T+2]=v[_+2],c[T+3]=C<x?S[C]:255;if(8==h)for(p=0;p<s;p++){var C;T=p<<2,_=3*(C=t[p]),c[T]=v[_],c[T+1]=v[_+1],c[T+2]=v[_+2],c[T+3]=C<x?S[C]:255}}else if(4==u){if(8==h)for(p=0;p<s;p++){T=p<<2;var A=t[F=p<<1];c[T]=A,c[T+1]=A,c[T+2]=A,c[T+3]=t[F+1]}if(16==h)for(p=0;p<s;p++){var F;T=p<<2,A=t[F=p<<2],c[T]=A,c[T+1]=A,c[T+2]=A,c[T+3]=t[F+2]}}else if(0==u){if(m=i.tabs.tRNS?i.tabs.tRNS:-1,1==h)for(p=0;p<s;p++){var R=(A=255*(t[p>>3]>>7-(7&p)&1))==255*m?0:255;l[p]=R<<24|A<<16|A<<8|A}if(2==h)for(p=0;p<s;p++)R=(A=85*(t[p>>2]>>6-((3&p)<<1)&3))==85*m?0:255,l[p]=R<<24|A<<16|A<<8|A;if(4==h)for(p=0;p<s;p++)R=(A=17*(t[p>>1]>>4-((1&p)<<2)&15))==17*m?0:255,l[p]=R<<24|A<<16|A<<8|A;if(8==h)for(p=0;p<s;p++)R=(A=t[p])==m?0:255,l[p]=R<<24|A<<16|A<<8|A;if(16==h)for(p=0;p<s;p++)A=t[p<<1],R=d(t,p<<1)==m?0:255,l[p]=R<<24|A<<16|A<<8|A}return c},e.decode=function(t){for(var n,r=new Uint8Array(t),i=8,s=e._bin,a=s.readUshort,o=s.readUint,c={tabs:{},frames:[]},l=new Uint8Array(r.length),u=0,h=0,d=[137,80,78,71,13,10,26,10],f=0;f<8;f++)if(r[f]!=d[f])throw new Error("The input is not a PNG file!");for(;i<r.length;){var p=s.readUint(r,i);i+=4;var g=s.readASCII(r,i,4);if(i+=4,"IHDR"==g)e.decode._IHDR(r,i,c);else if("IDAT"==g){for(f=0;f<p;f++)l[u+f]=r[i+f];u+=p}else if("acTL"==g)c.tabs[g]={num_frames:o(r,i),num_plays:o(r,i+4)},n=new Uint8Array(r.length);else if("fcTL"==g){0!=h&&((I=c.frames[c.frames.length-1]).data=e.decode._decompress(c,n.slice(0,h),I.rect.width,I.rect.height),h=0);var m={x:o(r,i+12),y:o(r,i+16),width:o(r,i+4),height:o(r,i+8)},y=a(r,i+22);y=a(r,i+20)/(0==y?100:y);var b={rect:m,delay:Math.round(1e3*y),dispose:r[i+24],blend:r[i+25]};c.frames.push(b)}else if("fdAT"==g){for(f=0;f<p-4;f++)n[h+f]=r[i+f+4];h+=p-4}else if("pHYs"==g)c.tabs[g]=[s.readUint(r,i),s.readUint(r,i+4),r[i+8]];else if("cHRM"==g)for(c.tabs[g]=[],f=0;f<8;f++)c.tabs[g].push(s.readUint(r,i+4*f));else if("tEXt"==g){null==c.tabs[g]&&(c.tabs[g]={});var w=s.nextZero(r,i),v=s.readASCII(r,i,w-i),S=s.readASCII(r,w+1,i+p-w-1);c.tabs[g][v]=S}else if("iTXt"==g){null==c.tabs[g]&&(c.tabs[g]={}),w=0;var x=i;w=s.nextZero(r,x),v=s.readASCII(r,x,w-x),r[x=w+1],r[x+1],x+=2,w=s.nextZero(r,x),s.readASCII(r,x,w-x),x=w+1,w=s.nextZero(r,x),s.readUTF8(r,x,w-x),x=w+1,S=s.readUTF8(r,x,p-(x-i)),c.tabs[g][v]=S}else if("PLTE"==g)c.tabs[g]=s.readBytes(r,i,p);else if("hIST"==g){var E=c.tabs.PLTE.length/3;for(c.tabs[g]=[],f=0;f<E;f++)c.tabs[g].push(a(r,i+2*f))}else if("tRNS"==g)3==c.ctype?c.tabs[g]=s.readBytes(r,i,p):0==c.ctype?c.tabs[g]=a(r,i):2==c.ctype&&(c.tabs[g]=[a(r,i),a(r,i+2),a(r,i+4)]);else if("gAMA"==g)c.tabs[g]=s.readUint(r,i)/1e5;else if("sRGB"==g)c.tabs[g]=r[i];else if("bKGD"==g)0==c.ctype||4==c.ctype?c.tabs[g]=[a(r,i)]:2==c.ctype||6==c.ctype?c.tabs[g]=[a(r,i),a(r,i+2),a(r,i+4)]:3==c.ctype&&(c.tabs[g]=r[i]);else if("IEND"==g){var I;0!=h&&((I=c.frames[c.frames.length-1]).data=e.decode._decompress(c,n.slice(0,h),I.rect.width,I.rect.height),h=0),c.data=e.decode._decompress(c,l,c.width,c.height);break}i+=p,s.readUint(r,i),i+=4}return delete c.compress,delete c.interlace,delete c.filter,c},e.decode._decompress=function(t,n,r,i){return 0==t.compress&&(n=e.decode._inflate(n)),0==t.interlace?n=e.decode._filterZero(n,t,0,r,i):1==t.interlace&&(n=e.decode._readInterlace(n,t)),n},e.decode._inflate=function(e){return t.decompressSync(e)},e.decode._readInterlace=function(t,n){for(var r=n.width,i=n.height,s=e.decode._getBPP(n),a=s>>3,o=Math.ceil(r*s/8),c=new Uint8Array(i*o),l=0,u=[0,0,4,0,2,0,1],h=[0,4,0,2,0,1,0],d=[8,8,8,4,4,2,2],f=[8,8,4,4,2,2,1],p=0;p<7;){for(var g=d[p],m=f[p],y=0,b=0,w=u[p];w<i;)w+=g,b++;for(var v=h[p];v<r;)v+=m,y++;var S=Math.ceil(y*s/8);e.decode._filterZero(t,n,l,y,b);for(var x=0,E=u[p];E<i;){for(var I=h[p],k=l+x*S<<3;I<r;){var T;if(1==s&&(T=(T=t[k>>3])>>7-(7&k)&1,c[E*o+(I>>3)]|=T<<7-(3&I)),2==s&&(T=(T=t[k>>3])>>6-(7&k)&3,c[E*o+(I>>2)]|=T<<6-((3&I)<<1)),4==s&&(T=(T=t[k>>3])>>4-(7&k)&15,c[E*o+(I>>1)]|=T<<4-((1&I)<<2)),s>=8)for(var _=E*o+I*a,C=0;C<a;C++)c[_+C]=t[(k>>3)+C];k+=s,I+=m}x++,E+=g}y*b!=0&&(l+=b*(1+S)),p+=1}return c},e.decode._getBPP=function(e){return[1,null,3,1,2,null,4][e.ctype]*e.depth},e.decode._filterZero=function(t,n,r,i,s){var a=e.decode._getBPP(n),o=Math.ceil(i*a/8),c=e.decode._paeth;a=Math.ceil(a/8);for(var l=0;l<s;l++){var u=r+l*o,h=u+l+1,d=t[h-1];if(0==d)for(var f=0;f<o;f++)t[u+f]=t[h+f];else if(1==d){for(f=0;f<a;f++)t[u+f]=t[h+f];for(f=a;f<o;f++)t[u+f]=t[h+f]+t[u+f-a]&255}else if(0==l){for(f=0;f<a;f++)t[u+f]=t[h+f];if(2==d)for(f=a;f<o;f++)t[u+f]=255&t[h+f];if(3==d)for(f=a;f<o;f++)t[u+f]=t[h+f]+(t[u+f-a]>>1)&255;if(4==d)for(f=a;f<o;f++)t[u+f]=t[h+f]+c(t[u+f-a],0,0)&255}else{if(2==d)for(f=0;f<o;f++)t[u+f]=t[h+f]+t[u+f-o]&255;if(3==d){for(f=0;f<a;f++)t[u+f]=t[h+f]+(t[u+f-o]>>1)&255;for(f=a;f<o;f++)t[u+f]=t[h+f]+(t[u+f-o]+t[u+f-a]>>1)&255}if(4==d){for(f=0;f<a;f++)t[u+f]=t[h+f]+c(0,t[u+f-o],0)&255;for(f=a;f<o;f++)t[u+f]=t[h+f]+c(t[u+f-a],t[u+f-o],t[u+f-a-o])&255}}}return t},e.decode._paeth=function(e,t,n){var r=e+t-n,i=Math.abs(r-e),s=Math.abs(r-t),a=Math.abs(r-n);return i<=s&&i<=a?e:s<=a?t:n},e.decode._IHDR=function(t,n,r){var i=e._bin;r.width=i.readUint(t,n),n+=4,r.height=i.readUint(t,n),n+=4,r.depth=t[n],n++,r.ctype=t[n],n++,r.compress=t[n],n++,r.filter=t[n],n++,r.interlace=t[n],n++},e._bin={nextZero:function(e,t){for(;0!=e[t];)t++;return t},readUshort:function(e,t){return e[t]<<8|e[t+1]},writeUshort:function(e,t,n){e[t]=n>>8&255,e[t+1]=255&n},readUint:function(e,t){return 16777216*e[t]+(e[t+1]<<16|e[t+2]<<8|e[t+3])},writeUint:function(e,t,n){e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n},readASCII:function(e,t,n){for(var r="",i=0;i<n;i++)r+=String.fromCharCode(e[t+i]);return r},writeASCII:function(e,t,n){for(var r=0;r<n.length;r++)e[t+r]=n.charCodeAt(r)},readBytes:function(e,t,n){for(var r=[],i=0;i<n;i++)r.push(e[t+i]);return r},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(t,n,r){for(var i,s="",a=0;a<r;a++)s+="%"+e._bin.pad(t[n+a].toString(16));try{i=decodeURIComponent(s)}catch(i){return e._bin.readASCII(t,n,r)}return i}},e._copyTile=function(e,t,n,r,i,s,a,o,c){for(var l=Math.min(t,i),u=Math.min(n,s),h=0,d=0,f=0;f<u;f++)for(var p=0;p<l;p++)if(a>=0&&o>=0?(h=f*t+p<<2,d=(o+f)*i+a+p<<2):(h=(-o+f)*t-a+p<<2,d=f*i+p<<2),0==c)r[d]=e[h],r[d+1]=e[h+1],r[d+2]=e[h+2],r[d+3]=e[h+3];else if(1==c){var g=e[h+3]*(1/255),m=e[h]*g,y=e[h+1]*g,b=e[h+2]*g,w=r[d+3]*(1/255),v=r[d]*w,S=r[d+1]*w,x=r[d+2]*w,E=1-g,I=g+w*E,k=0==I?0:1/I;r[d+3]=255*I,r[d+0]=(m+v*E)*k,r[d+1]=(y+S*E)*k,r[d+2]=(b+x*E)*k}else if(2==c)g=e[h+3],m=e[h],y=e[h+1],b=e[h+2],w=r[d+3],v=r[d],S=r[d+1],x=r[d+2],g==w&&m==v&&y==S&&b==x?(r[d]=0,r[d+1]=0,r[d+2]=0,r[d+3]=0):(r[d]=m,r[d+1]=y,r[d+2]=b,r[d+3]=g);else if(3==c){if(g=e[h+3],m=e[h],y=e[h+1],b=e[h+2],w=r[d+3],v=r[d],S=r[d+1],x=r[d+2],g==w&&m==v&&y==S&&b==x)continue;if(g<220&&w>20)return!1}return!0},e.encode=function(t,n,r,i,s,a){null==i&&(i=0),null==a&&(a=!1);for(var o=new Uint8Array(t[0].byteLength*t.length+100),c=[137,80,78,71,13,10,26,10],l=0;l<8;l++)o[l]=c[l];var u=8,h=e._bin,d=e.crc.crc,f=h.writeUint,p=h.writeUshort,g=h.writeASCII,m=e.encode.compressPNG(t,n,r,i,a);f(o,u,13),g(o,u+=4,"IHDR"),f(o,u+=4,n),f(o,u+=4,r),o[u+=4]=m.depth,o[++u]=m.ctype,o[++u]=0,o[++u]=0,o[++u]=0,f(o,++u,d(o,u-17,17)),f(o,u+=4,1),g(o,u+=4,"sRGB"),o[u+=4]=1,f(o,++u,d(o,u-5,5)),u+=4;var y=t.length>1;if(y&&(f(o,u,8),g(o,u+=4,"acTL"),f(o,u+=4,t.length),f(o,u+=4,0),f(o,u+=4,d(o,u-12,12)),u+=4),3==m.ctype){for(f(o,u,3*(T=m.plte.length)),g(o,u+=4,"PLTE"),u+=4,l=0;l<T;l++){var b=3*l,w=m.plte[l],v=255&w,S=w>>8&255,x=w>>16&255;o[u+b+0]=v,o[u+b+1]=S,o[u+b+2]=x}if(f(o,u+=3*T,d(o,u-3*T-4,3*T+4)),u+=4,m.gotAlpha){for(f(o,u,T),g(o,u+=4,"tRNS"),u+=4,l=0;l<T;l++)o[u+l]=m.plte[l]>>24&255;f(o,u+=T,d(o,u-T-4,T+4)),u+=4}}for(var E=0,I=0;I<m.frames.length;I++){var k=m.frames[I];y&&(f(o,u,26),g(o,u+=4,"fcTL"),f(o,u+=4,E++),f(o,u+=4,k.rect.width),f(o,u+=4,k.rect.height),f(o,u+=4,k.rect.x),f(o,u+=4,k.rect.y),p(o,u+=4,s[I]),p(o,u+=2,1e3),o[u+=2]=k.dispose,o[++u]=k.blend,f(o,++u,d(o,u-30,30)),u+=4);var T,_=k.cimg;f(o,u,(T=_.length)+(0==I?0:4));var C=u+=4;for(g(o,u,0==I?"IDAT":"fdAT"),u+=4,0!=I&&(f(o,u,E++),u+=4),l=0;l<T;l++)o[u+l]=_[l];f(o,u+=T,d(o,C,u-C)),u+=4}return f(o,u,0),g(o,u+=4,"IEND"),f(o,u+=4,d(o,u-4,4)),u+=4,o.buffer.slice(0,u)},e.encode.compressPNG=function(t,n,r,i,s){for(var a=e.encode.compress(t,n,r,i,!1,s),o=0;o<t.length;o++){var c=a.frames[o],l=(c.rect.width,c.rect.height),u=c.bpl,h=c.bpp,d=new Uint8Array(l*u+l);c.cimg=e.encode._filterZero(c.img,l,h,u,d)}return a},e.encode.compress=function(t,n,r,i,s,a){null==a&&(a=!1);for(var o=6,c=8,l=4,u=255,h=0;h<t.length;h++)for(var d=new Uint8Array(t[h]),f=d.length,p=0;p<f;p+=4)u&=d[p+3];var g=255!=u,m={},y=[];if(0!=t.length&&(m[0]=0,y.push(0),0!=i&&i--),0!=i){var b=e.quantize(t,i,s);for(t=b.bufs,p=0;p<b.plte.length;p++)null==m[v=b.plte[p].est.rgba]&&(m[v]=y.length,y.push(v))}else for(h=0;h<t.length;h++){var w=new Uint32Array(t[h]);for(f=w.length,p=0;p<f;p++){var v=w[p];if((p<n||v!=w[p-1]&&v!=w[p-n])&&null==m[v]&&(m[v]=y.length,y.push(v),y.length>=300))break}}var S=!!g&&s,x=y.length;x<=256&&0==a&&(c=x<=2?1:x<=4?2:x<=16?4:8,s&&(c=8),g=!0);var E=[];for(h=0;h<t.length;h++){var I=new Uint8Array(t[h]),k=new Uint32Array(I.buffer),T=0,_=0,C=n,A=r,F=0;if(0!=h&&!S){for(var R=s||1==h||2==E[E.length-2].dispose?1:2,M=0,D=1e9,O=0;O<R;O++){for(var P=new Uint8Array(t[h-1-O]),N=new Uint32Array(t[h-1-O]),L=n,B=r,U=-1,V=-1,j=0;j<r;j++)for(var z=0;z<n;z++)k[p=j*n+z]!=N[p]&&(z<L&&(L=z),z>U&&(U=z),j<B&&(B=j),j>V&&(V=j));var G=-1==U?1:(U-L+1)*(V-B+1);G<D&&(D=G,M=O,-1==U?(T=_=0,C=A=1):(T=L,_=B,C=U-L+1,A=V-B+1))}P=new Uint8Array(t[h-1-M]),1==M&&(E[E.length-1].dispose=2);var H=new Uint8Array(C*A*4);new Uint32Array(H.buffer),e._copyTile(P,n,r,H,C,A,-T,-_,0),e._copyTile(I,n,r,H,C,A,-T,-_,3)?(e._copyTile(I,n,r,H,C,A,-T,-_,2),F=1):(e._copyTile(I,n,r,H,C,A,-T,-_,0),F=0),I=H,k=new Uint32Array(I.buffer)}var $=4*C;if(x<=256&&0==a){for($=Math.ceil(c*C/8),H=new Uint8Array($*A),j=0;j<A;j++){p=j*$;var W=j*C;if(8==c)for(z=0;z<C;z++)H[p+z]=m[k[W+z]];else if(4==c)for(z=0;z<C;z++)H[p+(z>>1)]|=m[k[W+z]]<<4-4*(1&z);else if(2==c)for(z=0;z<C;z++)H[p+(z>>2)]|=m[k[W+z]]<<6-2*(3&z);else if(1==c)for(z=0;z<C;z++)H[p+(z>>3)]|=m[k[W+z]]<<7-1*(7&z)}I=H,o=3,l=1}else if(0==g&&1==t.length){H=new Uint8Array(C*A*3);var q=C*A;for(p=0;p<q;p++){var X=3*p,Y=4*p;H[X]=I[Y],H[X+1]=I[Y+1],H[X+2]=I[Y+2]}I=H,o=2,l=3,$=3*C}E.push({rect:{x:T,y:_,width:C,height:A},img:I,bpl:$,bpp:l,blend:F,dispose:S?1:0})}return{ctype:o,depth:c,plte:y,gotAlpha:g,frames:E}},e.encode._filterZero=function(n,r,i,s,a){for(var o=[],c=0;c<5;c++)if(!(r*s>5e5)||2!=c&&3!=c&&4!=c){for(var l=0;l<r;l++)e.encode._filterLine(a,n,l,s,i,c);if(o.push(t.deflateSync(a)),1==i)break}for(var u,h=1e9,d=0;d<o.length;d++)o[d].length<h&&(u=d,h=o[d].length);return o[u]},e.encode._filterLine=function(t,n,r,i,s,a){var o=r*i,c=o+r,l=e.decode._paeth;if(t[c]=a,c++,0==a)for(var u=0;u<i;u++)t[c+u]=n[o+u];else if(1==a){for(u=0;u<s;u++)t[c+u]=n[o+u];for(u=s;u<i;u++)t[c+u]=n[o+u]-n[o+u-s]+256&255}else if(0==r){for(u=0;u<s;u++)t[c+u]=n[o+u];if(2==a)for(u=s;u<i;u++)t[c+u]=n[o+u];if(3==a)for(u=s;u<i;u++)t[c+u]=n[o+u]-(n[o+u-s]>>1)+256&255;if(4==a)for(u=s;u<i;u++)t[c+u]=n[o+u]-l(n[o+u-s],0,0)+256&255}else{if(2==a)for(u=0;u<i;u++)t[c+u]=n[o+u]+256-n[o+u-i]&255;if(3==a){for(u=0;u<s;u++)t[c+u]=n[o+u]+256-(n[o+u-i]>>1)&255;for(u=s;u<i;u++)t[c+u]=n[o+u]+256-(n[o+u-i]+n[o+u-s]>>1)&255}if(4==a){for(u=0;u<s;u++)t[c+u]=n[o+u]+256-l(0,n[o+u-i],0)&255;for(u=s;u<i;u++)t[c+u]=n[o+u]+256-l(n[o+u-s],n[o+u-i],n[o+u-s-i])&255}}},e.crc={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var n=t,r=0;r<8;r++)1&n?n=3988292384^n>>>1:n>>>=1;e[t]=n}return e}(),update:function(t,n,r,i){for(var s=0;s<i;s++)t=e.crc.table[255&(t^n[r+s])]^t>>>8;return t},crc:function(t,n,r){return 4294967295^e.crc.update(4294967295,t,n,r)}},e.quantize=function(t,n,r){for(var i=[],s=0,a=0;a<t.length;a++)i.push(e.encode.alphaMul(new Uint8Array(t[a]),r)),s+=t[a].byteLength;var o=new Uint8Array(s),c=new Uint32Array(o.buffer),l=0;for(a=0;a<i.length;a++){for(var u=i[a],h=u.length,d=0;d<h;d++)o[l+d]=u[d];l+=h}var f={i0:0,i1:o.length,bst:null,est:null,tdst:0,left:null,right:null};f.bst=e.quantize.stats(o,f.i0,f.i1),f.est=e.quantize.estats(f.bst);for(var p=[f];p.length<n;){var g=0,m=0;for(a=0;a<p.length;a++)p[a].est.L>g&&(g=p[a].est.L,m=a);if(g<.001)break;var y=p[m],b=e.quantize.splitPixels(o,c,y.i0,y.i1,y.est.e,y.est.eMq255),w={i0:y.i0,i1:b,bst:null,est:null,tdst:0,left:null,right:null};w.bst=e.quantize.stats(o,w.i0,w.i1),w.est=e.quantize.estats(w.bst);var v={i0:b,i1:y.i1,bst:null,est:null,tdst:0,left:null,right:null};for(v.bst={R:[],m:[],N:y.bst.N-w.bst.N},a=0;a<16;a++)v.bst.R[a]=y.bst.R[a]-w.bst.R[a];for(a=0;a<4;a++)v.bst.m[a]=y.bst.m[a]-w.bst.m[a];v.est=e.quantize.estats(v.bst),y.left=w,y.right=v,p[m]=w,p.push(v)}p.sort(function(e,t){return t.bst.N-e.bst.N});for(var S=0;S<i.length;S++){var x=e.quantize.planeDst,E=new Uint8Array(i[S].buffer),I=new Uint32Array(i[S].buffer),k=E.length;for(a=0;a<k;a+=4){for(var T=E[a]*(1/255),_=E[a+1]*(1/255),C=E[a+2]*(1/255),A=E[a+3]*(1/255),F=f;F.left;)F=x(F.est,T,_,C,A)<=0?F.left:F.right;I[a>>2]=F.est.rgba}i[S]=I.buffer}return{bufs:i,plte:p}},e.quantize.getNearest=function(t,n,r,i,s){if(null==t.left)return t.tdst=e.quantize.dist(t.est.q,n,r,i,s),t;var a=e.quantize.planeDst(t.est,n,r,i,s),o=t.left,c=t.right;a>0&&(o=t.right,c=t.left);var l=e.quantize.getNearest(o,n,r,i,s);if(l.tdst<=a*a)return l;var u=e.quantize.getNearest(c,n,r,i,s);return u.tdst<l.tdst?u:l},e.quantize.planeDst=function(e,t,n,r,i){var s=e.e;return s[0]*t+s[1]*n+s[2]*r+s[3]*i-e.eMq},e.quantize.dist=function(e,t,n,r,i){var s=t-e[0],a=n-e[1],o=r-e[2],c=i-e[3];return s*s+a*a+o*o+c*c},e.quantize.splitPixels=function(t,n,r,i,s,a){var o=e.quantize.vecDot;for(i-=4;r<i;){for(;o(t,r,s)<=a;)r+=4;for(;o(t,i,s)>a;)i-=4;if(r>=i)break;var c=n[r>>2];n[r>>2]=n[i>>2],n[i>>2]=c,r+=4,i-=4}for(;o(t,r,s)>a;)r-=4;return r+4},e.quantize.vecDot=function(e,t,n){return e[t]*n[0]+e[t+1]*n[1]+e[t+2]*n[2]+e[t+3]*n[3]},e.quantize.stats=function(e,t,n){for(var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0],s=n-t>>2,a=t;a<n;a+=4){var o=e[a]*(1/255),c=e[a+1]*(1/255),l=e[a+2]*(1/255),u=e[a+3]*(1/255);i[0]+=o,i[1]+=c,i[2]+=l,i[3]+=u,r[0]+=o*o,r[1]+=o*c,r[2]+=o*l,r[3]+=o*u,r[5]+=c*c,r[6]+=c*l,r[7]+=c*u,r[10]+=l*l,r[11]+=l*u,r[15]+=u*u}return r[4]=r[1],r[8]=r[2],r[12]=r[3],r[9]=r[6],r[13]=r[7],r[14]=r[11],{R:r,m:i,N:s}},e.quantize.estats=function(t){var n=t.R,r=t.m,i=t.N,s=r[0],a=r[1],o=r[2],c=r[3],l=0==i?0:1/i,u=[n[0]-s*s*l,n[1]-s*a*l,n[2]-s*o*l,n[3]-s*c*l,n[4]-a*s*l,n[5]-a*a*l,n[6]-a*o*l,n[7]-a*c*l,n[8]-o*s*l,n[9]-o*a*l,n[10]-o*o*l,n[11]-o*c*l,n[12]-c*s*l,n[13]-c*a*l,n[14]-c*o*l,n[15]-c*c*l],h=u,d=e.M4,f=[.5,.5,.5,.5],p=0,g=0;if(0!=i)for(var m=0;m<10&&(f=d.multVec(h,f),g=Math.sqrt(d.dot(f,f)),f=d.sml(1/g,f),!(Math.abs(g-p)<1e-9));m++)p=g;var y=[s*l,a*l,o*l,c*l],b=d.dot(d.sml(255,y),f),w=y[3]<.001?0:1/y[3];return{Cov:u,q:y,e:f,L:p,eMq255:b,eMq:d.dot(f,y),rgba:(Math.round(255*y[3])<<24|Math.round(255*y[2]*w)<<16|Math.round(255*y[1]*w)<<8|Math.round(255*y[0]*w))>>>0}},e.M4={multVec:function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],e[4]*t[0]+e[5]*t[1]+e[6]*t[2]+e[7]*t[3],e[8]*t[0]+e[9]*t[1]+e[10]*t[2]+e[11]*t[3],e[12]*t[0]+e[13]*t[1]+e[14]*t[2]+e[15]*t[3]]},dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},sml:function(e,t){return[e*t[0],e*t[1],e*t[2],e*t[3]]}},e.encode.alphaMul=function(e,t){for(var n=new Uint8Array(e.length),r=e.length>>2,i=0;i<r;i++){var s=i<<2,a=e[s+3];t&&(a=a<128?0:255);var o=a*(1/255);n[s+0]=e[s+0]*o,n[s+1]=e[s+1]*o,n[s+2]=e[s+2]*o,n[s+3]=a}return n}}(r,n(8398))},7083:e=>{"use strict";const{AbortController:t,AbortSignal:n}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;e.exports=t,e.exports.AbortSignal=n,e.exports.default=t},323:e=>{"use strict";function t(e,t){if(!Array.isArray(t))return e.slice();for(var n=t.length,r=e.length,i=-1,s=[];++i<r;){for(var a=e[i],o=!1,c=0;c<n;c++)if(a===t[c]){o=!0;break}!1===o&&s.push(a)}return s}e.exports=function(e){for(var n=arguments.length,r=0;++r<n;)e=t(e,arguments[r]);return e}},5123:e=>{"use strict";e.exports=function(e){if(!Array.isArray(e))throw new TypeError("arr-union expects the first argument to be an array.");for(var t=arguments.length,n=0;++n<t;){var r=arguments[n];if(r){Array.isArray(r)||(r=[r]);for(var i=0;i<r.length;i++){var s=r[i];e.indexOf(s)>=0||e.push(s)}}}return e}},785:e=>{"use strict";e.exports=function(e){if(!Array.isArray(e))throw new TypeError("array-unique expects an array.");for(var t=e.length,n=-1;n++<t;)for(var r=n+1;r<e.length;++r)e[n]===e[r]&&e.splice(r--,1);return e},e.exports.immutable=function(t){if(!Array.isArray(t))throw new TypeError("array-unique expects an array.");for(var n=t.length,r=new Array(n),i=0;i<n;i++)r[i]=t[i];return e.exports(r)}},2267:(e,t,n)=>{var r=t;r.bignum=n(2823),r.define=n(424).define,r.base=n(1284),r.constants=n(4962),r.decoders=n(8720),r.encoders=n(7912)},424:(e,t,n)=>{var r=n(2267),i=n(5615);function s(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}t.define=function(e,t){return new s(e,t)},s.prototype._createNamed=function(e){var t;try{t=n(113).runInThisContext("(function "+this.name+"(entity) {\n  this._initNamed(entity);\n})")}catch(e){t=function(e){this._initNamed(e)}}return i(t,e),t.prototype._initNamed=function(t){e.call(this,t)},new t(this)},s.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(r.decoders[e])),this.decoders[e]},s.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},s.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(r.encoders[e])),this.encoders[e]},s.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)}},9428:(e,t,n)=>{var r=n(5615),i=n(1284).Reporter,s=n(1048).Buffer;function a(e,t){i.call(this,t),s.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function o(e,t){if(Array.isArray(e))this.length=0,this.value=e.map(function(e){return e instanceof o||(e=new o(e,t)),this.length+=e.length,e},this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=s.byteLength(e);else{if(!s.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}r(a,i),t.t=a,a.prototype.save=function(){return{offset:this.offset,reporter:i.prototype.save.call(this)}},a.prototype.restore=function(e){var t=new a(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,i.prototype.restore.call(this,e.reporter),t},a.prototype.isEmpty=function(){return this.offset===this.length},a.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},a.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");var n=new a(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+e,this.offset+=e,n},a.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.d=o,o.prototype.join=function(e,t){return e||(e=new s(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach(function(n){n.join(e,t),t+=n.length}):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):s.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},1284:(e,t,n)=>{var r=t;r.Reporter=n(9963).a,r.DecoderBuffer=n(9428).t,r.EncoderBuffer=n(9428).d,r.Node=n(7410)},7410:(e,t,n)=>{var r=n(1284).Reporter,i=n(1284).EncoderBuffer,s=n(1284).DecoderBuffer,a=n(7784),o=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(o);function l(e,t){var n={};this._baseState=n,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}e.exports=l;var u=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];l.prototype.clone=function(){var e=this._baseState,t={};u.forEach(function(n){t[n]=e[n]});var n=new this.constructor(t.parent);return n._baseState=t,n},l.prototype._wrap=function(){var e=this._baseState;c.forEach(function(t){this[t]=function(){var n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}},this)},l.prototype._init=function(e){var t=this._baseState;a(null===t.parent),e.call(this),t.children=t.children.filter(function(e){return e._baseState.parent===this},this),a.equal(t.children.length,1,"Root node can have only one child")},l.prototype._useArgs=function(e){var t=this._baseState,n=e.filter(function(e){return e instanceof this.constructor},this);e=e.filter(function(e){return!(e instanceof this.constructor)},this),0!==n.length&&(a(null===t.children),t.children=n,n.forEach(function(e){e._baseState.parent=this},this)),0!==e.length&&(a(null===t.args),t.args=e,t.reverseArgs=e.map(function(e){if("object"!=typeof e||e.constructor!==Object)return e;var t={};return Object.keys(e).forEach(function(n){n==(0|n)&&(n|=0);var r=e[n];t[r]=n}),t}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(e){l.prototype[e]=function(){var t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}}),o.forEach(function(e){l.prototype[e]=function(){var t=this._baseState,n=Array.prototype.slice.call(arguments);return a(null===t.tag),t.tag=e,this._useArgs(n),this}}),l.prototype.use=function(e){a(e);var t=this._baseState;return a(null===t.use),t.use=e,this},l.prototype.optional=function(){return this._baseState.optional=!0,this},l.prototype.def=function(e){var t=this._baseState;return a(null===t.default),t.default=e,t.optional=!0,this},l.prototype.explicit=function(e){var t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.explicit=e,this},l.prototype.implicit=function(e){var t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.implicit=e,this},l.prototype.obj=function(){var e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},l.prototype.key=function(e){var t=this._baseState;return a(null===t.key),t.key=e,this},l.prototype.any=function(){return this._baseState.any=!0,this},l.prototype.choice=function(e){var t=this._baseState;return a(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map(function(t){return e[t]})),this},l.prototype.contains=function(e){var t=this._baseState;return a(null===t.use),t.contains=e,this},l.prototype._decode=function(e,t){var n=this._baseState;if(null===n.parent)return e.wrapResult(n.children[0]._decode(e,t));var r,i=n.default,a=!0,o=null;if(null!==n.key&&(o=e.enterKey(n.key)),n.optional){var c=null;if(null!==n.explicit?c=n.explicit:null!==n.implicit?c=n.implicit:null!==n.tag&&(c=n.tag),null!==c||n.any){if(a=this._peekTag(e,c,n.any),e.isError(a))return a}else{var l=e.save();try{null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t),a=!0}catch(e){a=!1}e.restore(l)}}if(n.obj&&a&&(r=e.enterObject()),a){if(null!==n.explicit){var u=this._decodeTag(e,n.explicit);if(e.isError(u))return u;e=u}var h=e.offset;if(null===n.use&&null===n.choice){n.any&&(l=e.save());var d=this._decodeTag(e,null!==n.implicit?n.implicit:n.tag,n.any);if(e.isError(d))return d;n.any?i=e.raw(l):e=d}if(t&&t.track&&null!==n.tag&&t.track(e.path(),h,e.length,"tagged"),t&&t.track&&null!==n.tag&&t.track(e.path(),e.offset,e.length,"content"),n.any||(i=null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t)),e.isError(i))return i;if(n.any||null!==n.choice||null===n.children||n.children.forEach(function(n){n._decode(e,t)}),n.contains&&("octstr"===n.tag||"bitstr"===n.tag)){var f=new s(i);i=this._getUse(n.contains,e._reporterState.obj)._decode(f,t)}}return n.obj&&a&&(i=e.leaveObject(r)),null===n.key||null===i&&!0!==a?null!==o&&e.exitKey(o):e.leaveKey(o,n.key,i),i},l.prototype._decodeGeneric=function(e,t,n){var r=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,r.args[0],n):/str$/.test(e)?this._decodeStr(t,e,n):"objid"===e&&r.args?this._decodeObjid(t,r.args[0],r.args[1],n):"objid"===e?this._decodeObjid(t,null,null,n):"gentime"===e||"utctime"===e?this._decodeTime(t,e,n):"null_"===e?this._decodeNull(t,n):"bool"===e?this._decodeBool(t,n):"objDesc"===e?this._decodeStr(t,e,n):"int"===e||"enum"===e?this._decodeInt(t,r.args&&r.args[0],n):null!==r.use?this._getUse(r.use,t._reporterState.obj)._decode(t,n):t.error("unknown tag: "+e)},l.prototype._getUse=function(e,t){var n=this._baseState;return n.useDecoder=this._use(e,t),a(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},l.prototype._decodeChoice=function(e,t){var n=this._baseState,r=null,i=!1;return Object.keys(n.choice).some(function(s){var a=e.save(),o=n.choice[s];try{var c=o._decode(e,t);if(e.isError(c))return!1;r={type:s,value:c},i=!0}catch(t){return e.restore(a),!1}return!0},this),i?r:e.error("Choice not matched")},l.prototype._createEncoderBuffer=function(e){return new i(e,this.reporter)},l.prototype._encode=function(e,t,n){var r=this._baseState;if(null===r.default||r.default!==e){var i=this._encodeValue(e,t,n);if(void 0!==i&&!this._skipDefault(i,t,n))return i}},l.prototype._encodeValue=function(e,t,n){var i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new r);var s=null;if(this.reporter=t,i.optional&&void 0===e){if(null===i.default)return;e=i.default}var a=null,o=!1;if(i.any)s=this._createEncoderBuffer(e);else if(i.choice)s=this._encodeChoice(e,t);else if(i.contains)a=this._getUse(i.contains,n)._encode(e,t),o=!0;else if(i.children)a=i.children.map(function(n){if("null_"===n._baseState.tag)return n._encode(null,t,e);if(null===n._baseState.key)return t.error("Child should have a key");var r=t.enterKey(n._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");var i=n._encode(e[n._baseState.key],t,e);return t.leaveKey(r),i},this).filter(function(e){return e}),a=this._createEncoderBuffer(a);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");var c=this.clone();c._baseState.implicit=null,a=this._createEncoderBuffer(e.map(function(n){var r=this._baseState;return this._getUse(r.args[0],e)._encode(n,t)},c))}else null!==i.use?s=this._getUse(i.use,n)._encode(e,t):(a=this._encodePrimitive(i.tag,e),o=!0);if(!i.any&&null===i.choice){var l=null!==i.implicit?i.implicit:i.tag,u=null===i.implicit?"universal":"context";null===l?null===i.use&&t.error("Tag could be omitted only for .use()"):null===i.use&&(s=this._encodeComposite(l,o,u,a))}return null!==i.explicit&&(s=this._encodeComposite(i.explicit,!1,"context",s)),s},l.prototype._encodeChoice=function(e,t){var n=this._baseState,r=n.choice[e.type];return r||a(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),r._encode(e.value,t)},l.prototype._encodePrimitive=function(e,t){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},l.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},l.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}},9963:(e,t,n)=>{var r=n(5615);function i(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function s(e,t){this.path=e,this.rethrow(t)}t.a=i,i.prototype.isError=function(e){return e instanceof s},i.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},i.prototype.restore=function(e){var t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},i.prototype.enterKey=function(e){return this._reporterState.path.push(e)},i.prototype.exitKey=function(e){var t=this._reporterState;t.path=t.path.slice(0,e-1)},i.prototype.leaveKey=function(e,t,n){var r=this._reporterState;this.exitKey(e),null!==r.obj&&(r.obj[t]=n)},i.prototype.path=function(){return this._reporterState.path.join("/")},i.prototype.enterObject=function(){var e=this._reporterState,t=e.obj;return e.obj={},t},i.prototype.leaveObject=function(e){var t=this._reporterState,n=t.obj;return t.obj=e,n},i.prototype.error=function(e){var t,n=this._reporterState,r=e instanceof s;if(t=r?e:new s(n.path.map(function(e){return"["+JSON.stringify(e)+"]"}).join(""),e.message||e,e.stack),!n.options.partial)throw t;return r||n.errors.push(t),t},i.prototype.wrapResult=function(e){var t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},r(s,Error),s.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}},6457:(e,t,n)=>{var r=n(4962);t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=r._reverse(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=r._reverse(t.tag)},4962:(e,t,n)=>{var r=t;r._reverse=function(e){var t={};return Object.keys(e).forEach(function(n){(0|n)==n&&(n|=0);var r=e[n];t[r]=n}),t},r.der=n(6457)},3975:(e,t,n)=>{var r=n(5615),i=n(2267),s=i.base,a=i.bignum,o=i.constants.der;function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new l,this.tree._init(e.body)}function l(e){s.Node.call(this,"der",e)}function u(e,t){var n=e.readUInt8(t);if(e.isError(n))return n;var r=o.tagClass[n>>6],i=!(32&n);if(31&~n)n&=31;else{var s=n;for(n=0;!(128&~s);){if(s=e.readUInt8(t),e.isError(s))return s;n<<=7,n|=127&s}}return{cls:r,primitive:i,tag:n,tagStr:o.tag[n]}}function h(e,t,n){var r=e.readUInt8(n);if(e.isError(r))return r;if(!t&&128===r)return null;if(!(128&r))return r;var i=127&r;if(i>4)return e.error("length octect is too long");r=0;for(var s=0;s<i;s++){r<<=8;var a=e.readUInt8(n);if(e.isError(a))return a;r|=a}return r}e.exports=c,c.prototype.decode=function(e,t){return e instanceof s.DecoderBuffer||(e=new s.DecoderBuffer(e,t)),this.tree._decode(e,t)},r(l,s.Node),l.prototype._peekTag=function(e,t,n){if(e.isEmpty())return!1;var r=e.save(),i=u(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(r),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||n)},l.prototype._decodeTag=function(e,t,n){var r=u(e,'Failed to decode tag of "'+t+'"');if(e.isError(r))return r;var i=h(e,r.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!n&&r.tag!==t&&r.tagStr!==t&&r.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(r.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');var s=e.save(),a=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(a)?a:(i=e.offset-s.offset,e.restore(s),e.skip(i,'Failed to match body of: "'+t+'"'))},l.prototype._skipUntilEnd=function(e,t){for(;;){var n=u(e,t);if(e.isError(n))return n;var r,i=h(e,n.primitive,t);if(e.isError(i))return i;if(r=n.primitive||null!==i?e.skip(i):this._skipUntilEnd(e,t),e.isError(r))return r;if("end"===n.tagStr)break}},l.prototype._decodeList=function(e,t,n,r){for(var i=[];!e.isEmpty();){var s=this._peekTag(e,"end");if(e.isError(s))return s;var a=n.decode(e,"der",r);if(e.isError(a)&&s)break;i.push(a)}return i},l.prototype._decodeStr=function(e,t){if("bitstr"===t){var n=e.readUInt8();return e.isError(n)?n:{unused:n,data:e.raw()}}if("bmpstr"===t){var r=e.raw();if(r.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");for(var i="",s=0;s<r.length/2;s++)i+=String.fromCharCode(r.readUInt16BE(2*s));return i}if("numstr"===t){var a=e.raw().toString("ascii");return this._isNumstr(a)?a:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){var o=e.raw().toString("ascii");return this._isPrintstr(o)?o:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},l.prototype._decodeObjid=function(e,t,n){for(var r,i=[],s=0;!e.isEmpty();){var a=e.readUInt8();s<<=7,s|=127&a,128&a||(i.push(s),s=0)}128&a&&i.push(s);var o=i[0]/40|0,c=i[0]%40;if(r=n?i:[o,c].concat(i.slice(1)),t){var l=t[r.join(" ")];void 0===l&&(l=t[r.join(".")]),void 0!==l&&(r=l)}return r},l.prototype._decodeTime=function(e,t){var n=e.raw().toString();if("gentime"===t)var r=0|n.slice(0,4),i=0|n.slice(4,6),s=0|n.slice(6,8),a=0|n.slice(8,10),o=0|n.slice(10,12),c=0|n.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");r=0|n.slice(0,2),i=0|n.slice(2,4),s=0|n.slice(4,6),a=0|n.slice(6,8),o=0|n.slice(8,10),c=0|n.slice(10,12),r=r<70?2e3+r:1900+r}return Date.UTC(r,i-1,s,a,o,c,0)},l.prototype._decodeNull=function(e){return null},l.prototype._decodeBool=function(e){var t=e.readUInt8();return e.isError(t)?t:0!==t},l.prototype._decodeInt=function(e,t){var n=e.raw(),r=new a(n);return t&&(r=t[r.toString(10)]||r),r},l.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}},8720:(e,t,n)=>{var r=t;r.der=n(3975),r.pem=n(3850)},3850:(e,t,n)=>{var r=n(5615),i=n(1048).Buffer,s=n(3975);function a(e){s.call(this,e),this.enc="pem"}r(a,s),e.exports=a,a.prototype.decode=function(e,t){for(var n=e.toString().split(/[\r\n]+/g),r=t.label.toUpperCase(),a=/^-----(BEGIN|END) ([^-]+)-----$/,o=-1,c=-1,l=0;l<n.length;l++){var u=n[l].match(a);if(null!==u&&u[2]===r){if(-1!==o){if("END"!==u[1])break;c=l;break}if("BEGIN"!==u[1])break;o=l}}if(-1===o||-1===c)throw new Error("PEM section not found for: "+r);var h=n.slice(o+1,c).join("");h.replace(/[^a-z0-9\+\/=]+/gi,"");var d=new i(h,"base64");return s.prototype.decode.call(this,d,t)}},5775:(e,t,n)=>{var r=n(5615),i=n(1048).Buffer,s=n(2267),a=s.base,o=s.constants.der;function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new l,this.tree._init(e.body)}function l(e){a.Node.call(this,"der",e)}function u(e){return e<10?"0"+e:e}e.exports=c,c.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},r(l,a.Node),l.prototype._encodeComposite=function(e,t,n,r){var s,a=function(e,t,n,r){var i;if("seqof"===e?e="seq":"setof"===e&&(e="set"),o.tagByName.hasOwnProperty(e))i=o.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return r.error("Unknown tag: "+e);i=e}return i>=31?r.error("Multi-octet tag encoding unsupported"):(t||(i|=32),i|=o.tagClassByName[n||"universal"]<<6)}(e,t,n,this.reporter);if(r.length<128)return(s=new i(2))[0]=a,s[1]=r.length,this._createEncoderBuffer([s,r]);for(var c=1,l=r.length;l>=256;l>>=8)c++;(s=new i(2+c))[0]=a,s[1]=128|c,l=1+c;for(var u=r.length;u>0;l--,u>>=8)s[l]=255&u;return this._createEncoderBuffer([s,r])},l.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){for(var n=new i(2*e.length),r=0;r<e.length;r++)n.writeUInt16BE(e.charCodeAt(r),2*r);return this._createEncoderBuffer(n)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},l.prototype._encodeObjid=function(e,t,n){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s\.]+/g);for(var r=0;r<e.length;r++)e[r]|=0}else if(Array.isArray(e))for(e=e.slice(),r=0;r<e.length;r++)e[r]|=0;if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}var s=0;for(r=0;r<e.length;r++){var a=e[r];for(s++;a>=128;a>>=7)s++}var o=new i(s),c=o.length-1;for(r=e.length-1;r>=0;r--)for(a=e[r],o[c--]=127&a;(a>>=7)>0;)o[c--]=128|127&a;return this._createEncoderBuffer(o)},l.prototype._encodeTime=function(e,t){var n,r=new Date(e);return"gentime"===t?n=[u(r.getFullYear()),u(r.getUTCMonth()+1),u(r.getUTCDate()),u(r.getUTCHours()),u(r.getUTCMinutes()),u(r.getUTCSeconds()),"Z"].join(""):"utctime"===t?n=[u(r.getFullYear()%100),u(r.getUTCMonth()+1),u(r.getUTCDate()),u(r.getUTCHours()),u(r.getUTCMinutes()),u(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(n,"octstr")},l.prototype._encodeNull=function(){return this._createEncoderBuffer("")},l.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!i.isBuffer(e)){var n=e.toArray();!e.sign&&128&n[0]&&n.unshift(0),e=new i(n)}if(i.isBuffer(e)){var r=e.length;0===e.length&&r++;var s=new i(r);return e.copy(s),0===e.length&&(s[0]=0),this._createEncoderBuffer(s)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);r=1;for(var a=e;a>=256;a>>=8)r++;for(a=(s=new Array(r)).length-1;a>=0;a--)s[a]=255&e,e>>=8;return 128&s[0]&&s.unshift(0),this._createEncoderBuffer(new i(s))},l.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},l.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},l.prototype._skipDefault=function(e,t,n){var r,i=this._baseState;if(null===i.default)return!1;var s=e.join();if(void 0===i.defaultBuffer&&(i.defaultBuffer=this._encodeValue(i.default,t,n).join()),s.length!==i.defaultBuffer.length)return!1;for(r=0;r<s.length;r++)if(s[r]!==i.defaultBuffer[r])return!1;return!0}},7912:(e,t,n)=>{var r=t;r.der=n(5775),r.pem=n(8962)},8962:(e,t,n)=>{var r=n(5615),i=n(5775);function s(e){i.call(this,e),this.enc="pem"}r(s,i),e.exports=s,s.prototype.encode=function(e,t){for(var n=i.prototype.encode.call(this,e).toString("base64"),r=["-----BEGIN "+t.label+"-----"],s=0;s<n.length;s+=64)r.push(n.slice(s,s+64));return r.push("-----END "+t.label+"-----"),r.join("\n")}},1483:e=>{"use strict";e.exports=function(e,t){if(null==e)throw new TypeError("expected first argument to be an object.");if(void 0===t||"undefined"==typeof Symbol)return e;if("function"!=typeof Object.getOwnPropertySymbols)return e;for(var n=Object.prototype.propertyIsEnumerable,r=Object(e),i=arguments.length,s=0;++s<i;)for(var a=Object(arguments[s]),o=Object.getOwnPropertySymbols(a),c=0;c<o.length;c++){var l=o[c];n.call(a,l)&&(r[l]=a[l])}return r}},7599:(e,t,n)=>{"use strict";var r=n(9208),i=n(5677),s=n(450),a=n(8106),o=n(9537),c=n(8636),l=n(6458),u=n(5558);function h(e){var t=e?s.namespace(e):s,n=[];function h(e,n){if(!(this instanceof h))return new h(e,n);t.call(this,e),this.is("base"),this.initBase(e,n)}return r.inherits(h,t),a(h),h.prototype.initBase=function(t,r){this.options=c({},this.options,r),this.cache=this.cache||{},this.define("registered",{}),e&&(this[e]={}),this.define("_callbacks",this._callbacks),o(t)&&this.visit("set",t),h.run(this,"use",n)},h.prototype.is=function(e){if("string"!=typeof e)throw new TypeError("expected name to be a string");return this.define("is"+l(e),!0),this.define("_name",e),this.define("_appname",e),this},h.prototype.isRegistered=function(e,t){return!!this.registered.hasOwnProperty(e)||(!1!==t&&(this.registered[e]=!0,this.emit("plugin",e)),!1)},h.prototype.use=function(e){return e.call(this,this),this},h.prototype.define=function(e,t){return o(e)?this.visit("define",e):(i(this,e,t),this)},h.prototype.mixin=function(e,t){return h.prototype[e]=t,this},h.prototype.mixins=h.prototype.mixins||[],Object.defineProperty(h.prototype,"base",{configurable:!0,get:function(){return this.parent?this.parent.base:this}}),i(h,"use",function(e){return n.push(e),h}),i(h,"run",function(e,t,n){for(var r=n.length,i=0;r--;)e[t](n[i++]);return h}),i(h,"extend",u.extend(h,function(e,t){return e.prototype.mixins=e.prototype.mixins||[],i(e,"mixin",function(t){var n=t(e.prototype,e);return"function"==typeof n&&e.prototype.mixins.push(n),e}),i(e,"mixins",function(t){return h.run(t,"mixin",e.prototype.mixins),e}),e.prototype.mixin=function(t,n){return e.prototype[t]=n,this},h})),i(h,"mixin",function(e){var t=e(h.prototype,h);return"function"==typeof t&&h.prototype.mixins.push(t),h}),i(h,"mixins",function(e){return h.run(e,"mixin",h.prototype.mixins),h}),i(h,"inherit",u.inherit),i(h,"bubble",u.bubble),h}e.exports=h(),e.exports.namespace=h},7991:(e,t)=>{"use strict";t.byteLength=function(e){var t=o(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,s=o(e),a=s[0],c=s[1],l=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,c)),u=0,h=c>0?a-4:a;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t),1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],a=16383,o=0,l=r-i;o<l;o+=a)s.push(c(e,o,o+a>l?l:o+a));return 1===i?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=s[a],r[s.charCodeAt(a)]=a;function o(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var i,s,a=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(n[(s=i)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},2823:function(e,t,n){!function(e,t){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function s(e,t,n){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var a;"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:n(8379).Buffer}catch(e){}function o(e,t){var n=e.charCodeAt(t);return n>=48&&n<=57?n-48:n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:void r(!1,"Invalid character in "+e)}function c(e,t,n){var r=o(e,n);return n-1>=t&&(r|=o(e,n-1)<<4),r}function l(e,t,n,i){for(var s=0,a=0,o=Math.min(e.length,n),c=t;c<o;c++){var l=e.charCodeAt(c)-48;s*=i,a=l>=49?l-49+10:l>=17?l-17+10:l,r(l>=0&&a<i,"Invalid character"),s+=a}return s}function u(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,n){if("number"==typeof e)return this._initNumber(e,t,n);if("object"==typeof e)return this._initArray(e,t,n);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,n):(this._parseBase(e,t,i),"le"===n&&this._initArray(this.toArray(),t,n)))},s.prototype._initNumber=function(e,t,n){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(r(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===n&&this._initArray(this.toArray(),t,n)},s.prototype._initArray=function(e,t,n){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,a,o=0;if("be"===n)for(i=e.length-1,s=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);else if("le"===n)for(i=0,s=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=a<<o&67108863,this.words[s+1]=a>>>26-o&67108863,(o+=24)>=26&&(o-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,n){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,s=0,a=0;if("be"===n)for(r=e.length-1;r>=t;r-=2)i=c(e,t,r)<<s,this.words[a]|=67108863&i,s>=18?(s-=18,a+=1,this.words[a]|=i>>>26):s+=8;else for(r=(e.length-t)%2==0?t+1:t;r<e.length;r+=2)i=c(e,t,r)<<s,this.words[a]|=67108863&i,s>=18?(s-=18,a+=1,this.words[a]|=i>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var s=e.length-n,a=s%r,o=Math.min(s,s-a)+n,c=0,u=n;u<o;u+=r)c=l(e,u,u+r,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==a){var h=1;for(c=l(e,u,e.length,t),u=0;u<a;u++)h*=t;this.imuln(h),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){u(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=h}catch(e){s.prototype.inspect=h}else s.prototype.inspect=h;function h(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function g(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],s=0|t.words[0],a=i*s,o=67108863&a,c=a/67108864|0;n.words[0]=o;for(var l=1;l<r;l++){for(var u=c>>>26,h=67108863&c,d=Math.min(l,t.length-1),f=Math.max(0,l-e.length+1);f<=d;f++){var p=l-f|0;u+=(a=(i=0|e.words[p])*(s=0|t.words[f])+h)/67108864|0,h=67108863&a}n.words[l]=0|h,c=0|u}return 0!==c?n.words[l]=0|c:n.length--,n._strip()}s.prototype.toString=function(e,t){var n;if(t=0|t||1,16===(e=e||10)||"hex"===e){n="";for(var i=0,s=0,a=0;a<this.length;a++){var o=this.words[a],c=(16777215&(o<<i|s)).toString(16);s=o>>>24-i&16777215,(i+=2)>=26&&(i-=26,a--),n=0!==s||a!==this.length-1?d[6-c.length]+c+n:c+n}for(0!==s&&(n=s.toString(16)+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}if(e===(0|e)&&e>=2&&e<=36){var l=f[e],u=p[e];n="";var h=this.clone();for(h.negative=0;!h.isZero();){var g=h.modrn(u).toString(e);n=(h=h.idivn(u)).isZero()?g+n:d[l-g.length]+g+n}for(this.isZero()&&(n="0"+n);n.length%t!=0;)n="0"+n;return 0!==this.negative&&(n="-"+n),n}r(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},a&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(a,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,n){this._strip();var i=this.byteLength(),s=n||Math.max(1,i);r(i<=s,"byte array longer than desired length"),r(s>0,"Requested array length <= 0");var a=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](a,i),a},s.prototype._toArrayLikeLE=function(e,t){for(var n=0,r=0,i=0,s=0;i<this.length;i++){var a=this.words[i]<<s|r;e[n++]=255&a,n<e.length&&(e[n++]=a>>8&255),n<e.length&&(e[n++]=a>>16&255),6===s?(n<e.length&&(e[n++]=a>>24&255),r=0,s=0):(r=a>>>24,s+=2)}if(n<e.length)for(e[n++]=r;n<e.length;)e[n++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var n=e.length-1,r=0,i=0,s=0;i<this.length;i++){var a=this.words[i]<<s|r;e[n--]=255&a,n>=0&&(e[n--]=a>>8&255),n>=0&&(e[n--]=a>>16&255),6===s?(n>=0&&(e[n--]=a>>24&255),r=0,s=0):(r=a>>>24,s+=2)}if(n>=0)for(e[n--]=r;n>=0;)e[n--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 8191&t||(n+=13,t>>>=13),127&t||(n+=7,t>>>=7),15&t||(n+=4,t>>>=4),3&t||(n+=2,t>>>=2),1&t||n++,n},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return r(!(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return r(!(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return r(!(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),n=e%26;this._expand(t),n>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return n>0&&(this.words[i]=~this.words[i]&67108863>>26-n),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var n=e/26|0,i=e%26;return this._expand(n+1),this.words[n]=t?this.words[n]|1<<i:this.words[n]&~(1<<i),this._strip()},s.prototype.iadd=function(e){var t,n,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,s=0;s<r.length;s++)t=(0|n.words[s])+(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<n.length;s++)t=(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;s<n.length;s++)this.words[s]=n.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,r,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=e):(n=e,r=this);for(var s=0,a=0;a<r.length;a++)s=(t=(0|n.words[a])-(0|r.words[a])+s)>>26,this.words[a]=67108863&t;for(;0!==s&&a<n.length;a++)s=(t=(0|n.words[a])+s)>>26,this.words[a]=67108863&t;if(0===s&&a<n.length&&n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this.length=Math.max(this.length,a),n!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var m=function(e,t,n){var r,i,s,a=e.words,o=t.words,c=n.words,l=0,u=0|a[0],h=8191&u,d=u>>>13,f=0|a[1],p=8191&f,g=f>>>13,m=0|a[2],y=8191&m,b=m>>>13,w=0|a[3],v=8191&w,S=w>>>13,x=0|a[4],E=8191&x,I=x>>>13,k=0|a[5],T=8191&k,_=k>>>13,C=0|a[6],A=8191&C,F=C>>>13,R=0|a[7],M=8191&R,D=R>>>13,O=0|a[8],P=8191&O,N=O>>>13,L=0|a[9],B=8191&L,U=L>>>13,V=0|o[0],j=8191&V,z=V>>>13,G=0|o[1],H=8191&G,$=G>>>13,W=0|o[2],q=8191&W,X=W>>>13,Y=0|o[3],K=8191&Y,J=Y>>>13,Z=0|o[4],Q=8191&Z,ee=Z>>>13,te=0|o[5],ne=8191&te,re=te>>>13,ie=0|o[6],se=8191&ie,ae=ie>>>13,oe=0|o[7],ce=8191&oe,le=oe>>>13,ue=0|o[8],he=8191&ue,de=ue>>>13,fe=0|o[9],pe=8191&fe,ge=fe>>>13;n.negative=e.negative^t.negative,n.length=19;var me=(l+(r=Math.imul(h,j))|0)+((8191&(i=(i=Math.imul(h,z))+Math.imul(d,j)|0))<<13)|0;l=((s=Math.imul(d,z))+(i>>>13)|0)+(me>>>26)|0,me&=67108863,r=Math.imul(p,j),i=(i=Math.imul(p,z))+Math.imul(g,j)|0,s=Math.imul(g,z);var ye=(l+(r=r+Math.imul(h,H)|0)|0)+((8191&(i=(i=i+Math.imul(h,$)|0)+Math.imul(d,H)|0))<<13)|0;l=((s=s+Math.imul(d,$)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(y,j),i=(i=Math.imul(y,z))+Math.imul(b,j)|0,s=Math.imul(b,z),r=r+Math.imul(p,H)|0,i=(i=i+Math.imul(p,$)|0)+Math.imul(g,H)|0,s=s+Math.imul(g,$)|0;var be=(l+(r=r+Math.imul(h,q)|0)|0)+((8191&(i=(i=i+Math.imul(h,X)|0)+Math.imul(d,q)|0))<<13)|0;l=((s=s+Math.imul(d,X)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(v,j),i=(i=Math.imul(v,z))+Math.imul(S,j)|0,s=Math.imul(S,z),r=r+Math.imul(y,H)|0,i=(i=i+Math.imul(y,$)|0)+Math.imul(b,H)|0,s=s+Math.imul(b,$)|0,r=r+Math.imul(p,q)|0,i=(i=i+Math.imul(p,X)|0)+Math.imul(g,q)|0,s=s+Math.imul(g,X)|0;var we=(l+(r=r+Math.imul(h,K)|0)|0)+((8191&(i=(i=i+Math.imul(h,J)|0)+Math.imul(d,K)|0))<<13)|0;l=((s=s+Math.imul(d,J)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(E,j),i=(i=Math.imul(E,z))+Math.imul(I,j)|0,s=Math.imul(I,z),r=r+Math.imul(v,H)|0,i=(i=i+Math.imul(v,$)|0)+Math.imul(S,H)|0,s=s+Math.imul(S,$)|0,r=r+Math.imul(y,q)|0,i=(i=i+Math.imul(y,X)|0)+Math.imul(b,q)|0,s=s+Math.imul(b,X)|0,r=r+Math.imul(p,K)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(g,K)|0,s=s+Math.imul(g,J)|0;var ve=(l+(r=r+Math.imul(h,Q)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(d,Q)|0))<<13)|0;l=((s=s+Math.imul(d,ee)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(T,j),i=(i=Math.imul(T,z))+Math.imul(_,j)|0,s=Math.imul(_,z),r=r+Math.imul(E,H)|0,i=(i=i+Math.imul(E,$)|0)+Math.imul(I,H)|0,s=s+Math.imul(I,$)|0,r=r+Math.imul(v,q)|0,i=(i=i+Math.imul(v,X)|0)+Math.imul(S,q)|0,s=s+Math.imul(S,X)|0,r=r+Math.imul(y,K)|0,i=(i=i+Math.imul(y,J)|0)+Math.imul(b,K)|0,s=s+Math.imul(b,J)|0,r=r+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,s=s+Math.imul(g,ee)|0;var Se=(l+(r=r+Math.imul(h,ne)|0)|0)+((8191&(i=(i=i+Math.imul(h,re)|0)+Math.imul(d,ne)|0))<<13)|0;l=((s=s+Math.imul(d,re)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(A,j),i=(i=Math.imul(A,z))+Math.imul(F,j)|0,s=Math.imul(F,z),r=r+Math.imul(T,H)|0,i=(i=i+Math.imul(T,$)|0)+Math.imul(_,H)|0,s=s+Math.imul(_,$)|0,r=r+Math.imul(E,q)|0,i=(i=i+Math.imul(E,X)|0)+Math.imul(I,q)|0,s=s+Math.imul(I,X)|0,r=r+Math.imul(v,K)|0,i=(i=i+Math.imul(v,J)|0)+Math.imul(S,K)|0,s=s+Math.imul(S,J)|0,r=r+Math.imul(y,Q)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(b,Q)|0,s=s+Math.imul(b,ee)|0,r=r+Math.imul(p,ne)|0,i=(i=i+Math.imul(p,re)|0)+Math.imul(g,ne)|0,s=s+Math.imul(g,re)|0;var xe=(l+(r=r+Math.imul(h,se)|0)|0)+((8191&(i=(i=i+Math.imul(h,ae)|0)+Math.imul(d,se)|0))<<13)|0;l=((s=s+Math.imul(d,ae)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(M,j),i=(i=Math.imul(M,z))+Math.imul(D,j)|0,s=Math.imul(D,z),r=r+Math.imul(A,H)|0,i=(i=i+Math.imul(A,$)|0)+Math.imul(F,H)|0,s=s+Math.imul(F,$)|0,r=r+Math.imul(T,q)|0,i=(i=i+Math.imul(T,X)|0)+Math.imul(_,q)|0,s=s+Math.imul(_,X)|0,r=r+Math.imul(E,K)|0,i=(i=i+Math.imul(E,J)|0)+Math.imul(I,K)|0,s=s+Math.imul(I,J)|0,r=r+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(S,Q)|0,s=s+Math.imul(S,ee)|0,r=r+Math.imul(y,ne)|0,i=(i=i+Math.imul(y,re)|0)+Math.imul(b,ne)|0,s=s+Math.imul(b,re)|0,r=r+Math.imul(p,se)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(g,se)|0,s=s+Math.imul(g,ae)|0;var Ee=(l+(r=r+Math.imul(h,ce)|0)|0)+((8191&(i=(i=i+Math.imul(h,le)|0)+Math.imul(d,ce)|0))<<13)|0;l=((s=s+Math.imul(d,le)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(P,j),i=(i=Math.imul(P,z))+Math.imul(N,j)|0,s=Math.imul(N,z),r=r+Math.imul(M,H)|0,i=(i=i+Math.imul(M,$)|0)+Math.imul(D,H)|0,s=s+Math.imul(D,$)|0,r=r+Math.imul(A,q)|0,i=(i=i+Math.imul(A,X)|0)+Math.imul(F,q)|0,s=s+Math.imul(F,X)|0,r=r+Math.imul(T,K)|0,i=(i=i+Math.imul(T,J)|0)+Math.imul(_,K)|0,s=s+Math.imul(_,J)|0,r=r+Math.imul(E,Q)|0,i=(i=i+Math.imul(E,ee)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,ee)|0,r=r+Math.imul(v,ne)|0,i=(i=i+Math.imul(v,re)|0)+Math.imul(S,ne)|0,s=s+Math.imul(S,re)|0,r=r+Math.imul(y,se)|0,i=(i=i+Math.imul(y,ae)|0)+Math.imul(b,se)|0,s=s+Math.imul(b,ae)|0,r=r+Math.imul(p,ce)|0,i=(i=i+Math.imul(p,le)|0)+Math.imul(g,ce)|0,s=s+Math.imul(g,le)|0;var Ie=(l+(r=r+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,de)|0)+Math.imul(d,he)|0))<<13)|0;l=((s=s+Math.imul(d,de)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(B,j),i=(i=Math.imul(B,z))+Math.imul(U,j)|0,s=Math.imul(U,z),r=r+Math.imul(P,H)|0,i=(i=i+Math.imul(P,$)|0)+Math.imul(N,H)|0,s=s+Math.imul(N,$)|0,r=r+Math.imul(M,q)|0,i=(i=i+Math.imul(M,X)|0)+Math.imul(D,q)|0,s=s+Math.imul(D,X)|0,r=r+Math.imul(A,K)|0,i=(i=i+Math.imul(A,J)|0)+Math.imul(F,K)|0,s=s+Math.imul(F,J)|0,r=r+Math.imul(T,Q)|0,i=(i=i+Math.imul(T,ee)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,ee)|0,r=r+Math.imul(E,ne)|0,i=(i=i+Math.imul(E,re)|0)+Math.imul(I,ne)|0,s=s+Math.imul(I,re)|0,r=r+Math.imul(v,se)|0,i=(i=i+Math.imul(v,ae)|0)+Math.imul(S,se)|0,s=s+Math.imul(S,ae)|0,r=r+Math.imul(y,ce)|0,i=(i=i+Math.imul(y,le)|0)+Math.imul(b,ce)|0,s=s+Math.imul(b,le)|0,r=r+Math.imul(p,he)|0,i=(i=i+Math.imul(p,de)|0)+Math.imul(g,he)|0,s=s+Math.imul(g,de)|0;var ke=(l+(r=r+Math.imul(h,pe)|0)|0)+((8191&(i=(i=i+Math.imul(h,ge)|0)+Math.imul(d,pe)|0))<<13)|0;l=((s=s+Math.imul(d,ge)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,r=Math.imul(B,H),i=(i=Math.imul(B,$))+Math.imul(U,H)|0,s=Math.imul(U,$),r=r+Math.imul(P,q)|0,i=(i=i+Math.imul(P,X)|0)+Math.imul(N,q)|0,s=s+Math.imul(N,X)|0,r=r+Math.imul(M,K)|0,i=(i=i+Math.imul(M,J)|0)+Math.imul(D,K)|0,s=s+Math.imul(D,J)|0,r=r+Math.imul(A,Q)|0,i=(i=i+Math.imul(A,ee)|0)+Math.imul(F,Q)|0,s=s+Math.imul(F,ee)|0,r=r+Math.imul(T,ne)|0,i=(i=i+Math.imul(T,re)|0)+Math.imul(_,ne)|0,s=s+Math.imul(_,re)|0,r=r+Math.imul(E,se)|0,i=(i=i+Math.imul(E,ae)|0)+Math.imul(I,se)|0,s=s+Math.imul(I,ae)|0,r=r+Math.imul(v,ce)|0,i=(i=i+Math.imul(v,le)|0)+Math.imul(S,ce)|0,s=s+Math.imul(S,le)|0,r=r+Math.imul(y,he)|0,i=(i=i+Math.imul(y,de)|0)+Math.imul(b,he)|0,s=s+Math.imul(b,de)|0;var Te=(l+(r=r+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ge)|0)+Math.imul(g,pe)|0))<<13)|0;l=((s=s+Math.imul(g,ge)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(B,q),i=(i=Math.imul(B,X))+Math.imul(U,q)|0,s=Math.imul(U,X),r=r+Math.imul(P,K)|0,i=(i=i+Math.imul(P,J)|0)+Math.imul(N,K)|0,s=s+Math.imul(N,J)|0,r=r+Math.imul(M,Q)|0,i=(i=i+Math.imul(M,ee)|0)+Math.imul(D,Q)|0,s=s+Math.imul(D,ee)|0,r=r+Math.imul(A,ne)|0,i=(i=i+Math.imul(A,re)|0)+Math.imul(F,ne)|0,s=s+Math.imul(F,re)|0,r=r+Math.imul(T,se)|0,i=(i=i+Math.imul(T,ae)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,ae)|0,r=r+Math.imul(E,ce)|0,i=(i=i+Math.imul(E,le)|0)+Math.imul(I,ce)|0,s=s+Math.imul(I,le)|0,r=r+Math.imul(v,he)|0,i=(i=i+Math.imul(v,de)|0)+Math.imul(S,he)|0,s=s+Math.imul(S,de)|0;var _e=(l+(r=r+Math.imul(y,pe)|0)|0)+((8191&(i=(i=i+Math.imul(y,ge)|0)+Math.imul(b,pe)|0))<<13)|0;l=((s=s+Math.imul(b,ge)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(B,K),i=(i=Math.imul(B,J))+Math.imul(U,K)|0,s=Math.imul(U,J),r=r+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,ee)|0,r=r+Math.imul(M,ne)|0,i=(i=i+Math.imul(M,re)|0)+Math.imul(D,ne)|0,s=s+Math.imul(D,re)|0,r=r+Math.imul(A,se)|0,i=(i=i+Math.imul(A,ae)|0)+Math.imul(F,se)|0,s=s+Math.imul(F,ae)|0,r=r+Math.imul(T,ce)|0,i=(i=i+Math.imul(T,le)|0)+Math.imul(_,ce)|0,s=s+Math.imul(_,le)|0,r=r+Math.imul(E,he)|0,i=(i=i+Math.imul(E,de)|0)+Math.imul(I,he)|0,s=s+Math.imul(I,de)|0;var Ce=(l+(r=r+Math.imul(v,pe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ge)|0)+Math.imul(S,pe)|0))<<13)|0;l=((s=s+Math.imul(S,ge)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,r=Math.imul(B,Q),i=(i=Math.imul(B,ee))+Math.imul(U,Q)|0,s=Math.imul(U,ee),r=r+Math.imul(P,ne)|0,i=(i=i+Math.imul(P,re)|0)+Math.imul(N,ne)|0,s=s+Math.imul(N,re)|0,r=r+Math.imul(M,se)|0,i=(i=i+Math.imul(M,ae)|0)+Math.imul(D,se)|0,s=s+Math.imul(D,ae)|0,r=r+Math.imul(A,ce)|0,i=(i=i+Math.imul(A,le)|0)+Math.imul(F,ce)|0,s=s+Math.imul(F,le)|0,r=r+Math.imul(T,he)|0,i=(i=i+Math.imul(T,de)|0)+Math.imul(_,he)|0,s=s+Math.imul(_,de)|0;var Ae=(l+(r=r+Math.imul(E,pe)|0)|0)+((8191&(i=(i=i+Math.imul(E,ge)|0)+Math.imul(I,pe)|0))<<13)|0;l=((s=s+Math.imul(I,ge)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(B,ne),i=(i=Math.imul(B,re))+Math.imul(U,ne)|0,s=Math.imul(U,re),r=r+Math.imul(P,se)|0,i=(i=i+Math.imul(P,ae)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,ae)|0,r=r+Math.imul(M,ce)|0,i=(i=i+Math.imul(M,le)|0)+Math.imul(D,ce)|0,s=s+Math.imul(D,le)|0,r=r+Math.imul(A,he)|0,i=(i=i+Math.imul(A,de)|0)+Math.imul(F,he)|0,s=s+Math.imul(F,de)|0;var Fe=(l+(r=r+Math.imul(T,pe)|0)|0)+((8191&(i=(i=i+Math.imul(T,ge)|0)+Math.imul(_,pe)|0))<<13)|0;l=((s=s+Math.imul(_,ge)|0)+(i>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,r=Math.imul(B,se),i=(i=Math.imul(B,ae))+Math.imul(U,se)|0,s=Math.imul(U,ae),r=r+Math.imul(P,ce)|0,i=(i=i+Math.imul(P,le)|0)+Math.imul(N,ce)|0,s=s+Math.imul(N,le)|0,r=r+Math.imul(M,he)|0,i=(i=i+Math.imul(M,de)|0)+Math.imul(D,he)|0,s=s+Math.imul(D,de)|0;var Re=(l+(r=r+Math.imul(A,pe)|0)|0)+((8191&(i=(i=i+Math.imul(A,ge)|0)+Math.imul(F,pe)|0))<<13)|0;l=((s=s+Math.imul(F,ge)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(B,ce),i=(i=Math.imul(B,le))+Math.imul(U,ce)|0,s=Math.imul(U,le),r=r+Math.imul(P,he)|0,i=(i=i+Math.imul(P,de)|0)+Math.imul(N,he)|0,s=s+Math.imul(N,de)|0;var Me=(l+(r=r+Math.imul(M,pe)|0)|0)+((8191&(i=(i=i+Math.imul(M,ge)|0)+Math.imul(D,pe)|0))<<13)|0;l=((s=s+Math.imul(D,ge)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(B,he),i=(i=Math.imul(B,de))+Math.imul(U,he)|0,s=Math.imul(U,de);var De=(l+(r=r+Math.imul(P,pe)|0)|0)+((8191&(i=(i=i+Math.imul(P,ge)|0)+Math.imul(N,pe)|0))<<13)|0;l=((s=s+Math.imul(N,ge)|0)+(i>>>13)|0)+(De>>>26)|0,De&=67108863;var Oe=(l+(r=Math.imul(B,pe))|0)+((8191&(i=(i=Math.imul(B,ge))+Math.imul(U,pe)|0))<<13)|0;return l=((s=Math.imul(U,ge))+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,c[0]=me,c[1]=ye,c[2]=be,c[3]=we,c[4]=ve,c[5]=Se,c[6]=xe,c[7]=Ee,c[8]=Ie,c[9]=ke,c[10]=Te,c[11]=_e,c[12]=Ce,c[13]=Ae,c[14]=Fe,c[15]=Re,c[16]=Me,c[17]=De,c[18]=Oe,0!==l&&(c[19]=l,n.length++),n};function y(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,s=0;s<n.length-1;s++){var a=i;i=0;for(var o=67108863&r,c=Math.min(s,t.length-1),l=Math.max(0,s-e.length+1);l<=c;l++){var u=s-l,h=(0|e.words[u])*(0|t.words[l]),d=67108863&h;o=67108863&(d=d+o|0),i+=(a=(a=a+(h/67108864|0)|0)+(d>>>26)|0)>>>26,a&=67108863}n.words[s]=o,r=a,a=i}return 0!==r?n.words[s]=r:n.length--,n._strip()}function b(e,t,n){return y(e,t,n)}function w(e,t){this.x=e,this.y=t}Math.imul||(m=g),s.prototype.mulTo=function(e,t){var n=this.length+e.length;return 10===this.length&&10===e.length?m(this,e,t):n<63?g(this,e,t):n<1024?y(this,e,t):b(this,e,t)},w.prototype.makeRBT=function(e){for(var t=new Array(e),n=s.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},w.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},w.prototype.permute=function(e,t,n,r,i,s){for(var a=0;a<s;a++)r[a]=t[e[a]],i[a]=n[e[a]]},w.prototype.transform=function(e,t,n,r,i,s){this.permute(s,e,t,n,r,i);for(var a=1;a<i;a<<=1)for(var o=a<<1,c=Math.cos(2*Math.PI/o),l=Math.sin(2*Math.PI/o),u=0;u<i;u+=o)for(var h=c,d=l,f=0;f<a;f++){var p=n[u+f],g=r[u+f],m=n[u+f+a],y=r[u+f+a],b=h*m-d*y;y=h*y+d*m,m=b,n[u+f]=p+m,r[u+f]=g+y,n[u+f+a]=p-m,r[u+f+a]=g-y,f!==o&&(b=c*h-l*d,d=c*d+l*h,h=b)}},w.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},w.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},w.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},w.prototype.convert13b=function(e,t,n,i){for(var s=0,a=0;a<t;a++)s+=0|e[a],n[2*a]=8191&s,s>>>=13,n[2*a+1]=8191&s,s>>>=13;for(a=2*t;a<i;++a)n[a]=0;r(0===s),r(!(-8192&s))},w.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},w.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),s=this.stub(r),a=new Array(r),o=new Array(r),c=new Array(r),l=new Array(r),u=new Array(r),h=new Array(r),d=n.words;d.length=r,this.convert13b(e.words,e.length,a,r),this.convert13b(t.words,t.length,l,r),this.transform(a,s,o,c,r,i),this.transform(l,s,u,h,r,i);for(var f=0;f<r;f++){var p=o[f]*u[f]-c[f]*h[f];c[f]=o[f]*h[f]+c[f]*u[f],o[f]=p}return this.conjugate(o,c,r),this.transform(o,c,d,s,r,i),this.conjugate(d,s,r),this.normalize13b(d,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),b(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),r("number"==typeof e),r(e<67108864);for(var n=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,a=(67108863&s)+(67108863&n);n>>=26,n+=s/67108864|0,n+=a>>>26,this.words[i]=67108863&a}return 0!==n&&(this.words[i]=n,this.length++),this.length=0===e?1:this.length,t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=e.words[r]>>>i&1}return t}(e);if(0===t.length)return new s(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var i=n.sqr();r<t.length;r++,i=i.sqr())0!==t[r]&&(n=n.mul(i));return n},s.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,n=e%26,i=(e-n)/26,s=67108863>>>26-n<<26-n;if(0!==n){var a=0;for(t=0;t<this.length;t++){var o=this.words[t]&s,c=(0|this.words[t])-o<<n;this.words[t]=c|a,a=o>>>26-n}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,n){var i;r("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,a=Math.min((e-s)/26,this.length),o=67108863^67108863>>>s<<s,c=n;if(i-=a,i=Math.max(0,i),c){for(var l=0;l<a;l++)c.words[l]=this.words[l];c.length=a}if(0===a);else if(this.length>a)for(this.length-=a,l=0;l<this.length;l++)this.words[l]=this.words[l+a];else this.words[0]=0,this.length=1;var u=0;for(l=this.length-1;l>=0&&(0!==u||l>=i);l--){var h=0|this.words[l];this.words[l]=u<<26-s|h>>>s,u=h&o}return c&&0!==u&&(c.words[c.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,n){return r(0===this.negative),this.iushrn(e,t,n)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26,i=1<<t;return!(this.length<=n||!(this.words[n]&i))},s.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,n=(e-t)/26;if(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=n)return this;if(0!==t&&n++,this.length=Math.min(n,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return r("number"==typeof e),r(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(r("number"==typeof e),r(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,n){var i,s,a=e.length+n;this._expand(a);var o=0;for(i=0;i<e.length;i++){s=(0|this.words[i+n])+o;var c=(0|e.words[i])*t;o=((s-=67108863&c)>>26)-(c/67108864|0),this.words[i+n]=67108863&s}for(;i<this.length-n;i++)o=(s=(0|this.words[i+n])+o)>>26,this.words[i+n]=67108863&s;if(0===o)return this._strip();for(r(-1===o),o=0,i=0;i<this.length;i++)o=(s=-(0|this.words[i])+o)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var n=(this.length,e.length),r=this.clone(),i=e,a=0|i.words[i.length-1];0!=(n=26-this._countBits(a))&&(i=i.ushln(n),r.iushln(n),a=0|i.words[i.length-1]);var o,c=r.length-i.length;if("mod"!==t){(o=new s(null)).length=c+1,o.words=new Array(o.length);for(var l=0;l<o.length;l++)o.words[l]=0}var u=r.clone()._ishlnsubmul(i,1,c);0===u.negative&&(r=u,o&&(o.words[c]=1));for(var h=c-1;h>=0;h--){var d=67108864*(0|r.words[i.length+h])+(0|r.words[i.length+h-1]);for(d=Math.min(d/a|0,67108863),r._ishlnsubmul(i,d,h);0!==r.negative;)d--,r.negative=0,r._ishlnsubmul(i,1,h),r.isZero()||(r.negative^=1);o&&(o.words[h]=d)}return o&&o._strip(),r._strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:o||null,mod:r}},s.prototype.divmod=function(e,t,n){return r(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(i=o.div.neg()),"div"!==t&&(a=o.mod.neg(),n&&0!==a.negative&&a.iadd(e)),{div:i,mod:a}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(i=o.div.neg()),{div:i,mod:o.mod}):this.negative&e.negative?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(a=o.mod.neg(),n&&0!==a.negative&&a.isub(e)),{div:o.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,a,o},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),s=n.cmp(r);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var n=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(n*i+(0|this.words[s]))%e;return t?-i:i},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),r(e<=67108863);for(var n=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*n;this.words[i]=s/e|0,n=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),a=new s(0),o=new s(0),c=new s(1),l=0;t.isEven()&&n.isEven();)t.iushrn(1),n.iushrn(1),++l;for(var u=n.clone(),h=t.clone();!t.isZero();){for(var d=0,f=1;!(t.words[0]&f)&&d<26;++d,f<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(i.isOdd()||a.isOdd())&&(i.iadd(u),a.isub(h)),i.iushrn(1),a.iushrn(1);for(var p=0,g=1;!(n.words[0]&g)&&p<26;++p,g<<=1);if(p>0)for(n.iushrn(p);p-- >0;)(o.isOdd()||c.isOdd())&&(o.iadd(u),c.isub(h)),o.iushrn(1),c.iushrn(1);t.cmp(n)>=0?(t.isub(n),i.isub(o),a.isub(c)):(n.isub(t),o.isub(i),c.isub(a))}return{a:o,b:c,gcd:n.iushln(l)}},s.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t=this,n=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,a=new s(1),o=new s(0),c=n.clone();t.cmpn(1)>0&&n.cmpn(1)>0;){for(var l=0,u=1;!(t.words[0]&u)&&l<26;++l,u<<=1);if(l>0)for(t.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);for(var h=0,d=1;!(n.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(n.iushrn(h);h-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);t.cmp(n)>=0?(t.isub(n),a.isub(o)):(n.isub(t),o.isub(a))}return(i=0===t.cmpn(1)?a:o).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var s=t;t=n,n=s}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return!(1&this.words[0])},s.prototype.isOdd=function(){return!(1&~this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,n=(e-t)/26,i=1<<t;if(this.length<=n)return this._expand(n+1),this.words[n]|=i,this;for(var s=i,a=n;0!==s&&a<this.length;a++){var o=0|this.words[a];s=(o+=s)>>>26,o&=67108863,this.words[a]=o}return 0!==s&&(this.words[a]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,n=e<0;if(0!==this.negative&&!n)return-1;if(0===this.negative&&n)return 1;if(this._strip(),this.length>1)t=1;else{n&&(e=-e),r(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new T(e)},s.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function S(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function x(){S.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){S.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function I(){S.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function k(){S.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function T(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function _(e){T.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}S.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},S.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},S.prototype.split=function(e,t){e.iushrn(this.n,0,t)},S.prototype.imulK=function(e){return e.imul(this.k)},i(x,S),x.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&n,i=10;i<e.length;i++){var a=0|e.words[i];e.words[i-10]=(a&n)<<4|s>>>22,s=a}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},x.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(E,S),i(I,S),i(k,S),k.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new x;else if("p224"===e)t=new E;else if("p192"===e)t=new I;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new k}return v[e]=t,t},T.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},T.prototype._verify2=function(e,t){r(!(e.negative|t.negative),"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},T.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(u(e,e.umod(this.m)._forceRed(this)),e)},T.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},T.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},T.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},T.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},T.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},T.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},T.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},T.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},T.prototype.isqr=function(e){return this.imul(e,e.clone())},T.prototype.sqr=function(e){return this.mul(e,e)},T.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var n=this.m.add(new s(1)).iushrn(2);return this.pow(e,n)}for(var i=this.m.subn(1),a=0;!i.isZero()&&0===i.andln(1);)a++,i.iushrn(1);r(!i.isZero());var o=new s(1).toRed(this),c=o.redNeg(),l=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,l).cmp(c);)u.redIAdd(c);for(var h=this.pow(u,i),d=this.pow(e,i.addn(1).iushrn(1)),f=this.pow(e,i),p=a;0!==f.cmp(o);){for(var g=f,m=0;0!==g.cmp(o);m++)g=g.redSqr();r(m<p);var y=this.pow(h,new s(1).iushln(p-m-1));d=d.redMul(y),h=y.redSqr(),f=f.redMul(h),p=m}return d},T.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},T.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new s(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var i=n[0],a=0,o=0,c=t.bitLength()%26;for(0===c&&(c=26),r=t.length-1;r>=0;r--){for(var l=t.words[r],u=c-1;u>=0;u--){var h=l>>u&1;i!==n[0]&&(i=this.sqr(i)),0!==h||0!==a?(a<<=1,a|=h,(4==++o||0===r&&0===u)&&(i=this.mul(i,n[a]),o=0,a=0)):o=0}c=26}return i},T.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},T.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new _(e)},i(_,T),_.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},_.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},_.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},_.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),a=i;return i.cmp(this.m)>=0?a=i.isub(this.m):i.cmpn(0)<0&&(a=i.iadd(this.m)),a._forceRed(this)},_.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=n.nmd(e),this)},7048:(e,t,n)=>{var r;function i(e){this.rand=e}if(e.exports=function(e){return r||(r=new i(null)),r.generate(e)},e.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),n=0;n<t.length;n++)t[n]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var s=n(3553);if("function"!=typeof s.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return s.randomBytes(e)}}catch(e){}},921:(e,t,n)=>{var r=n(5636).Buffer;function i(e){r.isBuffer(e)||(e=r.from(e));for(var t=e.length/4|0,n=new Array(t),i=0;i<t;i++)n[i]=e.readUInt32BE(4*i);return n}function s(e){for(;0<e.length;e++)e[0]=0}function a(e,t,n,r,i){for(var s,a,o,c,l=n[0],u=n[1],h=n[2],d=n[3],f=e[0]^t[0],p=e[1]^t[1],g=e[2]^t[2],m=e[3]^t[3],y=4,b=1;b<i;b++)s=l[f>>>24]^u[p>>>16&255]^h[g>>>8&255]^d[255&m]^t[y++],a=l[p>>>24]^u[g>>>16&255]^h[m>>>8&255]^d[255&f]^t[y++],o=l[g>>>24]^u[m>>>16&255]^h[f>>>8&255]^d[255&p]^t[y++],c=l[m>>>24]^u[f>>>16&255]^h[p>>>8&255]^d[255&g]^t[y++],f=s,p=a,g=o,m=c;return s=(r[f>>>24]<<24|r[p>>>16&255]<<16|r[g>>>8&255]<<8|r[255&m])^t[y++],a=(r[p>>>24]<<24|r[g>>>16&255]<<16|r[m>>>8&255]<<8|r[255&f])^t[y++],o=(r[g>>>24]<<24|r[m>>>16&255]<<16|r[f>>>8&255]<<8|r[255&p])^t[y++],c=(r[m>>>24]<<24|r[f>>>16&255]<<16|r[p>>>8&255]<<8|r[255&g])^t[y++],[s>>>=0,a>>>=0,o>>>=0,c>>>=0]}var o=[0,1,2,4,8,16,32,64,128,27,54],c=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var n=[],r=[],i=[[],[],[],[]],s=[[],[],[],[]],a=0,o=0,c=0;c<256;++c){var l=o^o<<1^o<<2^o<<3^o<<4;l=l>>>8^255&l^99,n[a]=l,r[l]=a;var u=e[a],h=e[u],d=e[h],f=257*e[l]^16843008*l;i[0][a]=f<<24|f>>>8,i[1][a]=f<<16|f>>>16,i[2][a]=f<<8|f>>>24,i[3][a]=f,f=16843009*d^65537*h^257*u^16843008*a,s[0][l]=f<<24|f>>>8,s[1][l]=f<<16|f>>>16,s[2][l]=f<<8|f>>>24,s[3][l]=f,0===a?a=o=1:(a=u^e[e[e[d^u]]],o^=e[e[o]])}return{SBOX:n,INV_SBOX:r,SUB_MIX:i,INV_SUB_MIX:s}}();function l(e){this._key=i(e),this._reset()}l.blockSize=16,l.keySize=32,l.prototype.blockSize=l.blockSize,l.prototype.keySize=l.keySize,l.prototype._reset=function(){for(var e=this._key,t=e.length,n=t+6,r=4*(n+1),i=[],s=0;s<t;s++)i[s]=e[s];for(s=t;s<r;s++){var a=i[s-1];s%t==0?(a=a<<8|a>>>24,a=c.SBOX[a>>>24]<<24|c.SBOX[a>>>16&255]<<16|c.SBOX[a>>>8&255]<<8|c.SBOX[255&a],a^=o[s/t|0]<<24):t>6&&s%t==4&&(a=c.SBOX[a>>>24]<<24|c.SBOX[a>>>16&255]<<16|c.SBOX[a>>>8&255]<<8|c.SBOX[255&a]),i[s]=i[s-t]^a}for(var l=[],u=0;u<r;u++){var h=r-u,d=i[h-(u%4?0:4)];l[u]=u<4||h<=4?d:c.INV_SUB_MIX[0][c.SBOX[d>>>24]]^c.INV_SUB_MIX[1][c.SBOX[d>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[d>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&d]]}this._nRounds=n,this._keySchedule=i,this._invKeySchedule=l},l.prototype.encryptBlockRaw=function(e){return a(e=i(e),this._keySchedule,c.SUB_MIX,c.SBOX,this._nRounds)},l.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),n=r.allocUnsafe(16);return n.writeUInt32BE(t[0],0),n.writeUInt32BE(t[1],4),n.writeUInt32BE(t[2],8),n.writeUInt32BE(t[3],12),n},l.prototype.decryptBlock=function(e){var t=(e=i(e))[1];e[1]=e[3],e[3]=t;var n=a(e,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX,this._nRounds),s=r.allocUnsafe(16);return s.writeUInt32BE(n[0],0),s.writeUInt32BE(n[3],4),s.writeUInt32BE(n[2],8),s.writeUInt32BE(n[1],12),s},l.prototype.scrub=function(){s(this._keySchedule),s(this._invKeySchedule),s(this._key)},e.exports.AES=l},4029:(e,t,n)=>{var r=n(921),i=n(5636).Buffer,s=n(7589),a=n(5615),o=n(4803),c=n(2444),l=n(2379);function u(e,t,n,a){s.call(this);var c=i.alloc(4,0);this._cipher=new r.AES(t);var u=this._cipher.encryptBlock(c);this._ghash=new o(u),n=function(e,t,n){if(12===t.length)return e._finID=i.concat([t,i.from([0,0,0,1])]),i.concat([t,i.from([0,0,0,2])]);var r=new o(n),s=t.length,a=s%16;r.update(t),a&&(a=16-a,r.update(i.alloc(a,0))),r.update(i.alloc(8,0));var c=8*s,u=i.alloc(8);u.writeUIntBE(c,0,8),r.update(u),e._finID=r.state;var h=i.from(e._finID);return l(h),h}(this,n,u),this._prev=i.from(n),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}a(u,s),u.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=i.alloc(t,0),this._ghash.update(t))}this._called=!0;var n=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(n),this._len+=e.length,n},u.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=c(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var n=0;e.length!==t.length&&n++;for(var r=Math.min(e.length,t.length),i=0;i<r;++i)n+=e[i]^t[i];return n}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},u.prototype.getAuthTag=function(){if(this._decrypt||!i.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},u.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},u.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},e.exports=u},178:(e,t,n)=>{var r=n(692),i=n(2096),s=n(6);t.createCipher=t.Cipher=r.createCipher,t.createCipheriv=t.Cipheriv=r.createCipheriv,t.createDecipher=t.Decipher=i.createDecipher,t.createDecipheriv=t.Decipheriv=i.createDecipheriv,t.listCiphers=t.getCiphers=function(){return Object.keys(s)}},2096:(e,t,n)=>{var r=n(4029),i=n(5636).Buffer,s=n(8197),a=n(7695),o=n(7589),c=n(921),l=n(8981);function u(e,t,n){o.call(this),this._cache=new h,this._last=void 0,this._cipher=new c.AES(t),this._prev=i.from(n),this._mode=e,this._autopadding=!0}function h(){this.cache=i.allocUnsafe(0)}function d(e,t,n){var o=s[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");if("string"==typeof n&&(n=i.from(n)),"GCM"!==o.mode&&n.length!==o.iv)throw new TypeError("invalid iv length "+n.length);if("string"==typeof t&&(t=i.from(t)),t.length!==o.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===o.type?new a(o.module,t,n,!0):"auth"===o.type?new r(o.module,t,n,!0):new u(o.module,t,n)}n(5615)(u,o),u.prototype._update=function(e){var t,n;this._cache.add(e);for(var r=[];t=this._cache.get(this._autopadding);)n=this._mode.decrypt(this,t),r.push(n);return i.concat(r)},u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");for(var n=-1;++n<t;)if(e[n+(16-t)]!==t)throw new Error("unable to decrypt data");if(16!==t)return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},h.prototype.add=function(e){this.cache=i.concat([this.cache,e])},h.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},h.prototype.flush=function(){if(this.cache.length)return this.cache},t.createDecipher=function(e,t){var n=s[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=l(t,!1,n.key,n.iv);return d(e,r.key,r.iv)},t.createDecipheriv=d},692:(e,t,n)=>{var r=n(8197),i=n(4029),s=n(5636).Buffer,a=n(7695),o=n(7589),c=n(921),l=n(8981);function u(e,t,n){o.call(this),this._cache=new d,this._cipher=new c.AES(t),this._prev=s.from(n),this._mode=e,this._autopadding=!0}n(5615)(u,o),u.prototype._update=function(e){var t,n;this._cache.add(e);for(var r=[];t=this._cache.get();)n=this._mode.encrypt(this,t),r.push(n);return s.concat(r)};var h=s.alloc(16,16);function d(){this.cache=s.allocUnsafe(0)}function f(e,t,n){var o=r[e.toLowerCase()];if(!o)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=s.from(t)),t.length!==o.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof n&&(n=s.from(n)),"GCM"!==o.mode&&n.length!==o.iv)throw new TypeError("invalid iv length "+n.length);return"stream"===o.type?new a(o.module,t,n):"auth"===o.type?new i(o.module,t,n):new u(o.module,t,n)}u.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(h))throw this._cipher.scrub(),new Error("data not multiple of block length")},u.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},d.prototype.add=function(e){this.cache=s.concat([this.cache,e])},d.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},d.prototype.flush=function(){for(var e=16-this.cache.length,t=s.allocUnsafe(e),n=-1;++n<e;)t.writeUInt8(e,n);return s.concat([this.cache,t])},t.createCipheriv=f,t.createCipher=function(e,t){var n=r[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var i=l(t,!1,n.key,n.iv);return f(e,i.key,i.iv)}},4803:(e,t,n)=>{var r=n(5636).Buffer,i=r.alloc(16,0);function s(e){var t=r.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function a(e){this.h=e,this.state=r.alloc(16,0),this.cache=r.allocUnsafe(0)}a.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},a.prototype._multiply=function(){for(var e,t,n,r=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],i=[0,0,0,0],a=-1;++a<128;){for(!!(this.state[~~(a/8)]&1<<7-a%8)&&(i[0]^=r[0],i[1]^=r[1],i[2]^=r[2],i[3]^=r[3]),n=!!(1&r[3]),t=3;t>0;t--)r[t]=r[t]>>>1|(1&r[t-1])<<31;r[0]=r[0]>>>1,n&&(r[0]=r[0]^225<<24)}this.state=s(i)},a.prototype.update=function(e){var t;for(this.cache=r.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},a.prototype.final=function(e,t){return this.cache.length&&this.ghash(r.concat([this.cache,i],16)),this.ghash(s([0,e,0,t])),this.state},e.exports=a},2379:e=>{e.exports=function(e){for(var t,n=e.length;n--;){if(255!==(t=e.readUInt8(n))){t++,e.writeUInt8(t,n);break}e.writeUInt8(0,n)}}},5923:(e,t,n)=>{var r=n(2444);t.encrypt=function(e,t){var n=r(t,e._prev);return e._prev=e._cipher.encryptBlock(n),e._prev},t.decrypt=function(e,t){var n=e._prev;e._prev=t;var i=e._cipher.decryptBlock(t);return r(i,n)}},2840:(e,t,n)=>{var r=n(5636).Buffer,i=n(2444);function s(e,t,n){var s=t.length,a=i(t,e._cache);return e._cache=e._cache.slice(s),e._prev=r.concat([e._prev,n?t:a]),a}t.encrypt=function(e,t,n){for(var i,a=r.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=r.allocUnsafe(0)),!(e._cache.length<=t.length)){a=r.concat([a,s(e,t,n)]);break}i=e._cache.length,a=r.concat([a,s(e,t.slice(0,i),n)]),t=t.slice(i)}return a}},3081:(e,t,n)=>{var r=n(5636).Buffer;function i(e,t,n){for(var r,i,a=-1,o=0;++a<8;)r=t&1<<7-a?128:0,o+=(128&(i=e._cipher.encryptBlock(e._prev)[0]^r))>>a%8,e._prev=s(e._prev,n?r:i);return o}function s(e,t){var n=e.length,i=-1,s=r.allocUnsafe(e.length);for(e=r.concat([e,r.from([t])]);++i<n;)s[i]=e[i]<<1|e[i+1]>>7;return s}t.encrypt=function(e,t,n){for(var s=t.length,a=r.allocUnsafe(s),o=-1;++o<s;)a[o]=i(e,t[o],n);return a}},3250:(e,t,n)=>{var r=n(5636).Buffer;function i(e,t,n){var i=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=r.concat([e._prev.slice(1),r.from([n?t:i])]),i}t.encrypt=function(e,t,n){for(var s=t.length,a=r.allocUnsafe(s),o=-1;++o<s;)a[o]=i(e,t[o],n);return a}},7306:(e,t,n)=>{var r=n(2444),i=n(5636).Buffer,s=n(2379);function a(e){var t=e._cipher.encryptBlockRaw(e._prev);return s(e._prev),t}t.encrypt=function(e,t){var n=Math.ceil(t.length/16),s=e._cache.length;e._cache=i.concat([e._cache,i.allocUnsafe(16*n)]);for(var o=0;o<n;o++){var c=a(e),l=s+16*o;e._cache.writeUInt32BE(c[0],l+0),e._cache.writeUInt32BE(c[1],l+4),e._cache.writeUInt32BE(c[2],l+8),e._cache.writeUInt32BE(c[3],l+12)}var u=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),r(t,u)}},7347:(e,t)=>{t.encrypt=function(e,t){return e._cipher.encryptBlock(t)},t.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},8197:(e,t,n)=>{var r={ECB:n(7347),CBC:n(5923),CFB:n(2840),CFB8:n(3250),CFB1:n(3081),OFB:n(3228),CTR:n(7306),GCM:n(7306)},i=n(6);for(var s in i)i[s].module=r[i[s].mode];e.exports=i},3228:(e,t,n)=>{var r=n(1048).Buffer,i=n(2444);function s(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}t.encrypt=function(e,t){for(;e._cache.length<t.length;)e._cache=r.concat([e._cache,s(e)]);var n=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,n)}},7695:(e,t,n)=>{var r=n(921),i=n(5636).Buffer,s=n(7589);function a(e,t,n,a){s.call(this),this._cipher=new r.AES(t),this._prev=i.from(n),this._cache=i.allocUnsafe(0),this._secCache=i.allocUnsafe(0),this._decrypt=a,this._mode=e}n(5615)(a,s),a.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},a.prototype._final=function(){this._cipher.scrub()},e.exports=a},7172:(e,t,n)=>{var r=n(681),i=n(178),s=n(8197),a=n(5913),o=n(8981);function c(e,t,n){if(e=e.toLowerCase(),s[e])return i.createCipheriv(e,t,n);if(a[e])return new r({key:t,iv:n,mode:e});throw new TypeError("invalid suite type")}function l(e,t,n){if(e=e.toLowerCase(),s[e])return i.createDecipheriv(e,t,n);if(a[e])return new r({key:t,iv:n,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}t.createCipher=t.Cipher=function(e,t){var n,r;if(e=e.toLowerCase(),s[e])n=s[e].key,r=s[e].iv;else{if(!a[e])throw new TypeError("invalid suite type");n=8*a[e].key,r=a[e].iv}var i=o(t,!1,n,r);return c(e,i.key,i.iv)},t.createCipheriv=t.Cipheriv=c,t.createDecipher=t.Decipher=function(e,t){var n,r;if(e=e.toLowerCase(),s[e])n=s[e].key,r=s[e].iv;else{if(!a[e])throw new TypeError("invalid suite type");n=8*a[e].key,r=a[e].iv}var i=o(t,!1,n,r);return l(e,i.key,i.iv)},t.createDecipheriv=t.Decipheriv=l,t.listCiphers=t.getCiphers=function(){return Object.keys(a).concat(i.getCiphers())}},681:(e,t,n)=>{var r=n(7589),i=n(2431),s=n(5615),a=n(5636).Buffer,o={"des-ede3-cbc":i.CBC.instantiate(i.EDE),"des-ede3":i.EDE,"des-ede-cbc":i.CBC.instantiate(i.EDE),"des-ede":i.EDE,"des-cbc":i.CBC.instantiate(i.DES),"des-ecb":i.DES};function c(e){r.call(this);var t,n=e.mode.toLowerCase(),i=o[n];t=e.decrypt?"decrypt":"encrypt";var s=e.key;a.isBuffer(s)||(s=a.from(s)),"des-ede"!==n&&"des-ede-cbc"!==n||(s=a.concat([s,s.slice(0,8)]));var c=e.iv;a.isBuffer(c)||(c=a.from(c)),this._des=i.create({key:s,iv:c,type:t})}o.des=o["des-cbc"],o.des3=o["des-ede3-cbc"],e.exports=c,s(c,r),c.prototype._update=function(e){return a.from(this._des.update(e))},c.prototype._final=function(){return a.from(this._des.final())}},5913:(e,t)=>{t["des-ecb"]={key:8,iv:0},t["des-cbc"]=t.des={key:8,iv:8},t["des-ede3-cbc"]=t.des3={key:24,iv:8},t["des-ede3"]={key:24,iv:0},t["des-ede-cbc"]={key:16,iv:8},t["des-ede"]={key:16,iv:0}},4215:(e,t,n)=>{"use strict";var r=n(2823),i=n(2644),s=n(5636).Buffer;function a(e){var t,n=e.modulus.byteLength();do{t=new r(i(n))}while(t.cmp(e.modulus)>=0||!t.umod(e.prime1)||!t.umod(e.prime2));return t}function o(e,t){var n=function(e){var t=a(e);return{blinder:t.toRed(r.mont(e.modulus)).redPow(new r(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}(t),i=t.modulus.byteLength(),o=new r(e).mul(n.blinder).umod(t.modulus),c=o.toRed(r.mont(t.prime1)),l=o.toRed(r.mont(t.prime2)),u=t.coefficient,h=t.prime1,d=t.prime2,f=c.redPow(t.exponent1).fromRed(),p=l.redPow(t.exponent2).fromRed(),g=f.isub(p).imul(u).umod(h).imul(d);return p.iadd(g).imul(n.unblinder).umod(t.modulus).toArrayLike(s,"be",i)}o.getr=a,e.exports=o},3982:(e,t,n)=>{"use strict";e.exports=n(4716)},9553:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(3257),s=n(8521),a=n(5615),o=n(2188),c=n(6680),l=n(4716);function u(e){s.Writable.call(this);var t=l[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function h(e){s.Writable.call(this);var t=l[e];if(!t)throw new Error("Unknown message digest");this._hash=i(t.hash),this._tag=t.id,this._signType=t.sign}function d(e){return new u(e)}function f(e){return new h(e)}Object.keys(l).forEach(function(e){l[e].id=r.from(l[e].id,"hex"),l[e.toLowerCase()]=l[e]}),a(u,s.Writable),u.prototype._write=function(e,t,n){this._hash.update(e),n()},u.prototype.update=function(e,t){return this._hash.update("string"==typeof e?r.from(e,t):e),this},u.prototype.sign=function(e,t){this.end();var n=this._hash.digest(),r=o(n,e,this._hashType,this._signType,this._tag);return t?r.toString(t):r},a(h,s.Writable),h.prototype._write=function(e,t,n){this._hash.update(e),n()},h.prototype.update=function(e,t){return this._hash.update("string"==typeof e?r.from(e,t):e),this},h.prototype.verify=function(e,t,n){var i="string"==typeof t?r.from(t,n):t;this.end();var s=this._hash.digest();return c(i,s,e,this._signType,this._tag)},e.exports={Sign:d,Verify:f,createSign:d,createVerify:f}},2188:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(5262),s=n(4215),a=n(3360).ec,o=n(2823),c=n(5069),l=n(6646);function u(e,t,n,s){if((e=r.from(e.toArray())).length<t.byteLength()){var a=r.alloc(t.byteLength()-e.length);e=r.concat([a,e])}var o=n.length,c=function(e,t){e=(e=h(e,t)).mod(t);var n=r.from(e.toArray());if(n.length<t.byteLength()){var i=r.alloc(t.byteLength()-n.length);n=r.concat([i,n])}return n}(n,t),l=r.alloc(o);l.fill(1);var u=r.alloc(o);return u=i(s,u).update(l).update(r.from([0])).update(e).update(c).digest(),l=i(s,u).update(l).digest(),{k:u=i(s,u).update(l).update(r.from([1])).update(e).update(c).digest(),v:l=i(s,u).update(l).digest()}}function h(e,t){var n=new o(e),r=(e.length<<3)-t.bitLength();return r>0&&n.ishrn(r),n}function d(e,t,n){var s,a;do{for(s=r.alloc(0);8*s.length<e.bitLength();)t.v=i(n,t.k).update(t.v).digest(),s=r.concat([s,t.v]);a=h(s,e),t.k=i(n,t.k).update(t.v).update(r.from([0])).digest(),t.v=i(n,t.k).update(t.v).digest()}while(-1!==a.cmp(e));return a}function f(e,t,n,r){return e.toRed(o.mont(n)).redPow(t).fromRed().mod(r)}e.exports=function(e,t,n,i,p){var g=c(t);if(g.curve){if("ecdsa"!==i&&"ecdsa/rsa"!==i)throw new Error("wrong private key type");return function(e,t){var n=l[t.curve.join(".")];if(!n)throw new Error("unknown curve "+t.curve.join("."));var i=new a(n).keyFromPrivate(t.privateKey).sign(e);return r.from(i.toDER())}(e,g)}if("dsa"===g.type){if("dsa"!==i)throw new Error("wrong private key type");return function(e,t,n){for(var i,s=t.params.priv_key,a=t.params.p,c=t.params.q,l=t.params.g,p=new o(0),g=h(e,c).mod(c),m=!1,y=u(s,c,e,n);!1===m;)p=f(l,i=d(c,y,n),a,c),0===(m=i.invm(c).imul(g.add(s.mul(p))).mod(c)).cmpn(0)&&(m=!1,p=new o(0));return function(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e)),128&t[0]&&(t=[0].concat(t));var n=[48,e.length+t.length+4,2,e.length];return n=n.concat(e,[2,t.length],t),r.from(n)}(p,m)}(e,g,n)}if("rsa"!==i&&"ecdsa/rsa"!==i)throw new Error("wrong private key type");if(void 0!==t.padding&&1!==t.padding)throw new Error("illegal or unsupported padding mode");e=r.concat([p,e]);for(var m=g.modulus.byteLength(),y=[0,1];e.length+y.length+1<m;)y.push(255);y.push(0);for(var b=-1;++b<e.length;)y.push(e[b]);return s(y,g)},e.exports.getKey=u,e.exports.makeKey=d},6680:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(2823),s=n(3360).ec,a=n(5069),o=n(6646);function c(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=0)throw new Error("invalid sig")}e.exports=function(e,t,n,l,u){var h=a(n);if("ec"===h.type){if("ecdsa"!==l&&"ecdsa/rsa"!==l)throw new Error("wrong public key type");return function(e,t,n){var r=o[n.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var i=new s(r),a=n.data.subjectPrivateKey.data;return i.verify(t,e,a)}(e,t,h)}if("dsa"===h.type){if("dsa"!==l)throw new Error("wrong public key type");return function(e,t,n){var r=n.data.p,s=n.data.q,o=n.data.g,l=n.data.pub_key,u=a.signature.decode(e,"der"),h=u.s,d=u.r;c(h,s),c(d,s);var f=i.mont(r),p=h.invm(s);return 0===o.toRed(f).redPow(new i(t).mul(p).mod(s)).fromRed().mul(l.toRed(f).redPow(d.mul(p).mod(s)).fromRed()).mod(r).mod(s).cmp(d)}(e,t,h)}if("rsa"!==l&&"ecdsa/rsa"!==l)throw new Error("wrong public key type");t=r.concat([u,t]);for(var d=h.modulus.byteLength(),f=[1],p=0;t.length+f.length+2<d;)f.push(255),p+=1;f.push(0);for(var g=-1;++g<t.length;)f.push(t[g]);f=r.from(f);var m=i.mont(h.modulus);e=(e=new i(e).toRed(m)).redPow(new i(h.publicExponent)),e=r.from(e.fromRed().toArray());var y=p<8?1:0;for(d=Math.min(e.length,f.length),e.length!==f.length&&(y=1),g=-1;++g<d;)y|=e[g]^f[g];return 0===y}},2444:(e,t,n)=>{var r=n(1048).Buffer;e.exports=function(e,t){for(var n=Math.min(e.length,t.length),i=new r(n),s=0;s<n;++s)i[s]=e[s]^t[s];return i}},1048:(e,t,n)=>{"use strict";const r=n(7991),i=n(9318),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function o(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,t,n)}function l(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|g(e,t);let r=o(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Y(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Y(e,ArrayBuffer)||e&&Y(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(e,SharedArrayBuffer)||e&&Y(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?o(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),o(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=o(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function p(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function g(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Y(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(i)return r?-1:W(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return F(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){let s,a=1,o=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,o/=2,c/=2,n/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let r=-1;for(s=n;s<o;s++)if(l(e,s)===l(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===c)return r*a}else-1!==r&&(s-=s-r),r=-1}else for(n+c>o&&(n=o-c),s=n;s>=0;s--){let n=!0;for(let r=0;r<c;r++)if(l(e,s+r)!==l(t,r)){n=!1;break}if(n)return s}return-1}function v(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const s=t.length;let a;for(r>s/2&&(r=s/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(K(r))return a;e[n+a]=r}return a}function S(e,t,n,r){return X(W(t,e.length-n),e,n,r)}function x(e,t,n,r){return X(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return X(q(t),e,n,r)}function I(e,t,n,r){return X(function(e,t){let n,r,i;const s=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let s=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,o,c;switch(a){case 1:t<128&&(s=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(s=c));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:n=e[i+1],r=e[i+2],o=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&o)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&o,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=a}return function(e){const t=e.length;if(t<=_)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=_));return n}(r)}t.kMaxLength=a,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return l(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(Y(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?T(this,0,e):m.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const o=Math.min(s,a),l=this.slice(r,i),u=e.slice(t,n);for(let e=0;e<o;++e)if(l[e]!==u[e]){s=l[e],a=u[e];break}return s<a?-1:a<s?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return S(this,e,t,n);case"ascii":case"latin1":case"binary":return x(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const _=4096;function C(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function F(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=J[e[r]];return i}function R(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function M(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,r,i,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function O(e,t,n,r,i){z(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function P(e,t,n,r,i){z(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function N(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,s){return t=+t,n>>>=0,s||N(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function B(e,t,n,r,s){return t=+t,n>>>=0,s||N(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||M(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=Z(function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||H(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))}),c.prototype.readBigUInt64BE=Z(function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||H(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||M(e,t,this.length);let r=t,i=1,s=this[e+--r];for(;r>0&&(i*=256);)s+=this[e+--r]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||M(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||M(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||M(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||M(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=Z(function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||H(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),c.prototype.readBigInt64BE=Z(function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||H(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)}),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||M(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||M(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||D(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||D(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=Z(function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=Z(function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);D(this,e,t,n,r-1,-r)}let i=0,s=1,a=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s|0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);D(this,e,t,n,r-1,-r)}let i=n-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s|0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=Z(function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=Z(function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return B(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return B(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const s=c.isBuffer(e)?e:c.from(e,r),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};const U={};function V(e,t,n){U[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function j(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function z(e,t,n,r,i,s){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(s+1)}${r}`:`>= -(2${r} ** ${8*(s+1)-1}${r}) and < 2 ** ${8*(s+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new U.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||H(t,e.length-(n+1))}(r,i,s)}function G(e,t){if("number"!=typeof e)throw new U.ERR_INVALID_ARG_TYPE(t,"number",e)}function H(e,t,n){if(Math.floor(e)!==e)throw G(e,n),new U.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}V("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),V("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=j(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r},RangeError);const $=/[^+/0-9A-Za-z-_]/g;function W(e,t){let n;t=t||1/0;const r=e.length;let i=null;const s=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function q(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Y(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Z(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},450:(e,t,n)=>{"use strict";var r=n(9537),i=n(8106),s=n(768),a=n(9815),o=n(4409),c=n(6767),l=n(5302),u=(n(8418),n(1098));function h(e){function t(t){e&&(this[e]={}),t&&this.set(t)}return i(t.prototype),t.prototype.set=function(t,n){return Array.isArray(t)&&2===arguments.length&&(t=a(t)),r(t)||Array.isArray(t)?this.visit("set",t):(u(e?this[e]:this,t,n),this.emit("set",t,n)),this},t.prototype.union=function(t,n){Array.isArray(t)&&2===arguments.length&&(t=a(t));var r=e?this[e]:this;return o(r,t,function(e){return e?Array.isArray(e)?e:[e]:[]}(n)),this.emit("union",n),this},t.prototype.get=function(t){t=a(arguments);var n=e?this[e]:this,r=l(n,t);return this.emit("get",t,r),r},t.prototype.has=function(t){t=a(arguments);var n=e?this[e]:this,r=void 0!==l(n,t);return this.emit("has",t,r),r},t.prototype.del=function(t){return Array.isArray(t)?this.visit("del",t):(c(e?this[e]:this,t),this.emit("del",t)),this},t.prototype.clear=function(){e&&(this[e]={})},t.prototype.visit=function(e,t){return s(this,e,t),this},t}e.exports=h(),e.exports.namespace=h},8165:(e,t,n)=>{"use strict";var r=n(9138),i=n(6095),s=n(4531),a=n(7196);e.exports=a||r.call(s,i)},2012:(e,t,n)=>{"use strict";var r=n(9138),i=n(6095),s=n(8165);e.exports=function(){return s(r,i,arguments)}},6095:e=>{"use strict";e.exports=Function.prototype.apply},4531:e=>{"use strict";e.exports=Function.prototype.call},9903:(e,t,n)=>{"use strict";var r=n(9138),i=n(3468),s=n(4531),a=n(8165);e.exports=function(e){if(e.length<1||"function"!=typeof e[0])throw new i("a function is required");return a(r,s,e)}},7196:e=>{"use strict";e.exports="undefined"!=typeof Reflect&&Reflect&&Reflect.apply},8498:(e,t,n)=>{"use strict";var r=n(6108),i=n(4940),s=n(9903),a=n(2012);e.exports=function(e){var t=s(arguments),n=e.length-(arguments.length-1);return r(t,1+(n>0?n:0),!0)},i?i(e.exports,"apply",{value:a}):e.exports.apply=a},4607:(e,t,n)=>{"use strict";var r=n(528),i=n(9903),s=i([r("%String.prototype.indexOf%")]);e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&s(e,".prototype.")>-1?i([n]):n}},7589:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(1983).Transform,s=n(8888).StringDecoder;function a(e){i.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}n(5615)(a,i);var o="undefined"!=typeof Uint8Array,c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&ArrayBuffer.isView&&(r.prototype instanceof Uint8Array||r.TYPED_ARRAY_SUPPORT);a.prototype.update=function(e,t,n){var i=function(e,t){if(e instanceof r)return e;if("string"==typeof e)return r.from(e,t);if(c&&ArrayBuffer.isView(e)){if(0===e.byteLength)return r.alloc(0);var n=r.from(e.buffer,e.byteOffset,e.byteLength);if(n.byteLength===e.byteLength)return n}if(o&&e instanceof Uint8Array)return r.from(e);if(r.isBuffer(e)&&e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))return r.from(e);throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView.')}(e,t),s=this._update(i);return this.hashMode?this:(n&&(s=this._toString(s,n)),s)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){r=e}finally{n(r)}},a.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},a.prototype._finalOrDigest=function(e){var t=this.__final()||r.alloc(0);return e&&(t=this._toString(t,e,!0)),t},a.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new s(t),this._encoding=t),this._encoding!==t)throw new Error("cant switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r},e.exports=a},5558:(e,t,n)=>{"use strict";n(9208);var r=n(5123),i=n(5677),s=n(8324),a=n(9537),o=e.exports;o.isObject=function(e){return a(e)||"function"==typeof e},o.has=function(e,t){var n=(t=o.arrayify(t)).length;if(o.isObject(e)){for(var r in e)if(t.indexOf(r)>-1)return!0;var i=o.nativeKeys(e);return o.has(i,t)}if(Array.isArray(e)){for(var s=e;n--;)if(s.indexOf(t[n])>-1)return!0;return!1}throw new TypeError("expected an array or object.")},o.hasAll=function(e,t){for(var n=(t=o.arrayify(t)).length;n--;)if(!o.has(e,t[n]))return!1;return!0},o.arrayify=function(e){return e?Array.isArray(e)?e:[e]:[]},o.noop=function(){},o.identity=function(e){return e},o.hasConstructor=function(e){return o.isObject(e)&&void 0!==e.constructor},o.nativeKeys=function(e){if(!o.hasConstructor(e))return[];var t=Object.getOwnPropertyNames(e);return"caller"in e&&t.push("caller"),t},o.getDescriptor=function(e,t){if(!o.isObject(e))throw new TypeError("expected an object.");if("string"!=typeof t)throw new TypeError("expected key to be a string.");return Object.getOwnPropertyDescriptor(e,t)},o.copyDescriptor=function(e,t,n){if(!o.isObject(e))throw new TypeError("expected receiving object to be an object.");if(!o.isObject(t))throw new TypeError("expected providing object to be an object.");if("string"!=typeof n)throw new TypeError("expected name to be a string.");var r=o.getDescriptor(t,n);r&&Object.defineProperty(e,n,r)},o.copy=function(e,t,n){if(!o.isObject(e))throw new TypeError("expected receiving object to be an object.");if(!o.isObject(t))throw new TypeError("expected providing object to be an object.");var r,s=Object.getOwnPropertyNames(t),a=Object.keys(t),c=s.length;for(n=o.arrayify(n);c--;)r=s[c],o.has(a,r)?i(e,r,t[r]):r in e||o.has(n,r)||o.copyDescriptor(e,t,r)},o.inherit=function(e,t,n){if(!o.isObject(e))throw new TypeError("expected receiving object to be an object.");if(!o.isObject(t))throw new TypeError("expected providing object to be an object.");var r=[];for(var i in t)r.push(i),e[i]=t[i];r=r.concat(o.arrayify(n));var s=t.prototype||t,a=e.prototype||e;o.copy(a,s,r)},o.extend=function(){return s.apply(null,arguments)},o.bubble=function(e,t){t=t||[],e.bubble=function(n,i){Array.isArray(i)&&(t=r([],t,i));for(var s=t.length,a=-1;++a<s;){var c=t[a];e.on(c,n.emit.bind(n,c))}o.bubble(n,t)}}},768:(e,t,n)=>{"use strict";var r=n(9535),i=n(6094);e.exports=function(e,t,n){var s;if("string"==typeof n&&t in e){var a=[].slice.call(arguments,2);s=e[t].apply(e,a)}else s=Array.isArray(n)?i.apply(null,arguments):r.apply(null,arguments);return void 0!==s?s:e}},8106:e=>{function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},9379:e=>{"use strict";function t(e){return"[object Object]"==={}.toString.call(e)}e.exports=function(e,n,r,i){if(t(n)||"function"==typeof n||(i=r,r=n,n=e),!t(e)&&"function"!=typeof e)throw new TypeError("expected the first argument to be an object");if(!t(n)&&"function"!=typeof n)throw new TypeError("expected provider to be an object");if("string"!=typeof i&&(i=r),"string"!=typeof r)throw new TypeError("expected key to be a string");if(!(r in n))throw new Error('property "'+r+'" does not exist');var s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(e,i,s)}},5517:(e,t,n)=>{var r=n(1048).Buffer,i=n(3360),s=n(2823);e.exports=function(e){return new o(e)};var a={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function o(e){this.curveType=a[e],this.curveType||(this.curveType={name:e}),this.curve=new i.ec(this.curveType.name),this.keys=void 0}function c(e,t,n){Array.isArray(e)||(e=e.toArray());var i=new r(e);if(n&&i.length<n){var s=new r(n-i.length);s.fill(0),i=r.concat([s,i])}return t?i.toString(t):i}a.p224=a.secp224r1,a.p256=a.secp256r1=a.prime256v1,a.p192=a.secp192r1=a.prime192v1,a.p384=a.secp384r1,a.p521=a.secp521r1,o.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},o.prototype.computeSecret=function(e,t,n){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),c(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),n,this.curveType.byteLength)},o.prototype.getPublicKey=function(e,t){var n=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(n[n.length-1]%2?n[0]=7:n[0]=6),c(n,e)},o.prototype.getPrivateKey=function(e){return c(this.keys.getPrivate(),e)},o.prototype.setPublicKey=function(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this.keys._importPublic(e),this},o.prototype.setPrivateKey=function(e,t){t=t||"utf8",r.isBuffer(e)||(e=new r(e,t));var n=new s(e);return n=n.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(n),this}},3257:(e,t,n)=>{"use strict";var r=n(5615),i=n(3275),s=n(5586),a=n(3229),o=n(7589);function c(e){o.call(this,"digest"),this._hash=e}r(c,o),c.prototype._update=function(e){this._hash.update(e)},c.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return"md5"===(e=e.toLowerCase())?new i:"rmd160"===e||"ripemd160"===e?new s:new c(a(e))}},4277:(e,t,n)=>{var r=n(3275);e.exports=function(e){return(new r).update(e).digest()}},5262:(e,t,n)=>{"use strict";var r=n(5615),i=n(1719),s=n(7589),a=n(5636).Buffer,o=n(4277),c=n(5586),l=n(3229),u=a.alloc(128);function h(e,t){s.call(this,"digest"),"string"==typeof t&&(t=a.from(t));var n="sha512"===e||"sha384"===e?128:64;this._alg=e,this._key=t,t.length>n?t=("rmd160"===e?new c:l(e)).update(t).digest():t.length<n&&(t=a.concat([t,u],n));for(var r=this._ipad=a.allocUnsafe(n),i=this._opad=a.allocUnsafe(n),o=0;o<n;o++)r[o]=54^t[o],i[o]=92^t[o];this._hash="rmd160"===e?new c:l(e),this._hash.update(r)}r(h,s),h.prototype._update=function(e){this._hash.update(e)},h.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new c:l(this._alg)).update(this._opad).update(e).digest()},e.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new h("rmd160",t):"md5"===e?new i(o,t):new h(e,t)}},1719:(e,t,n)=>{"use strict";var r=n(5615),i=n(5636).Buffer,s=n(7589),a=i.alloc(128),o=64;function c(e,t){s.call(this,"digest"),"string"==typeof t&&(t=i.from(t)),this._alg=e,this._key=t,t.length>o?t=e(t):t.length<o&&(t=i.concat([t,a],o));for(var n=this._ipad=i.allocUnsafe(o),r=this._opad=i.allocUnsafe(o),c=0;c<o;c++)n[c]=54^t[c],r[c]=92^t[c];this._hash=[n]}r(c,s),c.prototype._update=function(e){this._hash.push(e)},c.prototype._final=function(){var e=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,e]))},e.exports=c},328:(e,t,n)=>{"use strict";t.po=n(2644),t.n1=n(3257),t.Gz=n(5262);var r=n(3982),i=Object.keys(r),s=(["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(i),n(8619));s.pbkdf2,s.pbkdf2Sync;var a=n(7172);a.Cipher,a.createCipher,a.Cipheriv,t.Tt=a.createCipheriv,a.Decipher,a.createDecipher,a.Decipheriv,t._7=a.createDecipheriv,a.getCiphers,a.listCiphers;var o=n(7019);o.DiffieHellmanGroup,o.createDiffieHellmanGroup,o.getDiffieHellman,o.createDiffieHellman,o.DiffieHellman;var c=n(9553);c.createSign,c.Sign,c.createVerify,c.Verify,n(5517);var l=n(4055);l.publicEncrypt,l.privateEncrypt,l.publicDecrypt,l.privateDecrypt;var u=n(9904);u.randomFill,u.randomFillSync},3464:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,n="millisecond",r="second",i="minute",s="hour",a="day",o="week",c="month",l="quarter",u="year",h="date",d="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},m=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},y={s:m,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+m(r,2,"0")+":"+m(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,c),s=n-i<0,a=t.clone().add(r+(s?-1:1),c);return+(-(r+(n-i)/(s?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:o,d:a,D:h,h:s,m:i,s:r,ms:n,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},b="en",w={};w[b]=g;var v="$isDayjsObject",S=function(e){return e instanceof k||!(!e||!e[v])},x=function e(t,n,r){var i;if(!t)return b;if("string"==typeof t){var s=t.toLowerCase();w[s]&&(i=s),n&&(w[s]=n,i=s);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var o=t.name;w[o]=t,i=o}return!r&&i&&(b=i),i||!r&&b},E=function(e,t){if(S(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new k(n)},I=y;I.l=x,I.i=S,I.w=function(e,t){return E(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var k=function(){function g(e){this.$L=x(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[v]=!0}var m=g.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(I.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var i=r[2]-1||0,s=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(t)}(e),this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return I},m.isValid=function(){return!(this.$d.toString()===d)},m.isSame=function(e,t){var n=E(e);return this.startOf(t)<=n&&n<=this.endOf(t)},m.isAfter=function(e,t){return E(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<E(e)},m.$g=function(e,t,n){return I.u(e)?this[t]:this.set(n,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var n=this,l=!!I.u(t)||t,d=I.p(e),f=function(e,t){var r=I.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return l?r:r.endOf(a)},p=function(e,t){return I.w(n.toDate()[e].apply(n.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},g=this.$W,m=this.$M,y=this.$D,b="set"+(this.$u?"UTC":"");switch(d){case u:return l?f(1,0):f(31,11);case c:return l?f(1,m):f(0,m+1);case o:var w=this.$locale().weekStart||0,v=(g<w?g+7:g)-w;return f(l?y-v:y+(6-v),m);case a:case h:return p(b+"Hours",0);case s:return p(b+"Minutes",1);case i:return p(b+"Seconds",2);case r:return p(b+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var o,l=I.p(e),d="set"+(this.$u?"UTC":""),f=(o={},o[a]=d+"Date",o[h]=d+"Date",o[c]=d+"Month",o[u]=d+"FullYear",o[s]=d+"Hours",o[i]=d+"Minutes",o[r]=d+"Seconds",o[n]=d+"Milliseconds",o)[l],p=l===a?this.$D+(t-this.$W):t;if(l===c||l===u){var g=this.clone().set(h,1);g.$d[f](p),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[I.p(e)]()},m.add=function(n,l){var h,d=this;n=Number(n);var f=I.p(l),p=function(e){var t=E(d);return I.w(t.date(t.date()+Math.round(e*n)),d)};if(f===c)return this.set(c,this.$M+n);if(f===u)return this.set(u,this.$y+n);if(f===a)return p(1);if(f===o)return p(7);var g=(h={},h[i]=e,h[s]=t,h[r]=1e3,h)[f]||1,m=this.$d.getTime()+n*g;return I.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=I.z(this),s=this.$H,a=this.$m,o=this.$M,c=n.weekdays,l=n.months,u=n.meridiem,h=function(e,n,i,s){return e&&(e[n]||e(t,r))||i[n].slice(0,s)},f=function(e){return I.s(s%12||12,e,"0")},g=u||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(p,function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return I.s(t.$y,4,"0");case"M":return o+1;case"MM":return I.s(o+1,2,"0");case"MMM":return h(n.monthsShort,o,l,3);case"MMMM":return h(l,o);case"D":return t.$D;case"DD":return I.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(n.weekdaysMin,t.$W,c,2);case"ddd":return h(n.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(s);case"HH":return I.s(s,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return g(s,a,!0);case"A":return g(s,a,!1);case"m":return String(a);case"mm":return I.s(a,2,"0");case"s":return String(t.$s);case"ss":return I.s(t.$s,2,"0");case"SSS":return I.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")})},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(n,h,d){var f,p=this,g=I.p(h),m=E(n),y=(m.utcOffset()-this.utcOffset())*e,b=this-m,w=function(){return I.m(p,m)};switch(g){case u:f=w()/12;break;case c:f=w();break;case l:f=w()/3;break;case o:f=(b-y)/6048e5;break;case a:f=(b-y)/864e5;break;case s:f=b/t;break;case i:f=b/e;break;case r:f=b/1e3;break;default:f=b}return d?f:I.a(f)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return w[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=x(e,t,!0);return r&&(n.$L=r),n},m.clone=function(){return I.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},g}(),T=k.prototype;return E.prototype=T,[["$ms",n],["$s",r],["$m",i],["$H",s],["$W",a],["$M",c],["$y",u],["$D",h]].forEach(function(e){T[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),E.extend=function(e,t){return e.$i||(e(t,k,E),e.$i=!0),E},E.locale=x,E.isDayjs=S,E.unix=function(e){return E(1e3*e)},E.en=w[b],E.Ls=w,E.p={},E}()},1630:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\d/,r=/\d\d/,i=/\d\d?/,s=/\d*[^-_:/,()\s\d]+/,a={},o=function(e){return(e=+e)+(e>68?1900:2e3)},c=function(e){return function(t){this[e]=+t}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:"+"===t[0]?-n:n}(e)}],u=function(e){var t=a[e];return t&&(t.indexOf?t:t.s.concat(t.f))},h=function(e,t){var n,r=a.meridiem;if(r){for(var i=1;i<=24;i+=1)if(e.indexOf(r(i,0,t))>-1){n=i>12;break}}else n=e===(t?"pm":"PM");return n},d={A:[s,function(e){this.afternoon=h(e,!1)}],a:[s,function(e){this.afternoon=h(e,!0)}],Q:[n,function(e){this.month=3*(e-1)+1}],S:[n,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[i,c("seconds")],ss:[i,c("seconds")],m:[i,c("minutes")],mm:[i,c("minutes")],H:[i,c("hours")],h:[i,c("hours")],HH:[i,c("hours")],hh:[i,c("hours")],D:[i,c("day")],DD:[r,c("day")],Do:[s,function(e){var t=a.ordinal,n=e.match(/\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],w:[i,c("week")],ww:[r,c("week")],M:[i,c("month")],MM:[r,c("month")],MMM:[s,function(e){var t=u("months"),n=(u("monthsShort")||t.map(function(e){return e.slice(0,3)})).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[s,function(e){var t=u("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,c("year")],YY:[r,function(e){this.year=o(e)}],YYYY:[/\d{4}/,c("year")],Z:l,ZZ:l};function f(n){var r,i;r=n,i=a&&a.formats;for(var s=(n=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(t,n,r){var s=r&&r.toUpperCase();return n||i[r]||e[r]||i[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(e,t,n){return t||n.slice(1)})})).match(t),o=s.length,c=0;c<o;c+=1){var l=s[c],u=d[l],h=u&&u[0],f=u&&u[1];s[c]=f?{regex:h,parser:f}:l.replace(/^\[|\]$/g,"")}return function(e){for(var t={},n=0,r=0;n<o;n+=1){var i=s[n];if("string"==typeof i)r+=i.length;else{var a=i.regex,c=i.parser,l=e.slice(r),u=a.exec(l)[0];c.call(t,u),e=e.replace(u,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(o=e.parseTwoDigitYear);var r=t.prototype,i=r.parse;r.parse=function(e){var t=e.date,r=e.utc,s=e.args;this.$u=r;var o=s[1];if("string"==typeof o){var c=!0===s[2],l=!0===s[3],u=c||l,h=s[2];l&&(h=s[2]),a=this.$locale(),!c&&h&&(a=n.Ls[h]),this.$d=function(e,t,n,r){try{if(["x","X"].indexOf(t)>-1)return new Date(("X"===t?1e3:1)*e);var i=f(t)(e),s=i.year,a=i.month,o=i.day,c=i.hours,l=i.minutes,u=i.seconds,h=i.milliseconds,d=i.zone,p=i.week,g=new Date,m=o||(s||a?1:g.getDate()),y=s||g.getFullYear(),b=0;s&&!a||(b=a>0?a-1:g.getMonth());var w,v=c||0,S=l||0,x=u||0,E=h||0;return d?new Date(Date.UTC(y,b,m,v,S,x,E+60*d.offset*1e3)):n?new Date(Date.UTC(y,b,m,v,S,x,E)):(w=new Date(y,b,m,v,S,x,E),p&&(w=r(w).week(p).toDate()),w)}catch(e){return new Date("")}}(t,o,r,n),this.init(),h&&!0!==h&&(this.$L=this.locale(h).$L),u&&t!=this.format(o)&&(this.$d=new Date("")),a={}}else if(o instanceof Array)for(var d=o.length,p=1;p<=d;p+=1){s[1]=o[p-1];var g=n.apply(this,s);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}p===d&&(this.$d=new Date(""))}else i.call(this,e)}}}()},7657:function(e){e.exports=function(){"use strict";var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(r,i,s){var a=i.prototype;s.utc=function(e){return new i({date:e,utc:!0,args:arguments})},a.utc=function(t){var n=s(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},a.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var o=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var c=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else c.call(this)};var l=a.utcOffset;a.utcOffset=function(r,i){var s=this.$utils().u;if(s(r))return this.$u?0:s(this.$offset)?l.call(this):this.$offset;if("string"==typeof r&&(r=function(e){void 0===e&&(e="");var r=e.match(t);if(!r)return null;var i=(""+r[0]).match(n)||["-",0,0],s=i[0],a=60*+i[1]+ +i[2];return 0===a?0:"+"===s?a:-a}(r),null===r))return this;var a=Math.abs(r)<=16?60*r:r,o=this;if(i)return o.$offset=a,o.$u=0===r,o;if(0!==r){var c=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(a+c,e)).$offset=a,o.$x.$localOffset=c}else o=this.utc();return o};var u=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var h=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():h.call(this)};var d=a.diff;a.diff=function(e,t,n){if(e&&this.$u===e.$u)return d.call(this,e,t,n);var r=this.local(),i=s(e).local();return d.call(r,i,t,n)}}}()},124:(e,t,n)=>{var r=n(9907);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(7891)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},7891:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,s,a=null;function o(...e){if(!o.enabled)return;const r=o,i=Number(new Date),s=i-(n||i);r.diff=s,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";a++;const s=t.formatters[i];if("function"==typeof s){const t=e[a];n=s.call(r,t),e.splice(a,1),a--}return n}),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return o.namespace=e,o.useColors=t.useColors(),o.color=t.selectColor(e),o.extend=r,o.destroy=t.destroy,Object.defineProperty(o,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{a=e}}),"function"==typeof t.init&&t.init(o),o}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e,t){let n=0,r=0,i=-1,s=0;for(;n<e.length;)if(r<t.length&&(t[r]===e[n]||"*"===t[r]))"*"===t[r]?(i=r,s=n,r++):(n++,r++);else{if(-1===i)return!1;r=i+1,s++,n=s}for(;r<t.length&&"*"===t[r];)r++;return r===t.length}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names,...t.skips.map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const e of n)"-"===e[0]?t.skips.push(e.slice(1)):t.names.push(e)},t.enabled=function(e){for(const n of t.skips)if(i(e,n))return!1;for(const n of t.names)if(i(e,n))return!0;return!1},t.humanize=n(7250),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},1078:(e,t,n)=>{const r=n(6464);class i{constructor(e,t,{width:n,height:r,colorDepth:i,format:s}){if(this.format=s,this.offset=t,this.depth=i,this.stride=function(e){const t=e%4;return t?e+4-t:e}(n*this.depth/8),this.size=this.stride*r,this.data=e.slice(this.offset,this.offset+this.size),this.size!==this.data.byteLength)throw new Error("Truncated bitmap data")}get(e,t,n){const r=this.format.indexOf(n);return 1===this.depth?(this.data[t*this.stride+(e/8|0)]&1<<7-e%8*1)>>7-e%8*1:2===this.depth?(this.data[t*this.stride+(e/4|0)]&3<<6-e%4*2)>>>6-e%4*2:4===this.depth?(this.data[t*this.stride+(e/2|0)]&15<<4-e%2*4)>>>4-e%2*4:this.data[t*this.stride+e*(this.depth/8)+r]}}e.exports=function(e,{width:t=0,height:n=0,icon:s=!1}={}){const a=r(e);let o,c,l,u,h;s?(o=a.getUint32(0,!0),c=a.getUint32(4,!0)/1|0,l=a.getUint32(8,!0)/2|0,u=a.getUint16(14,!0),h=a.getUint32(32,!0)):(function(e){if(19778!==e)throw new Error(`Invalid magic byte 0x${e.toString(16)}`)}(a.getUint16(0,!0)),o=14+a.getUint32(14,!0),c=a.getUint32(18,!0),l=a.getUint32(22,!0),u=a.getUint16(28,!0),h=a.getUint32(46,!0)),0===h&&u<=8&&(h=1<<u);const d=0===c?t:c,f=0===l?n:l,p=new Uint8Array(a.buffer,a.byteOffset+o,a.byteLength-o),g=h?function(e,{width:t,height:n,colorDepth:r,colorCount:s,icon:a}){if(8!==r&&4!==r&&2!==r&&1!==r)throw new Error(`A color depth of ${r} is not supported`);const o=new i(e,0,{width:s,height:1,colorDepth:32,format:"BGRA"}),c=new i(e,o.offset+o.size,{width:t,height:n,colorDepth:r,format:"C"}),l=a?new i(e,c.offset+c.size,{width:t,height:n,colorDepth:1,format:"A"}):null,u=new Uint8Array(t*n*4);let h=0;for(let e=0;e<n;e++)for(let r=0;r<t;r++){const t=c.get(r,n-e-1,"C");u[h++]=o.get(t,0,"R"),u[h++]=o.get(t,0,"G"),u[h++]=o.get(t,0,"B"),u[h++]=l&&l.get(r,n-e-1,"A")?0:255}return u}(p,{width:d,height:f,colorDepth:u,colorCount:h,icon:s}):function(e,{width:t,height:n,colorDepth:r,icon:s}){if(32!==r&&24!==r)throw new Error(`A color depth of ${r} is not supported`);const a=new i(e,0,{width:t,height:n,colorDepth:r,format:"BGRA"}),o=24===r&&s?new i(e,a.offset+a.size,{width:t,height:n,colorDepth:1,format:"A"}):null,c=new Uint8Array(t*n*4);let l=0;for(let e=0;e<n;e++)for(let i=0;i<t;i++)c[l++]=a.get(i,n-e-1,"R"),c[l++]=a.get(i,n-e-1,"G"),c[l++]=a.get(i,n-e-1,"B"),c[l++]=32===r?a.get(i,n-e-1,"A"):o&&o.get(i,n-e-1,"A")?0:255;return c}(p,{width:d,height:f,colorDepth:u,icon:s});return{width:d,height:f,data:g,colorDepth:u}}},686:(e,t,n)=>{"use strict";var r=n(4940),i=n(5731),s=n(3468),a=n(9336);e.exports=function(e,t,n){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new s("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new s("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new s("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new s("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new s("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new s("`loose`, if provided, must be a boolean");var o=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],h=!!a&&a(e,t);if(r)r(e,t,{configurable:null===l&&h?h.configurable:!l,enumerable:null===o&&h?h.enumerable:!o,value:n,writable:null===c&&h?h.writable:!c});else{if(!u&&(o||c||l))throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},5677:(e,t,n)=>{"use strict";var r=n(9537),i=n(6248),s="undefined"!=typeof Reflect&&Reflect.defineProperty?Reflect.defineProperty:Object.defineProperty;e.exports=function(e,t,n){if(!r(e)&&"function"!=typeof e&&!Array.isArray(e))throw new TypeError("expected an object, function, or array");if("string"!=typeof t)throw new TypeError('expected "key" to be a string');return i(n)?(s(e,t,n),e):(s(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n}),e)}},2431:(e,t,n)=>{"use strict";t.utils=n(6769),t.Cipher=n(9341),t.DES=n(3768),t.CBC=n(4914),t.EDE=n(3352)},4914:(e,t,n)=>{"use strict";var r=n(7784),i=n(5615),s={};function a(e){r.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}t.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}i(t,e);for(var n=Object.keys(s),r=0;r<n.length;r++){var a=n[r];t.prototype[a]=s[a]}return t.create=function(e){return new t(e)},t},s._cbcInit=function(){var e=new a(this.options.iv);this._cbcState=e},s._update=function(e,t,n,r){var i=this._cbcState,s=this.constructor.super_.prototype,a=i.iv;if("encrypt"===this.type){for(var o=0;o<this.blockSize;o++)a[o]^=e[t+o];for(s._update.call(this,a,0,n,r),o=0;o<this.blockSize;o++)a[o]=n[r+o]}else{for(s._update.call(this,e,t,n,r),o=0;o<this.blockSize;o++)n[r+o]^=a[o];for(o=0;o<this.blockSize;o++)a[o]=e[t+o]}}},9341:(e,t,n)=>{"use strict";var r=n(7784);function i(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=!1!==e.padding}e.exports=i,i.prototype._init=function(){},i.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},i.prototype._buffer=function(e,t){for(var n=Math.min(this.buffer.length-this.bufferOff,e.length-t),r=0;r<n;r++)this.buffer[this.bufferOff+r]=e[t+r];return this.bufferOff+=n,n},i.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},i.prototype._updateEncrypt=function(e){var t=0,n=0,r=(this.bufferOff+e.length)/this.blockSize|0,i=new Array(r*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(i,n)));for(var s=e.length-(e.length-t)%this.blockSize;t<s;t+=this.blockSize)this._update(e,t,i,n),n+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},i.prototype._updateDecrypt=function(e){for(var t=0,n=0,r=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,i=new Array(r*this.blockSize);r>0;r--)t+=this._buffer(e,t),n+=this._flushBuffer(i,n);return t+=this._buffer(e,t),i},i.prototype.final=function(e){var t,n;return e&&(t=this.update(e)),n="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(n):n},i.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},i.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},i.prototype._unpad=function(e){return e},i.prototype._finalDecrypt=function(){r.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},3768:(e,t,n)=>{"use strict";var r=n(7784),i=n(5615),s=n(6769),a=n(9341);function o(){this.tmp=new Array(2),this.keys=null}function c(e){a.call(this,e);var t=new o;this._desState=t,this.deriveKeys(t,e.key)}i(c,a),e.exports=c,c.create=function(e){return new c(e)};var l=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];c.prototype.deriveKeys=function(e,t){e.keys=new Array(32),r.equal(t.length,this.blockSize,"Invalid key length");var n=s.readUInt32BE(t,0),i=s.readUInt32BE(t,4);s.pc1(n,i,e.tmp,0),n=e.tmp[0],i=e.tmp[1];for(var a=0;a<e.keys.length;a+=2){var o=l[a>>>1];n=s.r28shl(n,o),i=s.r28shl(i,o),s.pc2(n,i,e.keys,a)}},c.prototype._update=function(e,t,n,r){var i=this._desState,a=s.readUInt32BE(e,t),o=s.readUInt32BE(e,t+4);s.ip(a,o,i.tmp,0),a=i.tmp[0],o=i.tmp[1],"encrypt"===this.type?this._encrypt(i,a,o,i.tmp,0):this._decrypt(i,a,o,i.tmp,0),a=i.tmp[0],o=i.tmp[1],s.writeUInt32BE(n,a,r),s.writeUInt32BE(n,o,r+4)},c.prototype._pad=function(e,t){if(!1===this.padding)return!1;for(var n=e.length-t,r=t;r<e.length;r++)e[r]=n;return!0},c.prototype._unpad=function(e){if(!1===this.padding)return e;for(var t=e[e.length-1],n=e.length-t;n<e.length;n++)r.equal(e[n],t);return e.slice(0,e.length-t)},c.prototype._encrypt=function(e,t,n,r,i){for(var a=t,o=n,c=0;c<e.keys.length;c+=2){var l=e.keys[c],u=e.keys[c+1];s.expand(o,e.tmp,0),l^=e.tmp[0],u^=e.tmp[1];var h=s.substitute(l,u),d=o;o=(a^s.permute(h))>>>0,a=d}s.rip(o,a,r,i)},c.prototype._decrypt=function(e,t,n,r,i){for(var a=n,o=t,c=e.keys.length-2;c>=0;c-=2){var l=e.keys[c],u=e.keys[c+1];s.expand(a,e.tmp,0),l^=e.tmp[0],u^=e.tmp[1];var h=s.substitute(l,u),d=a;a=(o^s.permute(h))>>>0,o=d}s.rip(a,o,r,i)}},3352:(e,t,n)=>{"use strict";var r=n(7784),i=n(5615),s=n(9341),a=n(3768);function o(e,t){r.equal(t.length,24,"Invalid key length");var n=t.slice(0,8),i=t.slice(8,16),s=t.slice(16,24);this.ciphers="encrypt"===e?[a.create({type:"encrypt",key:n}),a.create({type:"decrypt",key:i}),a.create({type:"encrypt",key:s})]:[a.create({type:"decrypt",key:s}),a.create({type:"encrypt",key:i}),a.create({type:"decrypt",key:n})]}function c(e){s.call(this,e);var t=new o(this.type,this.options.key);this._edeState=t}i(c,s),e.exports=c,c.create=function(e){return new c(e)},c.prototype._update=function(e,t,n,r){var i=this._edeState;i.ciphers[0]._update(e,t,n,r),i.ciphers[1]._update(n,r,n,r),i.ciphers[2]._update(n,r,n,r)},c.prototype._pad=a.prototype._pad,c.prototype._unpad=a.prototype._unpad},6769:(e,t)=>{"use strict";t.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},t.writeUInt32BE=function(e,t,n){e[0+n]=t>>>24,e[1+n]=t>>>16&255,e[2+n]=t>>>8&255,e[3+n]=255&t},t.ip=function(e,t,n,r){for(var i=0,s=0,a=6;a>=0;a-=2){for(var o=0;o<=24;o+=8)i<<=1,i|=t>>>o+a&1;for(o=0;o<=24;o+=8)i<<=1,i|=e>>>o+a&1}for(a=6;a>=0;a-=2){for(o=1;o<=25;o+=8)s<<=1,s|=t>>>o+a&1;for(o=1;o<=25;o+=8)s<<=1,s|=e>>>o+a&1}n[r+0]=i>>>0,n[r+1]=s>>>0},t.rip=function(e,t,n,r){for(var i=0,s=0,a=0;a<4;a++)for(var o=24;o>=0;o-=8)i<<=1,i|=t>>>o+a&1,i<<=1,i|=e>>>o+a&1;for(a=4;a<8;a++)for(o=24;o>=0;o-=8)s<<=1,s|=t>>>o+a&1,s<<=1,s|=e>>>o+a&1;n[r+0]=i>>>0,n[r+1]=s>>>0},t.pc1=function(e,t,n,r){for(var i=0,s=0,a=7;a>=5;a--){for(var o=0;o<=24;o+=8)i<<=1,i|=t>>o+a&1;for(o=0;o<=24;o+=8)i<<=1,i|=e>>o+a&1}for(o=0;o<=24;o+=8)i<<=1,i|=t>>o+a&1;for(a=1;a<=3;a++){for(o=0;o<=24;o+=8)s<<=1,s|=t>>o+a&1;for(o=0;o<=24;o+=8)s<<=1,s|=e>>o+a&1}for(o=0;o<=24;o+=8)s<<=1,s|=e>>o+a&1;n[r+0]=i>>>0,n[r+1]=s>>>0},t.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var n=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];t.pc2=function(e,t,r,i){for(var s=0,a=0,o=n.length>>>1,c=0;c<o;c++)s<<=1,s|=e>>>n[c]&1;for(c=o;c<n.length;c++)a<<=1,a|=t>>>n[c]&1;r[i+0]=s>>>0,r[i+1]=a>>>0},t.expand=function(e,t,n){var r=0,i=0;r=(1&e)<<5|e>>>27;for(var s=23;s>=15;s-=4)r<<=6,r|=e>>>s&63;for(s=11;s>=3;s-=4)i|=e>>>s&63,i<<=6;i|=(31&e)<<1|e>>>31,t[n+0]=r>>>0,t[n+1]=i>>>0};var r=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];t.substitute=function(e,t){for(var n=0,i=0;i<4;i++)n<<=4,n|=r[64*i+(e>>>18-6*i&63)];for(i=0;i<4;i++)n<<=4,n|=r[256+64*i+(t>>>18-6*i&63)];return n>>>0};var i=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];t.permute=function(e){for(var t=0,n=0;n<i.length;n++)t<<=1,t|=e>>>i[n]&1;return t>>>0},t.padSplit=function(e,t,n){for(var r=e.toString(2);r.length<t;)r="0"+r;for(var i=[],s=0;s<t;s+=n)i.push(r.slice(s,s+n));return i.join(" ")}},7019:(e,t,n)=>{var r=n(1048).Buffer,i=n(902),s=n(8632),a=n(6551),o={binary:!0,hex:!0,base64:!0};t.DiffieHellmanGroup=t.createDiffieHellmanGroup=t.getDiffieHellman=function(e){var t=new r(s[e].prime,"hex"),n=new r(s[e].gen,"hex");return new a(t,n)},t.createDiffieHellman=t.DiffieHellman=function e(t,n,s,c){return r.isBuffer(n)||void 0===o[n]?e(t,"binary",n,s):(n=n||"binary",c=c||"binary",s=s||new r([2]),r.isBuffer(s)||(s=new r(s,c)),"number"==typeof t?new a(i(t,s),s,!0):(r.isBuffer(t)||(t=new r(t,n)),new a(t,s,!0)))}},6551:(e,t,n)=>{var r=n(1048).Buffer,i=n(2823),s=new(n(1929)),a=new i(24),o=new i(11),c=new i(10),l=new i(3),u=new i(7),h=n(902),d=n(2644);function f(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this._pub=new i(e),this}function p(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this._priv=new i(e),this}e.exports=m;var g={};function m(e,t,n){this.setGenerator(t),this.__prime=new i(e),this._prime=i.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,n?(this.setPublicKey=f,this.setPrivateKey=p):this._primeCode=8}function y(e,t){var n=new r(e.toArray());return t?n.toString(t):n}Object.defineProperty(m.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var n=t.toString("hex"),r=[n,e.toString(16)].join("_");if(r in g)return g[r];var i,d=0;if(e.isEven()||!h.simpleSieve||!h.fermatTest(e)||!s.test(e))return d+=1,d+="02"===n||"05"===n?8:4,g[r]=d,d;switch(s.test(e.shrn(1))||(d+=2),n){case"02":e.mod(a).cmp(o)&&(d+=8);break;case"05":(i=e.mod(c)).cmp(l)&&i.cmp(u)&&(d+=8);break;default:d+=4}return g[r]=d,d}(this.__prime,this.__gen)),this._primeCode}}),m.prototype.generateKeys=function(){return this._priv||(this._priv=new i(d(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},m.prototype.computeSecret=function(e){var t=(e=(e=new i(e)).toRed(this._prime)).redPow(this._priv).fromRed(),n=new r(t.toArray()),s=this.getPrime();if(n.length<s.length){var a=new r(s.length-n.length);a.fill(0),n=r.concat([a,n])}return n},m.prototype.getPublicKey=function(e){return y(this._pub,e)},m.prototype.getPrivateKey=function(e){return y(this._priv,e)},m.prototype.getPrime=function(e){return y(this.__prime,e)},m.prototype.getGenerator=function(e){return y(this._gen,e)},m.prototype.setGenerator=function(e,t){return t=t||"utf8",r.isBuffer(e)||(e=new r(e,t)),this.__gen=e,this._gen=new i(e),this}},902:(e,t,n)=>{var r=n(2644);e.exports=y,y.simpleSieve=g,y.fermatTest=m;var i=n(2823),s=new i(24),a=new(n(1929)),o=new i(1),c=new i(2),l=new i(5),u=(new i(16),new i(8),new i(10)),h=new i(3),d=(new i(7),new i(11)),f=new i(4),p=(new i(12),null);function g(e){for(var t=function(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,n=3;n<1048576;n+=2){for(var r=Math.ceil(Math.sqrt(n)),i=0;i<t&&e[i]<=r&&n%e[i]!=0;i++);t!==i&&e[i]<=r||(e[t++]=n)}return p=e,e}(),n=0;n<t.length;n++)if(0===e.modn(t[n]))return 0===e.cmpn(t[n]);return!0}function m(e){var t=i.mont(e);return 0===c.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function y(e,t){if(e<16)return new i(2===t||5===t?[140,123]:[140,39]);var n,p;for(t=new i(t);;){for(n=new i(r(Math.ceil(e/8)));n.bitLength()>e;)n.ishrn(1);if(n.isEven()&&n.iadd(o),n.testn(1)||n.iadd(c),t.cmp(c)){if(!t.cmp(l))for(;n.mod(u).cmp(h);)n.iadd(f)}else for(;n.mod(s).cmp(d);)n.iadd(f);if(g(p=n.shrn(1))&&g(n)&&m(p)&&m(n)&&a.test(p)&&a.test(n))return n}}},6423:(e,t,n)=>{"use strict";var r,i=n(9903),s=n(9336);try{r=[].__proto__===Array.prototype}catch(e){if(!e||"object"!=typeof e||!("code"in e)||"ERR_PROTO_ACCESS"!==e.code)throw e}var a=!!r&&s&&s(Object.prototype,"__proto__"),o=Object,c=o.getPrototypeOf;e.exports=a&&"function"==typeof a.get?i([a.get]):"function"==typeof c&&function(e){return c(null==e?e:o(e))}},3360:(e,t,n)=>{"use strict";var r=t;r.version=n(183).rE,r.utils=n(1874),r.rand=n(7048),r.curve=n(7131),r.curves=n(6443),r.ec=n(5064),r.eddsa=n(4807)},5174:(e,t,n)=>{"use strict";var r=n(2823),i=n(1874),s=i.getNAF,a=i.getJSF,o=i.assert;function c(e,t){this.type=e,this.p=new r(t.p,16),this.red=t.prime?r.red(t.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=t.n&&new r(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var n=this.n&&this.p.div(this.n);!n||n.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function l(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){o(e.precomputed);var n=e._getDoubles(),r=s(t,1,this._bitLength),i=(1<<n.step+1)-(n.step%2==0?2:1);i/=3;var a,c,l=[];for(a=0;a<r.length;a+=n.step){c=0;for(var u=a+n.step-1;u>=a;u--)c=(c<<1)+r[u];l.push(c)}for(var h=this.jpoint(null,null,null),d=this.jpoint(null,null,null),f=i;f>0;f--){for(a=0;a<l.length;a++)(c=l[a])===f?d=d.mixedAdd(n.points[a]):c===-f&&(d=d.mixedAdd(n.points[a].neg()));h=h.add(d)}return h.toP()},c.prototype._wnafMul=function(e,t){var n=4,r=e._getNAFPoints(n);n=r.wnd;for(var i=r.points,a=s(t,n,this._bitLength),c=this.jpoint(null,null,null),l=a.length-1;l>=0;l--){for(var u=0;l>=0&&0===a[l];l--)u++;if(l>=0&&u++,c=c.dblp(u),l<0)break;var h=a[l];o(0!==h),c="affine"===e.type?h>0?c.mixedAdd(i[h-1>>1]):c.mixedAdd(i[-h-1>>1].neg()):h>0?c.add(i[h-1>>1]):c.add(i[-h-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,n,r,i){var o,c,l,u=this._wnafT1,h=this._wnafT2,d=this._wnafT3,f=0;for(o=0;o<r;o++){var p=(l=t[o])._getNAFPoints(e);u[o]=p.wnd,h[o]=p.points}for(o=r-1;o>=1;o-=2){var g=o-1,m=o;if(1===u[g]&&1===u[m]){var y=[t[g],null,null,t[m]];0===t[g].y.cmp(t[m].y)?(y[1]=t[g].add(t[m]),y[2]=t[g].toJ().mixedAdd(t[m].neg())):0===t[g].y.cmp(t[m].y.redNeg())?(y[1]=t[g].toJ().mixedAdd(t[m]),y[2]=t[g].add(t[m].neg())):(y[1]=t[g].toJ().mixedAdd(t[m]),y[2]=t[g].toJ().mixedAdd(t[m].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],w=a(n[g],n[m]);for(f=Math.max(w[0].length,f),d[g]=new Array(f),d[m]=new Array(f),c=0;c<f;c++){var v=0|w[0][c],S=0|w[1][c];d[g][c]=b[3*(v+1)+(S+1)],d[m][c]=0,h[g]=y}}else d[g]=s(n[g],u[g],this._bitLength),d[m]=s(n[m],u[m],this._bitLength),f=Math.max(d[g].length,f),f=Math.max(d[m].length,f)}var x=this.jpoint(null,null,null),E=this._wnafT4;for(o=f;o>=0;o--){for(var I=0;o>=0;){var k=!0;for(c=0;c<r;c++)E[c]=0|d[c][o],0!==E[c]&&(k=!1);if(!k)break;I++,o--}if(o>=0&&I++,x=x.dblp(I),o<0)break;for(c=0;c<r;c++){var T=E[c];0!==T&&(T>0?l=h[c][T-1>>1]:T<0&&(l=h[c][-T-1>>1].neg()),x="affine"===l.type?x.mixedAdd(l):x.add(l))}}for(o=0;o<r;o++)h[o]=null;return i?x:x.toP()},c.BasePoint=l,l.prototype.eq=function(){throw new Error("Not implemented")},l.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var n=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*n)return 6===e[0]?o(e[e.length-1]%2==0):7===e[0]&&o(e[e.length-1]%2==1),this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));if((2===e[0]||3===e[0])&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),3===e[0]);throw new Error("Unknown point format")},l.prototype.encodeCompressed=function(e){return this.encode(e,!0)},l.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))},l.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},l.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},l.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},l.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<t;i+=e){for(var s=0;s<e;s++)r=r.dbl();n.push(r)}return{step:e,points:n}},l.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)t[i]=t[i-1].add(r);return{wnd:e,points:t}},l.prototype._getBeta=function(){return null},l.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}},1547:(e,t,n)=>{"use strict";var r=n(1874),i=n(2823),s=n(5615),a=n(5174),o=r.assert;function c(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,a.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),o(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function l(e,t,n,r,s){a.BasePoint.call(this,e,"projective"),null===t&&null===n&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(n,16),this.z=r?new i(r,16):this.curve.one,this.t=s&&new i(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(c,a),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,n,r){return this.point(e,t,n,r)},c.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),r=this.c2.redSub(this.a.redMul(n)),s=this.one.redSub(this.c2.redMul(this.d).redMul(n)),a=r.redMul(s.redInvm()),o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");var c=o.fromRed().isOdd();return(t&&!c||!t&&c)&&(o=o.redNeg()),this.point(e,o)},c.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),r=n.redSub(this.c2),s=n.redMul(this.d).redMul(this.c2).redSub(this.a),a=r.redMul(s.redInvm());if(0===a.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");return o.fromRed().isOdd()!==t&&(o=o.redNeg()),this.point(o,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),r=t.redMul(this.a).redAdd(n),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return 0===r.cmp(i)},s(l,a.BasePoint),c.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},c.prototype.point=function(e,t,n,r){return new l(this,e,t,n,r)},l.fromJSON=function(e,t){return new l(e,t[0],t[1],t[2])},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},l.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),s=r.redAdd(t),a=s.redSub(n),o=r.redSub(t),c=i.redMul(a),l=s.redMul(o),u=i.redMul(o),h=a.redMul(s);return this.curve.point(c,l,h,u)},l.prototype._projDbl=function(){var e,t,n,r,i,s,a=this.x.redAdd(this.y).redSqr(),o=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var l=(r=this.curve._mulA(o)).redAdd(c);this.zOne?(e=a.redSub(o).redSub(c).redMul(l.redSub(this.curve.two)),t=l.redMul(r.redSub(c)),n=l.redSqr().redSub(l).redSub(l)):(i=this.z.redSqr(),s=l.redSub(i).redISub(i),e=a.redSub(o).redISub(c).redMul(s),t=l.redMul(r.redSub(c)),n=l.redMul(s))}else r=o.redAdd(c),i=this.curve._mulC(this.z).redSqr(),s=r.redSub(i).redSub(i),e=this.curve._mulC(a.redISub(r)).redMul(s),t=this.curve._mulC(r).redMul(o.redISub(c)),n=r.redMul(s);return this.curve.point(e,t,n)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},l.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),s=n.redSub(t),a=i.redSub(r),o=i.redAdd(r),c=n.redAdd(t),l=s.redMul(a),u=o.redMul(c),h=s.redMul(c),d=a.redMul(o);return this.curve.point(l,u,d,h)},l.prototype._projAdd=function(e){var t,n,r=this.z.redMul(e.z),i=r.redSqr(),s=this.x.redMul(e.x),a=this.y.redMul(e.y),o=this.curve.d.redMul(s).redMul(a),c=i.redSub(o),l=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(a),h=r.redMul(c).redMul(u);return this.curve.twisted?(t=r.redMul(l).redMul(a.redSub(this.curve._mulA(s))),n=c.redMul(l)):(t=r.redMul(l).redMul(a.redSub(s)),n=this.curve._mulC(c).redMul(l)),this.curve.point(h,t,n)},l.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},l.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!1)},l.prototype.jmulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!0)},l.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},l.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()},l.prototype.getY=function(){return this.normalize(),this.y.fromRed()},l.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},l.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var n=e.clone(),r=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(r),0===this.x.cmp(t))return!0}},l.prototype.toP=l.prototype.normalize,l.prototype.mixedAdd=l.prototype.add},7131:(e,t,n)=>{"use strict";var r=t;r.base=n(5174),r.short=n(277),r.mont=n(3245),r.edwards=n(1547)},3245:(e,t,n)=>{"use strict";var r=n(2823),i=n(5615),s=n(5174),a=n(1874);function o(e){s.call(this,"mont",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.i4=new r(4).toRed(this.red).redInvm(),this.two=new r(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,n){s.BasePoint.call(this,e,"projective"),null===t&&null===n?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new r(t,16),this.z=new r(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(o,s),e.exports=o,o.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),r=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t);return 0===r.redSqrt().redSqr().cmp(r)},i(c,s.BasePoint),o.prototype.decodePoint=function(e,t){return this.point(a.toArray(e,t),1)},o.prototype.point=function(e,t){return new c(this,e,t)},o.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),n=e.redSub(t),r=e.redMul(t),i=n.redMul(t.redAdd(this.curve.a24.redMul(n)));return this.curve.point(r,i)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),r=this.x.redSub(this.z),i=e.x.redAdd(e.z),s=e.x.redSub(e.z).redMul(n),a=i.redMul(r),o=t.z.redMul(s.redAdd(a).redSqr()),c=t.x.redMul(s.redISub(a).redSqr());return this.curve.point(o,c)},c.prototype.mul=function(e){for(var t=e.clone(),n=this,r=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var s=i.length-1;s>=0;s--)0===i[s]?(n=n.diffAdd(r,this),r=r.dbl()):(r=n.diffAdd(r,this),n=n.dbl());return r},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},277:(e,t,n)=>{"use strict";var r=n(1874),i=n(2823),s=n(5615),a=n(5174),o=r.assert;function c(e){a.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function l(e,t,n,r){a.BasePoint.call(this,e,"affine"),null===t&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(n,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function u(e,t,n,r){a.BasePoint.call(this,e,"jacobian"),null===t&&null===n&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(n,16),this.z=new i(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(c,a),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,n;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var r=this._getEndoRoots(this.p);t=(t=r[0].cmp(r[1])<0?r[0]:r[1]).toRed(this.red)}if(e.lambda)n=new i(e.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))?n=s[0]:(n=s[1],o(0===this.g.mul(n).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:n,basis:e.basis?e.basis.map(function(e){return{a:new i(e.a,16),b:new i(e.b,16)}}):this._getEndoBasis(n)}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),n=new i(2).toRed(t).redInvm(),r=n.redNeg(),s=new i(3).toRed(t).redNeg().redSqrt().redMul(n);return[r.redAdd(s).fromRed(),r.redSub(s).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,n,r,s,a,o,c,l,u,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=e,f=this.n.clone(),p=new i(1),g=new i(0),m=new i(0),y=new i(1),b=0;0!==d.cmpn(0);){var w=f.div(d);l=f.sub(w.mul(d)),u=m.sub(w.mul(p));var v=y.sub(w.mul(g));if(!r&&l.cmp(h)<0)t=c.neg(),n=p,r=l.neg(),s=u;else if(r&&2==++b)break;c=l,f=d,d=l,m=p,p=u,y=g,g=v}a=l.neg(),o=u;var S=r.sqr().add(s.sqr());return a.sqr().add(o.sqr()).cmp(S)>=0&&(a=t,o=n),r.negative&&(r=r.neg(),s=s.neg()),a.negative&&(a=a.neg(),o=o.neg()),[{a:r,b:s},{a,b:o}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],r=t[1],i=r.b.mul(e).divRound(this.n),s=n.b.neg().mul(e).divRound(this.n),a=i.mul(n.a),o=s.mul(r.a),c=i.mul(n.b),l=s.mul(r.b);return{k1:e.sub(a).sub(o),k2:c.add(l).neg()}},c.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),r=n.redSqrt();if(0!==r.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var s=r.fromRed().isOdd();return(t&&!s||!t&&s)&&(r=r.redNeg()),this.point(e,r)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,r=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,n){for(var r=this._endoWnafT1,i=this._endoWnafT2,s=0;s<e.length;s++){var a=this._endoSplit(t[s]),o=e[s],c=o._getBeta();a.k1.negative&&(a.k1.ineg(),o=o.neg(!0)),a.k2.negative&&(a.k2.ineg(),c=c.neg(!0)),r[2*s]=o,r[2*s+1]=c,i[2*s]=a.k1,i[2*s+1]=a.k2}for(var l=this._wnafMulAdd(1,r,i,2*s,n),u=0;u<2*s;u++)r[u]=null,i[u]=null;return l},s(l,a.BasePoint),c.prototype.point=function(e,t,n){return new l(this,e,t,n)},c.prototype.pointFromJSON=function(e,t){return l.fromJSON(this,e,t)},l.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,r=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},l.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},l.fromJSON=function(e,t,n){"string"==typeof t&&(t=JSON.parse(t));var r=e.point(t[0],t[1],n);if(!t[2])return r;function i(t){return e.point(t[0],t[1],n)}var s=t[2];return r.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[r].concat(s.doubles.points.map(i))},naf:s.naf&&{wnd:s.naf.wnd,points:[r].concat(s.naf.points.map(i))}},r},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return this.inf},l.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},l.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),r=e.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(r),s=i.redSqr().redISub(this.x.redAdd(this.x)),a=i.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,a)},l.prototype.getX=function(){return this.x.fromRed()},l.prototype.getY=function(){return this.y.fromRed()},l.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},l.prototype.jmulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i,!0):this.curve._wnafMulAdd(1,r,i,2,!0)},l.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},l.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return t},l.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(u,a.BasePoint),c.prototype.jpoint=function(e,t,n){return new u(this,e,t,n)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(n,r)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(t),i=e.x.redMul(n),s=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(n.redMul(this.z)),o=r.redSub(i),c=s.redSub(a);if(0===o.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=o.redSqr(),u=l.redMul(o),h=r.redMul(l),d=c.redSqr().redIAdd(u).redISub(h).redISub(h),f=c.redMul(h.redISub(d)).redISub(s.redMul(u)),p=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(d,f,p)},u.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,r=e.x.redMul(t),i=this.y,s=e.y.redMul(t).redMul(this.z),a=n.redSub(r),o=i.redSub(s);if(0===a.cmpn(0))return 0!==o.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),l=c.redMul(a),u=n.redMul(c),h=o.redSqr().redIAdd(l).redISub(u).redISub(u),d=o.redMul(u.redISub(h)).redISub(i.redMul(l)),f=this.z.redMul(a);return this.curve.jpoint(h,d,f)},u.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var r=this.curve.a,i=this.curve.tinv,s=this.x,a=this.y,o=this.z,c=o.redSqr().redSqr(),l=a.redAdd(a);for(t=0;t<e;t++){var u=s.redSqr(),h=l.redSqr(),d=h.redSqr(),f=u.redAdd(u).redIAdd(u).redIAdd(r.redMul(c)),p=s.redMul(h),g=f.redSqr().redISub(p.redAdd(p)),m=p.redISub(g),y=f.redMul(m);y=y.redIAdd(y).redISub(d);var b=l.redMul(o);t+1<e&&(c=c.redMul(d)),s=g,o=b,l=y}return this.curve.jpoint(s,l.redMul(i),o)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(r).redISub(s);a=a.redIAdd(a);var o=r.redAdd(r).redIAdd(r),c=o.redSqr().redISub(a).redISub(a),l=s.redIAdd(s);l=(l=l.redIAdd(l)).redIAdd(l),e=c,t=o.redMul(a.redISub(c)).redISub(l),n=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),h=this.y.redSqr(),d=h.redSqr(),f=this.x.redAdd(h).redSqr().redISub(u).redISub(d);f=f.redIAdd(f);var p=u.redAdd(u).redIAdd(u),g=p.redSqr(),m=d.redIAdd(d);m=(m=m.redIAdd(m)).redIAdd(m),e=g.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(m),n=(n=this.y.redMul(this.z)).redIAdd(n)}return this.curve.jpoint(e,t,n)},u.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(r).redISub(s);a=a.redIAdd(a);var o=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),c=o.redSqr().redISub(a).redISub(a);e=c;var l=s.redIAdd(s);l=(l=l.redIAdd(l)).redIAdd(l),t=o.redMul(a.redISub(c)).redISub(l),n=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),h=this.y.redSqr(),d=this.x.redMul(h),f=this.x.redSub(u).redMul(this.x.redAdd(u));f=f.redAdd(f).redIAdd(f);var p=d.redIAdd(d),g=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(g),n=this.y.redAdd(this.z).redSqr().redISub(h).redISub(u);var m=h.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),t=f.redMul(p.redISub(e)).redISub(m)}return this.curve.jpoint(e,t,n)},u.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),s=t.redSqr(),a=n.redSqr(),o=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(i)),c=t.redAdd(t),l=(c=c.redIAdd(c)).redMul(a),u=o.redSqr().redISub(l.redAdd(l)),h=l.redISub(u),d=a.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=o.redMul(h).redISub(d),p=n.redAdd(n).redMul(r);return this.curve.jpoint(u,f,p)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),r=t.redSqr(),i=e.redAdd(e).redIAdd(e),s=i.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(r),o=(a=(a=(a=a.redIAdd(a)).redAdd(a).redIAdd(a)).redISub(s)).redSqr(),c=r.redIAdd(r);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var l=i.redIAdd(a).redSqr().redISub(s).redISub(o).redISub(c),u=t.redMul(l);u=(u=u.redIAdd(u)).redIAdd(u);var h=this.x.redMul(o).redISub(u);h=(h=h.redIAdd(h)).redIAdd(h);var d=this.y.redMul(l.redMul(c.redISub(l)).redISub(a.redMul(o)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var f=this.z.redAdd(a).redSqr().redISub(n).redISub(o);return this.curve.jpoint(h,d,f)},u.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},u.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(0!==this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),i=n.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(r)).cmpn(0)},u.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(n))return!0;for(var r=e.clone(),i=this.curve.redN.redMul(t);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(i),0===this.x.cmp(n))return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},6443:(e,t,n)=>{"use strict";var r,i=t,s=n(9499),a=n(7131),o=n(1874).assert;function c(e){"short"===e.type?this.curve=new a.short(e):"edwards"===e.type?this.curve=new a.edwards(e):this.curve=new a.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function l(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var n=new c(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:n}),n}})}i.PresetCurve=c,l("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),l("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),l("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),l("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),l("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),l("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),l("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=n(3986)}catch(e){r=void 0}l("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})},5064:(e,t,n)=>{"use strict";var r=n(2823),i=n(4742),s=n(1874),a=n(6443),o=n(7048),c=s.assert,l=n(7531),u=n(7782);function h(e){if(!(this instanceof h))return new h(e);"string"==typeof e&&(c(Object.prototype.hasOwnProperty.call(a,e),"Unknown curve "+e),e=a[e]),e instanceof a.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=h,h.prototype.keyPair=function(e){return new l(this,e)},h.prototype.keyFromPrivate=function(e,t){return l.fromPrivate(this,e,t)},h.prototype.keyFromPublic=function(e,t){return l.fromPublic(this,e,t)},h.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||o(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),s=this.n.sub(new r(2));;){var a=new r(t.generate(n));if(!(a.cmp(s)>0))return a.iaddn(1),this.keyFromPrivate(a)}},h.prototype._truncateToN=function(e,t,n){var i;if(r.isBN(e)||"number"==typeof e)i=(e=new r(e,16)).byteLength();else if("object"==typeof e)i=e.length,e=new r(e,16);else{var s=e.toString();i=s.length+1>>>1,e=new r(s,16)}"number"!=typeof n&&(n=8*i);var a=n-this.n.bitLength();return a>0&&(e=e.ushrn(a)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},h.prototype.sign=function(e,t,n,s){if("object"==typeof n&&(s=n,n=null),s||(s={}),"string"!=typeof e&&"number"!=typeof e&&!r.isBN(e)){c("object"==typeof e&&e&&"number"==typeof e.length,"Expected message to be an array-like, a hex string, or a BN instance"),c(e.length>>>0===e.length);for(var a=0;a<e.length;a++)c((255&e[a])===e[a])}t=this.keyFromPrivate(t,n),e=this._truncateToN(e,!1,s.msgBitLength),c(!e.isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),l=t.getPrivate().toArray("be",o),h=e.toArray("be",o);c(new r(h).eq(e),"Can not sign message");for(var d=new i({hash:this.hash,entropy:l,nonce:h,pers:s.pers,persEnc:s.persEnc||"utf8"}),f=this.n.sub(new r(1)),p=0;;p++){var g=s.k?s.k(p):new r(d.generate(this.n.byteLength()));if(!((g=this._truncateToN(g,!0)).cmpn(1)<=0||g.cmp(f)>=0)){var m=this.g.mul(g);if(!m.isInfinity()){var y=m.getX(),b=y.umod(this.n);if(0!==b.cmpn(0)){var w=g.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(0!==(w=w.umod(this.n)).cmpn(0)){var v=(m.getY().isOdd()?1:0)|(0!==y.cmp(b)?2:0);return s.canonical&&w.cmp(this.nh)>0&&(w=this.n.sub(w),v^=1),new u({r:b,s:w,recoveryParam:v})}}}}}},h.prototype.verify=function(e,t,n,r,i){i||(i={}),e=this._truncateToN(e,!1,i.msgBitLength),n=this.keyFromPublic(n,r);var s=(t=new u(t,"hex")).r,a=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var o,c=a.invm(this.n),l=c.mul(e).umod(this.n),h=c.mul(s).umod(this.n);return this.curve._maxwellTrick?!(o=this.g.jmulAdd(l,n.getPublic(),h)).isInfinity()&&o.eqXToP(s):!(o=this.g.mulAdd(l,n.getPublic(),h)).isInfinity()&&0===o.getX().umod(this.n).cmp(s)},h.prototype.recoverPubKey=function(e,t,n,i){c((3&n)===n,"The recovery param is more than two bits"),t=new u(t,i);var s=this.n,a=new r(e),o=t.r,l=t.s,h=1&n,d=n>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw new Error("Unable to find sencond key candinate");o=d?this.curve.pointFromX(o.add(this.curve.n),h):this.curve.pointFromX(o,h);var f=t.r.invm(s),p=s.sub(a).mul(f).umod(s),g=l.mul(f).umod(s);return this.g.mulAdd(p,o,g)},h.prototype.getKeyRecoveryParam=function(e,t,n,r){if(null!==(t=new u(t,r)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch(e){continue}if(s.eq(n))return i}throw new Error("Unable to find valid recovery factor")}},7531:(e,t,n)=>{"use strict";var r=n(2823),i=n(1874).assert;function s(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=s,s.fromPublic=function(e,t,n){return t instanceof s?t:new s(e,{pub:t,pubEnc:n})},s.fromPrivate=function(e,t,n){return t instanceof s?t:new s(e,{priv:t,privEnc:n})},s.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},s.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(e,t){this.priv=new r(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},s.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},s.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)},s.prototype.verify=function(e,t,n){return this.ec.verify(e,t,this,void 0,n)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},7782:(e,t,n)=>{"use strict";var r=n(2823),i=n(1874),s=i.assert;function a(e,t){if(e instanceof a)return e;this._importDER(e,t)||(s(e.r&&e.s,"Signature without r or s"),this.r=new r(e.r,16),this.s=new r(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function o(){this.place=0}function c(e,t){var n=e[t.place++];if(!(128&n))return n;var r=15&n;if(0===r||r>4)return!1;if(0===e[t.place])return!1;for(var i=0,s=0,a=t.place;s<r;s++,a++)i<<=8,i|=e[a],i>>>=0;return!(i<=127)&&(t.place=a,i)}function l(e){for(var t=0,n=e.length-1;!e[t]&&!(128&e[t+1])&&t<n;)t++;return 0===t?e:e.slice(t)}function u(e,t){if(t<128)e.push(t);else{var n=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|n);--n;)e.push(t>>>(n<<3)&255);e.push(t)}}e.exports=a,a.prototype._importDER=function(e,t){e=i.toArray(e,t);var n=new o;if(48!==e[n.place++])return!1;var s=c(e,n);if(!1===s)return!1;if(s+n.place!==e.length)return!1;if(2!==e[n.place++])return!1;var a=c(e,n);if(!1===a)return!1;if(128&e[n.place])return!1;var l=e.slice(n.place,a+n.place);if(n.place+=a,2!==e[n.place++])return!1;var u=c(e,n);if(!1===u)return!1;if(e.length!==u+n.place)return!1;if(128&e[n.place])return!1;var h=e.slice(n.place,u+n.place);if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}if(0===h[0]){if(!(128&h[1]))return!1;h=h.slice(1)}return this.r=new r(l),this.s=new r(h),this.recoveryParam=null,!0},a.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&n[0]&&(n=[0].concat(n)),t=l(t),n=l(n);!(n[0]||128&n[1]);)n=n.slice(1);var r=[2];u(r,t.length),(r=r.concat(t)).push(2),u(r,n.length);var s=r.concat(n),a=[48];return u(a,s.length),a=a.concat(s),i.encode(a,e)}},4807:(e,t,n)=>{"use strict";var r=n(9499),i=n(6443),s=n(1874),a=s.assert,o=s.parseBytes,c=n(4672),l=n(8401);function u(e){if(a("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof u))return new u(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=r.sha512}e.exports=u,u.prototype.sign=function(e,t){e=o(e);var n=this.keyFromSecret(t),r=this.hashInt(n.messagePrefix(),e),i=this.g.mul(r),s=this.encodePoint(i),a=this.hashInt(s,n.pubBytes(),e).mul(n.priv()),c=r.add(a).umod(this.curve.n);return this.makeSignature({R:i,S:c,Rencoded:s})},u.prototype.verify=function(e,t,n){if(e=o(e),(t=this.makeSignature(t)).S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var r=this.keyFromPublic(n),i=this.hashInt(t.Rencoded(),r.pubBytes(),e),s=this.g.mul(t.S());return t.R().add(r.pub().mul(i)).eq(s)},u.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},u.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},u.prototype.makeSignature=function(e){return e instanceof l?e:new l(this,e)},u.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},u.prototype.decodePoint=function(e){var t=(e=s.parseBytes(e)).length-1,n=e.slice(0,t).concat(-129&e[t]),r=!!(128&e[t]),i=s.intFromLE(n);return this.curve.pointFromY(i,r)},u.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(e){return s.intFromLE(e)},u.prototype.isPoint=function(e){return e instanceof this.pointClass}},4672:(e,t,n)=>{"use strict";var r=n(1874),i=r.assert,s=r.parseBytes,a=r.cachedProperty;function o(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}o.fromPublic=function(e,t){return t instanceof o?t:new o(e,{pub:t})},o.fromSecret=function(e,t){return t instanceof o?t:new o(e,{secret:t})},o.prototype.secret=function(){return this._secret},a(o,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),a(o,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),a(o,"privBytes",function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[n]&=127,r[n]|=64,r}),a(o,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),a(o,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),a(o,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),o.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},o.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},o.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),r.encode(this.secret(),e)},o.prototype.getPublic=function(e){return r.encode(this.pubBytes(),e)},e.exports=o},8401:(e,t,n)=>{"use strict";var r=n(2823),i=n(1874),s=i.assert,a=i.cachedProperty,o=i.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=o(t)),Array.isArray(t)&&(s(t.length===2*e.encodingLength,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof r&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}a(c,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),a(c,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),a(c,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),a(c,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},3986:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},1874:(e,t,n)=>{"use strict";var r=t,i=n(2823),s=n(7784),a=n(9042);r.assert=s,r.toArray=a.toArray,r.zero2=a.zero2,r.toHex=a.toHex,r.encode=a.encode,r.getNAF=function(e,t,n){var r,i=new Array(Math.max(e.bitLength(),n)+1);for(r=0;r<i.length;r+=1)i[r]=0;var s=1<<t+1,a=e.clone();for(r=0;r<i.length;r++){var o,c=a.andln(s-1);a.isOdd()?(o=c>(s>>1)-1?(s>>1)-c:c,a.isubn(o)):o=0,i[r]=o,a.iushrn(1)}return i},r.getJSF=function(e,t){var n=[[],[]];e=e.clone(),t=t.clone();for(var r,i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var a,o,c=e.andln(3)+i&3,l=t.andln(3)+s&3;3===c&&(c=-1),3===l&&(l=-1),a=1&c?3!=(r=e.andln(7)+i&7)&&5!==r||2!==l?c:-c:0,n[0].push(a),o=1&l?3!=(r=t.andln(7)+s&7)&&5!==r||2!==c?l:-l:0,n[1].push(o),2*i===a+1&&(i=1-i),2*s===o+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return n},r.cachedProperty=function(e,t,n){var r="_"+t;e.prototype[t]=function(){return void 0!==this[r]?this[r]:this[r]=n.call(this)}},r.parseBytes=function(e){return"string"==typeof e?r.toArray(e,"hex"):e},r.intFromLE=function(e){return new i(e,"hex","le")}},4940:e=>{"use strict";var t=Object.defineProperty||!1;if(t)try{t({},"a",{value:1})}catch(e){t=!1}e.exports=t},9110:e=>{"use strict";e.exports=EvalError},9838:e=>{"use strict";e.exports=Error},1155:e=>{"use strict";e.exports=RangeError},4943:e=>{"use strict";e.exports=ReferenceError},5731:e=>{"use strict";e.exports=SyntaxError},3468:e=>{"use strict";e.exports=TypeError},2140:e=>{"use strict";e.exports=URIError},9629:e=>{"use strict";e.exports=Object},8985:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,r,s,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new i(r,s||e,a),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},o.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,a=new Array(s);i<s;i++)a[i]=r[i].fn;return a},o.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,i,s,a){var o=n?n+e:e;if(!this._events[o])return!1;var c,l,u=this._events[o],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,i),!0;case 5:return u.fn.call(u.context,t,r,i,s),!0;case 6:return u.fn.call(u.context,t,r,i,s,a),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,f=u.length;for(l=0;l<f;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},o.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,r,i){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return a(this,s),this;var o=this._events[s];if(o.fn)o.fn!==t||i&&!o.once||r&&o.context!==r||a(this,s);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||i&&!o[c].once||r&&o[c].context!==r)&&l.push(o[c]);l.length?this._events[s]=1===l.length?l[0]:l:a(this,s)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o},46:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,s),r(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}g(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,s,a,l;if(o(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,l=u,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=u.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=p(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return o(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,s,a;if(o(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return d(this,e,!0)},s.prototype.rawListeners=function(e){return d(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},8981:(e,t,n)=>{var r=n(5636).Buffer,i=n(3275);e.exports=function(e,t,n,s){if(r.isBuffer(e)||(e=r.from(e,"binary")),t&&(r.isBuffer(t)||(t=r.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=n/8,o=r.alloc(a),c=r.alloc(s||0),l=r.alloc(0);a>0||s>0;){var u=new i;u.update(l),u.update(e),t&&u.update(t),l=u.digest();var h=0;if(a>0){var d=o.length-a;h=Math.min(a,l.length),l.copy(o,d,0,h),a-=h}if(h<l.length&&s>0){var f=c.length-s,p=Math.min(s,l.length-h);l.copy(c,f,h,h+p),s-=p}}return l.fill(0),{key:o,iv:c}}},3760:(e,t,n)=>{var r=n(5225);e.exports={create:function(e,t){if(e instanceof(t=t||(0,eval)("this")).ArrayBuffer){var i=n(5927);return new r(new i(e,0,e.byteLength,!0,t))}var s=n(2340);return new r(new s(e,0,e.length,!0))}}},2340:e=>{function t(e,t,n,r){this.buffer=e,this.offset=t||0,n="number"==typeof n?n:e.length,this.endPosition=this.offset+n,this.setBigEndian(r)}t.prototype={setBigEndian:function(e){this.bigEndian=!!e},nextUInt8:function(){var e=this.buffer.readUInt8(this.offset);return this.offset+=1,e},nextInt8:function(){var e=this.buffer.readInt8(this.offset);return this.offset+=1,e},nextUInt16:function(){var e=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,e},nextUInt32:function(){var e=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,e},nextInt16:function(){var e=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,e},nextInt32:function(){var e=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,e},nextFloat:function(){var e=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,e},nextDouble:function(){var e=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,e},nextBuffer:function(e){var t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},remainingLength:function(){return this.endPosition-this.offset},nextString:function(e){var t=this.buffer.toString("utf8",this.offset,this.offset+e);return this.offset+=e,t},mark:function(){var e=this;return{openWithOffset:function(n){return n=(n||0)+this.offset,new t(e.buffer,n,e.endPosition-n,e.bigEndian)},offset:this.offset}},offsetFrom:function(e){return this.offset-e.offset},skip:function(e){this.offset+=e},branch:function(e,n){return n="number"==typeof n?n:this.endPosition-(this.offset+e),new t(this.buffer,this.offset+e,n,this.bigEndian)}},e.exports=t},8814:e=>{function t(e){return parseInt(e,10)}function n(e,n){e=e.map(t),n=n.map(t);var r=e[0],i=e[1]-1,s=e[2],a=n[0],o=n[1],c=n[2];return Date.UTC(r,i,s,a,o,c,0)/1e3}function r(e){var r=e.substr(0,10).split("-"),i=e.substr(11,8).split(":"),s=e.substr(19,6).split(":").map(t),a=3600*s[0]+60*s[1],o=n(r,i);if("number"==typeof(o-=a)&&!isNaN(o))return o}function i(e){var t=e.split(" "),r=n(t[0].split(":"),t[1].split(":"));if("number"==typeof r&&!isNaN(r))return r}e.exports={parseDateWithSpecFormat:i,parseDateWithTimezoneFormat:r,parseExifDate:function(e){var t=19===e.length&&":"===e.charAt(4);return 25===e.length&&"T"===e.charAt(10)?r(e):t?i(e):void 0}}},5927:e=>{function t(e,t,n,r,i,s){this.global=i,t=t||0,n=n||e.byteLength-t,this.arrayBuffer=e.slice(t,t+n),this.view=new i.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(r),this.offset=0,this.parentOffset=(s||0)+t}t.prototype={setBigEndian:function(e){this.littleEndian=!e},nextUInt8:function(){var e=this.view.getUint8(this.offset);return this.offset+=1,e},nextInt8:function(){var e=this.view.getInt8(this.offset);return this.offset+=1,e},nextUInt16:function(){var e=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,e},nextUInt32:function(){var e=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},nextInt16:function(){var e=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},nextInt32:function(){var e=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},nextFloat:function(){var e=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},nextDouble:function(){var e=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},nextBuffer:function(e){var t=this.arrayBuffer.slice(this.offset,this.offset+e);return this.offset+=e,t},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(e){var t=this.arrayBuffer.slice(this.offset,this.offset+e);return t=String.fromCharCode.apply(null,new this.global.Uint8Array(t)),this.offset+=e,t},mark:function(){var e=this;return{openWithOffset:function(n){return n=(n||0)+this.offset,new t(e.arrayBuffer,n,e.arrayBuffer.byteLength-n,!e.littleEndian,e.global,e.parentOffset)},offset:this.offset,getParentOffset:function(){return e.parentOffset}}},offsetFrom:function(e){return this.parentOffset+this.offset-(e.offset+e.getParentOffset())},skip:function(e){this.offset+=e},branch:function(e,n){return n="number"==typeof n?n:this.arrayBuffer.byteLength-(this.offset+e),new t(this.arrayBuffer,this.offset+e,n,!this.littleEndian,this.global,this.parentOffset)}},e.exports=t},1672:e=>{e.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}},7032:e=>{function t(e,t){switch(e){case 1:return t.nextUInt8();case 3:case 8:return t.nextUInt16();case 4:case 9:return t.nextUInt32();case 5:return[t.nextUInt32(),t.nextUInt32()];case 6:return t.nextInt8();case 10:return[t.nextInt32(),t.nextInt32()];case 11:return t.nextFloat();case 12:return t.nextDouble();default:throw new Error("Invalid format while decoding: "+e)}}function n(e,n){var r,i,s=n.nextUInt16(),a=n.nextUInt16(),o=function(e){switch(e){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}(a),c=n.nextUInt32(),l=o*c;if(l>4&&(n=e.openWithOffset(n.nextUInt32())),2===a){var u=(r=n.nextString(c)).indexOf("\0");-1!==u&&(r=r.substr(0,u))}else if(7===a)r=n.nextBuffer(c);else if(0!==a)for(r=[],i=0;i<c;++i)r.push(t(a,n));return l<4&&n.skip(4-l),[s,r,a]}function r(e,t,r){var i,s,a=t.nextUInt16();for(s=0;s<a;++s)r((i=n(e,t))[0],i[1],i[2])}e.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(e,t){var n,i,s,a;try{n=function(e){if("Exif\0\0"!==e.nextString(6))throw new Error("Invalid EXIF header");var t=e.mark(),n=e.nextUInt16();if(18761===n)e.setBigEndian(!1);else{if(19789!==n)throw new Error("Invalid TIFF header");e.setBigEndian(!0)}if(42!==e.nextUInt16())throw new Error("Invalid TIFF data");return t}(e)}catch(e){return!1}var o=n.openWithOffset(e.nextUInt32()),c=this.IFD0;r(n,o,function(e,n,r){switch(e){case 34853:s=n[0];break;case 34665:i=n[0];break;default:t(c,e,n,r)}});var l=o.nextUInt32();if(0!==l){var u=n.openWithOffset(l);r(n,u,t.bind(null,this.IFD1))}if(s){var h=n.openWithOffset(s);r(n,h,t.bind(null,this.GPSIFD))}if(i){var d=n.openWithOffset(i),f=this.InteropIFD;r(n,d,function(e,n,r){40965===e?a=n[0]:t(f,e,n,r)})}if(a){var p=n.openWithOffset(a);r(n,p,t.bind(null,this.InteropIFD))}return!0}}},2020:e=>{e.exports={parseSections:function(e,t){var n,r;for(e.setBigEndian(!0);e.remainingLength()>0&&218!==r;){if(255!==e.nextUInt8())throw new Error("Invalid JPEG section offset");n=(r=e.nextUInt8())>=208&&r<=217||218===r?0:e.nextUInt16()-2,t(r,e.branch(0,n)),e.skip(n)}},getSizeFromSOFSection:function(e){return e.skip(1),{height:e.nextUInt16(),width:e.nextUInt16()}},getSectionName:function(e){var t,n;switch(e){case 216:t="SOI";break;case 196:t="DHT";break;case 219:t="DQT";break;case 221:t="DRI";break;case 218:t="SOS";break;case 254:t="COM";break;case 217:t="EOI";break;default:e>=224&&e<=239?(t="APP",n=e-224):e>=192&&e<=207&&196!==e&&200!==e&&204!==e?(t="SOF",n=e-192):e>=208&&e<=215&&(t="RST",n=e-208)}var r={name:t};return"number"==typeof n&&(r.index=n),r}}},5225:(e,t,n)=>{var r=n(2020),i=n(7032),s=n(3705);function a(e,t,n,r,i,s,a){this.startMarker=e,this.tags=t,this.imageSize=n,this.thumbnailOffset=r,this.thumbnailLength=i,this.thumbnailType=s,this.app1Offset=a}function o(e){this.stream=e,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}a.prototype={hasThumbnail:function(e){return!(!this.thumbnailOffset||!this.thumbnailLength||"string"==typeof e&&("image/jpeg"===e.toLowerCase().trim()?6!==this.thumbnailType:"image/tiff"!==e.toLowerCase().trim()||1!==this.thumbnailType))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var e,t=this._getThumbnailStream();return r.parseSections(t,function(t,n){"SOF"===r.getSectionName(t).name&&(e=r.getSizeFromSOFSection(n))}),e}},o.prototype={enableBinaryFields:function(e){return this.flags.readBinaryTags=!!e,this},enablePointers:function(e){return this.flags.hidePointers=!e,this},enableTagNames:function(e){return this.flags.resolveTagNames=!!e,this},enableImageSize:function(e){return this.flags.imageSize=!!e,this},enableReturnTags:function(e){return this.flags.returnTags=!!e,this},enableSimpleValues:function(e){return this.flags.simplifyValues=!!e,this},parse:function(){var e,t,o,c,l,u,h,d,f,p=this.stream.mark(),g=p.openWithOffset(0),m=this.flags;return m.resolveTagNames&&(h=n(1672)),m.resolveTagNames?(e={},d=function(t){return e[t.name]},f=function(t,n){e[t.name]=n}):(e=[],d=function(t){var n;for(n=0;n<e.length;++n)if(e[n].type===t.type&&e[n].section===t.section)return e.value},f=function(t,n){var r;for(r=0;r<e.length;++r)if(e[r].type===t.type&&e[r].section===t.section)return void(e.value=n)}),r.parseSections(g,function(n,a){var d=a.offsetFrom(p);225===n?i.parseTags(a,function(t,n,r,a){if(m.readBinaryTags||7!==a){if(513===n){if(o=r[0],m.hidePointers)return}else if(514===n){if(c=r[0],m.hidePointers)return}else if(259===n&&(l=r[0],m.hidePointers))return;if(m.returnTags)if(m.simplifyValues&&(r=s.simplifyValue(r,a)),m.resolveTagNames){var u=(t===i.GPSIFD?h.gps:h.exif)[n];u||(u=h.exif[n]),e.hasOwnProperty(u)||(e[u]=r)}else e.push({section:t,type:n,value:r})}})&&(u=d):m.imageSize&&"SOF"===r.getSectionName(n).name&&(t=r.getSizeFromSOFSection(a))}),m.simplifyValues&&(s.castDegreeValues(d,f),s.castDateValues(d,f)),new a(p,e,t,o,c,l,u)}},e.exports=o},3705:(e,t,n)=>{var r=n(7032),i=n(8814),s=[{section:r.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:r.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],a=[{section:r.SubIFD,type:306,name:"ModifyDate"},{section:r.SubIFD,type:36867,name:"DateTimeOriginal"},{section:r.SubIFD,type:36868,name:"CreateDate"},{section:r.SubIFD,type:306,name:"ModifyDate"}];e.exports={castDegreeValues:function(e,t){s.forEach(function(n){var r=e(n);if(r){var i=e({section:n.section,type:n.refType,name:n.refName})===n.posVal?1:-1,s=(r[0]+r[1]/60+r[2]/3600)*i;t(n,s)}})},castDateValues:function(e,t){a.forEach(function(n){var r=e(n);if(r){var s=i.parseExifDate(r);void 0!==s&&t(n,s)}})},simplifyValue:function(e,t){return Array.isArray(e)&&1===(e=e.map(function(e){return 10===t||5===t?e[0]/e[1]:e})).length&&(e=e[0]),e}}},1743:(e,t,n)=>{"use strict";var r=n(5433),i=n(1483);function s(e,t){for(var n in t)l(t,n)&&(e[n]=t[n])}function a(e){return e&&"string"==typeof e}function o(e){var t={};for(var n in e)t[n]=e[n];return t}function c(e){return e&&"object"==typeof e||r(e)}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");c(e)||(e={});for(var t=1;t<arguments.length;t++){var n=arguments[t];a(n)&&(n=o(n)),c(n)&&(s(e,n),i(e,n))}return e}},5867:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var Buffer=__webpack_require__(1048).Buffer;const{multiByteIndexOf,stringToBytes,readUInt64LE,tarHeaderChecksumMatches,uint8ArrayUtf8ByteString}=__webpack_require__(9315),supported=__webpack_require__(2009),xpiZipFilename=stringToBytes("META-INF/mozilla.rsa"),oxmlContentTypes=stringToBytes("[Content_Types].xml"),oxmlRels=stringToBytes("_rels/.rels"),fileType=e=>{if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||Buffer.isBuffer(e)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof e}\``);const t=e instanceof Uint8Array?e:new Uint8Array(e);if(!(t&&t.length>1))return;const n=(e,n)=>{n={offset:0,...n};for(let r=0;r<e.length;r++)if(n.mask){if(e[r]!==(n.mask[r]&t[r+n.offset]))return!1}else if(e[r]!==t[r+n.offset])return!1;return!0},r=(e,t)=>n(stringToBytes(e),t);if(n([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(n([137,80,78,71,13,10,26,10])){const e=33,n=t.findIndex((n,r)=>r>=e&&73===t[r]&&68===t[r+1]&&65===t[r+2]&&84===t[r+3]),r=t.subarray(e,n);return r.findIndex((e,t)=>97===r[t]&&99===r[t+1]&&84===r[t+2]&&76===r[t+3])>=0?{ext:"apng",mime:"image/apng"}:{ext:"png",mime:"image/png"}}if(n([71,73,70]))return{ext:"gif",mime:"image/gif"};if(n([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(n([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((n([73,73,42,0])||n([77,77,0,42]))&&n([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(n([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(n([73,73,42,0])&&(n([16,251,134,1],{offset:4})||n([8,0,0,0],{offset:4}))&&n([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9}))return{ext:"arw",mime:"image/x-sony-arw"};if(n([73,73,42,0,8,0,0,0])&&(n([45,0,254,0],{offset:8})||n([39,0,254,0],{offset:8})))return{ext:"dng",mime:"image/x-adobe-dng"};if(n([73,73,42,0])&&n([28,0,254,0],{offset:8}))return{ext:"nef",mime:"image/x-nikon-nef"};if(n([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(r("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(n([73,73,42,0])||n([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(n([66,77]))return{ext:"bmp",mime:"image/bmp"};if(n([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(n([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};const i=[80,75,3,4];if(n(i)){if(n([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(n(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(r("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(r("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(r("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};let e,s=0,a=!1;do{const o=s+30;if(a||(a=n(oxmlContentTypes,{offset:o})||n(oxmlRels,{offset:o})),e||(r("word/",{offset:o})?e={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:r("ppt/",{offset:o})?e={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:r("xl/",{offset:o})&&(e={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),a&&e)return e;s=multiByteIndexOf(t,i,o)}while(s>=0);if(e)return e}if(n([80,75])&&(3===t[2]||5===t[2]||7===t[2])&&(4===t[3]||6===t[3]||8===t[3]))return{ext:"zip",mime:"application/zip"};if(n([48,48,48,48,48,48],{offset:148,mask:[248,248,248,248,248,248]})&&tarHeaderChecksumMatches(t))return{ext:"tar",mime:"application/x-tar"};if(n([82,97,114,33,26,7])&&(0===t[6]||1===t[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(n([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(n([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(n([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(n([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(n([102,114,101,101],{offset:4})||n([109,100,97,116],{offset:4})||n([109,111,111,118],{offset:4})||n([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r("ftyp",{offset:4})&&96&t[8]){const e=uint8ArrayUtf8ByteString(t,8,12).replace("\0"," ").trim();switch(e){case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};default:return e.startsWith("3g")?e.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(n([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(n([26,69,223,163])){const e=t.subarray(4,4100),n=e.findIndex((e,t,n)=>66===n[t]&&130===n[t+1]);if(-1!==n){const t=n+3,r=n=>[...n].every((n,r)=>e[t+r]===n.charCodeAt(0));if(r("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(r("webm"))return{ext:"webm",mime:"video/webm"}}}if(n([82,73,70,70])){if(n([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(n([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(n([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(n([48,38,178,117,142,102,207,17,166,217])){let e=30;do{const r=readUInt64LE(t,e+16);if(n([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:e})){if(n([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:e+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(n([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:e+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}e+=r}while(e+24<=t.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(n([0,0,1,186])||n([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};for(let e=0;e<2&&e<t.length-16;e++){if(n([73,68,51],{offset:e})||n([255,226],{offset:e,mask:[255,230]}))return{ext:"mp3",mime:"audio/mpeg"};if(n([255,228],{offset:e,mask:[255,230]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,248],{offset:e,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(n([255,240],{offset:e,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(n([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(n([79,103,103,83]))return n([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:n([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:n([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:n([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:n([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(n([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(n([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(n([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(n([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(n([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(n([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===t[0]||70===t[0])&&n([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(n([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(n([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(n([119,79,70,70])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(n([119,79,70,50])&&(n([0,1,0,0],{offset:4})||n([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(n([76,80],{offset:34})&&(n([0,0,1],{offset:8})||n([1,0,2],{offset:8})||n([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(n([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(n([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(n([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(n([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(n([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(n([37,33]))return{ext:"ps",mime:"application/postscript"};if(n([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(n([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(n([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(n([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(n([77,83,67,70])||n([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(n([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(n([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(n([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(n([31,160])||n([31,157]))return{ext:"Z",mime:"application/x-compress"};if(n([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(n([208,207,17,224,161,177,26,225,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62]))return{ext:"msi",mime:"application/x-msi"};if(n([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(n([71],{offset:4})&&(n([71],{offset:192})||n([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(n([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(n([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(n([0,0,0,12,106,80,32,32,13,10,135,10])){if(n([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(n([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(n([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(n([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}return n([70,79,82,77])?{ext:"aif",mime:"audio/aiff"}:r("<?xml ")?{ext:"xml",mime:"application/xml"}:n([66,79,79,75,77,79,66,73],{offset:60})?{ext:"mobi",mime:"application/x-mobipocket-ebook"}:n([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:n([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:n([77,80,43])||n([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:n([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:n([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:n([212,195,178,161])||n([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:n([68,83,68,32])?{ext:"dsf",mime:"audio/x-dsf"}:n([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70])?{ext:"lnk",mime:"application/x.ms.shortcut"}:n([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0])?{ext:"alias",mime:"application/x.apple.alias"}:r("Creative Voice File")?{ext:"voc",mime:"audio/x-voc"}:n([11,119])?{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"}:(n([126,16,4])||n([126,24,4]))&&n([48,77,73,69],{offset:4})?{ext:"mie",mime:"application/x-mie"}:n([65,82,82,79,87,49,0,0])?{ext:"arrow",mime:"application/x-apache-arrow"}:n([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2})?{ext:"shp",mime:"application/x-esri-shape"}:void 0};module.exports=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),fileType.stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",()=>{const e=new stream.PassThrough,t=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{e.fileType=fileType(t)}catch(e){reject(e)}readableStream.unshift(t),stream.pipeline?resolve(stream.pipeline(readableStream,e,()=>{})):resolve(readableStream.pipe(e))})}),Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)})},2009:e=>{"use strict";e.exports={extensions:["jpg","png","apng","gif","webp","flif","cr2","orf","arw","dng","nef","rw2","raf","tif","bmp","jxr","psd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","msi","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","wmv","wma","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-canon-cr2","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-wma","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-msi","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/ktx","application/dicom","audio/x-musepack","text/calendar","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape"]}},9315:(e,t,n)=>{"use strict";var r=n(1048).Buffer;t.stringToBytes=e=>[...e].map(e=>e.charCodeAt(0));const i=(e,t,n)=>String.fromCharCode(...e.slice(t,n));t.readUInt64LE=(e,t=0)=>{let n=e[t],r=1,i=0;for(;++i<8;)r*=256,n+=e[t+i]*r;return n},t.tarHeaderChecksumMatches=e=>{if(e.length<512)return!1;let t=256,n=0;for(let r=0;r<148;r++){const i=e[r];t+=i,n+=128&i}for(let r=156;r<512;r++){const i=e[r];t+=i,n+=128&i}const r=parseInt(i(e,148,154),8);return r===t||r===t-(n<<1)},t.multiByteIndexOf=(e,t,n=0)=>{if(r&&r.isBuffer(e))return e.indexOf(r.from(t),n);const i=(e,t,n)=>{for(let r=1;r<t.length;r++)if(t[r]!==e[n+r])return!1;return!0};let s=e.indexOf(t[0],n);for(;s>=0;){if(i(e,t,s))return s;s=e.indexOf(t[0],s+1)}return-1},t.uint8ArrayUtf8ByteString=i},705:(e,t,n)=>{"use strict";var r=n(9617),i=Object.prototype.toString,s=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){if(!r(t))throw new TypeError("iterator must be a function");var a;arguments.length>=3&&(a=n),"[object Array]"===i.call(e)?function(e,t,n){for(var r=0,i=e.length;r<i;r++)s.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,a):"string"==typeof e?function(e,t,n){for(var r=0,i=e.length;r<i;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,a):function(e,t,n){for(var r in e)s.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,a)}},7091:e=>{"use strict";e.exports=function(e,t,n){for(var r in e)if(!1===t.call(n,e[r],r,e))break}},6553:(e,t,n)=>{"use strict";var r=n(6343);function i(e){this.caches=e||{}}i.prototype={cache:function(e){return this.caches[e]||(this.caches[e]=new r)},set:function(e,t,n){var r=this.cache(e);return r.set(t,n),r},has:function(e,t){return void 0!==this.get(e,t)},get:function(e,t){var n=this.cache(e);return"string"==typeof t?n.get(t):n}},e.exports=i},8794:e=>{"use strict";var t=Object.prototype.toString,n=Math.max,r=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n};e.exports=function(e){var i=this;if("function"!=typeof i||"[object Function]"!==t.apply(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var s,a=function(e){for(var t=[],n=1,r=0;n<e.length;n+=1,r+=1)t[r]=e[n];return t}(arguments),o=n(0,i.length-a.length),c=[],l=0;l<o;l++)c[l]="$"+l;if(s=Function("binder","return function ("+function(e){for(var t="",n=0;n<e.length;n+=1)t+=e[n],n+1<e.length&&(t+=",");return t}(c)+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof s){var t=i.apply(this,r(a,arguments));return Object(t)===t?t:this}return i.apply(e,r(a,arguments))}),i.prototype){var u=function(){};u.prototype=i.prototype,s.prototype=new u,u.prototype=null}return s}},9138:(e,t,n)=>{"use strict";var r=n(8794);e.exports=Function.prototype.bind||r},528:(e,t,n)=>{"use strict";var r,i=n(9629),s=n(9838),a=n(9110),o=n(1155),c=n(4943),l=n(5731),u=n(3468),h=n(2140),d=n(8479),f=n(8449),p=n(8129),g=n(2387),m=n(5865),y=n(1319),b=n(6882),w=Function,v=function(e){try{return w('"use strict"; return ('+e+").constructor;")()}catch(e){}},S=n(9336),x=n(4940),E=function(){throw new u},I=S?function(){try{return E}catch(e){try{return S(arguments,"callee").get}catch(e){return E}}}():E,k=n(3558)(),T=n(6369),_=n(7345),C=n(7859),A=n(6095),F=n(4531),R={},M="undefined"!=typeof Uint8Array&&T?T(Uint8Array):r,D={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":k&&T?T([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":R,"%AsyncGenerator%":R,"%AsyncGeneratorFunction%":R,"%AsyncIteratorPrototype%":R,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":s,"%eval%":eval,"%EvalError%":a,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":w,"%GeneratorFunction%":R,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":k&&T?T(T([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&k&&T?T((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":S,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":o,"%ReferenceError%":c,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&k&&T?T((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":k&&T?T(""[Symbol.iterator]()):r,"%Symbol%":k?Symbol:r,"%SyntaxError%":l,"%ThrowTypeError%":I,"%TypedArray%":M,"%TypeError%":u,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":h,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet,"%Function.prototype.call%":F,"%Function.prototype.apply%":A,"%Object.defineProperty%":x,"%Object.getPrototypeOf%":_,"%Math.abs%":d,"%Math.floor%":f,"%Math.max%":p,"%Math.min%":g,"%Math.pow%":m,"%Math.round%":y,"%Math.sign%":b,"%Reflect.getPrototypeOf%":C};if(T)try{null.error}catch(e){var O=T(T(e));D["%Error.prototype%"]=O}var P=function e(t){var n;if("%AsyncFunction%"===t)n=v("async function () {}");else if("%GeneratorFunction%"===t)n=v("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=v("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&T&&(n=T(i.prototype))}return D[t]=n,n},N={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},L=n(9138),B=n(8554),U=L.call(F,Array.prototype.concat),V=L.call(A,Array.prototype.splice),j=L.call(F,String.prototype.replace),z=L.call(F,String.prototype.slice),G=L.call(F,RegExp.prototype.exec),H=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,$=/\\(\\)?/g,W=function(e,t){var n,r=e;if(B(N,r)&&(r="%"+(n=N[r])[0]+"%"),B(D,r)){var i=D[r];if(i===R&&(i=P(r)),void 0===i&&!t)throw new u("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:i}}throw new l("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new u('"allowMissing" argument must be a boolean');if(null===G(/^%?[^%]*%?$/,e))throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(e){var t=z(e,0,1),n=z(e,-1);if("%"===t&&"%"!==n)throw new l("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new l("invalid intrinsic syntax, expected opening `%`");var r=[];return j(e,H,function(e,t,n,i){r[r.length]=n?j(i,$,"$1"):t||e}),r}(e),r=n.length>0?n[0]:"",i=W("%"+r+"%",t),s=i.name,a=i.value,o=!1,c=i.alias;c&&(r=c[0],V(n,U([0,1],c)));for(var h=1,d=!0;h<n.length;h+=1){var f=n[h],p=z(f,0,1),g=z(f,-1);if(('"'===p||"'"===p||"`"===p||'"'===g||"'"===g||"`"===g)&&p!==g)throw new l("property names with quotes must have matching quotes");if("constructor"!==f&&d||(o=!0),B(D,s="%"+(r+="."+f)+"%"))a=D[s];else if(null!=a){if(!(f in a)){if(!t)throw new u("base intrinsic for "+e+" exists, but the property is not available.");return}if(S&&h+1>=n.length){var m=S(a,f);a=(d=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:a[f]}else d=B(a,f),a=a[f];d&&!o&&(D[s]=a)}}return a}},7345:(e,t,n)=>{"use strict";var r=n(9629);e.exports=r.getPrototypeOf||null},7859:e=>{"use strict";e.exports="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null},6369:(e,t,n)=>{"use strict";var r=n(7859),i=n(7345),s=n(6423);e.exports=r?function(e){return r(e)}:i?function(e){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("getProto: not an object");return i(e)}:s?function(e){return s(e)}:null},5302:e=>{function t(e){return e?Array.isArray(e)?e.join("."):e:""}e.exports=function(e,n,r,i,s){if(null===(a=e)||"object"!=typeof a&&"function"!=typeof a||!n)return e;var a;if(n=t(n),r&&(n+="."+t(r)),i&&(n+="."+t(i)),s&&(n+="."+t(s)),n in e)return e[n];for(var o=n.split("."),c=o.length,l=-1;e&&++l<c;){for(var u=o[l];"\\"===u[u.length-1];)u=u.slice(0,-1)+"."+o[++l];e=e[u]}return e}},5328:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deinterlace=void 0,t.deinterlace=function(e,t){for(var n=new Array(e.length),r=e.length/t,i=function(r,i){var s=e.slice(i*t,(i+1)*t);n.splice.apply(n,[r*t,t].concat(s))},s=[0,4,2,1],a=[8,8,4,2],o=0,c=0;c<4;c++)for(var l=s[c];l<r;l+=a[c])i(l,o),o++;return n}},6560:(e,t,n)=>{"use strict";t.Ud=t.O5=void 0;var r,i=(r=n(7128))&&r.__esModule?r:{default:r},s=n(5005),a=n(538),o=n(5328),c=n(2747);t.O5=function(e){var t=new Uint8Array(e);return(0,s.parse)((0,a.buildStream)(t),i.default)},t.Ud=function(e,t){return e.frames.filter(function(e){return e.image}).map(function(n){return function(e,t,n){if(e.image){var r=e.image,i=r.descriptor.width*r.descriptor.height,s=(0,c.lzw)(r.data.minCodeSize,r.data.blocks,i);r.descriptor.lct.interlaced&&(s=(0,o.deinterlace)(s,r.descriptor.width));var a={pixels:s,dims:{top:e.image.descriptor.top,left:e.image.descriptor.left,width:e.image.descriptor.width,height:e.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?a.colorTable=r.lct:a.colorTable=t,e.gce&&(a.delay=10*(e.gce.delay||10),a.disposalType=e.gce.extras.disposal,e.gce.extras.transparentColorGiven&&(a.transparentIndex=e.gce.transparentColorIndex)),n&&(a.patch=function(e){for(var t=e.pixels.length,n=new Uint8ClampedArray(4*t),r=0;r<t;r++){var i=4*r,s=e.pixels[r],a=e.colorTable[s]||[0,0,0];n[i]=a[0],n[i+1]=a[1],n[i+2]=a[2],n[i+3]=s!==e.transparentIndex?255:0}return n}(a)),a}console.warn("gif frame does not have associated image.")}(n,e.gct,t)})}},2747:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lzw=void 0,t.lzw=function(e,t,n){var r,i,s,a,o,c,l,u,h,d,f,p,g,m,y,b,w=4096,v=n,S=new Array(n),x=new Array(w),E=new Array(w),I=new Array(4097);for(o=1+(i=1<<(d=e)),r=i+2,l=-1,s=(1<<(a=d+1))-1,u=0;u<i;u++)x[u]=0,E[u]=u;for(f=p=g=m=y=b=0,h=0;h<v;){if(0===m){if(p<a){f+=t[b]<<p,p+=8,b++;continue}if(u=f&s,f>>=a,p-=a,u>r||u==o)break;if(u==i){s=(1<<(a=d+1))-1,r=i+2,l=-1;continue}if(-1==l){I[m++]=E[u],l=u,g=u;continue}for(c=u,u==r&&(I[m++]=g,u=l);u>i;)I[m++]=E[u],u=x[u];g=255&E[u],I[m++]=g,r<w&&(x[r]=l,E[r]=g,!(++r&s)&&r<w&&(a++,s+=r)),l=c}m--,S[y++]=I[m],h++}for(h=y;h<v;h++)S[h]=0;return S}},1292:e=>{"use strict";e.exports=Object.getOwnPropertyDescriptor},9336:(e,t,n)=>{"use strict";var r=n(1292);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},7239:(e,t,n)=>{"use strict";var r=n(4940),i=function(){return!!r};i.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},3558:(e,t,n)=>{"use strict";var r="undefined"!=typeof Symbol&&Symbol,i=n(2908);e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&i()}},2908:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(var r in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(e,t);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},1913:(e,t,n)=>{"use strict";var r=n(2908);e.exports=function(){return r()&&!!Symbol.toStringTag}},8418:(e,t,n)=>{"use strict";var r=n(9537),i=n(819),s=n(5302);e.exports=function(e,t){return i(r(e)&&t?s(e,t):e)}},819:(e,t,n)=>{"use strict";var r=n(1182),i=n(8424);e.exports=function e(t){if(i(t))return!0;switch(r(t)){case"null":case"boolean":case"function":return!0;case"string":case"arguments":return 0!==t.length;case"error":return""!==t.message;case"array":var n=t.length;if(0===n)return!1;for(var s=0;s<n;s++)if(e(t[s]))return!0;return!1;case"file":case"map":case"set":return 0!==t.size;case"object":var a=Object.keys(t);if(0===a.length)return!1;for(s=0;s<a.length;s++)if(e(t[a[s]]))return!0;return!1;default:return!1}}},1848:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(1983).Transform;function s(e){i.call(this),this._block=r.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}n(5615)(s,i),s.prototype._transform=function(e,t,n){var r=null;try{this.update(e,t)}catch(e){r=e}n(r)},s.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)};var a="undefined"!=typeof Uint8Array,o="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&ArrayBuffer.isView&&(r.prototype instanceof Uint8Array||r.TYPED_ARRAY_SUPPORT);s.prototype.update=function(e,t){if(this._finalized)throw new Error("Digest already called");e=function(e,t){if(e instanceof r)return e;if("string"==typeof e)return r.from(e,t);if(o&&ArrayBuffer.isView(e)){if(0===e.byteLength)return r.alloc(0);var n=r.from(e.buffer,e.byteOffset,e.byteLength);if(n.byteLength===e.byteLength)return n}if(a&&e instanceof Uint8Array)return r.from(e);if(r.isBuffer(e)&&e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))return r.from(e);throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView.')}(e,t);for(var n=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var s=this._blockOffset;s<this._blockSize;)n[s++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)n[this._blockOffset++]=e[i++];for(var c=0,l=8*e.length;l>0;++c)this._length[c]+=l,(l=this._length[c]/4294967296|0)>0&&(this._length[c]-=4294967296*l);return this},s.prototype._update=function(){throw new Error("_update is not implemented")},s.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return t},s.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=s},9499:(e,t,n)=>{var r=t;r.utils=n(461),r.common=n(2191),r.sha=n(5746),r.ripemd=n(4169),r.hmac=n(1825),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160},2191:(e,t,n)=>{"use strict";var r=n(461),i=n(7784);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=s,s.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else for(r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,s=8;s<this.padLength;s++)r[i++]=0;return r}},1825:(e,t,n)=>{"use strict";var r=n(461),i=n(7784);function s(e,t,n){if(!(this instanceof s))return new s(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(t,n))}e.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},4169:(e,t,n)=>{"use strict";var r=n(461),i=n(2191),s=r.rotl32,a=r.sum32,o=r.sum32_3,c=r.sum32_4,l=i.BlockHash;function u(){if(!(this instanceof u))return new u;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function h(e,t,n,r){return e<=15?t^n^r:e<=31?t&n|~t&r:e<=47?(t|~n)^r:e<=63?t&r|n&~r:t^(n|~r)}function d(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}r.inherits(u,l),t.ripemd160=u,u.blockSize=512,u.outSize=160,u.hmacStrength=192,u.padLength=64,u.prototype._update=function(e,t){for(var n=this.h[0],r=this.h[1],i=this.h[2],l=this.h[3],u=this.h[4],b=n,w=r,v=i,S=l,x=u,E=0;E<80;E++){var I=a(s(c(n,h(E,r,i,l),e[p[E]+t],d(E)),m[E]),u);n=u,u=l,l=s(i,10),i=r,r=I,I=a(s(c(b,h(79-E,w,v,S),e[g[E]+t],f(E)),y[E]),x),b=x,x=S,S=s(v,10),v=w,w=I}I=o(this.h[1],i,S),this.h[1]=o(this.h[2],l,x),this.h[2]=o(this.h[3],u,b),this.h[3]=o(this.h[4],n,w),this.h[4]=o(this.h[0],r,v),this.h[0]=I},u.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},5746:(e,t,n)=>{"use strict";t.sha1=n(2986),t.sha224=n(5393),t.sha256=n(536),t.sha384=n(2348),t.sha512=n(2157)},2986:(e,t,n)=>{"use strict";var r=n(461),i=n(2191),s=n(600),a=r.rotl32,o=r.sum32,c=r.sum32_5,l=s.ft_1,u=i.BlockHash,h=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}r.inherits(d,u),e.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=a(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0],s=this.h[1],u=this.h[2],d=this.h[3],f=this.h[4];for(r=0;r<n.length;r++){var p=~~(r/20),g=c(a(i,5),l(p,s,u,d),f,n[r],h[p]);f=d,d=u,u=a(s,30),s=i,i=g}this.h[0]=o(this.h[0],i),this.h[1]=o(this.h[1],s),this.h[2]=o(this.h[2],u),this.h[3]=o(this.h[3],d),this.h[4]=o(this.h[4],f)},d.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},5393:(e,t,n)=>{"use strict";var r=n(461),i=n(536);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}r.inherits(s,i),e.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},536:(e,t,n)=>{"use strict";var r=n(461),i=n(2191),s=n(600),a=n(7784),o=r.sum32,c=r.sum32_4,l=r.sum32_5,u=s.ch32,h=s.maj32,d=s.s0_256,f=s.s1_256,p=s.g0_256,g=s.g1_256,m=i.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=new Array(64)}r.inherits(b,m),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=c(g(n[r-2]),n[r-7],p(n[r-15]),n[r-16]);var i=this.h[0],s=this.h[1],m=this.h[2],y=this.h[3],b=this.h[4],w=this.h[5],v=this.h[6],S=this.h[7];for(a(this.k.length===n.length),r=0;r<n.length;r++){var x=l(S,f(b),u(b,w,v),this.k[r],n[r]),E=o(d(i),h(i,s,m));S=v,v=w,w=b,b=o(y,x),y=m,m=s,s=i,i=o(x,E)}this.h[0]=o(this.h[0],i),this.h[1]=o(this.h[1],s),this.h[2]=o(this.h[2],m),this.h[3]=o(this.h[3],y),this.h[4]=o(this.h[4],b),this.h[5]=o(this.h[5],w),this.h[6]=o(this.h[6],v),this.h[7]=o(this.h[7],S)},b.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},2348:(e,t,n)=>{"use strict";var r=n(461),i=n(2157);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}r.inherits(s,i),e.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},2157:(e,t,n)=>{"use strict";var r=n(461),i=n(2191),s=n(7784),a=r.rotr64_hi,o=r.rotr64_lo,c=r.shr64_hi,l=r.shr64_lo,u=r.sum64,h=r.sum64_hi,d=r.sum64_lo,f=r.sum64_4_hi,p=r.sum64_4_lo,g=r.sum64_5_hi,m=r.sum64_5_lo,y=i.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=new Array(160)}function v(e,t,n,r,i){var s=e&n^~e&i;return s<0&&(s+=4294967296),s}function S(e,t,n,r,i,s){var a=t&r^~t&s;return a<0&&(a+=4294967296),a}function x(e,t,n,r,i){var s=e&n^e&i^n&i;return s<0&&(s+=4294967296),s}function E(e,t,n,r,i,s){var a=t&r^t&s^r&s;return a<0&&(a+=4294967296),a}function I(e,t){var n=a(e,t,28)^a(t,e,2)^a(t,e,7);return n<0&&(n+=4294967296),n}function k(e,t){var n=o(e,t,28)^o(t,e,2)^o(t,e,7);return n<0&&(n+=4294967296),n}function T(e,t){var n=o(e,t,14)^o(e,t,18)^o(t,e,9);return n<0&&(n+=4294967296),n}function _(e,t){var n=a(e,t,1)^a(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function C(e,t){var n=o(e,t,1)^o(e,t,8)^l(e,t,7);return n<0&&(n+=4294967296),n}function A(e,t){var n=o(e,t,19)^o(t,e,29)^l(e,t,6);return n<0&&(n+=4294967296),n}r.inherits(w,y),e.exports=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(e,t){for(var n=this.W,r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=(m=n[r-4],y=n[r-3],b=void 0,(b=a(m,y,19)^a(y,m,29)^c(m,y,6))<0&&(b+=4294967296),b),s=A(n[r-4],n[r-3]),o=n[r-14],l=n[r-13],u=_(n[r-30],n[r-29]),h=C(n[r-30],n[r-29]),d=n[r-32],g=n[r-31];n[r]=f(i,s,o,l,u,h,d,g),n[r+1]=p(i,s,o,l,u,h,d,g)}var m,y,b},w.prototype._update=function(e,t){this._prepareBlock(e,t);var n,r,i,o=this.W,c=this.h[0],l=this.h[1],f=this.h[2],p=this.h[3],y=this.h[4],b=this.h[5],w=this.h[6],_=this.h[7],C=this.h[8],A=this.h[9],F=this.h[10],R=this.h[11],M=this.h[12],D=this.h[13],O=this.h[14],P=this.h[15];s(this.k.length===o.length);for(var N=0;N<o.length;N+=2){var L=O,B=P,U=(i=void 0,(i=a(n=C,r=A,14)^a(n,r,18)^a(r,n,9))<0&&(i+=4294967296),i),V=T(C,A),j=v(C,0,F,0,M),z=S(0,A,0,R,0,D),G=this.k[N],H=this.k[N+1],$=o[N],W=o[N+1],q=g(L,B,U,V,j,z,G,H,$,W),X=m(L,B,U,V,j,z,G,H,$,W);L=I(c,l),B=k(c,l),U=x(c,0,f,0,y),V=E(0,l,0,p,0,b);var Y=h(L,B,U,V),K=d(L,B,U,V);O=M,P=D,M=F,D=R,F=C,R=A,C=h(w,_,q,X),A=d(_,_,q,X),w=y,_=b,y=f,b=p,f=c,p=l,c=h(q,X,Y,K),l=d(q,X,Y,K)}u(this.h,0,c,l),u(this.h,2,f,p),u(this.h,4,y,b),u(this.h,6,w,_),u(this.h,8,C,A),u(this.h,10,F,R),u(this.h,12,M,D),u(this.h,14,O,P)},w.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},600:(e,t,n)=>{"use strict";var r=n(461).rotr32;function i(e,t,n){return e&t^~e&n}function s(e,t,n){return e&t^e&n^t&n}function a(e,t,n){return e^t^n}t.ft_1=function(e,t,n,r){return 0===e?i(t,n,r):1===e||3===e?a(t,n,r):2===e?s(t,n,r):void 0},t.ch32=i,t.maj32=s,t.p32=a,t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},461:(e,t,n)=>{"use strict";var r=n(7784),i=n(5615);function s(e,t){return 55296==(64512&e.charCodeAt(t))&&!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1))}function a(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function o(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)n.push(parseInt(e[i]+e[i+1],16))}else for(var r=0,i=0;i<e.length;i++){var a=e.charCodeAt(i);a<128?n[r++]=a:a<2048?(n[r++]=a>>6|192,n[r++]=63&a|128):s(e,i)?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++i)),n[r++]=a>>18|240,n[r++]=a>>12&63|128,n[r++]=a>>6&63|128,n[r++]=63&a|128):(n[r++]=a>>12|224,n[r++]=a>>6&63|128,n[r++]=63&a|128)}else for(i=0;i<e.length;i++)n[i]=0|e[i];return n},t.toHex=function(e){for(var t="",n=0;n<e.length;n++)t+=o(e[n].toString(16));return t},t.htonl=a,t.toHex32=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=a(i)),n+=c(i.toString(16))}return n},t.zero2=o,t.zero8=c,t.join32=function(e,t,n,i){var s=n-t;r(s%4==0);for(var a=new Array(s/4),o=0,c=t;o<a.length;o++,c+=4){var l;l="big"===i?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],a[o]=l>>>0}return a},t.split32=function(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var s=e[r];"big"===t?(n[i]=s>>>24,n[i+1]=s>>>16&255,n[i+2]=s>>>8&255,n[i+3]=255&s):(n[i+3]=s>>>24,n[i+2]=s>>>16&255,n[i+1]=s>>>8&255,n[i]=255&s)}return n},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,n){return e+t+n>>>0},t.sum32_4=function(e,t,n,r){return e+t+n+r>>>0},t.sum32_5=function(e,t,n,r,i){return e+t+n+r+i>>>0},t.sum64=function(e,t,n,r){var i=e[t],s=r+e[t+1]>>>0,a=(s<r?1:0)+n+i;e[t]=a>>>0,e[t+1]=s},t.sum64_hi=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},t.sum64_lo=function(e,t,n,r){return t+r>>>0},t.sum64_4_hi=function(e,t,n,r,i,s,a,o){var c=0,l=t;return c+=(l=l+r>>>0)<t?1:0,c+=(l=l+s>>>0)<s?1:0,e+n+i+a+(c+=(l=l+o>>>0)<o?1:0)>>>0},t.sum64_4_lo=function(e,t,n,r,i,s,a,o){return t+r+s+o>>>0},t.sum64_5_hi=function(e,t,n,r,i,s,a,o,c,l){var u=0,h=t;return u+=(h=h+r>>>0)<t?1:0,u+=(h=h+s>>>0)<s?1:0,u+=(h=h+o>>>0)<o?1:0,e+n+i+a+c+(u+=(h=h+l>>>0)<l?1:0)>>>0},t.sum64_5_lo=function(e,t,n,r,i,s,a,o,c,l){return t+r+s+o+l>>>0},t.rotr64_hi=function(e,t,n){return(t<<32-n|e>>>n)>>>0},t.rotr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0},t.shr64_hi=function(e,t,n){return e>>>n},t.shr64_lo=function(e,t,n){return(e<<32-n|t>>>n)>>>0}},8554:(e,t,n)=>{"use strict";var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,s=n(9138);e.exports=s.call(r,i)},4742:(e,t,n)=>{"use strict";var r=n(9499),i=n(9042),s=n(7784);function a(e){if(!(this instanceof a))return new a(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),n=i.toArray(e.nonce,e.nonceEnc||"hex"),r=i.toArray(e.pers,e.persEnc||"hex");s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,r)}e.exports=a,a.prototype._init=function(e,t,n){var r=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},a.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},a.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},a.prototype.reseed=function(e,t,n,r){"string"!=typeof t&&(r=n,n=t,t=null),e=i.toArray(e,t),n=i.toArray(n,r),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},a.prototype.generate=function(e,t,n,r){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(r=n,n=t,t=null),n&&(n=i.toArray(n,r||"hex"),this._update(n));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,e);return this._update(n),this._reseed++,i.encode(a,t)}},9318:(e,t)=>{t.read=function(e,t,n,r,i){var s,a,o=8*i-r-1,c=(1<<o)-1,l=c>>1,u=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=o;u>0;s=256*s+e[t+h],h+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=r;u>0;a=256*a+e[t+h],h+=d,u-=8);if(0===s)s=1-l;else{if(s===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),s-=l}return(f?-1:1)*a*Math.pow(2,s-r)},t.write=function(e,t,n,r,i,s){var a,o,c,l=8*s-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(a++,c/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(t*c-1)*Math.pow(2,i),a+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[n+f]=255&o,f+=p,o/=256,i-=8);for(a=a<<i|o,l+=i;l>0;e[n+f]=255&a,f+=p,a/=256,l-=8);e[n+f-p]|=128*g}},5615:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},5640:(e,t,n)=>{"use strict";var r=n(8554),i={__proto__:null,configurable:"boolean",enumerable:"boolean",get:"function",set:"function"};e.exports=function(e,t){if("string"==typeof t)return void 0!==Object.getOwnPropertyDescriptor(e,t);if(!e||"object"!=typeof e)return!1;if(r(e,"value")||r(e,"writable"))return!1;if(!(r(e,"get")&&"function"==typeof e.get||r(e,"set")&&"function"==typeof e.set))return!1;if(r(e,"get")&&"function"!=typeof e.get&&void 0!==e.get||r(e,"set")&&"function"!=typeof e.set&&void 0!==e.set)return!1;for(var n in e)if(r(e,n)&&r(i,n)&&typeof e[n]!==i[n]&&void 0!==e[n])return!1;return!0}},5387:(e,t,n)=>{"use strict";var r=n(1913)(),i=n(4607)("Object.prototype.toString"),s=function(e){return!(r&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},a=function(e){return!!s(e)||null!==e&&"object"==typeof e&&"length"in e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"callee"in e&&"[object Function]"===i(e.callee)},o=function(){return s(arguments)}();s.isLegacyArguments=a,e.exports=o?s:a},9617:e=>{"use strict";var t,n,r=Function.prototype.toString,i="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof i&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},i(function(){throw 42},null,t)}catch(e){e!==n&&(i=null)}else i=null;var s=/^\s*class\b/,a=function(e){try{var t=r.call(e);return s.test(t)}catch(e){return!1}},o=function(e){try{return!a(e)&&(r.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,l="function"==typeof Symbol&&!!Symbol.toStringTag,u=!(0 in[,]),h=function(){return!1};if("object"==typeof document){var d=document.all;c.call(d)===c.call(document.all)&&(h=function(e){if((u||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=i?function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{i(e,null,t)}catch(e){if(e!==n)return!1}return!a(e)&&o(e)}:function(e){if(h(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(l)return o(e);if(a(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&o(e)}},1297:(e,t,n)=>{"use strict";var r=n(8554),i={__proto__:null,configurable:"boolean",enumerable:"boolean",writable:"boolean"};e.exports=function(e,t){if(!e||"object"!=typeof e)return!1;if("string"==typeof t)return void 0!==Object.getOwnPropertyDescriptor(e,t);if(!("value"in e)&&!("writable"in e)||"get"in e||"set"in e)return!1;for(var n in e)if("value"!==n&&r(e,n)&&r(i,n)&&typeof e[n]!==i[n]&&void 0!==e[n])return!1;return!0}},6248:(e,t,n)=>{"use strict";var r=n(5640),i=n(1297);e.exports=function(e,t){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&("get"in e||"set"in e?r(e,t):i(e,t))}},5433:(e,t,n)=>{"use strict";var r=n(2685);e.exports=function(e){return r(e)||"function"==typeof e||Array.isArray(e)}},2625:(e,t,n)=>{"use strict";var r,i=n(4607),s=n(6132)(/^\s*(?:function)?\*/),a=n(1913)(),o=n(6369),c=i("Object.prototype.toString"),l=i("Function.prototype.toString");e.exports=function(e){if("function"!=typeof e)return!1;if(s(l(e)))return!0;if(!a)return"[object GeneratorFunction]"===c(e);if(!o)return!1;if(void 0===r){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();r=!!t&&o(t)}return o(e)===r}},8424:(e,t,n)=>{"use strict";var r=n(1182);e.exports=function(e){var t=r(e);if("string"===t){if(!e.trim())return!1}else if("number"!==t)return!1;return e-e+1>=0}},2685:(e,t,n)=>{"use strict";var r=n(9537);function i(e){return!0===r(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,n;return!1!==i(e)&&"function"==typeof(t=e.constructor)&&!1!==i(n=t.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")}},2672:(e,t,n)=>{"use strict";var r,i=n(4607),s=n(1913)(),a=n(8554),o=n(9336);if(s){var c=i("RegExp.prototype.exec"),l={},u=function(){throw l},h={toString:u,valueOf:u};"symbol"==typeof Symbol.toPrimitive&&(h[Symbol.toPrimitive]=u),r=function(e){if(!e||"object"!=typeof e)return!1;var t=o(e,"lastIndex");if(!t||!a(t,"value"))return!1;try{c(e,h)}catch(e){return e===l}}}else{var d=i("Object.prototype.toString");r=function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===d(e)}}e.exports=r},5943:(e,t,n)=>{"use strict";var r=n(2730);e.exports=function(e){return!!r(e)}},1750:(e,t,n)=>{var r,i,s,a,o=n(9907);a=function(){"use strict";return function(){return o&&("win32"===o.platform||/^(msys|cygwin)$/.test(o.env.OSTYPE))}},t&&"object"==typeof t?e.exports=a():(i=[],void 0===(s="function"==typeof(r=a)?r.apply(t,i):r)||(e.exports=s))},9196:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},9537:e=>{"use strict";e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},6968:(e,t,n)=>{var r=n(1584),i=n(2600);e.exports={encode:r,decode:i}},2600:(e,t,n)=>{var r=n(1048).Buffer,i=function(){"use strict";var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,n=799,r=3406,i=2276,s=1567,a=3784,o=5793,c=2896;function l(){}function u(e,t){for(var n,r,i=0,s=[],a=16;a>0&&!e[a-1];)a--;s.push({children:[],index:0});var o,c=s[0];for(n=0;n<a;n++){for(r=0;r<e[n];r++){for((c=s.pop()).children[c.index]=t[i];c.index>0;){if(0===s.length)throw new Error("Could not recreate Huffman Table");c=s.pop()}for(c.index++,s.push(c);s.length<=n;)s.push(o={children:[],index:0}),c.children[c.index]=o.children,c=o;i++}n+1<a&&(s.push(o={children:[],index:0}),c.children[c.index]=o.children,c=o)}return s[0].children}function h(t,n,r,i,s,a,o,c,l,u){r.precision,r.samplesPerLine,r.scanLines;var h=r.mcusPerLine,d=r.progressive,f=(r.maxH,r.maxV,n),p=0,g=0;function m(){if(g>0)return g--,p>>g&1;if(255==(p=t[n++])){var e=t[n++];if(e)throw new Error("unexpected marker: "+(p<<8|e).toString(16))}return g=7,p>>>7}function y(e){for(var t,n=e;null!==(t=m());){if("number"==typeof(n=n[t]))return n;if("object"!=typeof n)throw new Error("invalid huffman sequence")}return null}function b(e){for(var t=0;e>0;){var n=m();if(null===n)return;t=t<<1|n,e--}return t}function w(e){var t=b(e);return t>=1<<e-1?t:t+(-1<<e)+1}var v,S=0,x=0;function E(e,t,n,r,i){var s=n%h,a=(n/h|0)*e.v+r,o=s*e.h+i;void 0===e.blocks[a]&&u.tolerantDecoding||t(e,e.blocks[a][o])}function I(e,t,n){var r=n/e.blocksPerLine|0,i=n%e.blocksPerLine;void 0===e.blocks[r]&&u.tolerantDecoding||t(e,e.blocks[r][i])}var k,T,_,C,A,F,R=i.length;F=d?0===a?0===c?function(e,t){var n=y(e.huffmanTableDC),r=0===n?0:w(n)<<l;t[0]=e.pred+=r}:function(e,t){t[0]|=m()<<l}:0===c?function(t,n){if(S>0)S--;else for(var r=a,i=o;r<=i;){var s=y(t.huffmanTableAC),c=15&s,u=s>>4;if(0!==c)n[e[r+=u]]=w(c)*(1<<l),r++;else{if(u<15){S=b(u)+(1<<u)-1;break}r+=16}}}:function(t,n){for(var r=a,i=o,s=0;r<=i;){var c=e[r],u=n[c]<0?-1:1;switch(x){case 0:var h=y(t.huffmanTableAC),d=15&h;if(s=h>>4,0===d)s<15?(S=b(s)+(1<<s),x=4):(s=16,x=1);else{if(1!==d)throw new Error("invalid ACn encoding");v=w(d),x=s?2:3}continue;case 1:case 2:n[c]?n[c]+=(m()<<l)*u:0==--s&&(x=2==x?3:0);break;case 3:n[c]?n[c]+=(m()<<l)*u:(n[c]=v<<l,x=0);break;case 4:n[c]&&(n[c]+=(m()<<l)*u)}r++}4===x&&0==--S&&(x=0)}:function(t,n){var r=y(t.huffmanTableDC),i=0===r?0:w(r);n[0]=t.pred+=i;for(var s=1;s<64;){var a=y(t.huffmanTableAC),o=15&a,c=a>>4;if(0!==o)n[e[s+=c]]=w(o),s++;else{if(c<15)break;s+=16}}};var M,D,O,P,N=0;for(D=1==R?i[0].blocksPerLine*i[0].blocksPerColumn:h*r.mcusPerColumn,s||(s=D);N<D;){for(T=0;T<R;T++)i[T].pred=0;if(S=0,1==R)for(k=i[0],A=0;A<s;A++)I(k,F,N),N++;else for(A=0;A<s;A++){for(T=0;T<R;T++)for(O=(k=i[T]).h,P=k.v,_=0;_<P;_++)for(C=0;C<O;C++)E(k,F,N,_,C);if(++N===D)break}if(N===D)do{if(255===t[n]&&0!==t[n+1])break;n+=1}while(n<t.length-2);if(g=0,(M=t[n]<<8|t[n+1])<65280)throw new Error("marker was not found");if(!(M>=65488&&M<=65495))break;n+=2}return n-f}function d(e,l){var u,h,d=[],f=l.blocksPerLine,p=l.blocksPerColumn,g=f<<3,y=new Int32Array(64),b=new Uint8Array(64);function w(e,u,h){var d,f,p,g,m,y,b,w,v,S,x=l.quantizationTable,E=h;for(S=0;S<64;S++)E[S]=e[S]*x[S];for(S=0;S<8;++S){var I=8*S;0!=E[1+I]||0!=E[2+I]||0!=E[3+I]||0!=E[4+I]||0!=E[5+I]||0!=E[6+I]||0!=E[7+I]?(d=o*E[0+I]+128>>8,f=o*E[4+I]+128>>8,p=E[2+I],g=E[6+I],m=c*(E[1+I]-E[7+I])+128>>8,w=c*(E[1+I]+E[7+I])+128>>8,y=E[3+I]<<4,b=E[5+I]<<4,v=d-f+1>>1,d=d+f+1>>1,f=v,v=p*a+g*s+128>>8,p=p*s-g*a+128>>8,g=v,v=m-b+1>>1,m=m+b+1>>1,b=v,v=w+y+1>>1,y=w-y+1>>1,w=v,v=d-g+1>>1,d=d+g+1>>1,g=v,v=f-p+1>>1,f=f+p+1>>1,p=v,v=m*i+w*r+2048>>12,m=m*r-w*i+2048>>12,w=v,v=y*n+b*t+2048>>12,y=y*t-b*n+2048>>12,b=v,E[0+I]=d+w,E[7+I]=d-w,E[1+I]=f+b,E[6+I]=f-b,E[2+I]=p+y,E[5+I]=p-y,E[3+I]=g+m,E[4+I]=g-m):(v=o*E[0+I]+512>>10,E[0+I]=v,E[1+I]=v,E[2+I]=v,E[3+I]=v,E[4+I]=v,E[5+I]=v,E[6+I]=v,E[7+I]=v)}for(S=0;S<8;++S){var k=S;0!=E[8+k]||0!=E[16+k]||0!=E[24+k]||0!=E[32+k]||0!=E[40+k]||0!=E[48+k]||0!=E[56+k]?(d=o*E[0+k]+2048>>12,f=o*E[32+k]+2048>>12,p=E[16+k],g=E[48+k],m=c*(E[8+k]-E[56+k])+2048>>12,w=c*(E[8+k]+E[56+k])+2048>>12,y=E[24+k],b=E[40+k],v=d-f+1>>1,d=d+f+1>>1,f=v,v=p*a+g*s+2048>>12,p=p*s-g*a+2048>>12,g=v,v=m-b+1>>1,m=m+b+1>>1,b=v,v=w+y+1>>1,y=w-y+1>>1,w=v,v=d-g+1>>1,d=d+g+1>>1,g=v,v=f-p+1>>1,f=f+p+1>>1,p=v,v=m*i+w*r+2048>>12,m=m*r-w*i+2048>>12,w=v,v=y*n+b*t+2048>>12,y=y*t-b*n+2048>>12,b=v,E[0+k]=d+w,E[56+k]=d-w,E[8+k]=f+b,E[48+k]=f-b,E[16+k]=p+y,E[40+k]=p-y,E[24+k]=g+m,E[32+k]=g-m):(v=o*h[S+0]+8192>>14,E[0+k]=v,E[8+k]=v,E[16+k]=v,E[24+k]=v,E[32+k]=v,E[40+k]=v,E[48+k]=v,E[56+k]=v)}for(S=0;S<64;++S){var T=128+(E[S]+8>>4);u[S]=T<0?0:T>255?255:T}}m(g*p*8);for(var v=0;v<p;v++){var S=v<<3;for(u=0;u<8;u++)d.push(new Uint8Array(g));for(var x=0;x<f;x++){w(l.blocks[v][x],b,y);var E=0,I=x<<3;for(h=0;h<8;h++){var k=d[S+h];for(u=0;u<8;u++)k[I+u]=b[E++]}}}return d}function f(e){return e<0?0:e>255?255:e}l.prototype={load:function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){var e=new Uint8Array(t.response||t.mozResponseArrayBuffer);this.parse(e),this.onload&&this.onload()}.bind(this),t.send(null)},parse:function(t){var n=1e3*this.opts.maxResolutionInMP*1e3,r=0;function i(){var e=t[r]<<8|t[r+1];return r+=2,e}function s(e){var t,n,r=1,i=1;for(n in e.components)e.components.hasOwnProperty(n)&&(r<(t=e.components[n]).h&&(r=t.h),i<t.v&&(i=t.v));var s=Math.ceil(e.samplesPerLine/8/r),a=Math.ceil(e.scanLines/8/i);for(n in e.components)if(e.components.hasOwnProperty(n)){t=e.components[n];var o=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/r),c=Math.ceil(Math.ceil(e.scanLines/8)*t.v/i),l=s*t.h,u=a*t.v,h=[];m(u*l*256);for(var d=0;d<u;d++){for(var f=[],p=0;p<l;p++)f.push(new Int32Array(64));h.push(f)}t.blocksPerLine=o,t.blocksPerColumn=c,t.blocks=h}e.maxH=r,e.maxV=i,e.mcusPerLine=s,e.mcusPerColumn=a}t.length;var a,o,c,l,f=null,p=null,g=[],y=[],b=[],w=[],v=i(),S=-1;if(this.comments=[],65496!=v)throw new Error("SOI not found");for(v=i();65497!=v;){switch(v){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var x=(c=i(),l=t.subarray(r,r+c-2),r+=l.length,l);if(65534===v){var E=String.fromCharCode.apply(null,x);this.comments.push(E)}65504===v&&74===x[0]&&70===x[1]&&73===x[2]&&70===x[3]&&0===x[4]&&(f={version:{major:x[5],minor:x[6]},densityUnits:x[7],xDensity:x[8]<<8|x[9],yDensity:x[10]<<8|x[11],thumbWidth:x[12],thumbHeight:x[13],thumbData:x.subarray(14,14+3*x[12]*x[13])}),65505===v&&69===x[0]&&120===x[1]&&105===x[2]&&102===x[3]&&0===x[4]&&(this.exifBuffer=x.subarray(5,x.length)),65518===v&&65===x[0]&&100===x[1]&&111===x[2]&&98===x[3]&&101===x[4]&&0===x[5]&&(p={version:x[6],flags0:x[7]<<8|x[8],flags1:x[9]<<8|x[10],transformCode:x[11]});break;case 65499:for(var I=i()+r-2;r<I;){var k=t[r++];m(256);var T=new Int32Array(64);if(k>>4){if(k>>4!=1)throw new Error("DQT: invalid table spec");for(X=0;X<64;X++)T[e[X]]=i()}else for(X=0;X<64;X++)T[e[X]]=t[r++];g[15&k]=T}break;case 65472:case 65473:case 65474:i(),(a={}).extended=65473===v,a.progressive=65474===v,a.precision=t[r++],a.scanLines=i(),a.samplesPerLine=i(),a.components={},a.componentsOrder=[];var _=a.scanLines*a.samplesPerLine;if(_>n){var C=Math.ceil((_-n)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${C}MP`)}var A,F=t[r++];for(W=0;W<F;W++){A=t[r];var R=t[r+1]>>4,M=15&t[r+1],D=t[r+2];if(R<=0||M<=0)throw new Error("Invalid sampling factor, expected values above 0");a.componentsOrder.push(A),a.components[A]={h:R,v:M,quantizationIdx:D},r+=3}s(a),y.push(a);break;case 65476:var O=i();for(W=2;W<O;){var P=t[r++],N=new Uint8Array(16),L=0;for(X=0;X<16;X++,r++)L+=N[X]=t[r];m(16+L);var B=new Uint8Array(L);for(X=0;X<L;X++,r++)B[X]=t[r];W+=17+L,(P>>4?b:w)[15&P]=u(N,B)}break;case 65501:i(),o=i();break;case 65500:i(),i();break;case 65498:i();var U=t[r++],V=[];for(W=0;W<U;W++){Y=a.components[t[r++]];var j=t[r++];Y.huffmanTableDC=w[j>>4],Y.huffmanTableAC=b[15&j],V.push(Y)}var z=t[r++],G=t[r++],H=t[r++],$=h(t,r,a,V,o,z,G,H>>4,15&H,this.opts);r+=$;break;case 65535:255!==t[r]&&r--;break;default:if(255==t[r-3]&&t[r-2]>=192&&t[r-2]<=254){r-=3;break}if(224===v||225==v){if(-1!==S)throw new Error(`first unknown JPEG marker at offset ${S.toString(16)}, second unknown JPEG marker ${v.toString(16)} at offset ${(r-1).toString(16)}`);S=r-1;const e=i();if(255===t[r+e-2]){r+=e-2;break}}throw new Error("unknown JPEG marker "+v.toString(16))}v=i()}if(1!=y.length)throw new Error("only single frame JPEGs supported");for(var W=0;W<y.length;W++){var q=y[W].components;for(var X in q)q[X].quantizationTable=g[q[X].quantizationIdx],delete q[X].quantizationIdx}for(this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=f,this.adobe=p,this.components=[],W=0;W<a.componentsOrder.length;W++){var Y=a.components[a.componentsOrder[W]];this.components.push({lines:d(0,Y),scaleX:Y.h/a.maxH,scaleY:Y.v/a.maxV})}},getData:function(e,t){var n,r,i,s,a,o,c,l,u,h,d,p,g,y,b,w,v,S,x,E,I,k=this.width/e,T=this.height/t,_=0,C=e*t*this.components.length;m(C);var A=new Uint8Array(C);switch(this.components.length){case 1:for(n=this.components[0],h=0;h<t;h++)for(a=n.lines[0|h*n.scaleY*T],u=0;u<e;u++)d=a[0|u*n.scaleX*k],A[_++]=d;break;case 2:for(n=this.components[0],r=this.components[1],h=0;h<t;h++)for(a=n.lines[0|h*n.scaleY*T],o=r.lines[0|h*r.scaleY*T],u=0;u<e;u++)d=a[0|u*n.scaleX*k],A[_++]=d,d=o[0|u*r.scaleX*k],A[_++]=d;break;case 3:for(I=!0,this.adobe&&this.adobe.transformCode?I=!0:void 0!==this.opts.colorTransform&&(I=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],h=0;h<t;h++)for(a=n.lines[0|h*n.scaleY*T],o=r.lines[0|h*r.scaleY*T],c=i.lines[0|h*i.scaleY*T],u=0;u<e;u++)I?(d=a[0|u*n.scaleX*k],p=o[0|u*r.scaleX*k],S=f(d+1.402*((g=c[0|u*i.scaleX*k])-128)),x=f(d-.3441363*(p-128)-.71413636*(g-128)),E=f(d+1.772*(p-128))):(S=a[0|u*n.scaleX*k],x=o[0|u*r.scaleX*k],E=c[0|u*i.scaleX*k]),A[_++]=S,A[_++]=x,A[_++]=E;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(I=!1,this.adobe&&this.adobe.transformCode?I=!0:void 0!==this.opts.colorTransform&&(I=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],s=this.components[3],h=0;h<t;h++)for(a=n.lines[0|h*n.scaleY*T],o=r.lines[0|h*r.scaleY*T],c=i.lines[0|h*i.scaleY*T],l=s.lines[0|h*s.scaleY*T],u=0;u<e;u++)I?(d=a[0|u*n.scaleX*k],p=o[0|u*r.scaleX*k],g=c[0|u*i.scaleX*k],y=l[0|u*s.scaleX*k],b=255-f(d+1.402*(g-128)),w=255-f(d-.3441363*(p-128)-.71413636*(g-128)),v=255-f(d+1.772*(p-128))):(b=a[0|u*n.scaleX*k],w=o[0|u*r.scaleX*k],v=c[0|u*i.scaleX*k],y=l[0|u*s.scaleX*k]),A[_++]=255-b,A[_++]=255-w,A[_++]=255-v,A[_++]=255-y;break;default:throw new Error("Unsupported color mode")}return A},copyToImageData:function(e,t){var n,r,i,s,a,o,c,l,u,h=e.width,d=e.height,p=e.data,g=this.getData(h,d),m=0,y=0;switch(this.components.length){case 1:for(r=0;r<d;r++)for(n=0;n<h;n++)i=g[m++],p[y++]=i,p[y++]=i,p[y++]=i,t&&(p[y++]=255);break;case 3:for(r=0;r<d;r++)for(n=0;n<h;n++)c=g[m++],l=g[m++],u=g[m++],p[y++]=c,p[y++]=l,p[y++]=u,t&&(p[y++]=255);break;case 4:for(r=0;r<d;r++)for(n=0;n<h;n++)a=g[m++],o=g[m++],i=g[m++],c=255-f(a*(1-(s=g[m++])/255)+s),l=255-f(o*(1-s/255)+s),u=255-f(i*(1-s/255)+s),p[y++]=c,p[y++]=l,p[y++]=u,t&&(p[y++]=255);break;default:throw new Error("Unsupported color mode")}}};var p=0,g=0;function m(e=0){var t=p+e;if(t>g){var n=Math.ceil((t-g)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${n}MB`)}p=t}return l.resetMaxMemoryUsage=function(e){p=0,g=e},l.getBytesAllocated=function(){return p},l.requestMemoryAllocation=m,l}();e.exports=function(e,t={}){var n={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...t},s=new Uint8Array(e),a=new i;a.opts=n,i.resetMaxMemoryUsage(1024*n.maxMemoryUsageInMB*1024),a.parse(s);var o=n.formatAsRGBA?4:3,c=a.width*a.height*o;try{i.requestMemoryAllocation(c);var l={width:a.width,height:a.height,exifBuffer:a.exifBuffer,data:n.useTArray?new Uint8Array(c):r.alloc(c)};a.comments.length>0&&(l.comments=a.comments)}catch(e){if(e instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+c);if(e instanceof ReferenceError&&"Buffer is not defined"===e.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw e}return a.copyToImageData(l,n.formatAsRGBA),l}},1584:(e,t,n)=>{var r=n(1048).Buffer;function i(e){Math.round;var t,n,i,s,a,o=Math.floor,c=new Array(64),l=new Array(64),u=new Array(64),h=new Array(64),d=new Array(65535),f=new Array(65535),p=new Array(64),g=new Array(64),m=[],y=0,b=7,w=new Array(64),v=new Array(64),S=new Array(64),x=new Array(256),E=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],T=[0,1,2,3,4,5,6,7,8,9,10,11],_=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],C=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],M=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function D(e,t){for(var n=0,r=0,i=new Array,s=1;s<=16;s++){for(var a=1;a<=e[s];a++)i[t[r]]=[],i[t[r]][0]=n,i[t[r]][1]=s,r++,n++;n*=2}return i}function O(e){for(var t=e[0],n=e[1]-1;n>=0;)t&1<<n&&(y|=1<<b),n--,--b<0&&(255==y?(P(255),P(0)):P(y),b=7,y=0)}function P(e){m.push(e)}function N(e){P(e>>8&255),P(255&e)}function L(e,t,n,r,i){for(var s,a=i[0],o=i[240],c=function(e,t){var n,r,i,s,a,o,c,l,u,h,d=0;for(u=0;u<8;++u){n=e[d],r=e[d+1],i=e[d+2],s=e[d+3],a=e[d+4],o=e[d+5],c=e[d+6];var f=n+(l=e[d+7]),g=n-l,m=r+c,y=r-c,b=i+o,w=i-o,v=s+a,S=s-a,x=f+v,E=f-v,I=m+b,k=m-b;e[d]=x+I,e[d+4]=x-I;var T=.707106781*(k+E);e[d+2]=E+T,e[d+6]=E-T;var _=.382683433*((x=S+w)-(k=y+g)),C=.5411961*x+_,A=1.306562965*k+_,F=.707106781*(I=w+y),R=g+F,M=g-F;e[d+5]=M+C,e[d+3]=M-C,e[d+1]=R+A,e[d+7]=R-A,d+=8}for(d=0,u=0;u<8;++u){n=e[d],r=e[d+8],i=e[d+16],s=e[d+24],a=e[d+32],o=e[d+40],c=e[d+48];var D=n+(l=e[d+56]),O=n-l,P=r+c,N=r-c,L=i+o,B=i-o,U=s+a,V=s-a,j=D+U,z=D-U,G=P+L,H=P-L;e[d]=j+G,e[d+32]=j-G;var $=.707106781*(H+z);e[d+16]=z+$,e[d+48]=z-$;var W=.382683433*((j=V+B)-(H=N+O)),q=.5411961*j+W,X=1.306562965*H+W,Y=.707106781*(G=B+N),K=O+Y,J=O-Y;e[d+40]=J+q,e[d+24]=J-q,e[d+8]=K+X,e[d+56]=K-X,d++}for(u=0;u<64;++u)h=e[u]*t[u],p[u]=h>0?h+.5|0:h-.5|0;return p}(e,t),l=0;l<64;++l)g[I[l]]=c[l];var u=g[0]-n;n=g[0],0==u?O(r[0]):(O(r[f[s=32767+u]]),O(d[s]));for(var h=63;h>0&&0==g[h];h--);if(0==h)return O(a),n;for(var m,y=1;y<=h;){for(var b=y;0==g[y]&&y<=h;++y);var w=y-b;if(w>=16){m=w>>4;for(var v=1;v<=m;++v)O(o);w&=15}s=32767+g[y],O(i[(w<<4)+f[s]]),O(d[s]),y++}return 63!=h&&O(a),n}function B(e){e<=0&&(e=1),e>100&&(e=100),a!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=o((t[n]*e+50)/100);r<1?r=1:r>255&&(r=255),c[I[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var a=o((i[s]*e+50)/100);a<1?a=1:a>255&&(a=255),l[I[s]]=a}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var g=0;g<8;g++)u[f]=1/(c[I[f]]*d[p]*d[g]*8),h[f]=1/(l[I[f]]*d[p]*d[g]*8),f++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),a=e)}this.encode=function(e,a){var o;(new Date).getTime(),a&&B(a),m=new Array,y=0,b=7,N(65496),N(65504),N(16),P(74),P(70),P(73),P(70),P(0),P(1),P(1),P(0),N(1),N(1),P(0),P(0),void 0!==(o=e.comments)&&o.constructor===Array&&o.forEach(e=>{if("string"==typeof e){N(65534);var t,n=e.length;for(N(n+2),t=0;t<n;t++)P(e.charCodeAt(t))}}),function(e){if(e){N(65505),69===e[0]&&120===e[1]&&105===e[2]&&102===e[3]?N(e.length+2):(N(e.length+5+2),P(69),P(120),P(105),P(102),P(0));for(var t=0;t<e.length;t++)P(e[t])}}(e.exifBuffer),function(){N(65499),N(132),P(0);for(var e=0;e<64;e++)P(c[e]);P(1);for(var t=0;t<64;t++)P(l[t])}(),function(e,t){N(65472),N(17),P(8),N(t),N(e),P(3),P(1),P(17),P(0),P(2),P(17),P(1),P(3),P(17),P(1)}(e.width,e.height),function(){N(65476),N(418),P(0);for(var e=0;e<16;e++)P(k[e+1]);for(var t=0;t<=11;t++)P(T[t]);P(16);for(var n=0;n<16;n++)P(_[n+1]);for(var r=0;r<=161;r++)P(C[r]);P(1);for(var i=0;i<16;i++)P(A[i+1]);for(var s=0;s<=11;s++)P(F[s]);P(17);for(var a=0;a<16;a++)P(R[a+1]);for(var o=0;o<=161;o++)P(M[o])}(),N(65498),N(12),P(3),P(1),P(0),P(2),P(17),P(3),P(17),P(0),P(63),P(0);var d=0,f=0,p=0;y=0,b=7,this.encode.displayName="_encode_";for(var g,x,I,D,U,V,j,z,G,H=e.data,$=e.width,W=e.height,q=4*$,X=0;X<W;){for(g=0;g<q;){for(V=U=q*X+g,j=-1,z=0,G=0;G<64;G++)V=U+(z=G>>3)*q+(j=4*(7&G)),X+z>=W&&(V-=q*(X+1+z-W)),g+j>=q&&(V-=g+j-q+4),x=H[V++],I=H[V++],D=H[V++],w[G]=(E[x]+E[I+256|0]+E[D+512|0]>>16)-128,v[G]=(E[x+768|0]+E[I+1024|0]+E[D+1280|0]>>16)-128,S[G]=(E[x+1280|0]+E[I+1536|0]+E[D+1792|0]>>16)-128;d=L(w,u,d,t,i),f=L(v,h,f,n,s),p=L(S,h,p,n,s),g+=32}X+=8}if(b>=0){var Y=[];Y[1]=b+1,Y[0]=(1<<b+1)-1,O(Y)}return N(65497),r.from(m)},(new Date).getTime(),e||(e=50),function(){for(var e=String.fromCharCode,t=0;t<256;t++)x[t]=e(t)}(),t=D(k,T),n=D(A,F),i=D(_,C),s=D(R,M),function(){for(var e=1,t=2,n=1;n<=15;n++){for(var r=e;r<t;r++)f[32767+r]=n,d[32767+r]=[],d[32767+r][1]=n,d[32767+r][0]=r;for(var i=-(t-1);i<=-e;i++)f[32767+i]=n,d[32767+i]=[],d[32767+i][1]=n,d[32767+i][0]=t-1+i;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)E[e]=19595*e,E[e+256|0]=38470*e,E[e+512|0]=7471*e+32768,E[e+768|0]=-11059*e,E[e+1024|0]=-21709*e,E[e+1280|0]=32768*e+8421375,E[e+1536|0]=-27439*e,E[e+1792|0]=-5329*e}(),B(e),(new Date).getTime()}e.exports=function(e,t){return void 0===t&&(t=50),{data:new i(t).encode(e,t),width:e.width,height:e.height}}},5005:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loop=t.conditional=t.parse=void 0,t.parse=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:r;if(Array.isArray(n))n.forEach(function(n){return e(t,n,r,i)});else if("function"==typeof n)n(t,r,i,e);else{var s=Object.keys(n)[0];Array.isArray(n[s])?(i[s]={},e(t,n[s],r,i[s])):i[s]=n[s](t,r,i,e)}return r},t.conditional=function(e,t){return function(n,r,i,s){t(n,r,i)&&s(n,e,r,i)}},t.loop=function(e,t){return function(n,r,i,s){for(var a=[],o=n.pos;t(n,r,i);){var c={};if(s(n,e,r,c),n.pos===o)break;o=n.pos,a.push(c)}return a}}},538:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readBits=t.readArray=t.readUnsigned=t.readString=t.peekBytes=t.readBytes=t.peekByte=t.readByte=t.buildStream=void 0,t.buildStream=function(e){return{data:e,pos:0}},t.readByte=function(){return function(e){return e.data[e.pos++]}},t.peekByte=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(t){return t.data[t.pos+e]}};var n=function(e){return function(t){return t.data.subarray(t.pos,t.pos+=e)}};t.readBytes=n,t.peekBytes=function(e){return function(t){return t.data.subarray(t.pos,t.pos+e)}},t.readString=function(e){return function(t){return Array.from(n(e)(t)).map(function(e){return String.fromCharCode(e)}).join("")}},t.readUnsigned=function(e){return function(t){var r=n(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]}},t.readArray=function(e,t){return function(r,i,s){for(var a="function"==typeof t?t(r,i,s):t,o=n(e),c=new Array(a),l=0;l<a;l++)c[l]=o(r);return c}},t.readBits=function(e){return function(t){for(var n=function(e){return e.data[e.pos++]}(t),r=new Array(8),i=0;i<8;i++)r[7-i]=!!(n&1<<i);return Object.keys(e).reduce(function(t,n){var i=e[n];return i.length?t[n]=function(e,t,n){for(var r=0,i=0;i<n;i++)r+=e[t+i]&&Math.pow(2,n-i-1);return r}(r,i.index,i.length):t[n]=r[i.index],t},{})}}},7128:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(5005),i=n(538),s={blocks:function(e){for(var t=[],n=e.data.length,r=0,s=(0,i.readByte)()(e);0!==s&&s;s=(0,i.readByte)()(e)){if(e.pos+s>=n){var a=n-e.pos;t.push((0,i.readBytes)(a)(e)),r+=a;break}t.push((0,i.readBytes)(s)(e)),r+=s}for(var o=new Uint8Array(r),c=0,l=0;l<t.length;l++)o.set(t[l],c),c+=t[l].length;return o}},a=(0,r.conditional)({gce:[{codes:(0,i.readBytes)(2)},{byteSize:(0,i.readByte)()},{extras:(0,i.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,i.readUnsigned)(!0)},{transparentColorIndex:(0,i.readByte)()},{terminator:(0,i.readByte)()}]},function(e){var t=(0,i.peekBytes)(2)(e);return 33===t[0]&&249===t[1]}),o=(0,r.conditional)({image:[{code:(0,i.readByte)()},{descriptor:[{left:(0,i.readUnsigned)(!0)},{top:(0,i.readUnsigned)(!0)},{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{lct:(0,i.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,r.conditional)({lct:(0,i.readArray)(3,function(e,t,n){return Math.pow(2,n.descriptor.lct.size+1)})},function(e,t,n){return n.descriptor.lct.exists}),{data:[{minCodeSize:(0,i.readByte)()},s]}]},function(e){return 44===(0,i.peekByte)()(e)}),c=(0,r.conditional)({text:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{preData:function(e,t,n){return(0,i.readBytes)(n.text.blockSize)(e)}},s]},function(e){var t=(0,i.peekBytes)(2)(e);return 33===t[0]&&1===t[1]}),l=(0,r.conditional)({application:[{codes:(0,i.readBytes)(2)},{blockSize:(0,i.readByte)()},{id:function(e,t,n){return(0,i.readString)(n.blockSize)(e)}},s]},function(e){var t=(0,i.peekBytes)(2)(e);return 33===t[0]&&255===t[1]}),u=(0,r.conditional)({comment:[{codes:(0,i.readBytes)(2)},s]},function(e){var t=(0,i.peekBytes)(2)(e);return 33===t[0]&&254===t[1]}),h=[{header:[{signature:(0,i.readString)(3)},{version:(0,i.readString)(3)}]},{lsd:[{width:(0,i.readUnsigned)(!0)},{height:(0,i.readUnsigned)(!0)},{gct:(0,i.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,i.readByte)()},{pixelAspectRatio:(0,i.readByte)()}]},(0,r.conditional)({gct:(0,i.readArray)(3,function(e,t){return Math.pow(2,t.lsd.gct.size+1)})},function(e,t){return t.lsd.gct.exists}),{frames:(0,r.loop)([a,l,u,o,c],function(e){var t=(0,i.peekByte)()(e);return 33===t||44===t})}];t.default=h},1182:e=>{var t=Object.prototype.toString;function n(e){return"function"==typeof e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var r=typeof e;if("boolean"===r)return"boolean";if("string"===r)return"string";if("number"===r)return"number";if("symbol"===r)return"symbol";if("function"===r)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){return!(!e.constructor||"function"!=typeof e.constructor.isBuffer)&&e.constructor.isBuffer(e)}(e))return"buffer";if(function(e){try{if("number"==typeof e.length&&"function"==typeof e.callee)return!0}catch(e){if(-1!==e.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"==typeof e.flags&&"boolean"==typeof e.ignoreCase&&"boolean"==typeof e.multiline&&"boolean"==typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"==typeof e.throw&&"function"==typeof e.return&&"function"==typeof e.next}(e))return"generator";switch(r=t.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")}},2507:function(e,t){var n,r;void 0===(r="function"==typeof(n=function(){"use strict";function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var n={},r={};function i(e,t){var i,s,o;return t?(o=0<=(e>>>=0)&&e<256)&&(s=r[e])?s:(i=a(e,(0|e)<0?-1:0,!0),o&&(r[e]=i),i):(o=-128<=(e|=0)&&e<128)&&(s=n[e])?s:(i=a(e,e<0?-1:0,!1),o&&(n[e]=i),i)}function s(e,t){if(isNaN(e)||!isFinite(e))return t?g:p;if(t){if(e<0)return g;if(e>=h)return v}else{if(e<=-d)return S;if(e+1>=d)return w}return e<0?s(-e,t).neg():a(e%u|0,e/u|0,t)}function a(t,n,r){return new e(t,n,r)}e.fromInt=i,e.fromNumber=s,e.fromBits=a;var o=Math.pow;function c(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return p;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return c(e.substring(1),t,n).neg();for(var i=s(o(n,8)),a=p,l=0;l<e.length;l+=8){var u=Math.min(8,e.length-l),h=parseInt(e.substring(l,l+u),n);if(u<8){var d=s(o(n,u));a=a.mul(d).add(s(h))}else a=(a=a.mul(i)).add(s(h))}return a.unsigned=t,a}function l(t){return t instanceof e?t:"number"==typeof t?s(t):"string"==typeof t?c(t):a(t.low,t.high,t.unsigned)}e.fromString=c,e.fromValue=l;var u=4294967296,h=u*u,d=h/2,f=i(1<<24),p=i(0);e.ZERO=p;var g=i(0,!0);e.UZERO=g;var m=i(1);e.ONE=m;var y=i(1,!0);e.UONE=y;var b=i(-1);e.NEG_ONE=b;var w=a(-1,2147483647,!1);e.MAX_VALUE=w;var v=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=v;var S=a(0,-2147483648,!1);e.MIN_VALUE=S;var x=e.prototype;return x.toInt=function(){return this.unsigned?this.low>>>0:this.low},x.toNumber=function(){return this.unsigned?(this.high>>>0)*u+(this.low>>>0):this.high*u+(this.low>>>0)},x.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=s(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=s(o(e,6),this.unsigned),a=this,c="";;){var l=a.div(i),u=(a.sub(l.mul(i)).toInt()>>>0).toString(e);if((a=l).isZero())return u+c;for(;u.length<6;)u="0"+u;c=""+u+c}},x.getHighBits=function(){return this.high},x.getHighBitsUnsigned=function(){return this.high>>>0},x.getLowBits=function(){return this.low},x.getLowBitsUnsigned=function(){return this.low>>>0},x.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return 0!=this.high?t+33:t+1},x.isZero=function(){return 0===this.high&&0===this.low},x.isNegative=function(){return!this.unsigned&&this.high<0},x.isPositive=function(){return this.unsigned||this.high>=0},x.isOdd=function(){return!(1&~this.low)},x.isEven=function(){return!(1&this.low)},x.equals=function(e){return t(e)||(e=l(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},x.eq=x.equals,x.notEquals=function(e){return!this.eq(e)},x.neq=x.notEquals,x.lessThan=function(e){return this.comp(e)<0},x.lt=x.lessThan,x.lessThanOrEqual=function(e){return this.comp(e)<=0},x.lte=x.lessThanOrEqual,x.greaterThan=function(e){return this.comp(e)>0},x.gt=x.greaterThan,x.greaterThanOrEqual=function(e){return this.comp(e)>=0},x.gte=x.greaterThanOrEqual,x.compare=function(e){if(t(e)||(e=l(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},x.comp=x.compare,x.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(m)},x.neg=x.negate,x.add=function(e){t(e)||(e=l(e));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,s=65535&this.low,o=e.high>>>16,c=65535&e.high,u=e.low>>>16,h=0,d=0,f=0,p=0;return f+=(p+=s+(65535&e.low))>>>16,d+=(f+=i+u)>>>16,h+=(d+=r+c)>>>16,h+=n+o,a((f&=65535)<<16|(p&=65535),(h&=65535)<<16|(d&=65535),this.unsigned)},x.subtract=function(e){return t(e)||(e=l(e)),this.add(e.neg())},x.sub=x.subtract,x.multiply=function(e){if(this.isZero())return p;if(t(e)||(e=l(e)),e.isZero())return p;if(this.eq(S))return e.isOdd()?S:p;if(e.eq(S))return this.isOdd()?S:p;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f)&&e.lt(f))return s(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,u=65535&e.high,h=e.low>>>16,d=65535&e.low,g=0,m=0,y=0,b=0;return y+=(b+=o*d)>>>16,m+=(y+=i*d)>>>16,y&=65535,m+=(y+=o*h)>>>16,g+=(m+=r*d)>>>16,m&=65535,g+=(m+=i*h)>>>16,m&=65535,g+=(m+=o*u)>>>16,g+=n*d+r*h+i*u+o*c,a((y&=65535)<<16|(b&=65535),(g&=65535)<<16|(m&=65535),this.unsigned)},x.mul=x.multiply,x.divide=function(e){if(t(e)||(e=l(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:p;var n,r,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return y;i=g}else{if(this.eq(S))return e.eq(m)||e.eq(b)?S:e.eq(S)?m:(n=this.shr(1).div(e).shl(1)).eq(p)?e.isNegative()?m:b:(r=this.sub(e.mul(n)),i=n.add(r.div(e)));if(e.eq(S))return this.unsigned?g:p;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=p}for(r=this;r.gte(e);){n=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),c=a<=48?1:o(2,a-48),u=s(n),h=u.mul(e);h.isNegative()||h.gt(r);)h=(u=s(n-=c,this.unsigned)).mul(e);u.isZero()&&(u=m),i=i.add(u),r=r.sub(h)}return i},x.div=x.divide,x.modulo=function(e){return t(e)||(e=l(e)),this.sub(this.div(e).mul(e))},x.mod=x.modulo,x.not=function(){return a(~this.low,~this.high,this.unsigned)},x.and=function(e){return t(e)||(e=l(e)),a(this.low&e.low,this.high&e.high,this.unsigned)},x.or=function(e){return t(e)||(e=l(e)),a(this.low|e.low,this.high|e.high,this.unsigned)},x.xor=function(e){return t(e)||(e=l(e)),a(this.low^e.low,this.high^e.high,this.unsigned)},x.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?a(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):a(0,this.low<<e-32,this.unsigned)},x.shl=x.shiftLeft,x.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?a(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):a(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},x.shr=x.shiftRight,x.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),0==(e&=63))return this;var n=this.high;return e<32?a(this.low>>>e|n<<32-e,n>>>e,this.unsigned):a(32===e?n:n>>>e-32,0,this.unsigned)},x.shru=x.shiftRightUnsigned,x.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},x.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},x.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},x.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24&255,255&e,e>>>8&255,e>>>16&255,e>>>24&255]},x.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t]},e})?n.apply(t,[]):n)||(e.exports=r)},6343:e=>{"use strict";var t=Object.prototype.hasOwnProperty;function n(e){this.__data__=e||{}}e.exports=n,n.prototype.set=function(e,t){return"__proto__"!==e&&(this.__data__[e]=t),this},n.prototype.get=function(e){return"__proto__"===e?void 0:this.__data__[e]},n.prototype.has=function(e){return"__proto__"!==e&&t.call(this.__data__,e)},n.prototype.del=function(e){return this.has(e)&&delete this.__data__[e]}},6094:(e,t,n)=>{"use strict";var r=n(9208),i=n(9535);function s(e){return e&&("function"==typeof e||!Array.isArray(e)&&"object"==typeof e)}e.exports=function(e,t,n){if(s(n))return i.apply(null,arguments);if(!Array.isArray(n))throw new TypeError("expected an array: "+r.inspect(n));for(var a=[].slice.call(arguments,3),o=0;o<n.length;o++){var c=n[o];s(c)?i.apply(null,[e,t,c].concat(a)):e[t].apply(e,[c].concat(a))}}},8479:e=>{"use strict";e.exports=Math.abs},8449:e=>{"use strict";e.exports=Math.floor},2422:e=>{"use strict";e.exports=Number.isNaN||function(e){return e!=e}},8129:e=>{"use strict";e.exports=Math.max},2387:e=>{"use strict";e.exports=Math.min},5865:e=>{"use strict";e.exports=Math.pow},1319:e=>{"use strict";e.exports=Math.round},6882:(e,t,n)=>{"use strict";var r=n(2422);e.exports=function(e){return r(e)||0===e?e:e<0?-1:1}},3275:(e,t,n)=>{"use strict";var r=n(5615),i=n(1848),s=n(5636).Buffer,a=new Array(16);function o(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function c(e,t){return e<<t|e>>>32-t}function l(e,t,n,r,i,s,a){return c(e+(t&n|~t&r)+i+s|0,a)+t|0}function u(e,t,n,r,i,s,a){return c(e+(t&r|n&~r)+i+s|0,a)+t|0}function h(e,t,n,r,i,s,a){return c(e+(t^n^r)+i+s|0,a)+t|0}function d(e,t,n,r,i,s,a){return c(e+(n^(t|~r))+i+s|0,a)+t|0}r(o,i),o.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,r=this._b,i=this._c,s=this._d;n=l(n,r,i,s,e[0],3614090360,7),s=l(s,n,r,i,e[1],3905402710,12),i=l(i,s,n,r,e[2],606105819,17),r=l(r,i,s,n,e[3],3250441966,22),n=l(n,r,i,s,e[4],4118548399,7),s=l(s,n,r,i,e[5],1200080426,12),i=l(i,s,n,r,e[6],2821735955,17),r=l(r,i,s,n,e[7],4249261313,22),n=l(n,r,i,s,e[8],1770035416,7),s=l(s,n,r,i,e[9],2336552879,12),i=l(i,s,n,r,e[10],4294925233,17),r=l(r,i,s,n,e[11],2304563134,22),n=l(n,r,i,s,e[12],1804603682,7),s=l(s,n,r,i,e[13],4254626195,12),i=l(i,s,n,r,e[14],2792965006,17),n=u(n,r=l(r,i,s,n,e[15],1236535329,22),i,s,e[1],4129170786,5),s=u(s,n,r,i,e[6],3225465664,9),i=u(i,s,n,r,e[11],643717713,14),r=u(r,i,s,n,e[0],3921069994,20),n=u(n,r,i,s,e[5],3593408605,5),s=u(s,n,r,i,e[10],38016083,9),i=u(i,s,n,r,e[15],3634488961,14),r=u(r,i,s,n,e[4],3889429448,20),n=u(n,r,i,s,e[9],568446438,5),s=u(s,n,r,i,e[14],3275163606,9),i=u(i,s,n,r,e[3],4107603335,14),r=u(r,i,s,n,e[8],1163531501,20),n=u(n,r,i,s,e[13],2850285829,5),s=u(s,n,r,i,e[2],4243563512,9),i=u(i,s,n,r,e[7],1735328473,14),n=h(n,r=u(r,i,s,n,e[12],2368359562,20),i,s,e[5],4294588738,4),s=h(s,n,r,i,e[8],2272392833,11),i=h(i,s,n,r,e[11],1839030562,16),r=h(r,i,s,n,e[14],4259657740,23),n=h(n,r,i,s,e[1],2763975236,4),s=h(s,n,r,i,e[4],1272893353,11),i=h(i,s,n,r,e[7],4139469664,16),r=h(r,i,s,n,e[10],3200236656,23),n=h(n,r,i,s,e[13],681279174,4),s=h(s,n,r,i,e[0],3936430074,11),i=h(i,s,n,r,e[3],3572445317,16),r=h(r,i,s,n,e[6],76029189,23),n=h(n,r,i,s,e[9],3654602809,4),s=h(s,n,r,i,e[12],3873151461,11),i=h(i,s,n,r,e[15],530742520,16),n=d(n,r=h(r,i,s,n,e[2],3299628645,23),i,s,e[0],4096336452,6),s=d(s,n,r,i,e[7],1126891415,10),i=d(i,s,n,r,e[14],2878612391,15),r=d(r,i,s,n,e[5],4237533241,21),n=d(n,r,i,s,e[12],1700485571,6),s=d(s,n,r,i,e[3],2399980690,10),i=d(i,s,n,r,e[10],4293915773,15),r=d(r,i,s,n,e[1],2240044497,21),n=d(n,r,i,s,e[8],1873313359,6),s=d(s,n,r,i,e[15],4264355552,10),i=d(i,s,n,r,e[6],2734768916,15),r=d(r,i,s,n,e[13],1309151649,21),n=d(n,r,i,s,e[4],4149444226,6),s=d(s,n,r,i,e[11],3174756917,10),i=d(i,s,n,r,e[2],718787259,15),r=d(r,i,s,n,e[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+s|0},o.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=s.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=o},1929:(e,t,n)=>{var r=n(2823),i=n(7048);function s(e){this.rand=e||new i.Rand}e.exports=s,s.create=function(e){return new s(e)},s.prototype._randbelow=function(e){var t=e.bitLength(),n=Math.ceil(t/8);do{var i=new r(this.rand.generate(n))}while(i.cmp(e)>=0);return i},s.prototype._randrange=function(e,t){var n=t.sub(e);return e.add(this._randbelow(n))},s.prototype.test=function(e,t,n){var i=e.bitLength(),s=r.mont(e),a=new r(1).toRed(s);t||(t=Math.max(1,i/48|0));for(var o=e.subn(1),c=0;!o.testn(c);c++);for(var l=e.shrn(c),u=o.toRed(s);t>0;t--){var h=this._randrange(new r(2),o);n&&n(h);var d=h.toRed(s).redPow(l);if(0!==d.cmp(a)&&0!==d.cmp(u)){for(var f=1;f<c;f++){if(0===(d=d.redSqr()).cmp(a))return!1;if(0===d.cmp(u))break}if(f===c)return!1}}return!0},s.prototype.getDivisor=function(e,t){var n=e.bitLength(),i=r.mont(e),s=new r(1).toRed(i);t||(t=Math.max(1,n/48|0));for(var a=e.subn(1),o=0;!a.testn(o);o++);for(var c=e.shrn(o),l=a.toRed(i);t>0;t--){var u=this._randrange(new r(2),a),h=e.gcd(u);if(0!==h.cmpn(1))return h;var d=u.toRed(i).redPow(c);if(0!==d.cmp(s)&&0!==d.cmp(l)){for(var f=1;f<o;f++){if(0===(d=d.redSqr()).cmp(s))return d.fromRed().subn(1).gcd(e);if(0===d.cmp(l))break}if(f===o)return(d=d.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},7784:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}},9042:(e,t)=>{"use strict";var n=t;function r(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",n=0;n<e.length;n++)t+=r(e[n].toString(16));return t}n.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16));else for(r=0;r<e.length;r++){var i=e.charCodeAt(r),s=i>>8,a=255&i;s?n.push(s,a):n.push(a)}return n},n.zero2=r,n.toHex=i,n.encode=function(e,t){return"hex"===t?i(e):e}},8636:(e,t,n)=>{"use strict";var r=n(5433),i=n(7091);function s(e,t){for(var n=arguments.length,r=0;++r<n;){var s=arguments[r];o(s)&&i(s,a,e)}return e}function a(e,t){if(function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}(t)){var n=this[t];o(e)&&o(n)?s(n,e):this[t]=e}}function o(e){return r(e)&&!Array.isArray(e)}e.exports=s},1858:function(e,t,n){var r,i,s;!function(){"use strict";i=[t,n(9031)],void 0!==(s="function"==typeof(r=function(e,t){var n={AENC:"Audio encryption",APIC:"Attached picture",CHAP:"Chapter",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVAD:"Relative volume adjustment",RVRB:"Reverb",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMED:"Media type",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"},r={T:function(e,n,r){var i={encoding:e.getUint8(n)};return i.value=t.readStr[0===i.encoding?"iso":"ucs"](e,n+1,r-1),i},TXXX:function(e,n,r){var i={encoding:e.getUint8(n)};if(r<2)return i;var s=0===i.encoding?"iso":"ucs",a=n+1,o=t.locateStrTrm[s](e,a,r-4);return-1===o||(i.description=t.readStr[s](e,a,o-a),o+="ucs"===s?2:1,i.value=t.readStr[s](e,o,n+r-o)),i},W:function(e,n,r){return{value:t.readStr.iso(e,n,r)}},WXXX:function(e,n,r){var i={encoding:e.getUint8(n)};if(r<2)return i;var s=0===i.encoding?"iso":"ucs",a=n+1,o=t.locateStrTrm[s](e,a,r-4);return-1===o||(i.description=t.readStr[s](e,a,o-a),o+="ucs"===s?2:1,i.value=t.readStr.iso(e,o,n+r-o)),i},COMM:function(e,n,r){var i={encoding:e.getUint8(n)};if(r<5)return i;var s=0===i.encoding?"iso":"ucs",a=n+4;i.language=t.readTrmStr.iso(e,n+1,3);var o=t.locateStrTrm[s](e,a,r-4);return-1===o||(i.description=t.readStr[s](e,a,o-a),o+="ucs"===s?2:1,i.text=t.readStr[s](e,o,n+r-o)),i},UFID:function(e,n,r){var i=t.readTrmStr.iso(e,n,r);return{ownerIdentifier:i,identifier:new DataView(e.buffer,n+i.length+1,r-i.length-1)}},IPLS:function(e,n,r){for(var i,s={encoding:e.getUint8(n),values:[]},a=0===s.encoding?"iso":"ucs",o=n+1;o<n+r;)-1===(i=t.locateStrTrm[a](e,o,r-(o-n)))&&(i=n+r),s.values.push(t.readStr[a](e,o,i-o)),o=i+("ucs"===a?2:1);return s},USER:function(e,n,r){var i={encoding:e.getUint8(n)};if(r<5)return i;i.language=t.readTrmStr.iso(e,n+1,3);var s=n+4,a=0===i.encoding?"iso":"ucs";return i.text=t.readStr[a](e,s,n+r-s),i},PRIV:function(e,n,r){var i=t.readTrmStr.iso(e,n,r);return{ownerIdentifier:i,privateData:new DataView(e.buffer,n+i.length+1,r-i.length-1)}},PCNT:function(e,t,n){return n<4?{}:{counter:e.getUint32(t)}},POPM:function(e,n,r){var i={email:t.readTrmStr.iso(e,n,r)};return n+=i.email.length+1,r<6||(i.rating=e.getUint8(n),i.counter=e.getUint32(n+1)),i},APIC:function(e,n,r){var i={encoding:e.getUint8(n)};if(r<4)return i;var s,a,o=0===i.encoding?"iso":"ucs";return s=n+1,-1===(a=t.locateStrTrm.iso(e,s,r-1))||(i.mimeType=t.readStr.iso(e,s,a-s),s=a+1,i.pictureType=e.getUint8(s),s+=1,-1===(a=t.locateStrTrm[o](e,s,n+r-s))||(i.description=t.readStr[o](e,s,a-s),s=a+("ucs"===o?2:1),i.pictureData=new DataView(e.buffer,s,n+r-s))),i},CHAP:function(n,r,i){var s={encoding:n.getUint8(r)},a=t.locateStrTrm.iso(n,r,i-1);if(-1===a)return s;s.id=t.readStr.iso(n,r,a-r),s.startTime=n.getUint32(a+1),s.endTime=n.getUint32(a+5),s.startOffset=n.getUint32(a+9),s.endOffset=n.getUint32(a+13);var o=a+17;for(s.frames=[];o<r+i;){var c=e.readId3v2TagFrame(n,o);s.frames.push(c),o+=c.header.size+10}return s}};e.readId3v2TagFrame=function(e,i){var s={header:{id:t.readStr.iso(e,i,4),size:e.getUint32(i+4),flagsOctet1:e.getUint8(i+8),flagsOctet2:e.getUint8(i+9)}};if(s.header.size<1)return s;var a,o,c=(a=r,"TXXX"===(o=s.header.id)?a.TXXX:"T"===o.charAt(0)?a.T:"WXXX"===o?a.WXXX:"W"===o.charAt(0)?a.W:"COMM"===o||"USLT"===o?a.COMM:a[o]||t.noOp);return s.name=n[s.header.id],s.content=c(e,i+10,s.header.size),s},e.readId3v2Tag=function(n,r){if(r||(r=0),n.byteLength-r<10)return null;if(!t.isSeq(t.seq.id3,n,r))return null;var i=n.getUint8(r+5),s={_section:{type:"ID3v2",offset:r},header:{majorVersion:n.getUint8(r+3),minorRevision:n.getUint8(r+4),flagsOctet:i,unsynchronisationFlag:!(128&~i),extendedHeaderFlag:!(64&~i),experimentalIndicatorFlag:!(32&~i),size:t.unsynchsafe(n.getUint32(r+6))},frames:[]};s._section.byteLength=s.header.size+10;var a,o=r+s._section.byteLength;if(3!==s.header.majorVersion)return s;for(r+=10;r<o&&0!==n.getUint32(r)&&(a=e.readId3v2TagFrame(n,r));)s.frames.push(a),r+=a.header.size+10;return s}})?r.apply(t,i):r)&&(e.exports=s)}()},9031:function(e,t){var n,r,i;!function(){"use strict";r=[t],void 0!==(i="function"==typeof(n=function(e){var t,n=(t=[],function(e){return t[0]=128&~e?"0":"1",t[1]=64&~e?"0":"1",t[2]=32&~e?"0":"1",t[3]=16&~e?"0":"1",t[4]=8&~e?"0":"1",t[5]=4&~e?"0":"1",t[6]=2&~e?"0":"1",t[7]=1&~e?"0":"1",t.join("")});e.getFrameByteLength=function(t,n,r,i,s){var a=e.sampleLengthMap[i][s],o=r?"11"===s?4:1:0,c=1e3*t/8;return Math.floor(a*c/n+o)},e.getXingOffset=function(e,t){var n="11"===t;return"11"===e?n?21:36:n?13:21},e.v1l1Bitrates={"0000":"free","0001":32,"0010":64,"0011":96,"0100":128,"0101":160,"0110":192,"0111":224,1e3:256,1001:288,1010:320,1011:352,1100:384,1101:416,1110:448,1111:"bad"},e.v1l2Bitrates={"0000":"free","0001":32,"0010":48,"0011":56,"0100":64,"0101":80,"0110":96,"0111":112,1e3:128,1001:160,1010:192,1011:224,1100:256,1101:320,1110:384,1111:"bad"},e.v1l3Bitrates={"0000":"free","0001":32,"0010":40,"0011":48,"0100":56,"0101":64,"0110":80,"0111":96,1e3:112,1001:128,1010:160,1011:192,1100:224,1101:256,1110:320,1111:"bad"},e.v2l1Bitrates={"0000":"free","0001":32,"0010":48,"0011":56,"0100":64,"0101":80,"0110":96,"0111":112,1e3:128,1001:144,1010:160,1011:176,1100:192,1101:224,1110:256,1111:"bad"},e.v2l2Bitrates={"0000":"free","0001":8,"0010":16,"0011":24,"0100":32,"0101":40,"0110":48,"0111":56,1e3:64,1001:80,1010:96,1011:112,1100:128,1101:144,1110:160,1111:"bad"},e.v2l3Bitrates=e.v2l2Bitrates,e.v1SamplingRates={"00":44100,"01":48e3,10:32e3,11:"reserved"},e.v2SamplingRates={"00":22050,"01":24e3,10:16e3,11:"reserved"},e.v25SamplingRates={"00":11025,"01":12e3,10:8e3,11:"reserved"},e.channelModes={"00":"Stereo","01":"Joint stereo (Stereo)",10:"Dual channel (Stereo)",11:"Single channel (Mono)"},e.mpegVersionDescription={"00":"MPEG Version 2.5 (unofficial)","01":"reserved",10:"MPEG Version 2 (ISO/IEC 13818-3)",11:"MPEG Version 1 (ISO/IEC 11172-3)"},e.layerDescription={"00":"reserved","01":"Layer III",10:"Layer II",11:"Layer I"},e.bitrateMap={11:{"01":e.v1l3Bitrates,10:e.v1l2Bitrates,11:e.v1l1Bitrates},10:{"01":e.v2l3Bitrates,10:e.v2l2Bitrates,11:e.v2l1Bitrates}},e.samplingRateMap={"00":e.v25SamplingRates,10:e.v2SamplingRates,11:e.v1SamplingRates},e.v1SampleLengths={"01":1152,10:1152,11:384},e.v2SampleLengths={"01":576,10:1152,11:384},e.sampleLengthMap={"01":e.v2SampleLengths,10:e.v2SampleLengths,11:e.v1SampleLengths},e.wordSeqFromStr=function(e){for(var t=e.length-1,n=[];t>=0;--t)n[t]=e.charCodeAt(t);return n},e.seq={id3:e.wordSeqFromStr("ID3"),xing:e.wordSeqFromStr("Xing"),info:e.wordSeqFromStr("Info")},e.noOp=function(){},e.unsynchsafe=function(e){for(var t=0,n=2130706432;n;)t>>=1,t|=e&n,n>>=8;return t},e.isSeq=function(e,t,n){for(var r=e.length-1;r>=0;r--)if(e[r]!==t.getUint8(n+r))return!1;return!0},e.locateSeq=function(t,n,r,i){for(var s=0,a=i-t.length+1;s<a;++s)if(e.isSeq(t,n,r+s))return r+s;return-1},e.locateStrTrm={iso:function(t,n,r){return e.locateSeq([0],t,n,r)},ucs:function(t,n,r){var i=e.locateSeq([0,0],t,n,r);return-1===i?-1:((i-n)%2!=0&&++i,i)}},e.readStr={iso:function(e,t,n){return String.fromCharCode.apply(null,new Uint8Array(e.buffer,t,n))},ucs:function(e,t,n){65534!==e.getUint16(t)&&65279!==e.getUint16(t)||(t+=2,n-=2);var r=e.buffer;return t%2==1&&(r=r.slice(t,t+n),t=0),String.fromCharCode.apply(null,new Uint16Array(r,t,n/2))}},e.readTrmStr={iso:function(t,n,r){var i=e.locateStrTrm.iso(t,n,r);return-1!==i&&(r=i-n),e.readStr.iso(t,n,r)},ucs:function(t,n,r){var i=e.locateStrTrm.ucs(t,n,r);return-1!==i&&(r=i-n),e.readStr.ucs(t,n,r)}},e.readFrameHeader=function(t,r){if(r||(r=0),t.byteLength-r<=4)return null;if(255!==t.getUint8(r))return null;var i=t.getUint8(r+1);if(i<224)return null;var s=n(i).substr(3,2),a=n(i).substr(5,2),o={_section:{type:"frameHeader",byteLength:4,offset:r},mpegAudioVersionBits:s,mpegAudioVersion:e.mpegVersionDescription[s],layerDescriptionBits:a,layerDescription:e.layerDescription[a],isProtected:1&i};if(o.protectionBit=o.isProtected?"1":"0","reserved"===o.mpegAudioVersion)return null;if("reserved"===o.layerDescription)return null;var c=t.getUint8(r+2);if(c=n(c),o.bitrateBits=c.substr(0,4),o.bitrate=e.bitrateMap[s][a][o.bitrateBits],"bad"===o.bitrate)return null;if(o.samplingRateBits=c.substr(4,2),o.samplingRate=e.samplingRateMap[s][o.samplingRateBits],"reserved"===o.samplingRate)return null;o.frameIsPaddedBit=c.substr(6,1),o.frameIsPadded="1"===o.frameIsPaddedBit,o.framePadding=o.frameIsPadded?1:0,o.privateBit=c.substr(7,1);var l=t.getUint8(r+3);return o.channelModeBits=n(l).substr(0,2),o.channelMode=e.channelModes[o.channelModeBits],o},e.readFrame=function(t,n,r){n||(n=0);var i={_section:{type:"frame",offset:n},header:e.readFrameHeader(t,n)},s=i.header;if(!s)return null;i._section.sampleLength=e.sampleLengthMap[s.mpegAudioVersionBits][s.layerDescriptionBits],i._section.byteLength=e.getFrameByteLength(s.bitrate,s.samplingRate,s.framePadding,s.mpegAudioVersionBits,s.layerDescriptionBits),i._section.nextFrameIndex=n+i._section.byteLength;var a=e.getXingOffset(s.mpegAudioVersionBits,s.channelModeBits);return e.isSeq(e.seq.xing,t,n+a)||e.isSeq(e.seq.info,t,n+a)||r&&!e.readFrameHeader(t,i._section.nextFrameIndex)?null:i}})?n.apply(t,r):n)&&(e.exports=i)}()},3918:function(e,t,n){var r,i,s;!function(){"use strict";i=[t,n(9031)],void 0!==(s="function"==typeof(r=function(e,t){e.readXingTag=function(e,n){n||(n=0);var r={_section:{type:"Xing",offset:n},header:t.readFrameHeader(e,n)},i=r.header;if(!i)return null;var s=n+t.getXingOffset(i.mpegAudioVersionBits,i.channelModeBits);return e.byteLength<s+4?null:(r.identifier=t.isSeq(t.seq.xing,e,s)?"Xing":t.isSeq(t.seq.info,e,s)&&"Info",r.identifier?(r._section.byteLength=t.getFrameByteLength(i.bitrate,i.samplingRate,i.framePadding,i.mpegAudioVersionBits,i.layerDescriptionBits),r._section.nextFrameIndex=n+r._section.byteLength,r):null)}})?r.apply(t,i):r)&&(e.exports=s)}()},5007:function(e,t,n){var r,i,s;!function(){"use strict";i=[t,n(9031),n(1858),n(3918)],void 0!==(s="function"==typeof(r=function(e,t,n,r){e.readFrameHeader=function(e,n){return t.readFrameHeader(e,n)},e.readFrame=function(e,n,r){return t.readFrame(e,n,r)},e.readLastFrame=function(t,n,r){n||(n=t.byteLength-1);for(var i=null;n>=0;--n)if(255===t.getUint8(n)&&(i=e.readFrame(t,n,r)))return i;return null},e.readId3v2Tag=function(e,t){return n.readId3v2Tag(e,t)},e.readXingTag=function(e,t){return r.readXingTag(e,t)},e.readTags=function(t,n){n||(n=0);for(var r=[],i=null,s=!1,a=t.byteLength,o=[e.readId3v2Tag,e.readXingTag,e.readFrame],c=o.length;n<a&&!s;++n)for(var l=0;l<c;++l)if(i=o[l](t,n)){if(r.push(i),n+=i._section.byteLength,"frame"===i._section.type){s=!0;break}l=-1}return r}})?r.apply(t,i):r)&&(e.exports=s)}()},7250:e=>{var t=1e3,n=60*t,r=60*n,i=24*r,s=7*i;function a(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,o){o=o||{};var c,l,u=typeof e;if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var o=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return o*s;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*r;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===u&&isFinite(e))return o.long?(c=e,(l=Math.abs(c))>=i?a(c,l,i,"day"):l>=r?a(c,l,r,"hour"):l>=n?a(c,l,n,"minute"):l>=t?a(c,l,t,"second"):c+" ms"):function(e){var s=Math.abs(e);return s>=i?Math.round(e/i)+"d":s>=r?Math.round(e/r)+"h":s>=n?Math.round(e/n)+"m":s>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6649:(e,t,n)=>{"use strict";var r=n(9208),i=n(5629),s=n(1743),a=n(2575),o=n(7429),c=n(8207),l=n(7452);function u(e,t,n){t=l.arrayify(t),e=l.arrayify(e);var r=t.length;if(0===e.length||0===r)return[];if(1===r)return u.match(e,t[0],n);for(var i=!1,s=[],a=[],o=-1;++o<r;){var c=t[o];"string"==typeof c&&33===c.charCodeAt(0)?(s.push.apply(s,u.match(e,c.slice(1),n)),i=!0):a.push.apply(a,u.match(e,c,n))}if(i&&0===a.length)if(n&&!1===n.unixify)a=e.slice();else for(var h=l.unixify(n),d=0;d<e.length;d++)a.push(h(e[d]));var f=l.diff(a,s);return n&&!1===n.nodupes?f:l.unique(f)}function h(e,t,n,r){var i=l.createKey(e+"="+t,n);if(n&&!1===n.cache)return r(t,n);if(c.has(e,i))return c.get(e,i);var s=r(t,n);return c.set(e,i,s),s}u.match=function(e,t,n){if(Array.isArray(t))throw new TypeError("expected pattern to be a string");for(var r=l.unixify(n),i=h("match",t,n,u.matcher),s=[],a=(e=l.arrayify(e)).length,o=-1;++o<a;){var c=e[o];(c===t||i(c))&&s.push(l.value(c,r,n))}if(void 0===n)return l.unique(s);if(0===s.length){if(!0===n.failglob)throw new Error('no matches found for "'+t+'"');if(!0===n.nonull||!0===n.nullglob)return[n.unescape?l.unescape(t):t]}return n.ignore&&(s=u.not(s,n.ignore,n)),!1!==n.nodupes?l.unique(s):s},u.isMatch=function(e,t,n){if("string"!=typeof e)throw new TypeError('expected a string: "'+r.inspect(e)+'"');return!l.isEmptyString(e)&&!l.isEmptyString(t)&&(!!l.equalsPattern(n)(e)||h("isMatch",t,n,u.matcher)(e))},u.some=function(e,t,n){"string"==typeof e&&(e=[e]);for(var r=0;r<e.length;r++)if(1===u(e[r],t,n).length)return!0;return!1},u.every=function(e,t,n){"string"==typeof e&&(e=[e]);for(var r=0;r<e.length;r++)if(1!==u(e[r],t,n).length)return!1;return!0},u.any=function(e,t,n){if("string"!=typeof e)throw new TypeError('expected a string: "'+r.inspect(e)+'"');if(l.isEmptyString(e)||l.isEmptyString(t))return!1;"string"==typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(u.isMatch(e,t[i],n))return!0;return!1},u.all=function(e,t,n){if("string"!=typeof e)throw new TypeError('expected a string: "'+r.inspect(e)+'"');"string"==typeof t&&(t=[t]);for(var i=0;i<t.length;i++)if(!u.isMatch(e,t[i],n))return!1;return!0},u.not=function(e,t,n){var r=s({},n),i=r.ignore;delete r.ignore,e=l.arrayify(e);var a=l.diff(e,u(e,t,r));return i&&(a=l.diff(a,u(e,i))),!1!==r.nodupes?l.unique(a):a},u.contains=function(e,t,n){if("string"!=typeof e)throw new TypeError('expected a string: "'+r.inspect(e)+'"');if("string"==typeof t){if(l.isEmptyString(e)||l.isEmptyString(t))return!1;if(l.equalsPattern(t,n)(e))return!0;if(l.containsPattern(t,n)(e))return!0}var i=s({},n,{contains:!0});return u.any(e,t,i)},u.matchBase=function(e,t){return!(e&&-1!==e.indexOf("/")||!t||!0!==t.basename&&!0!==t.matchBase)},u.matchKeys=function(e,t,n){if(!l.isObject(e))throw new TypeError("expected the first argument to be an object");var r=u(Object.keys(e),t,n);return l.pick(e,r)},u.matcher=function e(t,n){if(l.isEmptyString(t))return function(){return!1};if(Array.isArray(t))return function(e,t,n){var r;return h("compose",String(e),t,function(){return function(i){if(!r){r=[];for(var s=0;s<e.length;s++)r.push(n(e[s],t))}for(var a=r.length;a--;)if(!0===r[a](i))return!0;return!1}})}(t,n,e);if(t instanceof RegExp)return i(t);if(!l.isString(t))throw new TypeError("expected pattern to be an array, string or regex");if(!l.hasSpecialChars(t))return n&&!0===n.nocase&&(t=t.toLowerCase()),l.matchPath(t,n);var r=u.makeRe(t,n);if(u.matchBase(t,n))return l.matchBasename(r,n);function i(e){var t=l.equalsPattern(n),r=l.unixify(n);return function(n){return!!t(n)||!!e.test(r(n))}}var s=i(r);return l.define(s,"result",r.result),s},u.capture=function(e,t,n){var r=u.makeRe(e,s({capture:!0},n)),i=l.unixify(n);return h("capture",e,n,function(){return function(e){var t=r.exec(i(e));return t?t.slice(1):null}})(t)},u.makeRe=function(e,t){if(e instanceof RegExp)return e;if("string"!=typeof e)throw new TypeError("expected pattern to be a string");if(e.length>65536)throw new Error("expected pattern to be less than 65536 characters");return h("makeRe",e,t,function(){var n=l.extend({wrap:!1},t),r=u.create(e,n),s=i(r.output,n);return l.define(s,"result",r),s})},u.create=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");return h("create",e,t,function(){return u.compile(u.parse(e,t),t)})},u.parse=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");return h("parse",e,t,function(){var n=l.instantiate(null,t);o(n,t);var r=n.parse(e,t);return l.define(r,"snapdragon",n),r.input=e,r})},u.compile=function(e,t){return"string"==typeof e&&(e=u.parse(e,t)),h("compile",e.input,t,function(){var n=l.instantiate(e,t);return a(n,t),n.compile(e,t)})},u.clearCache=function(){u.cache.__data__={}},u.compilers=a,u.parsers=o,u.cache=c,e.exports=u},8207:(e,t,n)=>{e.exports=new(n(6553))},2575:e=>{"use strict";e.exports=function(e,t){function n(){return t&&"string"==typeof t.slash?t.slash:t&&"function"==typeof t.slash?t.slash.call(e):"\\\\/"}function r(){return t&&"string"==typeof t.star?t.star:t&&"function"==typeof t.star?t.star.call(e):"[^"+n()+"]*?"}var i=e.ast=e.parser.ast;i.state=e.parser.state,e.compiler.state=i.state,e.compiler.set("not",function(e){var t=this.prev();return!0===this.options.nonegate||"bos"!==t.type?this.emit("\\"+e.val,e):this.emit(e.val,e)}).set("escape",function(e){return this.options.unescape&&/^[-\w_.]/.test(e.val)?this.emit(e.val,e):this.emit("\\"+e.val,e)}).set("quoted",function(e){return this.emit(e.val,e)}).set("dollar",function(e){return"bracket"===e.parent.type?this.emit(e.val,e):this.emit("\\"+e.val,e)}).set("dot",function(e){return!0===e.dotfiles&&(this.dotfiles=!0),this.emit("\\"+e.val,e)}).set("backslash",function(e){return this.emit(e.val,e)}).set("slash",function(e,t,r){for(var i="["+n()+"]",s=e.parent,a=this.prev();"paren"===s.type&&!s.hasSlash;)s.hasSlash=!0,s=s.parent;return a.addQmark&&(i+="?"),"\\b"===e.rest.slice(0,2)?this.emit(i,e):"**"===e.parsed||"./**"===e.parsed?(this.output="(?:"+this.output,this.emit(i+")?",e)):"!**"===e.parsed&&!0!==this.options.nonegate?this.emit(i+"?\\b",e):this.emit(i,e)}).set("bracket",function(e){var t=e.close,n=e.escaped?"\\[":"[",r=e.negated,i=e.inner,s=e.val;return!0===e.escaped&&(i=i.replace(/\\?(\W)/g,"\\$1"),r=""),"]-"===i&&(i="\\]\\-"),r&&-1===i.indexOf(".")&&(i+="."),r&&-1===i.indexOf("/")&&(i+="/"),s=n+r+i+t,this.emit(s,e)}).set("square",function(e){var t=(/^\W/.test(e.val)?"\\":"")+e.val;return this.emit(t,e)}).set("qmark",function(e){var t=this.prev(),n="[^.\\\\/]";if((this.options.dot||"bos"!==t.type&&"slash"!==t.type)&&(n="[^\\\\/]"),"("===e.parsed.slice(-1)){var r=e.rest.charAt(0);if("!"===r||"="===r||":"===r)return this.emit(e.val,e)}return e.val.length>1&&(n+="{"+e.val.length+"}"),this.emit(n,e)}).set("plus",function(e){var t=e.parsed.slice(-1);if("]"===t||")"===t)return this.emit(e.val,e);if(!this.output||/[?*+]/.test(n)&&"bracket"!==e.parent.type)return this.emit("\\+",e);var n=this.output.slice(-1);return/\w/.test(n)&&!e.inside?this.emit("+\\+?",e):this.emit("+",e)}).set("globstar",function(e,t,i){this.output||(this.state.leadingGlobstar=!0);var s=this.prev(),a=this.prev(2),o=this.next(),c=this.next(2),l=s.type,u=e.val;"slash"===s.type&&"slash"===o.type&&"text"===a.type&&(this.output+="?","text"!==c.type&&(this.output+="\\b"));var h=e.parsed;"!"===h.charAt(0)&&(h=h.slice(1));var d=e.isInside.paren||e.isInside.brace;return u=h&&"slash"!==l&&"bos"!==l&&!d?r():!0!==this.options.dot?"(?:(?!(?:["+n()+"]|^)\\.).)*?":"(?:(?!(?:["+n()+"]|^)(?:\\.{1,2})($|["+n()+"]))(?!\\.{2}).)*?","slash"!==l&&"bos"!==l||!0===this.options.dot||(u="(?!\\.)"+u),"slash"===s.type&&"slash"===o.type&&"text"!==a.type&&("text"!==c.type&&"star"!==c.type||(e.addQmark=!0)),this.options.capture&&(u="("+u+")"),this.emit(u,e)}).set("star",function(e,t,i){var s=t[i-2]||{},a=this.prev(),o=this.next(),c=a.type;function l(e){return"bos"===e.type||"slash"===e.type}if(""===this.output&&!0!==this.options.contains&&(this.output="(?!["+n()+"])"),"bracket"===c&&!1===this.options.bash){var u=o&&"bracket"===o.type?r():"*?";if(!a.nodes||"posix"!==a.nodes[1].type)return this.emit(u,e)}var h=this.dotfiles||"text"===c||"escape"===c?"":this.options.dot?"(?!(?:^|["+n()+"])\\.{1,2}(?:$|["+n()+"]))":"(?!\\.)";l(a)||l(s)&&"not"===c?h+="(?!\\.)"!==h?"(?!(\\.{2}|\\.["+n()+"]))(?=.)":"(?=.)":"(?!\\.)"===h&&(h=""),"not"===a.type&&"bos"===s.type&&!0===this.options.dot&&(this.output="(?!\\.)"+this.output);var d=h+r();return this.options.capture&&(d="("+d+")"),this.emit(d,e)}).set("text",function(e){return this.emit(e.val,e)}).set("eos",function(e){var t=this.prev(),r=e.val;return this.output="(?:\\.["+n()+"](?=.))?"+this.output,this.state.metachar&&"qmark"!==t.type&&"slash"!==t.type&&(r+=this.options.contains?"["+n()+"]?":"(?:["+n()+"]|$)"),this.emit(r,e)}),t&&"function"==typeof t.compilers&&t.compilers(e.compiler)}},7429:(e,t,n)=>{"use strict";var r,i=n(6837),s=n(5629),a="[\\[!*+?$^\"'.\\\\/]+",o=function(e){if(r)return r;var t={contains:!0,strictClose:!1},n=i.create(e,t),a=s("^(?:[*]\\((?=.)|"+n+")",t);return r=a}(a);e.exports=function(e,t){var n=e.parser,r=n.options;n.state={slashes:0,paths:[]},n.ast.state=n.state,n.capture("prefix",function(){this.parsed||this.match(/^\.[\\/]/)&&(this.state.strictOpen=!!this.options.strictOpen,this.state.addPrefix=!0)}).capture("escape",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(/^(?:\\(.)|([$^]))/);if(t)return e({type:"escape",val:t[2]||t[1]})}}).capture("quoted",function(){var e=this.position(),t=this.match(/^["']/);if(t){var n=t[0];if(-1===this.input.indexOf(n))return e({type:"escape",val:n});var r=function(e,t){var n=e.charAt(0),r={len:1,val:"",esc:""},i=0;function s(){"\\"!==n&&(r.esc+="\\"+n,r.val+=n),n=e.charAt(++i),r.len++,"\\"===n&&(s(),s())}for(;n&&n!==t;)s();return r}(this.input,n);return this.consume(r.len),e({type:"quoted",val:r.esc})}}).capture("not",function(){var e=this.parsed,t=this.position(),n=this.match(this.notRegex||/^!+/);if(n){var r=n[0],i=r.length%2==1;return""!==e||i||(r=""),""===e&&i&&!0!==this.options.nonegate&&(this.bos.val="(?!^(?:",this.append=")$).*",r=""),t({type:"not",val:r})}}).capture("dot",function(){var e=this.parsed,t=this.position(),n=this.match(/^\.+/);if(n){var r=n[0];return this.state.dot="."===r&&(""===e||"/"===e.slice(-1)),t({type:"dot",dotfiles:this.state.dot,val:r})}}).capture("plus",/^\+(?!\()/).capture("qmark",function(){var e=this.parsed,t=this.position(),n=this.match(/^\?+(?!\()/);if(n)return this.state.metachar=!0,this.state.qmark=!0,t({type:"qmark",parsed:e,val:n[0]})}).capture("globstar",function(){var e=this.parsed,t=this.position();if(this.match(/^\*{2}(?![*(])(?=[,)/]|$)/)){var n=!0!==r.noglobstar?"globstar":"star",i=t({type:n,parsed:e});for(this.state.metachar=!0;"/**/"===this.input.slice(0,4);)this.input=this.input.slice(3);return i.isInside={brace:this.isInside("brace"),paren:this.isInside("paren")},"globstar"===n?(this.state.globstar=!0,i.val="**"):(this.state.star=!0,i.val="*"),i}}).capture("star",function(){var e=this.position(),t=this.match(/^(?:\*(?![*(])|[*]{3,}(?!\()|[*]{2}(?![(/]|$)|\*(?=\*\())/);if(t)return this.state.metachar=!0,this.state.star=!0,e({type:"star",val:t[0]})}).capture("slash",function(){var e=this.position(),t=this.match(/^\//);if(t)return this.state.slashes++,e({type:"slash",val:t[0]})}).capture("backslash",function(){var e=this.position(),t=this.match(/^\\(?![*+?(){}[\]'"])/);if(t){var n=t[0];return this.isInside("bracket")?n="\\":n.length>1&&(n="\\\\"),e({type:"backslash",val:n})}}).capture("square",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(/^\[([^!^\\])\]/);if(t)return e({type:"square",val:t[1]})}}).capture("bracket",function(){var e=this.position(),t=this.match(/^(?:\[([!^]?)([^\]]+|\]-)(\]|[^*+?]+)|\[)/);if(t){var n=t[0],r=t[1]?"^":"",i=(t[2]||"").replace(/\\\\+/,"\\\\"),s=t[3]||"";t[2]&&i.length<t[2].length&&(n=n.replace(/\\\\+/,"\\\\"));var a=this.input.slice(0,2);if(""===i&&"\\]"===a){i+=a,this.consume(2);for(var o,c=this.input,l=-1;o=c[++l];){if(this.consume(1),"]"===o){s=o;break}i+=o}}return e({type:"bracket",val:n,escaped:"]"!==s,negated:r,inner:i,close:s})}}).capture("text",function(){if(!this.isInside("bracket")){var e=this.position(),t=this.match(o);if(t&&t[0])return e({type:"text",val:t[0]})}}),t&&"function"==typeof t.parsers&&t.parsers(e.parser)},e.exports.not=a},7452:(e,t,n)=>{"use strict";var r=e.exports,i=n(9942),s=n(1750)(),a=n(9645);r.define=n(5677),r.diff=n(323),r.extend=n(1743),r.pick=n(6364),r.typeOf=n(1182),r.unique=n(785),r.isEmptyString=function(e){return""===String(e)||"./"===String(e)},r.isWindows=function(){return"\\"===i.sep||!0===s},r.last=function(e,t){return e[e.length-(t||1)]},r.instantiate=function(e,t){var n;return n="object"===r.typeOf(e)&&e.snapdragon?e.snapdragon:"object"===r.typeOf(t)&&t.snapdragon?t.snapdragon:new a(t),r.define(n,"parse",function(e,t){var n=a.prototype.parse.call(this,e,t);n.input=e;var i=this.parser.stack.pop();if(i&&!0!==this.options.strictErrors){var s=i.nodes[0],o=i.nodes[1];if("bracket"===i.type)"["===o.val.charAt(0)&&(o.val="\\"+o.val);else{s.val="\\"+s.val;var c=s.parent.nodes[1];"star"===c.type&&(c.loose=!0)}}return r.define(n,"parser",this.parser),n}),n},r.createKey=function(e,t){if(void 0===t)return e;var n=e;for(var r in t)t.hasOwnProperty(r)&&(n+=";"+r+"="+String(t[r]));return n},r.arrayify=function(e){return"string"==typeof e?[e]:e?Array.isArray(e)?e:[e]:[]},r.isString=function(e){return"string"==typeof e},r.isRegex=function(e){return"regexp"===r.typeOf(e)},r.isObject=function(e){return"object"===r.typeOf(e)},r.escapeRegex=function(e){return e.replace(/[-[\]{}()^$|*+?.\\/\s]/g,"\\$&")},r.combineDupes=function(e,t){var n=(t=(t=r.arrayify(t).join("|").split("|")).map(function(e){return e.replace(/\\?([+*\\/])/g,"\\$1")})).join("|"),i=new RegExp("("+n+")(?=\\1)","g");return e.replace(i,"")},r.hasSpecialChars=function(e){return/(?:(?:(^|\/)[!.])|[*?+()|[\]{}]|[+@]\()/.test(e)},r.toPosixPath=function(e){return e.replace(/\\+/g,"/")},r.unescape=function(e){return r.toPosixPath(e.replace(/\\(?=[*+?!.])/g,""))},r.stripDrive=function(e){return r.isWindows()?e.replace(/^[a-z]:[\\/]+?/i,"/"):e},r.stripPrefix=function(e){return"."!==e.charAt(0)||"/"!==e.charAt(1)&&"\\"!==e.charAt(1)?e:e.slice(2)},r.isSimpleChar=function(e){return""===e.trim()||"."===e},r.isSlash=function(e){return"/"===e||"\\/"===e||"\\"===e||"\\\\"===e},r.matchPath=function(e,t){return t&&t.contains?r.containsPattern(e,t):r.equalsPattern(e,t)},r._equals=function(e,t,n){return n===e||n===t},r._contains=function(e,t,n){return-1!==e.indexOf(n)||-1!==t.indexOf(n)},r.equalsPattern=function(e,t){var n=r.unixify(t);return t=t||{},function(i){var s=r._equals(i,n(i),e);if(!0===s||!0!==t.nocase)return s;var a=i.toLowerCase();return r._equals(a,n(a),e)}},r.containsPattern=function(e,t){var n=r.unixify(t);return t=t||{},function(i){var s=r._contains(i,n(i),e);if(!0===s||!0!==t.nocase)return s;var a=i.toLowerCase();return r._contains(a,n(a),e)}},r.matchBasename=function(e){return function(t){return e.test(t)||e.test(i.basename(t))}},r.identity=function(e){return e},r.value=function(e,t,n){return n&&!1===n.unixify?e:n&&"function"==typeof n.unixify?n.unixify(e):t(e)},r.unixify=function(e){var t=e||{};return function(e){return!1!==t.stripPrefix&&(e=r.stripPrefix(e)),!0===t.unescape&&(e=r.unescape(e)),(!0===t.unixify||r.isWindows())&&(e=r.toPosixPath(e)),e}}},6325:(e,t,n)=>{"use strict";var r=n(1182),i=n(9379),s=n(5677);function a(e){return"object"===r(e)||"function"==typeof e}function o(e,t){var n=(t=c(t)).length;if(a(e)){for(var r in e)if(t.indexOf(r)>-1)return!0;return o(l(e),t)}if(Array.isArray(e)){for(var i=e;n--;)if(i.indexOf(t[n])>-1)return!0;return!1}throw new TypeError("expected an array or object.")}function c(e){return e?Array.isArray(e)?e:[e]:[]}function l(e){return function(e){return a(e)&&void 0!==e.constructor}(e)?Object.getOwnPropertyNames(e):[]}e.exports=function(e,t,n){if(!a(e))throw new TypeError("expected receiving object to be an object.");if(!a(t))throw new TypeError("expected providing object to be an object.");var r=l(t),u=Object.keys(t),h=r.length;for(n=c(n);h--;){var d=r[h];o(u,d)?s(e,d,t[d]):d in e||o(n,d)||i(e,t,d)}},e.exports.has=o},9535:(e,t,n)=>{"use strict";var r=n(9537);e.exports=function(e,t,n,i){if(!r(e)&&"function"!=typeof e)throw new Error("object-visit expects `thisArg` to be an object.");if("string"!=typeof t)throw new Error("object-visit expects `method` name to be a string");if("function"!=typeof e[t])return e;var s=[].slice.call(arguments,3);for(var a in n=n||{}){var o=[a,n[a]].concat(s);e[t].apply(e,o)}return e}},6364:(e,t,n)=>{"use strict";var r=n(9537);e.exports=function(e,t){if(!r(e)&&"function"!=typeof e)return{};var n={};if("string"==typeof t)return t in e&&(n[t]=e[t]),n;for(var i=t.length,s=-1;++s<i;){var a=t[s];a in e&&(n[a]=e[a])}return n}},308:(e,t,n)=>{"use strict";const r=n(5192);e.exports=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const t=new r;let n=0;const i=async(e,r,...i)=>{n++;const s=(async()=>e(...i))();r(s);try{await s}catch{}n--,t.size>0&&t.dequeue()()},s=(r,...s)=>new Promise(a=>{((r,s,...a)=>{t.enqueue(i.bind(null,r,s,...a)),(async()=>{await Promise.resolve(),n<e&&t.size>0&&t.dequeue()()})()})(r,a,...s)});return Object.defineProperties(s,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear()}}}),s}},9540:(e,t,n)=>{"use strict";var r=n(2267);t.certificate=n(7770);var i=r.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});t.RSAPrivateKey=i;var s=r.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});t.RSAPublicKey=s;var a=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),o=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())});t.PublicKey=o;var c=r.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(a),this.key("subjectPrivateKey").octstr())});t.PrivateKey=c;var l=r.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});t.EncryptedPrivateKey=l;var u=r.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});t.DSAPrivateKey=u,t.DSAparam=r.define("DSAparam",function(){this.int()});var h=r.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}),d=r.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(h),this.key("publicKey").optional().explicit(1).bitstr())});t.ECPrivateKey=d,t.signature=r.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},7770:(e,t,n)=>{"use strict";var r=n(2267),i=r.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),s=r.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),a=r.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),o=r.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())}),c=r.define("RelativeDistinguishedName",function(){this.setof(s)}),l=r.define("RDNSequence",function(){this.seqof(c)}),u=r.define("Name",function(){this.choice({rdnSequence:this.use(l)})}),h=r.define("Validity",function(){this.seq().obj(this.key("notBefore").use(i),this.key("notAfter").use(i))}),d=r.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),f=r.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(a),this.key("issuer").use(u),this.key("validity").use(h),this.key("subject").use(u),this.key("subjectPublicKeyInfo").use(o),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(d).optional())}),p=r.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(a),this.key("signatureValue").bitstr())});e.exports=p},2982:(e,t,n)=>{"use strict";var r=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,s=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,a=n(8981),o=n(178),c=n(5636).Buffer;e.exports=function(e,t){var n,l=e.toString(),u=l.match(r);if(u){var h="aes"+u[1],d=c.from(u[2],"hex"),f=c.from(u[3].replace(/[\r\n]/g,""),"base64"),p=a(t,d.slice(0,8),parseInt(u[1],10)).key,g=[],m=o.createDecipheriv(h,p,d);g.push(m.update(f)),g.push(m.final()),n=c.concat(g)}else{var y=l.match(s);n=c.from(y[2].replace(/[\r\n]/g,""),"base64")}return{tag:l.match(i)[1],data:n}}},5069:(e,t,n)=>{"use strict";var r=n(9540),i=n(1892),s=n(2982),a=n(178),o=n(8619),c=n(5636).Buffer;function l(e){var t;"object"!=typeof e||c.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=c.from(e));var n,l,u=s(e,t),h=u.tag,d=u.data;switch(h){case"CERTIFICATE":l=r.certificate.decode(d,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(l||(l=r.PublicKey.decode(d,"der")),n=l.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPublicKey.decode(l.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return l.subjectPrivateKey=l.subjectPublicKey,{type:"ec",data:l};case"1.2.840.10040.4.1":return l.algorithm.params.pub_key=r.DSAparam.decode(l.subjectPublicKey.data,"der"),{type:"dsa",data:l.algorithm.params};default:throw new Error("unknown key id "+n)}case"ENCRYPTED PRIVATE KEY":d=function(e,t){var n=e.algorithm.decrypt.kde.kdeparams.salt,r=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),s=i[e.algorithm.decrypt.cipher.algo.join(".")],l=e.algorithm.decrypt.cipher.iv,u=e.subjectPrivateKey,h=parseInt(s.split("-")[1],10)/8,d=o.pbkdf2Sync(t,n,r,h,"sha1"),f=a.createDecipheriv(s,d,l),p=[];return p.push(f.update(u)),p.push(f.final()),c.concat(p)}(d=r.EncryptedPrivateKey.decode(d,"der"),t);case"PRIVATE KEY":switch(n=(l=r.PrivateKey.decode(d,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return r.RSAPrivateKey.decode(l.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:l.algorithm.curve,privateKey:r.ECPrivateKey.decode(l.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return l.algorithm.params.priv_key=r.DSAparam.decode(l.subjectPrivateKey,"der"),{type:"dsa",params:l.algorithm.params};default:throw new Error("unknown key id "+n)}case"RSA PUBLIC KEY":return r.RSAPublicKey.decode(d,"der");case"RSA PRIVATE KEY":return r.RSAPrivateKey.decode(d,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:r.DSAPrivateKey.decode(d,"der")};case"EC PRIVATE KEY":return{curve:(d=r.ECPrivateKey.decode(d,"der")).parameters.value,privateKey:d.privateKey};default:throw new Error("unknown key type "+h)}}l.signature=r.signature,e.exports=l},6458:e=>{e.exports=function(e){if("string"!=typeof e)throw new TypeError("expected a string.");return 1===(e=e.replace(/([A-Z])/g," $1")).length?e.toUpperCase():(e=(e=e.replace(/^[\W_]+|[\W_]+$/g,"").toLowerCase()).charAt(0).toUpperCase()+e.slice(1)).replace(/[\W_]+(\w|$)/g,function(e,t){return t.toUpperCase()})}},9942:(e,t,n)=>{"use strict";var r=n(9907);function i(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function s(e,t){for(var n,r="",i=0,s=-1,a=0,o=0;o<=e.length;++o){if(o<e.length)n=e.charCodeAt(o);else{if(47===n)break;n=47}if(47===n){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var c=r.lastIndexOf("/");if(c!==r.length-1){-1===c?(r="",i=0):i=(r=r.slice(0,c)).length-1-r.lastIndexOf("/"),s=o,a=0;continue}}else if(2===r.length||1===r.length){r="",i=0,s=o,a=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(s+1,o):r=e.slice(s+1,o),i=o-s-1;s=o,a=0}else 46===n&&-1!==a?++a:a=-1}return r}var a={resolve:function(){for(var e,t="",n=!1,a=arguments.length-1;a>=-1&&!n;a--){var o;a>=0?o=arguments[a]:(void 0===e&&(e=r.cwd()),o=e),i(o),0!==o.length&&(t=o+"/"+t,n=47===o.charCodeAt(0))}return t=s(t,!n),n?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(i(e),0===e.length)return".";var t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=s(e,!t)).length||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return i(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];i(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":a.normalize(e)},relative:function(e,t){if(i(e),i(t),e===t)return"";if((e=a.resolve(e))===(t=a.resolve(t)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var r=e.length,s=r-n,o=1;o<t.length&&47===t.charCodeAt(o);++o);for(var c=t.length-o,l=s<c?s:c,u=-1,h=0;h<=l;++h){if(h===l){if(c>l){if(47===t.charCodeAt(o+h))return t.slice(o+h+1);if(0===h)return t.slice(o+h)}else s>l&&(47===e.charCodeAt(n+h)?u=h:0===h&&(u=0));break}var d=e.charCodeAt(n+h);if(d!==t.charCodeAt(o+h))break;47===d&&(u=h)}var f="";for(h=n+u+1;h<=r;++h)h!==r&&47!==e.charCodeAt(h)||(0===f.length?f+="..":f+="/..");return f.length>0?f+t.slice(o+u):(o+=u,47===t.charCodeAt(o)&&++o,t.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(i(e),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,s=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!s){r=a;break}}else s=!1;return-1===r?n?"/":".":n&&1===r?"//":e.slice(0,r)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');i(e);var n,r=0,s=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,c=-1;for(n=e.length-1;n>=0;--n){var l=e.charCodeAt(n);if(47===l){if(!a){r=n+1;break}}else-1===c&&(a=!1,c=n+1),o>=0&&(l===t.charCodeAt(o)?-1==--o&&(s=n):(o=-1,s=c))}return r===s?s=c:-1===s&&(s=e.length),e.slice(r,s)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!a){r=n+1;break}}else-1===s&&(a=!1,s=n+1);return-1===s?"":e.slice(r,s)},extname:function(e){i(e);for(var t=-1,n=0,r=-1,s=!0,a=0,o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(47!==c)-1===r&&(s=!1,r=o+1),46===c?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!s){n=o+1;break}}return-1===t||-1===r||0===a||1===a&&t===r-1&&t===n+1?"":e.slice(t,r)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+"/"+r:r}(0,e)},parse:function(e){i(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,r=e.charCodeAt(0),s=47===r;s?(t.root="/",n=1):n=0;for(var a=-1,o=0,c=-1,l=!0,u=e.length-1,h=0;u>=n;--u)if(47!==(r=e.charCodeAt(u)))-1===c&&(l=!1,c=u+1),46===r?-1===a?a=u:1!==h&&(h=1):-1!==a&&(h=-1);else if(!l){o=u+1;break}return-1===a||-1===c||0===h||1===h&&a===c-1&&a===o+1?-1!==c&&(t.base=t.name=0===o&&s?e.slice(1,c):e.slice(o,c)):(0===o&&s?(t.name=e.slice(1,a),t.base=e.slice(1,c)):(t.name=e.slice(o,a),t.base=e.slice(o,c)),t.ext=e.slice(a,c)),o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};a.posix=a,e.exports=a},8619:(e,t,n)=>{"use strict";t.pbkdf2=n(8399),t.pbkdf2Sync=n(4789)},8399:(e,t,n)=>{"use strict";var r,i,s=n(5636).Buffer,a=n(9697),o=n(9858),c=n(4789),l=n(4021),u=n.g.crypto&&n.g.crypto.subtle,h={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function f(){return i||(i=n.g.process&&n.g.process.nextTick?n.g.process.nextTick:n.g.queueMicrotask?n.g.queueMicrotask:n.g.setImmediate?n.g.setImmediate:n.g.setTimeout)}function p(e,t,n,r,i){return u.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then(function(e){return u.deriveBits({name:"PBKDF2",salt:t,iterations:n,hash:{name:i}},e,r<<3)}).then(function(e){return s.from(e)})}e.exports=function(e,t,i,g,m,y){"function"==typeof m&&(y=m,m=void 0);var b=h[(m=m||"sha1").toLowerCase()];if(b&&"function"==typeof n.g.Promise){if(a(i,g),e=l(e,o,"Password"),t=l(t,o,"Salt"),"function"!=typeof y)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then(function(e){f()(function(){t(null,e)})},function(e){f()(function(){t(e)})})}(function(e){if(n.g.process&&!n.g.process.browser)return Promise.resolve(!1);if(!u||!u.importKey||!u.deriveBits)return Promise.resolve(!1);if(void 0!==d[e])return d[e];var t=p(r=r||s.alloc(8),r,10,128,e).then(function(){return!0},function(){return!1});return d[e]=t,t}(b).then(function(n){return n?p(e,t,i,g,b):c(e,t,i,g,m)}),y)}else f()(function(){var n;try{n=c(e,t,i,g,m)}catch(e){return void y(e)}y(null,n)})}},9858:(e,t,n)=>{"use strict";var r,i=n(9907);r=n.g.process&&n.g.process.browser?"utf-8":n.g.process&&n.g.process.version?parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":"utf-8",e.exports=r},9697:e=>{"use strict";var t=Math.pow(2,30)-1;e.exports=function(e,n){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof n)throw new TypeError("Key length not a number");if(n<0||n>t||n!=n)throw new TypeError("Bad key length")}},4789:(e,t,n)=>{"use strict";var r=n(4277),i=n(5586),s=n(3229),a=n(5636).Buffer,o=n(9697),c=n(9858),l=n(4021),u=a.alloc(128),h={__proto__:null,md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,"sha512-256":32,ripemd160:20,rmd160:20},d={__proto__:null,"sha-1":"sha1","sha-224":"sha224","sha-256":"sha256","sha-384":"sha384","sha-512":"sha512","ripemd-160":"ripemd160"};function f(e){return(new i).update(e).digest()}function p(e,t,n){var i=function(e){return"rmd160"===e||"ripemd160"===e?f:"md5"===e?r:function(t){return s(e).update(t).digest()}}(e),o="sha512"===e||"sha384"===e?128:64;t.length>o?t=i(t):t.length<o&&(t=a.concat([t,u],o));for(var c=a.allocUnsafe(o+h[e]),l=a.allocUnsafe(o+h[e]),d=0;d<o;d++)c[d]=54^t[d],l[d]=92^t[d];var p=a.allocUnsafe(o+n+4);c.copy(p,0,0,o),this.ipad1=p,this.ipad2=c,this.opad=l,this.alg=e,this.blocksize=o,this.hash=i,this.size=h[e]}p.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,n,r,i){o(n,r),e=l(e,c,"Password"),t=l(t,c,"Salt");var s=(i||"sha1").toLowerCase(),u=d[s]||s,f=h[u];if("number"!=typeof f||!f)throw new TypeError("Digest algorithm not supported: "+i);var g=new p(u,e,t.length),m=a.allocUnsafe(r),y=a.allocUnsafe(t.length+4);t.copy(y,0,0,t.length);for(var b=0,w=f,v=Math.ceil(r/w),S=1;S<=v;S++){y.writeUInt32BE(S,t.length);for(var x=g.run(y,g.ipad1),E=x,I=1;I<n;I++){E=g.run(E,g.ipad2);for(var k=0;k<w;k++)x[k]^=E[k]}x.copy(m,b),b+=w}return m}},4021:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(8764),s="undefined"!=typeof Uint8Array,a=s&&"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView;e.exports=function(e,t,n){if("string"==typeof e||r.isBuffer(e)||s&&e instanceof Uint8Array||a&&a(e))return i(e,t);throw new TypeError(n+" must be a string, a Buffer, a Uint8Array, or a DataView")}},9501:e=>{"use strict";e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},9907:e=>{var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var o,c=[],l=!1,u=-1;function h(){l&&o&&(l=!1,o.length?c=o.concat(c):u=-1,c.length&&d())}function d(){if(!l){var e=a(h);l=!0;for(var t=c.length;t;){for(o=c,c=[];++u<t;)o&&o[u].run();u=-1,t=c.length}o=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||l||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},4055:(e,t,n)=>{t.publicEncrypt=n(3737),t.privateDecrypt=n(9107),t.privateEncrypt=function(e,n){return t.publicEncrypt(e,n,!0)},t.publicDecrypt=function(e,n){return t.privateDecrypt(e,n,!0)}},2965:(e,t,n)=>{var r=n(3257),i=n(5636).Buffer;function s(e){var t=i.allocUnsafe(4);return t.writeUInt32BE(e,0),t}e.exports=function(e,t){for(var n,a=i.alloc(0),o=0;a.length<t;)n=s(o++),a=i.concat([a,r("sha1").update(e).update(n).digest()]);return a.slice(0,t)}},9107:(e,t,n)=>{var r=n(5069),i=n(2965),s=n(6358),a=n(2823),o=n(4215),c=n(3257),l=n(5810),u=n(5636).Buffer;e.exports=function(e,t,n){var h;h=e.padding?e.padding:n?1:4;var d,f=r(e),p=f.modulus.byteLength();if(t.length>p||new a(t).cmp(f.modulus)>=0)throw new Error("decryption error");d=n?l(new a(t),f):o(t,f);var g=u.alloc(p-d.length);if(d=u.concat([g,d],p),4===h)return function(e,t){var n=e.modulus.byteLength(),r=c("sha1").update(u.alloc(0)).digest(),a=r.length;if(0!==t[0])throw new Error("decryption error");var o=t.slice(1,a+1),l=t.slice(a+1),h=s(o,i(l,a)),d=s(l,i(h,n-a-1));if(function(e,t){e=u.from(e),t=u.from(t);var n=0,r=e.length;e.length!==t.length&&(n++,r=Math.min(e.length,t.length));for(var i=-1;++i<r;)n+=e[i]^t[i];return n}(r,d.slice(0,a)))throw new Error("decryption error");for(var f=a;0===d[f];)f++;if(1!==d[f++])throw new Error("decryption error");return d.slice(f)}(f,d);if(1===h)return function(e,t,n){for(var r=t.slice(0,2),i=2,s=0;0!==t[i++];)if(i>=t.length){s++;break}var a=t.slice(2,i-1);if(("0002"!==r.toString("hex")&&!n||"0001"!==r.toString("hex")&&n)&&s++,a.length<8&&s++,s)throw new Error("decryption error");return t.slice(i)}(0,d,n);if(3===h)return d;throw new Error("unknown padding")}},3737:(e,t,n)=>{var r=n(5069),i=n(2644),s=n(3257),a=n(2965),o=n(6358),c=n(2823),l=n(5810),u=n(4215),h=n(5636).Buffer;e.exports=function(e,t,n){var d;d=e.padding?e.padding:n?1:4;var f,p=r(e);if(4===d)f=function(e,t){var n=e.modulus.byteLength(),r=t.length,l=s("sha1").update(h.alloc(0)).digest(),u=l.length,d=2*u;if(r>n-d-2)throw new Error("message too long");var f=h.alloc(n-r-d-2),p=n-u-1,g=i(u),m=o(h.concat([l,f,h.alloc(1,1),t],p),a(g,p)),y=o(g,a(m,u));return new c(h.concat([h.alloc(1),y,m],n))}(p,t);else if(1===d)f=function(e,t,n){var r,s=t.length,a=e.modulus.byteLength();if(s>a-11)throw new Error("message too long");return r=n?h.alloc(a-s-3,255):function(e){for(var t,n=h.allocUnsafe(e),r=0,s=i(2*e),a=0;r<e;)a===s.length&&(s=i(2*e),a=0),(t=s[a++])&&(n[r++]=t);return n}(a-s-3),new c(h.concat([h.from([0,n?1:2]),r,h.alloc(1),t],a))}(p,t,n);else{if(3!==d)throw new Error("unknown padding");if((f=new c(t)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return n?u(f,p):l(f,p)}},5810:(e,t,n)=>{var r=n(2823),i=n(5636).Buffer;e.exports=function(e,t){return i.from(e.toRed(r.mont(t.modulus)).redPow(new r(t.publicExponent)).fromRed().toArray())}},6358:e=>{e.exports=function(e,t){for(var n=e.length,r=-1;++r<n;)e[r]^=t[r];return e}},2644:(e,t,n)=>{"use strict";var r=n(9907),i=65536,s=n(5636).Buffer,a=n.g.crypto||n.g.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var n=s.allocUnsafe(e);if(e>0)if(e>i)for(var o=0;o<e;o+=i)a.getRandomValues(n.slice(o,o+i));else a.getRandomValues(n);return"function"==typeof t?r.nextTick(function(){t(null,n)}):n}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},9904:(e,t,n)=>{"use strict";var r=n(9907);function i(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var s=n(5636),a=n(2644),o=s.Buffer,c=s.kMaxLength,l=n.g.crypto||n.g.msCrypto,u=Math.pow(2,32)-1;function h(e,t){if("number"!=typeof e||e!=e)throw new TypeError("offset must be a number");if(e>u||e<0)throw new TypeError("offset must be a uint32");if(e>c||e>t)throw new RangeError("offset out of range")}function d(e,t,n){if("number"!=typeof e||e!=e)throw new TypeError("size must be a number");if(e>u||e<0)throw new TypeError("size must be a uint32");if(e+t>n||e>c)throw new RangeError("buffer too small")}function f(e,t,n,i){if(r.browser){var s=e.buffer,o=new Uint8Array(s,t,n);return l.getRandomValues(o),i?void r.nextTick(function(){i(null,e)}):e}if(!i)return a(n).copy(e,t),e;a(n,function(n,r){if(n)return i(n);r.copy(e,t),i(null,e)})}l&&l.getRandomValues||!r.browser?(t.randomFill=function(e,t,r,i){if(!(o.isBuffer(e)||e instanceof n.g.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof t)i=t,t=0,r=e.length;else if("function"==typeof r)i=r,r=e.length-t;else if("function"!=typeof i)throw new TypeError('"cb" argument must be a function');return h(t,e.length),d(r,t,e.length),f(e,t,r,i)},t.randomFillSync=function(e,t,r){if(void 0===t&&(t=0),!(o.isBuffer(e)||e instanceof n.g.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return h(t,e.length),void 0===r&&(r=e.length-t),d(r,t,e.length),f(e,t,r)}):(t.randomFill=i,t.randomFillSync=i)},1265:(e,t,n)=>{"use strict";e.exports=n(601).Duplex},4421:(e,t,n)=>{"use strict";e.exports=n(601).PassThrough},8199:(e,t,n)=>{"use strict";e.exports=n(601).Readable},9415:(e,t,n)=>{"use strict";e.exports=n(601).Transform},5291:(e,t,n)=>{"use strict";e.exports=n(601).Writable},1434:(e,t,n)=>{"use strict";const{SymbolDispose:r}=n(1473),{AbortError:i,codes:s}=n(2590),{isNodeStream:a,isWebStream:o,kControllerErrorFunction:c}=n(2520),l=n(4869),{ERR_INVALID_ARG_TYPE:u}=s;let h;e.exports.addAbortSignal=function(t,n){if((e=>{if("object"!=typeof e||!("aborted"in e))throw new u("signal","AbortSignal",e)})(t),!a(n)&&!o(n))throw new u("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;const s=a(t)?()=>{t.destroy(new i(void 0,{cause:e.reason}))}:()=>{t[c](new i(void 0,{cause:e.reason}))};if(e.aborted)s();else{h=h||n(6609).addAbortListener;const i=h(e,s);l(t,i[r])}return t}},82:(e,t,n)=>{"use strict";const{StringPrototypeSlice:r,SymbolIterator:i,TypedArrayPrototypeSet:s,Uint8Array:a}=n(1473),{Buffer:o}=n(1048),{inspect:c}=n(6609);e.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,n=""+t.data;for(;null!==(t=t.next);)n+=e+t.data;return n}concat(e){if(0===this.length)return o.alloc(0);const t=o.allocUnsafe(e>>>0);let n=this.head,r=0;for(;n;)s(t,n.data,r),r+=n.data.length,n=n.next;return t}consume(e,t){const n=this.head.data;if(e<n.length){const t=n.slice(0,e);return this.head.data=n.slice(e),t}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",n=this.head,i=0;do{const s=n.data;if(!(e>s.length)){e===s.length?(t+=s,++i,n.next?this.head=n.next:this.head=this.tail=null):(t+=r(s,0,e),this.head=n,n.data=r(s,e));break}t+=s,e-=s.length,++i}while(null!==(n=n.next));return this.length-=i,t}_getBuffer(e){const t=o.allocUnsafe(e),n=e;let r=this.head,i=0;do{const o=r.data;if(!(e>o.length)){e===o.length?(s(t,o,n-e),++i,r.next?this.head=r.next:this.head=this.tail=null):(s(t,new a(o.buffer,o.byteOffset,e),n-e),this.head=r,r.data=o.slice(e));break}s(t,o,n-e),e-=o.length,++i}while(null!==(r=r.next));return this.length-=i,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return c(this,{...t,depth:0,customInspect:!1})}}},7369:(e,t,n)=>{"use strict";const{pipeline:r}=n(6815),i=n(6279),{destroyer:s}=n(6527),{isNodeStream:a,isReadable:o,isWritable:c,isWebStream:l,isTransformStream:u,isWritableStream:h,isReadableStream:d}=n(2520),{AbortError:f,codes:{ERR_INVALID_ARG_VALUE:p,ERR_MISSING_ARGS:g}}=n(2590),m=n(4869);e.exports=function(...e){if(0===e.length)throw new g("streams");if(1===e.length)return i.from(e[0]);const t=[...e];if("function"==typeof e[0]&&(e[0]=i.from(e[0])),"function"==typeof e[e.length-1]){const t=e.length-1;e[t]=i.from(e[t])}for(let n=0;n<e.length;++n)if(a(e[n])||l(e[n])){if(n<e.length-1&&!(o(e[n])||d(e[n])||u(e[n])))throw new p(`streams[${n}]`,t[n],"must be readable");if(n>0&&!(c(e[n])||h(e[n])||u(e[n])))throw new p(`streams[${n}]`,t[n],"must be writable")}let n,y,b,w,v;const S=e[0],x=r(e,function(e){const t=w;w=null,t?t(e):e?v.destroy(e):I||E||v.destroy()}),E=!!(c(S)||h(S)||u(S)),I=!!(o(x)||d(x)||u(x));if(v=new i({writableObjectMode:!(null==S||!S.writableObjectMode),readableObjectMode:!(null==x||!x.readableObjectMode),writable:E,readable:I}),E){if(a(S))v._write=function(e,t,r){S.write(e,t)?r():n=r},v._final=function(e){S.end(),y=e},S.on("drain",function(){if(n){const e=n;n=null,e()}});else if(l(S)){const e=(u(S)?S.writable:S).getWriter();v._write=async function(t,n,r){try{await e.ready,e.write(t).catch(()=>{}),r()}catch(e){r(e)}},v._final=async function(t){try{await e.ready,e.close().catch(()=>{}),y=t}catch(e){t(e)}}}const e=u(x)?x.readable:x;m(e,()=>{if(y){const e=y;y=null,e()}})}if(I)if(a(x))x.on("readable",function(){if(b){const e=b;b=null,e()}}),x.on("end",function(){v.push(null)}),v._read=function(){for(;;){const e=x.read();if(null===e)return void(b=v._read);if(!v.push(e))return}};else if(l(x)){const e=(u(x)?x.readable:x).getReader();v._read=async function(){for(;;)try{const{value:t,done:n}=await e.read();if(!v.push(t))return;if(n)return void v.push(null)}catch{return}}}return v._destroy=function(e,t){e||null===w||(e=new f),b=null,n=null,y=null,null===w?t(e):(w=t,a(x)&&s(x,e))},v}},6527:(e,t,n)=>{"use strict";const r=n(9907),{aggregateTwoErrors:i,codes:{ERR_MULTIPLE_CALLBACK:s},AbortError:a}=n(2590),{Symbol:o}=n(1473),{kIsDestroyed:c,isDestroyed:l,isFinished:u,isServerRequest:h}=n(2520),d=o("kDestroy"),f=o("kConstruct");function p(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function g(e,t,n){let i=!1;function s(t){if(i)return;i=!0;const s=e._readableState,a=e._writableState;p(t,a,s),a&&(a.closed=!0),s&&(s.closed=!0),"function"==typeof n&&n(t),t?r.nextTick(m,e,t):r.nextTick(y,e)}try{e._destroy(t||null,s)}catch(t){s(t)}}function m(e,t){b(e,t),y(e)}function y(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=n&&n.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function b(e,t){const n=e._readableState,r=e._writableState;null!=r&&r.errorEmitted||null!=n&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function w(e,t,n){const i=e._readableState,s=e._writableState;if(null!=s&&s.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=s&&s.autoDestroy?e.destroy(t):t&&(t.stack,s&&!s.errored&&(s.errored=t),i&&!i.errored&&(i.errored=t),n?r.nextTick(b,e,t):b(e,t))}function v(e){let t=!1;function n(n){if(t)return void w(e,null!=n?n:new s);t=!0;const i=e._readableState,a=e._writableState,o=a||i;i&&(i.constructed=!0),a&&(a.constructed=!0),o.destroyed?e.emit(d,n):n?w(e,n,!0):r.nextTick(S,e)}try{e._construct(e=>{r.nextTick(n,e)})}catch(e){r.nextTick(n,e)}}function S(e){e.emit(f)}function x(e){return(null==e?void 0:e.setHeader)&&"function"==typeof e.abort}function E(e){e.emit("close")}function I(e,t){e.emit("error",t),r.nextTick(E,e)}e.exports={construct:function(e,t){if("function"!=typeof e._construct)return;const n=e._readableState,i=e._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),e.once(f,t),e.listenerCount(f)>1||r.nextTick(v,e)},destroyer:function(e,t){e&&!l(e)&&(t||u(e)||(t=new a),h(e)?(e.socket=null,e.destroy(t)):x(e)?e.abort():x(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?r.nextTick(I,e,t):r.nextTick(E,e),e.destroyed||(e[c]=!0))},destroy:function(e,t){const n=this._readableState,r=this._writableState,s=r||n;return null!=r&&r.destroyed||null!=n&&n.destroyed?("function"==typeof t&&t(),this):(p(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),s.constructed?g(this,e,t):this.once(d,function(n){g(this,i(n,e),t)}),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:w}},6279:(e,t,n)=>{"use strict";const{ObjectDefineProperties:r,ObjectGetOwnPropertyDescriptor:i,ObjectKeys:s,ObjectSetPrototypeOf:a}=n(1473);e.exports=l;const o=n(1509),c=n(5605);a(l.prototype,o.prototype),a(l,o);{const e=s(c.prototype);for(let t=0;t<e.length;t++){const n=e[t];l.prototype[n]||(l.prototype[n]=c.prototype[n])}}function l(e){if(!(this instanceof l))return new l(e);o.call(this,e),c.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let u,h;function d(){return void 0===u&&(u={}),u}r(l.prototype,{writable:{__proto__:null,...i(c.prototype,"writable")},writableHighWaterMark:{__proto__:null,...i(c.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...i(c.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...i(c.prototype,"writableBuffer")},writableLength:{__proto__:null,...i(c.prototype,"writableLength")},writableFinished:{__proto__:null,...i(c.prototype,"writableFinished")},writableCorked:{__proto__:null,...i(c.prototype,"writableCorked")},writableEnded:{__proto__:null,...i(c.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...i(c.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),l.fromWeb=function(e,t){return d().newStreamDuplexFromReadableWritablePair(e,t)},l.toWeb=function(e){return d().newReadableWritablePairFromDuplex(e)},l.from=function(e){return h||(h=n(5397)),h(e,"body")}},5397:(e,t,n)=>{const r=n(9907),i=n(1048),{isReadable:s,isWritable:a,isIterable:o,isNodeStream:c,isReadableNodeStream:l,isWritableNodeStream:u,isDuplexNodeStream:h,isReadableStream:d,isWritableStream:f}=n(2520),p=n(4869),{AbortError:g,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=n(2590),{destroyer:b}=n(6527),w=n(6279),v=n(1509),S=n(5605),{createDeferredPromise:x}=n(6609),E=n(1613),I=globalThis.Blob||i.Blob,k=void 0!==I?function(e){return e instanceof I}:function(e){return!1},T=globalThis.AbortController||n(7083).AbortController,{FunctionPrototypeCall:_}=n(1473);class C extends w{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function A(e){const t=e.readable&&"function"!=typeof e.readable.read?v.wrap(e.readable):e.readable,n=e.writable;let r,i,o,c,l,u=!!s(t),h=!!a(n);function d(e){const t=c;c=null,t?t(e):e&&l.destroy(e)}return l=new C({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==n||!n.writableObjectMode),readable:u,writable:h}),h&&(p(n,e=>{h=!1,e&&b(t,e),d(e)}),l._write=function(e,t,i){n.write(e,t)?i():r=i},l._final=function(e){n.end(),i=e},n.on("drain",function(){if(r){const e=r;r=null,e()}}),n.on("finish",function(){if(i){const e=i;i=null,e()}})),u&&(p(t,e=>{u=!1,e&&b(t,e),d(e)}),t.on("readable",function(){if(o){const e=o;o=null,e()}}),t.on("end",function(){l.push(null)}),l._read=function(){for(;;){const e=t.read();if(null===e)return void(o=l._read);if(!l.push(e))return}}),l._destroy=function(e,s){e||null===c||(e=new g),o=null,r=null,i=null,null===c?s(e):(c=s,b(n,e),b(t,e))},l}e.exports=function e(t,n){if(h(t))return t;if(l(t))return A({readable:t});if(u(t))return A({writable:t});if(c(t))return A({writable:!1,readable:!1});if(d(t))return A({readable:v.fromWeb(t)});if(f(t))return A({writable:S.fromWeb(t)});if("function"==typeof t){const{value:e,write:i,final:s,destroy:a}=function(e){let{promise:t,resolve:n}=x();const i=new T,s=i.signal;return{value:e(async function*(){for(;;){const e=t;t=null;const{chunk:i,done:a,cb:o}=await e;if(r.nextTick(o),a)return;if(s.aborted)throw new g(void 0,{cause:s.reason});({promise:t,resolve:n}=x()),yield i}}(),{signal:s}),write(e,t,r){const i=n;n=null,i({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}(t);if(o(e))return E(C,e,{objectMode:!0,write:i,final:s,destroy:a});const c=null==e?void 0:e.then;if("function"==typeof c){let t;const n=_(c,e,e=>{if(null!=e)throw new y("nully","body",e)},e=>{b(t,e)});return t=new C({objectMode:!0,readable:!1,write:i,final(e){s(async()=>{try{await n,r.nextTick(e,null)}catch(t){r.nextTick(e,t)}})},destroy:a})}throw new y("Iterable, AsyncIterable or AsyncFunction",n,e)}if(k(t))return e(t.arrayBuffer());if(o(t))return E(C,t,{objectMode:!0,writable:!1});if(d(null==t?void 0:t.readable)&&f(null==t?void 0:t.writable))return C.fromWeb(t);if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable))return A({readable:null!=t&&t.readable?l(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?u(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0});const i=null==t?void 0:t.then;if("function"==typeof i){let e;return _(i,t,t=>{null!=t&&e.push(t),e.push(null)},t=>{b(e,t)}),e=new C({objectMode:!0,writable:!1,read(){}})}throw new m(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}},4869:(e,t,n)=>{"use strict";const r=n(9907),{AbortError:i,codes:s}=n(2590),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_PREMATURE_CLOSE:o}=s,{kEmptyObject:c,once:l}=n(6609),{validateAbortSignal:u,validateFunction:h,validateObject:d,validateBoolean:f}=n(7840),{Promise:p,PromisePrototypeThen:g,SymbolDispose:m}=n(1473),{isClosed:y,isReadable:b,isReadableNodeStream:w,isReadableStream:v,isReadableFinished:S,isReadableErrored:x,isWritable:E,isWritableNodeStream:I,isWritableStream:k,isWritableFinished:T,isWritableErrored:_,isNodeStream:C,willEmitClose:A,kIsClosedPromise:F}=n(2520);let R;const M=()=>{};function D(e,t,s){var f,p;if(2===arguments.length?(s=t,t=c):null==t?t=c:d(t,"options"),h(s,"callback"),u(t.signal,"options.signal"),s=l(s),v(e)||k(e))return function(e,t,s){let a=!1,o=M;if(t.signal)if(o=()=>{a=!0,s.call(e,new i(void 0,{cause:t.signal.reason}))},t.signal.aborted)r.nextTick(o);else{R=R||n(6609).addAbortListener;const r=R(t.signal,o),i=s;s=l((...t)=>{r[m](),i.apply(e,t)})}const c=(...t)=>{a||r.nextTick(()=>s.apply(e,t))};return g(e[F].promise,c,c),M}(e,t,s);if(!C(e))throw new a("stream",["ReadableStream","WritableStream","Stream"],e);const D=null!==(f=t.readable)&&void 0!==f?f:w(e),O=null!==(p=t.writable)&&void 0!==p?p:I(e),P=e._writableState,N=e._readableState,L=()=>{e.writable||V()};let B=A(e)&&w(e)===D&&I(e)===O,U=T(e,!1);const V=()=>{U=!0,e.destroyed&&(B=!1),(!B||e.readable&&!D)&&(D&&!j||s.call(e))};let j=S(e,!1);const z=()=>{j=!0,e.destroyed&&(B=!1),(!B||e.writable&&!O)&&(O&&!U||s.call(e))},G=t=>{s.call(e,t)};let H=y(e);const $=()=>{H=!0;const t=_(e)||x(e);return t&&"boolean"!=typeof t?s.call(e,t):D&&!j&&w(e,!0)&&!S(e,!1)?s.call(e,new o):!O||U||T(e,!1)?void s.call(e):s.call(e,new o)},W=()=>{H=!0;const t=_(e)||x(e);if(t&&"boolean"!=typeof t)return s.call(e,t);s.call(e)},q=()=>{e.req.on("finish",V)};!function(e){return e.setHeader&&"function"==typeof e.abort}(e)?O&&!P&&(e.on("end",L),e.on("close",L)):(e.on("complete",V),B||e.on("abort",$),e.req?q():e.on("request",q)),B||"boolean"!=typeof e.aborted||e.on("aborted",$),e.on("end",z),e.on("finish",V),!1!==t.error&&e.on("error",G),e.on("close",$),H?r.nextTick($):null!=P&&P.errorEmitted||null!=N&&N.errorEmitted?B||r.nextTick(W):(D||B&&!b(e)||!U&&!1!==E(e))&&(O||B&&!E(e)||!j&&!1!==b(e))?N&&e.req&&e.aborted&&r.nextTick(W):r.nextTick(W);const X=()=>{s=M,e.removeListener("aborted",$),e.removeListener("complete",V),e.removeListener("abort",$),e.removeListener("request",q),e.req&&e.req.removeListener("finish",V),e.removeListener("end",L),e.removeListener("close",L),e.removeListener("finish",V),e.removeListener("end",z),e.removeListener("error",G),e.removeListener("close",$)};if(t.signal&&!H){const a=()=>{const n=s;X(),n.call(e,new i(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)r.nextTick(a);else{R=R||n(6609).addAbortListener;const r=R(t.signal,a),i=s;s=l((...t)=>{r[m](),i.apply(e,t)})}}return X}e.exports=D,e.exports.finished=function(e,t){var n;let r=!1;return null===t&&(t=c),null!==(n=t)&&void 0!==n&&n.cleanup&&(f(t.cleanup,"cleanup"),r=t.cleanup),new p((n,i)=>{const s=D(e,t,e=>{r&&s(),e?i(e):n()})})}},1613:(e,t,n)=>{"use strict";const r=n(9907),{PromisePrototypeThen:i,SymbolAsyncIterator:s,SymbolIterator:a}=n(1473),{Buffer:o}=n(1048),{ERR_INVALID_ARG_TYPE:c,ERR_STREAM_NULL_VALUES:l}=n(2590).codes;e.exports=function(e,t,n){let u,h;if("string"==typeof t||t instanceof o)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});if(t&&t[s])h=!0,u=t[s]();else{if(!t||!t[a])throw new c("iterable",["Iterable"],t);h=!1,u=t[a]()}const d=new e({objectMode:!0,highWaterMark:1,...n});let f=!1;return d._read=function(){f||(f=!0,async function(){for(;;){try{const{value:e,done:t}=h?await u.next():u.next();if(t)d.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw f=!1,new l;if(d.push(t))continue;f=!1}}catch(e){d.destroy(e)}break}}())},d._destroy=function(e,t){i(async function(e){const t=null!=e,n="function"==typeof u.throw;if(t&&n){const{value:t,done:n}=await u.throw(e);if(await t,n)return}if("function"==typeof u.return){const{value:e}=await u.return();await e}}(e),()=>r.nextTick(t,e),n=>r.nextTick(t,n||e))},d}},3054:(e,t,n)=>{"use strict";const{ArrayIsArray:r,ObjectSetPrototypeOf:i}=n(1473),{EventEmitter:s}=n(46);function a(e){s.call(this,e)}function o(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?r(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}i(a.prototype,s.prototype),i(a,s),a.prototype.pipe=function(e,t){const n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",i),e._isStdio||t&&!1===t.end||(n.on("end",c),n.on("close",l));let a=!1;function c(){a||(a=!0,e.end())}function l(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){h(),0===s.listenerCount(this,"error")&&this.emit("error",e)}function h(){n.removeListener("data",r),e.removeListener("drain",i),n.removeListener("end",c),n.removeListener("close",l),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),e.removeListener("close",h)}return o(n,"error",u),o(e,"error",u),n.on("end",h),n.on("close",h),e.on("close",h),e.emit("pipe",n),e},e.exports={Stream:a,prependListener:o}},4708:(e,t,n)=>{"use strict";const r=globalThis.AbortController||n(7083).AbortController,{codes:{ERR_INVALID_ARG_VALUE:i,ERR_INVALID_ARG_TYPE:s,ERR_MISSING_ARGS:a,ERR_OUT_OF_RANGE:o},AbortError:c}=n(2590),{validateAbortSignal:l,validateInteger:u,validateObject:h}=n(7840),d=n(1473).Symbol("kWeak"),f=n(1473).Symbol("kResistStopPropagation"),{finished:p}=n(4869),g=n(7369),{addAbortSignalNoValidate:m}=n(1434),{isWritable:y,isNodeStream:b}=n(2520),{deprecate:w}=n(6609),{ArrayPrototypePush:v,Boolean:S,MathFloor:x,Number:E,NumberIsNaN:I,Promise:k,PromiseReject:T,PromiseResolve:_,PromisePrototypeThen:C,Symbol:A}=n(1473),F=A("kEmpty"),R=A("kEof");function M(e,t){if("function"!=typeof e)throw new s("fn",["Function","AsyncFunction"],e);null!=t&&h(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal");let r=1;null!=(null==t?void 0:t.concurrency)&&(r=x(t.concurrency));let i=r-1;return null!=(null==t?void 0:t.highWaterMark)&&(i=x(t.highWaterMark)),u(r,"options.concurrency",1),u(i,"options.highWaterMark",0),i+=r,async function*(){const s=n(6609).AbortSignalAny([null==t?void 0:t.signal].filter(S)),a=this,o=[],l={signal:s};let u,h,d=!1,f=0;function p(){d=!0,g()}function g(){f-=1,m()}function m(){h&&!d&&f<r&&o.length<i&&(h(),h=null)}!async function(){try{for await(let t of a){if(d)return;if(s.aborted)throw new c;try{if(t=e(t,l),t===F)continue;t=_(t)}catch(e){t=T(e)}f+=1,C(t,g,p),o.push(t),u&&(u(),u=null),!d&&(o.length>=i||f>=r)&&await new k(e=>{h=e})}o.push(R)}catch(e){const t=T(e);C(t,g,p),o.push(t)}finally{d=!0,u&&(u(),u=null)}}();try{for(;;){for(;o.length>0;){const e=await o[0];if(e===R)return;if(s.aborted)throw new c;e!==F&&(yield e),o.shift(),m()}await new k(e=>{u=e})}}finally{d=!0,h&&(h(),h=null)}}.call(this)}async function D(e,t=void 0){for await(const n of O.call(this,e,t))return!0;return!1}function O(e,t){if("function"!=typeof e)throw new s("fn",["Function","AsyncFunction"],e);return M.call(this,async function(t,n){return await e(t,n)?t:F},t)}class P extends a{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function N(e){if(e=E(e),I(e))return 0;if(e<0)throw new o("number",">= 0",e);return e}e.exports.streamReturningOperators={asIndexedPairs:w(function(e=void 0){return null!=e&&h(e,"options"),null!=(null==e?void 0:e.signal)&&l(e.signal,"options.signal"),async function*(){let t=0;for await(const r of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new c({cause:e.signal.reason});yield[t++,r]}}.call(this)},"readable.asIndexedPairs will be removed in a future version."),drop:function(e,t=void 0){return null!=t&&h(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),e=N(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new c;for await(const n of this){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new c;e--<=0&&(yield n)}}.call(this)},filter:O,flatMap:function(e,t){const n=M.call(this,e,t);return async function*(){for await(const e of n)yield*e}.call(this)},map:M,take:function(e,t=void 0){return null!=t&&h(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),e=N(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new c;for await(const n of this){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new c;if(e-- >0&&(yield n),e<=0)return}}.call(this)},compose:function(e,t){if(null!=t&&h(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),b(e)&&!y(e))throw new i("stream",e,"must be writable");const n=g(this,e);return null!=t&&t.signal&&m(t.signal,n),n}},e.exports.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new s("fn",["Function","AsyncFunction"],e);return!await D.call(this,async(...t)=>!await e(...t),t)},forEach:async function(e,t){if("function"!=typeof e)throw new s("fn",["Function","AsyncFunction"],e);for await(const n of M.call(this,async function(t,n){return await e(t,n),F},t));},reduce:async function(e,t,n){var i;if("function"!=typeof e)throw new s("reducer",["Function","AsyncFunction"],e);null!=n&&h(n,"options"),null!=(null==n?void 0:n.signal)&&l(n.signal,"options.signal");let a=arguments.length>1;if(null!=n&&null!==(i=n.signal)&&void 0!==i&&i.aborted){const e=new c(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await p(this.destroy(e)),e}const o=new r,u=o.signal;if(null!=n&&n.signal){const e={once:!0,[d]:this,[f]:!0};n.signal.addEventListener("abort",()=>o.abort(),e)}let g=!1;try{for await(const r of this){var m;if(g=!0,null!=n&&null!==(m=n.signal)&&void 0!==m&&m.aborted)throw new c;a?t=await e(t,r,{signal:u}):(t=r,a=!0)}if(!g&&!a)throw new P}finally{o.abort()}return t},toArray:async function(e){null!=e&&h(e,"options"),null!=(null==e?void 0:e.signal)&&l(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new c(void 0,{cause:e.signal.reason});v(t,r)}return t},some:D,find:async function(e,t){for await(const n of O.call(this,e,t))return n}}},6587:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:r}=n(1473);e.exports=s;const i=n(2073);function s(e){if(!(this instanceof s))return new s(e);i.call(this,e)}r(s.prototype,i.prototype),r(s,i),s.prototype._transform=function(e,t,n){n(null,e)}},6815:(e,t,n)=>{const r=n(9907),{ArrayIsArray:i,Promise:s,SymbolAsyncIterator:a,SymbolDispose:o}=n(1473),c=n(4869),{once:l}=n(6609),u=n(6527),h=n(6279),{aggregateTwoErrors:d,codes:{ERR_INVALID_ARG_TYPE:f,ERR_INVALID_RETURN_VALUE:p,ERR_MISSING_ARGS:g,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=n(2590),{validateFunction:w,validateAbortSignal:v}=n(7840),{isIterable:S,isReadable:x,isReadableNodeStream:E,isNodeStream:I,isTransformStream:k,isWebStream:T,isReadableStream:_,isReadableFinished:C}=n(2520),A=globalThis.AbortController||n(7083).AbortController;let F,R,M;function D(e,t,n){let r=!1;return e.on("close",()=>{r=!0}),{destroy:t=>{r||(r=!0,u.destroyer(e,t||new m("pipe")))},cleanup:c(e,{readable:t,writable:n},e=>{r=!e})}}function O(e){if(S(e))return e;if(E(e))return async function*(e){R||(R=n(1509)),yield*R.prototype[a].call(e)}(e);throw new f("val",["Readable","Iterable","AsyncIterable"],e)}async function P(e,t,n,{end:r}){let i,a=null;const o=e=>{if(e&&(i=e),a){const e=a;a=null,e()}},l=()=>new s((e,t)=>{i?t(i):a=()=>{i?t(i):e()}});t.on("drain",o);const u=c(t,{readable:!1},o);try{t.writableNeedDrain&&await l();for await(const n of e)t.write(n)||await l();r&&(t.end(),await l()),n()}catch(e){n(i!==e?d(i,e):e)}finally{u(),t.off("drain",o)}}async function N(e,t,n,{end:r}){k(t)&&(t=t.writable);const i=t.getWriter();try{for await(const t of e)await i.ready,i.write(t).catch(()=>{});await i.ready,r&&await i.close(),n()}catch(e){try{await i.abort(e),n(e)}catch(e){n(e)}}}function L(e,t,s){if(1===e.length&&i(e[0])&&(e=e[0]),e.length<2)throw new g("streams");const a=new A,c=a.signal,l=null==s?void 0:s.signal,u=[];function d(){V(new b)}let m,y,w;v(l,"options.signal"),M=M||n(6609).addAbortListener,l&&(m=M(l,d));const C=[];let R,L=0;function U(e){V(e,0==--L)}function V(e,n){var i;if(!e||y&&"ERR_STREAM_PREMATURE_CLOSE"!==y.code||(y=e),y||n){for(;C.length;)C.shift()(y);null===(i=m)||void 0===i||i[o](),a.abort(),n&&(y||u.forEach(e=>e()),r.nextTick(t,y,w))}}for(let H=0;H<e.length;H++){const $=e[H],W=H<e.length-1,q=H>0,X=W||!1!==(null==s?void 0:s.end),Y=H===e.length-1;if(I($)){if(X){const{destroy:K,cleanup:J}=D($,W,q);C.push(K),x($)&&Y&&u.push(J)}function j(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&U(e)}$.on("error",j),x($)&&Y&&u.push(()=>{$.removeListener("error",j)})}if(0===H)if("function"==typeof $){if(R=$({signal:c}),!S(R))throw new p("Iterable, AsyncIterable or Stream","source",R)}else R=S($)||E($)||k($)?$:h.from($);else if("function"==typeof $){var z;if(R=k(R)?O(null===(z=R)||void 0===z?void 0:z.readable):O(R),R=$(R,{signal:c}),W){if(!S(R,!0))throw new p("AsyncIterable",`transform[${H-1}]`,R)}else{var G;F||(F=n(6587));const Z=new F({objectMode:!0}),Q=null===(G=R)||void 0===G?void 0:G.then;if("function"==typeof Q)L++,Q.call(R,e=>{w=e,null!=e&&Z.write(e),X&&Z.end(),r.nextTick(U)},e=>{Z.destroy(e),r.nextTick(U,e)});else if(S(R,!0))L++,P(R,Z,U,{end:X});else{if(!_(R)&&!k(R))throw new p("AsyncIterable or Promise","destination",R);{const ne=R.readable||R;L++,P(ne,Z,U,{end:X})}}R=Z;const{destroy:ee,cleanup:te}=D(R,!1,!0);C.push(ee),Y&&u.push(te)}}else if(I($)){if(E(R)){L+=2;const re=B(R,$,U,{end:X});x($)&&Y&&u.push(re)}else if(k(R)||_(R)){const ie=R.readable||R;L++,P(ie,$,U,{end:X})}else{if(!S(R))throw new f("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],R);L++,P(R,$,U,{end:X})}R=$}else if(T($)){if(E(R))L++,N(O(R),$,U,{end:X});else if(_(R)||S(R))L++,N(R,$,U,{end:X});else{if(!k(R))throw new f("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],R);L++,N(R.readable,$,U,{end:X})}R=$}else R=h.from($)}return(null!=c&&c.aborted||null!=l&&l.aborted)&&r.nextTick(d),R}function B(e,t,n,{end:i}){let s=!1;if(t.on("close",()=>{s||n(new y)}),e.pipe(t,{end:!1}),i){function a(){s=!0,t.end()}C(e)?r.nextTick(a):e.once("end",a)}else n();return c(e,{readable:!0,writable:!1},t=>{const r=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&r&&r.ended&&!r.errored&&!r.errorEmitted?e.once("end",n).once("error",n):n(t)}),c(t,{readable:!1,writable:!0},n)}e.exports={pipelineImpl:L,pipeline:function(...e){return L(e,l(function(e){return w(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}}},1509:(e,t,n)=>{"use strict";const r=n(9907),{ArrayPrototypeIndexOf:i,NumberIsInteger:s,NumberIsNaN:a,NumberParseInt:o,ObjectDefineProperties:c,ObjectKeys:l,ObjectSetPrototypeOf:u,Promise:h,SafeSet:d,SymbolAsyncDispose:f,SymbolAsyncIterator:p,Symbol:g}=n(1473);e.exports=q,q.ReadableState=W;const{EventEmitter:m}=n(46),{Stream:y,prependListener:b}=n(3054),{Buffer:w}=n(1048),{addAbortSignal:v}=n(1434),S=n(4869);let x=n(6609).debuglog("stream",e=>{x=e});const E=n(82),I=n(6527),{getHighWaterMark:k,getDefaultHighWaterMark:T}=n(9952),{aggregateTwoErrors:_,codes:{ERR_INVALID_ARG_TYPE:C,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_OUT_OF_RANGE:F,ERR_STREAM_PUSH_AFTER_EOF:R,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:M},AbortError:D}=n(2590),{validateObject:O}=n(7840),P=g("kPaused"),{StringDecoder:N}=n(8888),L=n(1613);u(q.prototype,y.prototype),u(q,y);const B=()=>{},{errorOrDestroy:U}=I,V=1,j=16,z=32,G=2048,H=4096;function $(e){return{enumerable:!1,get(){return!!(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function W(e,t,r){"boolean"!=typeof r&&(r=t instanceof n(6279)),this.state=G|H|j|z,e&&e.objectMode&&(this.state|=V),r&&e&&e.readableObjectMode&&(this.state|=V),this.highWaterMark=e?k(this,e,"readableHighWaterMark",r):T(!1),this.buffer=new E,this.length=0,this.pipes=[],this.flowing=null,this[P]=null,e&&!1===e.emitClose&&(this.state&=~G),e&&!1===e.autoDestroy&&(this.state&=~H),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new N(e.encoding),this.encoding=e.encoding)}function q(e){if(!(this instanceof q))return new q(e);const t=this instanceof n(6279);this._readableState=new W(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&v(e.signal,this)),y.call(this,e),I.construct(this,()=>{this._readableState.needReadable&&Q(this,this._readableState)})}function X(e,t,n,r){x("readableAddChunk",t);const i=e._readableState;let s;if(i.state&V||("string"==typeof t?(n=n||i.defaultEncoding,i.encoding!==n&&(r&&i.encoding?t=w.from(t,n).toString(i.encoding):(t=w.from(t,n),n=""))):t instanceof w?n="":y._isUint8Array(t)?(t=y._uint8ArrayToBuffer(t),n=""):null!=t&&(s=new C("chunk",["string","Buffer","Uint8Array"],t))),s)U(e,s);else if(null===t)i.state&=-9,function(e,t){if(x("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?J(e):(t.needReadable=!1,t.emittedReadable=!0,Z(e))}}(e,i);else if(i.state&V||t&&t.length>0)if(r)if(4&i.state)U(e,new M);else{if(i.destroyed||i.errored)return!1;Y(e,i,t,!0)}else if(i.ended)U(e,new R);else{if(i.destroyed||i.errored)return!1;i.state&=-9,i.decoder&&!n?(t=i.decoder.write(t),i.objectMode||0!==t.length?Y(e,i,t,!1):Q(e,i)):Y(e,i,t,!1)}else r||(i.state&=-9,Q(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function Y(e,t,n,r){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(65536&t.state?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),64&t.state&&J(e)),Q(e,t)}function K(e,t){return e<=0||0===t.length&&t.ended?0:t.state&V?1:a(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function J(e){const t=e._readableState;x("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(x("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(Z,e))}function Z(e){const t=e._readableState;x("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,ie(e)}function Q(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,r.nextTick(ee,e,t))}function ee(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const n=t.length;if(x("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function te(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[P]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function ne(e){x("readable nexttick read 0"),e.read(0)}function re(e,t){x("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),ie(e),t.flowing&&!t.reading&&e.read(0)}function ie(e){const t=e._readableState;for(x("flow",t.flowing);t.flowing&&null!==e.read(););}function se(e,t){"function"!=typeof e.read&&(e=q.wrap(e,{objectMode:!0}));const n=async function*(e,t){let n,r=B;function i(t){this===e?(r(),r=B):r=t}e.on("readable",i);const s=S(e,{writable:!1},e=>{n=e?_(n,e):null,r(),r=B});try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(n)throw n;if(null===n)return;await new h(i)}}}catch(e){throw n=_(n,e),n}finally{!n&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==n&&!e._readableState.autoDestroy?(e.off("readable",i),s()):I.destroyer(e,null)}}(e,t);return n.stream=e,n}function ae(e,t){if(0===t.length)return null;let n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n}function oe(e){const t=e._readableState;x("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(ce,t,e))}function ce(e,t){if(x("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)r.nextTick(le,t);else if(e.autoDestroy){const e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}function le(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let ue;function he(){return void 0===ue&&(ue={}),ue}c(W.prototype,{objectMode:$(V),ended:$(2),endEmitted:$(4),reading:$(8),constructed:$(j),sync:$(z),needReadable:$(64),emittedReadable:$(128),readableListening:$(256),resumeScheduled:$(512),errorEmitted:$(1024),emitClose:$(G),autoDestroy:$(H),destroyed:$(8192),closed:$(16384),closeEmitted:$(32768),multiAwaitDrain:$(65536),readingMore:$(1<<17),dataEmitted:$(1<<18)}),q.prototype.destroy=I.destroy,q.prototype._undestroy=I.undestroy,q.prototype._destroy=function(e,t){t(e)},q.prototype[m.captureRejectionSymbol]=function(e){this.destroy(e)},q.prototype[f]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new D,this.destroy(e)),new h((t,n)=>S(this,r=>r&&r!==e?n(r):t(null)))},q.prototype.push=function(e,t){return X(this,e,t,!1)},q.prototype.unshift=function(e,t){return X(this,e,t,!0)},q.prototype.isPaused=function(){const e=this._readableState;return!0===e[P]||!1===e.flowing},q.prototype.setEncoding=function(e){const t=new N(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const n=this._readableState.buffer;let r="";for(const e of n)r+=t.write(e);return n.clear(),""!==r&&n.push(r),this._readableState.length=r.length,this},q.prototype.read=function(e){x("read",e),void 0===e?e=NaN:s(e)||(e=o(e,10));const t=this._readableState,n=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new F("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return x("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?oe(this):J(this),null;if(0===(e=K(e,t))&&t.ended)return 0===t.length&&oe(this),null;let r,i=!!(64&t.state);if(x("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&(i=!0,x("length less than watermark",i)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)i=!1,x("reading, ended or constructing",i);else if(i){x("do read"),t.state|=8|z,0===t.length&&(t.state|=64);try{this._read(t.highWaterMark)}catch(e){U(this,e)}t.state&=~z,t.reading||(e=K(n,t))}return r=e>0?ae(e,t):null,null===r?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&oe(this)),null===r||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",r)),r},q.prototype._read=function(e){throw new A("_read()")},q.prototype.pipe=function(e,t){const n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new d(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(e),x("pipe count=%d opts=%j",i.pipes.length,t);const s=t&&!1===t.end||e===r.stdout||e===r.stderr?g:a;function a(){x("onend"),e.end()}let o;i.endEmitted?r.nextTick(s):n.once("end",s),e.on("unpipe",function t(r,s){x("onunpipe"),r===n&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,x("cleanup"),e.removeListener("close",f),e.removeListener("finish",p),o&&e.removeListener("drain",o),e.removeListener("error",h),e.removeListener("unpipe",t),n.removeListener("end",a),n.removeListener("end",g),n.removeListener("data",u),c=!0,o&&i.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&o())});let c=!1;function l(){c||(1===i.pipes.length&&i.pipes[0]===e?(x("false write response, pause",0),i.awaitDrainWriters=e,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(e)&&(x("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(e)),n.pause()),o||(o=function(e,t){return function(){const n=e._readableState;n.awaitDrainWriters===t?(x("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(x("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),n.awaitDrainWriters&&0!==n.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}(n,e),e.on("drain",o))}function u(t){x("ondata");const n=e.write(t);x("dest.write",n),!1===n&&l()}function h(t){if(x("onerror",t),g(),e.removeListener("error",h),0===e.listenerCount("error")){const n=e._writableState||e._readableState;n&&!n.errorEmitted?U(e,t):e.emit("error",t)}}function f(){e.removeListener("finish",p),g()}function p(){x("onfinish"),e.removeListener("close",f),g()}function g(){x("unpipe"),n.unpipe(e)}return n.on("data",u),b(e,"error",h),e.once("close",f),e.once("finish",p),e.emit("pipe",n),!0===e.writableNeedDrain?l():i.flowing||(x("pipe resume"),n.resume()),e},q.prototype.unpipe=function(e){const t=this._readableState;if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=i(t.pipes,e);return-1===n||(t.pipes.splice(n,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},q.prototype.on=function(e,t){const n=y.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,x("on readable",i.length,i.reading),i.length?J(this):i.reading||r.nextTick(ne,this))),n},q.prototype.addListener=q.prototype.on,q.prototype.removeListener=function(e,t){const n=y.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(te,this),n},q.prototype.off=q.prototype.removeListener,q.prototype.removeAllListeners=function(e){const t=y.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(te,this),t},q.prototype.resume=function(){const e=this._readableState;return e.flowing||(x("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(re,e,t))}(this,e)),e[P]=!1,this},q.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[P]=!0,this},q.prototype.wrap=function(e){let t=!1;e.on("data",n=>{!this.push(n)&&e.pause&&(t=!0,e.pause())}),e.on("end",()=>{this.push(null)}),e.on("error",e=>{U(this,e)}),e.on("close",()=>{this.destroy()}),e.on("destroy",()=>{this.destroy()}),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const n=l(e);for(let t=1;t<n.length;t++){const r=n[t];void 0===this[r]&&"function"==typeof e[r]&&(this[r]=e[r].bind(e))}return this},q.prototype[p]=function(){return se(this)},q.prototype.iterator=function(e){return void 0!==e&&O(e,"options"),se(this,e)},c(q.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),c(W.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[P]},set(e){this[P]=!!e}}}),q._fromList=ae,q.from=function(e,t){return L(q,e,t)},q.fromWeb=function(e,t){return he().newStreamReadableFromReadableStream(e,t)},q.toWeb=function(e,t){return he().newReadableStreamFromStreamReadable(e,t)},q.wrap=function(e,t){var n,r;return new q({objectMode:null===(n=null!==(r=e.readableObjectMode)&&void 0!==r?r:e.objectMode)||void 0===n||n,...t,destroy(t,n){I.destroyer(e,t),n(t)}}).wrap(e)}},9952:(e,t,n)=>{"use strict";const{MathFloor:r,NumberIsInteger:i}=n(1473),{validateInteger:s}=n(7840),{ERR_INVALID_ARG_VALUE:a}=n(2590).codes;let o=16384,c=16;function l(e){return e?c:o}e.exports={getHighWaterMark:function(e,t,n,s){const o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,s,n);if(null!=o){if(!i(o)||o<0)throw new a(s?`options.${n}`:"options.highWaterMark",o);return r(o)}return l(e.objectMode)},getDefaultHighWaterMark:l,setDefaultHighWaterMark:function(e,t){s(t,"value",0),e?c=t:o=t}}},2073:(e,t,n)=>{"use strict";const{ObjectSetPrototypeOf:r,Symbol:i}=n(1473);e.exports=l;const{ERR_METHOD_NOT_IMPLEMENTED:s}=n(2590).codes,a=n(6279),{getHighWaterMark:o}=n(9952);r(l.prototype,a.prototype),r(l,a);const c=i("kCallback");function l(e){if(!(this instanceof l))return new l(e);const t=e?o(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),a.call(this,e),this._readableState.sync=!1,this[c]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function u(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((t,n)=>{t?e?e(t):this.destroy(t):(null!=n&&this.push(n),this.push(null),e&&e())})}function h(){this._final!==u&&u.call(this)}l.prototype._final=u,l.prototype._transform=function(e,t,n){throw new s("_transform()")},l.prototype._write=function(e,t,n){const r=this._readableState,i=this._writableState,s=r.length;this._transform(e,t,(e,t)=>{e?n(e):(null!=t&&this.push(t),i.ended||s===r.length||r.length<r.highWaterMark?n():this[c]=n)})},l.prototype._read=function(){if(this[c]){const e=this[c];this[c]=null,e()}}},2520:(e,t,n)=>{"use strict";const{SymbolAsyncIterator:r,SymbolIterator:i,SymbolFor:s}=n(1473),a=s("nodejs.stream.destroyed"),o=s("nodejs.stream.errored"),c=s("nodejs.stream.readable"),l=s("nodejs.stream.writable"),u=s("nodejs.stream.disturbed"),h=s("nodejs.webstream.isClosedPromise"),d=s("nodejs.webstream.controllerErrorFunction");function f(e,t=!1){var n;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(n=e._readableState)||void 0===n?void 0:n.readable)||e._writableState&&!e._readableState)}function p(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function g(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function m(e){return!(!e||g(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function y(e){return!(!e||g(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function b(e){return!(!e||g(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function w(e){if(!g(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[a]||null!=r&&r.destroyed)}function v(e){if(!p(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function S(e,t){if(!f(e))return null;const n=e._readableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.endEmitted)?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function x(e){return e&&null!=e[c]?e[c]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!w(e)&&f(e)&&e.readable&&!S(e)}function E(e){return e&&null!=e[l]?e[l]:"boolean"!=typeof(null==e?void 0:e.writable)?null:!w(e)&&p(e)&&e.writable&&!v(e)}function I(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function k(e){return"boolean"==typeof e._sent100&&I(e)}e.exports={isDestroyed:w,kIsDestroyed:a,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[u])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:u,isErrored:function(e){var t,n,r,i,s,a,c,l,u,h;return!(!e||!(null!==(t=null!==(n=null!==(r=null!==(i=null!==(s=null!==(a=e[o])&&void 0!==a?a:e.readableErrored)&&void 0!==s?s:e.writableErrored)&&void 0!==i?i:null===(c=e._readableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==r?r:null===(l=e._writableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==n?n:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(h=e._writableState)||void 0===h?void 0:h.errored))},kIsErrored:o,isReadable:x,kIsReadable:c,kIsClosedPromise:h,kControllerErrorFunction:d,kIsWritable:l,isClosed:function(e){if(!g(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,n=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==n?void 0:n.closed)?(null==t?void 0:t.closed)||(null==n?void 0:n.closed):"boolean"==typeof e._closed&&I(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return g(e)?!(!w(e)&&(!1!==(null==t?void 0:t.readable)&&x(e)||!1!==(null==t?void 0:t.writable)&&E(e))):null},isIterable:function(e,t){return null!=e&&(!0===t?"function"==typeof e[r]:!1===t?"function"==typeof e[i]:"function"==typeof e[r]||"function"==typeof e[i])},isReadableNodeStream:f,isReadableStream:m,isReadableEnded:function(e){if(!f(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)},isReadableFinished:S,isReadableErrored:function(e){var t,n;return g(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isNodeStream:g,isWebStream:function(e){return m(e)||y(e)||b(e)},isWritable:E,isWritableNodeStream:p,isWritableStream:y,isWritableEnded:v,isWritableFinished:function(e,t){if(!p(e))return null;if(!0===e.writableFinished)return!0;const n=e._writableState;return(null==n||!n.errored)&&("boolean"!=typeof(null==n?void 0:n.finished)?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))},isWritableErrored:function(e){var t,n;return g(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:k,willEmitClose:function(e){if(!g(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&k(e)||!!(r&&r.autoDestroy&&r.emitClose&&!1===r.closed)},isTransformStream:b}},5605:(e,t,n)=>{"use strict";const r=n(9907),{ArrayPrototypeSlice:i,Error:s,FunctionPrototypeSymbolHasInstance:a,ObjectDefineProperty:o,ObjectDefineProperties:c,ObjectSetPrototypeOf:l,StringPrototypeToLowerCase:u,Symbol:h,SymbolHasInstance:d}=n(1473);e.exports=O,O.WritableState=M;const{EventEmitter:f}=n(46),p=n(3054).Stream,{Buffer:g}=n(1048),m=n(6527),{addAbortSignal:y}=n(1434),{getHighWaterMark:b,getDefaultHighWaterMark:w}=n(9952),{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:S,ERR_MULTIPLE_CALLBACK:x,ERR_STREAM_CANNOT_PIPE:E,ERR_STREAM_DESTROYED:I,ERR_STREAM_ALREADY_FINISHED:k,ERR_STREAM_NULL_VALUES:T,ERR_STREAM_WRITE_AFTER_END:_,ERR_UNKNOWN_ENCODING:C}=n(2590).codes,{errorOrDestroy:A}=m;function F(){}l(O.prototype,p.prototype),l(O,p);const R=h("kOnFinished");function M(e,t,r){"boolean"!=typeof r&&(r=t instanceof n(6279)),this.objectMode=!(!e||!e.objectMode),r&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?b(this,e,"writableHighWaterMark",r):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const i=!(!e||!1!==e.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=B.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,D(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[R]=[]}function D(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function O(e){const t=this instanceof n(6279);if(!t&&!a(O,this))return new O(e);this._writableState=new M(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&y(e.signal,this)),p.call(this,e),m.construct(this,()=>{const e=this._writableState;e.writing||z(this,e),H(this,e)})}function P(e,t,n,i){const s=e._writableState;if("function"==typeof n)i=n,n=s.defaultEncoding;else{if(n){if("buffer"!==n&&!g.isEncoding(n))throw new C(n)}else n=s.defaultEncoding;"function"!=typeof i&&(i=F)}if(null===t)throw new T;if(!s.objectMode)if("string"==typeof t)!1!==s.decodeStrings&&(t=g.from(t,n),n="buffer");else if(t instanceof g)n="buffer";else{if(!p._isUint8Array(t))throw new v("chunk",["string","Buffer","Uint8Array"],t);t=p._uint8ArrayToBuffer(t),n="buffer"}let a;return s.ending?a=new _:s.destroyed&&(a=new I("write")),a?(r.nextTick(i,a),A(e,a,!0),a):(s.pendingcb++,function(e,t,n,r,i){const s=t.objectMode?1:n.length;t.length+=s;const a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:r,callback:i}),t.allBuffers&&"buffer"!==r&&(t.allBuffers=!1),t.allNoop&&i!==F&&(t.allNoop=!1)):(t.writelen=s,t.writecb=i,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1),a&&!t.errored&&!t.destroyed}(e,s,t,n,i))}function N(e,t,n,r,i,s,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new I("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function L(e,t,n,r){--t.pendingcb,r(n),j(t),A(e,n)}function B(e,t){const n=e._writableState,i=n.sync,s=n.writecb;"function"==typeof s?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(t.stack,n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?r.nextTick(L,e,n,t,s):L(e,n,t,s)):(n.buffered.length>n.bufferedIndex&&z(e,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===s?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:s,stream:e,state:n},r.nextTick(U,n.afterWriteTickInfo)):V(e,n,1,s))):A(e,new x)}function U({stream:e,state:t,count:n,cb:r}){return t.afterWriteTickInfo=null,V(e,t,n,r)}function V(e,t,n,r){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));n-- >0;)t.pendingcb--,r();t.destroyed&&j(t),H(e,t)}function j(e){if(e.writing)return;for(let n=e.bufferedIndex;n<e.buffered.length;++n){var t;const{chunk:r,callback:i}=e.buffered[n],s=e.objectMode?1:r.length;e.length-=s,i(null!==(t=e.errored)&&void 0!==t?t:new I("write"))}const n=e[R].splice(0);for(let t=0;t<n.length;t++){var r;n[t](null!==(r=e.errored)&&void 0!==r?r:new I("end"))}D(e)}function z(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:n,bufferedIndex:r,objectMode:s}=t,a=n.length-r;if(!a)return;let o=r;if(t.bufferProcessing=!0,a>1&&e._writev){t.pendingcb-=a-1;const r=t.allNoop?F:e=>{for(let t=o;t<n.length;++t)n[t].callback(e)},s=t.allNoop&&0===o?n:i(n,o);s.allBuffers=t.allBuffers,N(e,t,!0,t.length,s,"",r),D(t)}else{do{const{chunk:r,encoding:i,callback:a}=n[o];n[o++]=null,N(e,t,!1,s?1:r.length,r,i,a)}while(o<n.length&&!t.writing);o===n.length?D(t):o>256?(n.splice(0,o),t.bufferedIndex=0):t.bufferedIndex=o}t.bufferProcessing=!1}function G(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function H(e,t,n){G(t)&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,function(e,t){let n=!1;function i(i){if(n)A(e,null!=i?i:x());else if(n=!0,t.pendingcb--,i){const n=t[R].splice(0);for(let e=0;e<n.length;e++)n[e](i);A(e,i,t.sync)}else G(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,r.nextTick($,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(e){i(e)}t.sync=!1}(e,t)))}(e,t),0===t.pendingcb&&(n?(t.pendingcb++,r.nextTick((e,t)=>{G(t)?$(e,t):t.pendingcb--},e,t)):G(t)&&(t.pendingcb++,$(e,t))))}function $(e,t){t.pendingcb--,t.finished=!0;const n=t[R].splice(0);for(let e=0;e<n.length;e++)n[e]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}M.prototype.getBuffer=function(){return i(this.buffered,this.bufferedIndex)},o(M.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),o(O,d,{__proto__:null,value:function(e){return!!a(this,e)||this===O&&e&&e._writableState instanceof M}}),O.prototype.pipe=function(){A(this,new E)},O.prototype.write=function(e,t,n){return!0===P(this,e,t,n)},O.prototype.cork=function(){this._writableState.corked++},O.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||z(this,e))},O.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=u(e)),!g.isEncoding(e))throw new C(e);return this._writableState.defaultEncoding=e,this},O.prototype._write=function(e,t,n){if(!this._writev)throw new S("_write()");this._writev([{chunk:e,encoding:t}],n)},O.prototype._writev=null,O.prototype.end=function(e,t,n){const i=this._writableState;let a;if("function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e){const n=P(this,e,t);n instanceof s&&(a=n)}return i.corked&&(i.corked=1,this.uncork()),a||(i.errored||i.ending?i.finished?a=new k("end"):i.destroyed&&(a=new I("end")):(i.ending=!0,H(this,i,!0),i.ended=!0)),"function"==typeof n&&(a||i.finished?r.nextTick(n,a):i[R].push(n)),this},c(O.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const W=m.destroy;let q;function X(){return void 0===q&&(q={}),q}O.prototype.destroy=function(e,t){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[R].length)&&r.nextTick(j,n),W.call(this,e,t),this},O.prototype._undestroy=m.undestroy,O.prototype._destroy=function(e,t){t(e)},O.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},O.fromWeb=function(e,t){return X().newStreamWritableFromWritableStream(e,t)},O.toWeb=function(e){return X().newWritableStreamFromStreamWritable(e)}},7840:(e,t,n)=>{"use strict";const{ArrayIsArray:r,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:s,ArrayPrototypeMap:a,NumberIsInteger:o,NumberIsNaN:c,NumberMAX_SAFE_INTEGER:l,NumberMIN_SAFE_INTEGER:u,NumberParseInt:h,ObjectPrototypeHasOwnProperty:d,RegExpPrototypeExec:f,String:p,StringPrototypeToUpperCase:g,StringPrototypeTrim:m}=n(1473),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:w,ERR_INVALID_ARG_VALUE:v,ERR_OUT_OF_RANGE:S,ERR_UNKNOWN_SIGNAL:x}}=n(2590),{normalizeEncoding:E}=n(6609),{isAsyncFunction:I,isArrayBufferView:k}=n(6609).types,T={},_=/^[0-7]+$/,C=y((e,t,n=u,r=l)=>{if("number"!=typeof e)throw new w(t,"number",e);if(!o(e))throw new S(t,"an integer",e);if(e<n||e>r)throw new S(t,`>= ${n} && <= ${r}`,e)}),A=y((e,t,n=-2147483648,r=2147483647)=>{if("number"!=typeof e)throw new w(t,"number",e);if(!o(e))throw new S(t,"an integer",e);if(e<n||e>r)throw new S(t,`>= ${n} && <= ${r}`,e)}),F=y((e,t,n=!1)=>{if("number"!=typeof e)throw new w(t,"number",e);if(!o(e))throw new S(t,"an integer",e);const r=n?1:0,i=4294967295;if(e<r||e>i)throw new S(t,`>= ${r} && <= ${i}`,e)});function R(e,t){if("string"!=typeof e)throw new w(t,"string",e)}const M=y((e,t,n)=>{if(!i(n,e)){const r=s(a(n,e=>"string"==typeof e?`'${e}'`:p(e)),", ");throw new v(t,e,"must be one of: "+r)}});function D(e,t){if("boolean"!=typeof e)throw new w(t,"boolean",e)}function O(e,t,n){return null!=e&&d(e,t)?e[t]:n}const P=y((e,t,n=null)=>{const i=O(n,"allowArray",!1),s=O(n,"allowFunction",!1);if(!O(n,"nullable",!1)&&null===e||!i&&r(e)||"object"!=typeof e&&(!s||"function"!=typeof e))throw new w(t,"Object",e)}),N=y((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new w(t,"a dictionary",e)}),L=y((e,t,n=0)=>{if(!r(e))throw new w(t,"Array",e);if(e.length<n)throw new v(t,e,`must be longer than ${n}`)}),B=y((e,t="buffer")=>{if(!k(e))throw new w(t,["Buffer","TypedArray","DataView"],e)}),U=y((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new w(t,"AbortSignal",e)}),V=y((e,t)=>{if("function"!=typeof e)throw new w(t,"Function",e)}),j=y((e,t)=>{if("function"!=typeof e||I(e))throw new w(t,"Function",e)}),z=y((e,t)=>{if(void 0!==e)throw new w(t,"undefined",e)}),G=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function H(e,t){if(void 0===e||!f(G,e))throw new v(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}e.exports={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,n){if(void 0===e&&(e=n),"string"==typeof e){if(null===f(_,e))throw new v(t,e,"must be a 32-bit unsigned integer or an octal string");e=h(e,8)}return F(e,t),e},validateArray:L,validateStringArray:function(e,t){L(e,t);for(let n=0;n<e.length;n++)R(e[n],`${t}[${n}]`)},validateBooleanArray:function(e,t){L(e,t);for(let n=0;n<e.length;n++)D(e[n],`${t}[${n}]`)},validateAbortSignalArray:function(e,t){L(e,t);for(let n=0;n<e.length;n++){const r=e[n],i=`${t}[${n}]`;if(null==r)throw new w(i,"AbortSignal",r);U(r,i)}},validateBoolean:D,validateBuffer:B,validateDictionary:N,validateEncoding:function(e,t){const n=E(t),r=e.length;if("hex"===n&&r%2!=0)throw new v("encoding",t,`is invalid for data of length ${r}`)},validateFunction:V,validateInt32:A,validateInteger:C,validateNumber:function(e,t,n=void 0,r){if("number"!=typeof e)throw new w(t,"number",e);if(null!=n&&e<n||null!=r&&e>r||(null!=n||null!=r)&&c(e))throw new S(t,`${null!=n?`>= ${n}`:""}${null!=n&&null!=r?" && ":""}${null!=r?`<= ${r}`:""}`,e)},validateObject:P,validateOneOf:M,validatePlainFunction:j,validatePort:function(e,t="Port",n=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===m(e).length||+e!=+e>>>0||e>65535||0===e&&!n)throw new b(t,e,n);return 0|e},validateSignalName:function(e,t="signal"){if(R(e,t),void 0===T[e]){if(void 0!==T[g(e)])throw new x(e+" (signals must use all capital letters)");throw new x(e)}},validateString:R,validateUint32:F,validateUndefined:z,validateUnion:function(e,t,n){if(!i(n,e))throw new w(t,`('${s(n,"|")}')`,e)},validateAbortSignal:U,validateLinkHeaderValue:function(e){if("string"==typeof e)return H(e,"hints"),e;if(r(e)){const t=e.length;let n="";if(0===t)return n;for(let r=0;r<t;r++){const i=e[r];H(i,"hints"),n+=i,r!==t-1&&(n+=", ")}return n}throw new v("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},8521:(e,t,n)=>{"use strict";const r=n(601),i=n(2010),s=r.Readable.destroy;e.exports=r.Readable,e.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,e.exports._isUint8Array=r._isUint8Array,e.exports.isDisturbed=r.isDisturbed,e.exports.isErrored=r.isErrored,e.exports.isReadable=r.isReadable,e.exports.Readable=r.Readable,e.exports.Writable=r.Writable,e.exports.Duplex=r.Duplex,e.exports.Transform=r.Transform,e.exports.PassThrough=r.PassThrough,e.exports.addAbortSignal=r.addAbortSignal,e.exports.finished=r.finished,e.exports.destroy=r.destroy,e.exports.destroy=s,e.exports.pipeline=r.pipeline,e.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get:()=>i}),e.exports.Stream=r.Stream,e.exports.default=e.exports},2590:(e,t,n)=>{"use strict";const{format:r,inspect:i}=n(8998),{AggregateError:s}=n(1473),a=globalThis.AggregateError||s,o=Symbol("kIsNodeError"),c=["string","function","number","object","Function","Object","boolean","bigint","symbol"],l=/^([A-Z][a-z0-9]*)+$/,u={};function h(e,t){if(!e)throw new u.ERR_INTERNAL_ASSERTION(t)}function d(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function f(e,t,n){n||(n=Error);class i extends n{constructor(...n){super(function(e,t,n){if("function"==typeof t)return h(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const i=(t.match(/%[dfijoOs]/g)||[]).length;return h(i===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${i}).`),0===n.length?t:r(t,...n)}(e,t,n))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(i.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),i.prototype.code=e,i.prototype[o]=!0,u[e]=i}function p(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class g extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new u.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}f("ERR_ASSERTION","%s",Error),f("ERR_INVALID_ARG_TYPE",(e,t,n)=>{h("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const s=[],a=[],o=[];for(const e of t)h("string"==typeof e,"All expected entries have to be of type string"),c.includes(e)?s.push(e.toLowerCase()):l.test(e)?a.push(e):(h("object"!==e,'The value "object" should be written as "Object"'),o.push(e));if(a.length>0){const e=s.indexOf("object");-1!==e&&(s.splice(s,e,1),a.push("Object"))}if(s.length>0){switch(s.length){case 1:r+=`of type ${s[0]}`;break;case 2:r+=`one of type ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();r+=`one of type ${s.join(", ")}, or ${e}`}}(a.length>0||o.length>0)&&(r+=" or ")}if(a.length>0){switch(a.length){case 1:r+=`an instance of ${a[0]}`;break;case 2:r+=`an instance of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();r+=`an instance of ${a.join(", ")}, or ${e}`}}o.length>0&&(r+=" or ")}switch(o.length){case 0:break;case 1:o[0].toLowerCase()!==o[0]&&(r+="an "),r+=`${o[0]}`;break;case 2:r+=`one of ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();r+=`one of ${o.join(", ")}, or ${e}`}}if(null==n)r+=`. Received ${n}`;else if("function"==typeof n&&n.name)r+=`. Received function ${n.name}`;else if("object"==typeof n){var u;null!==(u=n.constructor)&&void 0!==u&&u.name?r+=`. Received an instance of ${n.constructor.name}`:r+=`. Received ${i(n,{depth:-1})}`}else{let e=i(n,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),r+=`. Received type ${typeof n} (${e})`}return r},TypeError),f("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=i(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError),f("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;return`Expected ${e} to be returned from the "${t}" function but got ${null!=n&&null!==(r=n.constructor)&&void 0!==r&&r.name?`instance of ${n.constructor.name}`:"type "+typeof n}.`},TypeError),f("ERR_MISSING_ARGS",(...e)=>{let t;h(e.length>0,"At least one arg needs to be specified");const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(e=>`"${e}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}}return`${t} must be specified`},TypeError),f("ERR_OUT_OF_RANGE",(e,t,n)=>{let r;if(h(t,'Missing "range" argument'),Number.isInteger(n)&&Math.abs(n)>2**32)r=d(String(n));else if("bigint"==typeof n){r=String(n);const e=BigInt(2)**BigInt(32);(n>e||n<-e)&&(r=d(r)),r+="n"}else r=i(n);return`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError),f("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),f("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),f("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),f("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),f("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),f("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),f("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),f("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),f("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),f("ERR_STREAM_WRITE_AFTER_END","write after end",Error),f("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),e.exports={AbortError:g,aggregateTwoErrors:p(function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new a([t,e],t.message);return n.code=t.code,n}return e||t}),hideStackFrames:p,codes:u}},1473:e=>{"use strict";class t extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}e.exports={AggregateError:t,ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,n)=>e.slice(t,n),Error,FunctionPrototypeCall:(e,t,...n)=>e.call(t,...n),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,n)=>Object.defineProperty(e,t,n),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,n)=>e.then(t,n),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String,StringPrototypeSlice:(e,t,n)=>e.slice(t,n),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,n)=>e.set(t,n),Boolean,Uint8Array}},6609:(e,t,n)=>{"use strict";const r=n(1048),{format:i,inspect:s}=n(8998),{codes:{ERR_INVALID_ARG_TYPE:a}}=n(2590),{kResistStopPropagation:o,AggregateError:c,SymbolDispose:l}=n(1473),u=globalThis.AbortSignal||n(7083).AbortSignal,h=globalThis.AbortController||n(7083).AbortController,d=Object.getPrototypeOf(async function(){}).constructor,f=globalThis.Blob||r.Blob,p=void 0!==f?function(e){return e instanceof f}:function(e){return!1},g=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new a(t,"AbortSignal",e)};e.exports={AggregateError:c,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...n){t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}},promisify:e=>new Promise((t,n)=>{e((e,...r)=>e?n(e):t(...r))}),debuglog:()=>function(){},format:i,inspect:s,types:{isAsyncFunction:e=>e instanceof d,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:p,deprecate:(e,t)=>e,addAbortListener:n(46).addAbortListener||function(e,t){if(void 0===e)throw new a("signal","AbortSignal",e);let n;return g(e,"signal"),(e=>{if("function"!=typeof e)throw new a("listener","Function",e)})(t),e.aborted?queueMicrotask(()=>t()):(e.addEventListener("abort",t,{__proto__:null,once:!0,[o]:!0}),n=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[l](){var e;null===(e=n)||void 0===e||e()}}},AbortSignalAny:u.any||function(e){if(1===e.length)return e[0];const t=new h,n=()=>t.abort();return e.forEach(e=>{g(e,"signals"),e.addEventListener("abort",n,{once:!0})}),t.signal.addEventListener("abort",()=>{e.forEach(e=>e.removeEventListener("abort",n))},{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},8998:e=>{"use strict";e.exports={format:(e,...t)=>e.replace(/%([sdifj])/g,function(...[e,n]){const r=t.shift();return"f"===n?r.toFixed(6):"j"===n?JSON.stringify(r):"s"===n&&"object"==typeof r?`${r.constructor!==Object?r.constructor.name:""} {}`.trim():r.toString()}),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}},601:(e,t,n)=>{"use strict";const{Buffer:r}=n(1048),{ObjectDefineProperty:i,ObjectKeys:s,ReflectApply:a}=n(1473),{promisify:{custom:o}}=n(6609),{streamReturningOperators:c,promiseReturningOperators:l}=n(4708),{codes:{ERR_ILLEGAL_CONSTRUCTOR:u}}=n(2590),h=n(7369),{setDefaultHighWaterMark:d,getDefaultHighWaterMark:f}=n(9952),{pipeline:p}=n(6815),{destroyer:g}=n(6527),m=n(4869),y=n(2010),b=n(2520),w=e.exports=n(3054).Stream;w.isDestroyed=b.isDestroyed,w.isDisturbed=b.isDisturbed,w.isErrored=b.isErrored,w.isReadable=b.isReadable,w.isWritable=b.isWritable,w.Readable=n(1509);for(const S of s(c)){const x=c[S];function E(...e){if(new.target)throw u();return w.Readable.from(a(x,this,e))}i(E,"name",{__proto__:null,value:x.name}),i(E,"length",{__proto__:null,value:x.length}),i(w.Readable.prototype,S,{__proto__:null,value:E,enumerable:!1,configurable:!0,writable:!0})}for(const I of s(l)){const k=l[I];function T(...e){if(new.target)throw u();return a(k,this,e)}i(T,"name",{__proto__:null,value:k.name}),i(T,"length",{__proto__:null,value:k.length}),i(w.Readable.prototype,I,{__proto__:null,value:T,enumerable:!1,configurable:!0,writable:!0})}w.Writable=n(5605),w.Duplex=n(6279),w.Transform=n(2073),w.PassThrough=n(6587),w.pipeline=p;const{addAbortSignal:v}=n(1434);w.addAbortSignal=v,w.finished=m,w.destroy=g,w.compose=h,w.setDefaultHighWaterMark=d,w.getDefaultHighWaterMark=f,i(w,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>y}),i(p,o,{__proto__:null,enumerable:!0,get:()=>y.pipeline}),i(m,o,{__proto__:null,enumerable:!0,get:()=>y.finished}),w.Stream=w,w._isUint8Array=function(e){return e instanceof Uint8Array},w._uint8ArrayToBuffer=function(e){return r.from(e.buffer,e.byteOffset,e.byteLength)}},2010:(e,t,n)=>{"use strict";const{ArrayPrototypePop:r,Promise:i}=n(1473),{isIterable:s,isNodeStream:a,isWebStream:o}=n(2520),{pipelineImpl:c}=n(6815),{finished:l}=n(4869);n(601),e.exports={finished:l,pipeline:function(...e){return new i((t,n)=>{let i,l;const u=e[e.length-1];if(u&&"object"==typeof u&&!a(u)&&!s(u)&&!o(u)){const t=r(e);i=t.signal,l=t.end}c(e,(e,r)=>{e?n(e):t(r)},{signal:i,end:l})})}}},6837:(e,t,n)=>{"use strict";var r=n(1743),i=n(9893);function s(e,t){return new RegExp(s.create(e,t))}s.create=function(e,t){if("string"!=typeof e)throw new TypeError("expected a string");var n=r({},t);!0===n.contains&&(n.strictNegate=!1);var s=!1!==n.strictOpen?"^":"",a=!1!==n.strictClose?"$":"",o=n.endChar?n.endChar:"+",c=s+(!1===n.strictNegate?"(?:(?!(?:"+e+")).)"+o:"(?:(?!^(?:"+e+")$).)"+o)+a;if(!0===n.safe&&!1===i(c))throw new Error("potentially unsafe regular expression: "+c);return c},e.exports=s},6030:function(e,t,n){var r,i;r=function(){return function(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var t=document.createElement("base");if(t.href=arguments[0],1===e)return t.href;var n=document.getElementsByTagName("head")[0];n.insertBefore(t,n.firstChild);for(var r,i=document.createElement("a"),s=1;s<e;s++)i.href=arguments[s],r=i.href,t.href=r;return n.removeChild(t),r}},void 0===(i=r.call(t,n,t,e))||(e.exports=i)},1309:(e,t,n)=>{var r=n(4045),i=n(8020),s=n(7732),a=n(5097);e.exports=function(e){var t,n,o=0,c={type:i.ROOT,stack:[]},l=c,u=c.stack,h=[],d=function(t){r.error(e,"Nothing to repeat at column "+(t-1))},f=r.strToChars(e);for(t=f.length;o<t;)switch(n=f[o++]){case"\\":switch(n=f[o++]){case"b":u.push(a.wordBoundary());break;case"B":u.push(a.nonWordBoundary());break;case"w":u.push(s.words());break;case"W":u.push(s.notWords());break;case"d":u.push(s.ints());break;case"D":u.push(s.notInts());break;case"s":u.push(s.whitespace());break;case"S":u.push(s.notWhitespace());break;default:/\d/.test(n)?u.push({type:i.REFERENCE,value:parseInt(n,10)}):u.push({type:i.CHAR,value:n.charCodeAt(0)})}break;case"^":u.push(a.begin());break;case"$":u.push(a.end());break;case"[":var p;"^"===f[o]?(p=!0,o++):p=!1;var g=r.tokenizeClass(f.slice(o),e);o+=g[1],u.push({type:i.SET,set:g[0],not:p});break;case".":u.push(s.anyChar());break;case"(":var m={type:i.GROUP,stack:[],remember:!0};"?"===(n=f[o])&&(n=f[o+1],o+=2,"="===n?m.followedBy=!0:"!"===n?m.notFollowedBy=!0:":"!==n&&r.error(e,"Invalid group, character '"+n+"' after '?' at column "+(o-1)),m.remember=!1),u.push(m),h.push(l),l=m,u=m.stack;break;case")":0===h.length&&r.error(e,"Unmatched ) at column "+(o-1)),u=(l=h.pop()).options?l.options[l.options.length-1]:l.stack;break;case"|":l.options||(l.options=[l.stack],delete l.stack);var y=[];l.options.push(y),u=y;break;case"{":var b,w,v=/^(\d+)(,(\d+)?)?\}/.exec(f.slice(o));null!==v?(0===u.length&&d(o),b=parseInt(v[1],10),w=v[2]?v[3]?parseInt(v[3],10):1/0:b,o+=v[0].length,u.push({type:i.REPETITION,min:b,max:w,value:u.pop()})):u.push({type:i.CHAR,value:123});break;case"?":0===u.length&&d(o),u.push({type:i.REPETITION,min:0,max:1,value:u.pop()});break;case"+":0===u.length&&d(o),u.push({type:i.REPETITION,min:1,max:1/0,value:u.pop()});break;case"*":0===u.length&&d(o),u.push({type:i.REPETITION,min:0,max:1/0,value:u.pop()});break;default:u.push({type:i.CHAR,value:n.charCodeAt(0)})}return 0!==h.length&&r.error(e,"Unterminated group"),c},e.exports.types=i},5097:(e,t,n)=>{var r=n(8020);t.wordBoundary=function(){return{type:r.POSITION,value:"b"}},t.nonWordBoundary=function(){return{type:r.POSITION,value:"B"}},t.begin=function(){return{type:r.POSITION,value:"^"}},t.end=function(){return{type:r.POSITION,value:"$"}}},7732:(e,t,n)=>{var r=n(8020),i=function(){return[{type:r.RANGE,from:48,to:57}]},s=function(){return[{type:r.CHAR,value:95},{type:r.RANGE,from:97,to:122},{type:r.RANGE,from:65,to:90}].concat(i())},a=function(){return[{type:r.CHAR,value:9},{type:r.CHAR,value:10},{type:r.CHAR,value:11},{type:r.CHAR,value:12},{type:r.CHAR,value:13},{type:r.CHAR,value:32},{type:r.CHAR,value:160},{type:r.CHAR,value:5760},{type:r.CHAR,value:6158},{type:r.CHAR,value:8192},{type:r.CHAR,value:8193},{type:r.CHAR,value:8194},{type:r.CHAR,value:8195},{type:r.CHAR,value:8196},{type:r.CHAR,value:8197},{type:r.CHAR,value:8198},{type:r.CHAR,value:8199},{type:r.CHAR,value:8200},{type:r.CHAR,value:8201},{type:r.CHAR,value:8202},{type:r.CHAR,value:8232},{type:r.CHAR,value:8233},{type:r.CHAR,value:8239},{type:r.CHAR,value:8287},{type:r.CHAR,value:12288},{type:r.CHAR,value:65279}]};t.words=function(){return{type:r.SET,set:s(),not:!1}},t.notWords=function(){return{type:r.SET,set:s(),not:!0}},t.ints=function(){return{type:r.SET,set:i(),not:!1}},t.notInts=function(){return{type:r.SET,set:i(),not:!0}},t.whitespace=function(){return{type:r.SET,set:a(),not:!1}},t.notWhitespace=function(){return{type:r.SET,set:a(),not:!0}},t.anyChar=function(){return{type:r.SET,set:[{type:r.CHAR,value:10},{type:r.CHAR,value:13},{type:r.CHAR,value:8232},{type:r.CHAR,value:8233}],not:!0}}},8020:e=>{e.exports={ROOT:0,GROUP:1,POSITION:2,SET:3,RANGE:4,REPETITION:5,REFERENCE:6,CHAR:7}},4045:(e,t,n)=>{var r=n(8020),i=n(7732),s={0:0,t:9,n:10,v:11,f:12,r:13};t.strToChars=function(e){return e.replace(/(\[\\b\])|(\\)?\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z\[\\\]\^?])|([0tnvfr]))/g,function(e,t,n,r,i,a,o,c){if(n)return e;var l=t?8:r?parseInt(r,16):i?parseInt(i,16):a?parseInt(a,8):o?"@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?".indexOf(o):s[c],u=String.fromCharCode(l);return/[\[\]{}\^$.|?*+()]/.test(u)&&(u="\\"+u),u})},t.tokenizeClass=function(e,n){for(var s,a,o=[],c=/\\(?:(w)|(d)|(s)|(W)|(D)|(S))|((?:(?:\\)(.)|([^\]\\]))-(?:\\)?([^\]]))|(\])|(?:\\)?(.)/g;null!=(s=c.exec(e));)if(s[1])o.push(i.words());else if(s[2])o.push(i.ints());else if(s[3])o.push(i.whitespace());else if(s[4])o.push(i.notWords());else if(s[5])o.push(i.notInts());else if(s[6])o.push(i.notWhitespace());else if(s[7])o.push({type:r.RANGE,from:(s[8]||s[9]).charCodeAt(0),to:s[10].charCodeAt(0)});else{if(!(a=s[12]))return[o,c.lastIndex];o.push({type:r.CHAR,value:a.charCodeAt(0)})}t.error(n,"Unterminated character class")},t.error=function(e,t){throw new SyntaxError("Invalid regular expression: /"+e+"/: "+t)}},5586:(e,t,n)=>{"use strict";var r=n(1048).Buffer,i=n(5615),s=n(1848);function a(){s.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function o(e,t){return e<<t|e>>>32-t}function c(e,t,n,r,i,s,a,c){return o(e+(t^n^r)+s+a|0,c)+i|0}function l(e,t,n,r,i,s,a,c){return o(e+(t&n|~t&r)+s+a|0,c)+i|0}function u(e,t,n,r,i,s,a,c){return o(e+((t|~n)^r)+s+a|0,c)+i|0}function h(e,t,n,r,i,s,a,c){return o(e+(t&r|n&~r)+s+a|0,c)+i|0}function d(e,t,n,r,i,s,a,c){return o(e+(t^(n|~r))+s+a|0,c)+i|0}i(a,s),a.prototype._update=function(){for(var e=new Array(16),t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,r=this._b,i=this._c,s=this._d,a=this._e;n=c(n,r,i,s,a,e[0],0,11),a=c(a,n,r,i=o(i,10),s,e[1],0,14),s=c(s,a,n,r=o(r,10),i,e[2],0,15),i=c(i,s,a,n=o(n,10),r,e[3],0,12),r=c(r,i,s,a=o(a,10),n,e[4],0,5),n=c(n,r,i,s=o(s,10),a,e[5],0,8),a=c(a,n,r,i=o(i,10),s,e[6],0,7),s=c(s,a,n,r=o(r,10),i,e[7],0,9),i=c(i,s,a,n=o(n,10),r,e[8],0,11),r=c(r,i,s,a=o(a,10),n,e[9],0,13),n=c(n,r,i,s=o(s,10),a,e[10],0,14),a=c(a,n,r,i=o(i,10),s,e[11],0,15),s=c(s,a,n,r=o(r,10),i,e[12],0,6),i=c(i,s,a,n=o(n,10),r,e[13],0,7),r=c(r,i,s,a=o(a,10),n,e[14],0,9),a=l(a,n=c(n,r,i,s=o(s,10),a,e[15],0,8),r,i=o(i,10),s,e[7],1518500249,7),s=l(s,a,n,r=o(r,10),i,e[4],1518500249,6),i=l(i,s,a,n=o(n,10),r,e[13],1518500249,8),r=l(r,i,s,a=o(a,10),n,e[1],1518500249,13),n=l(n,r,i,s=o(s,10),a,e[10],1518500249,11),a=l(a,n,r,i=o(i,10),s,e[6],1518500249,9),s=l(s,a,n,r=o(r,10),i,e[15],1518500249,7),i=l(i,s,a,n=o(n,10),r,e[3],1518500249,15),r=l(r,i,s,a=o(a,10),n,e[12],1518500249,7),n=l(n,r,i,s=o(s,10),a,e[0],1518500249,12),a=l(a,n,r,i=o(i,10),s,e[9],1518500249,15),s=l(s,a,n,r=o(r,10),i,e[5],1518500249,9),i=l(i,s,a,n=o(n,10),r,e[2],1518500249,11),r=l(r,i,s,a=o(a,10),n,e[14],1518500249,7),n=l(n,r,i,s=o(s,10),a,e[11],1518500249,13),s=u(s,a=l(a,n,r,i=o(i,10),s,e[8],1518500249,12),n,r=o(r,10),i,e[3],1859775393,11),i=u(i,s,a,n=o(n,10),r,e[10],1859775393,13),r=u(r,i,s,a=o(a,10),n,e[14],1859775393,6),n=u(n,r,i,s=o(s,10),a,e[4],1859775393,7),a=u(a,n,r,i=o(i,10),s,e[9],1859775393,14),s=u(s,a,n,r=o(r,10),i,e[15],1859775393,9),i=u(i,s,a,n=o(n,10),r,e[8],1859775393,13),r=u(r,i,s,a=o(a,10),n,e[1],1859775393,15),n=u(n,r,i,s=o(s,10),a,e[2],1859775393,14),a=u(a,n,r,i=o(i,10),s,e[7],1859775393,8),s=u(s,a,n,r=o(r,10),i,e[0],1859775393,13),i=u(i,s,a,n=o(n,10),r,e[6],1859775393,6),r=u(r,i,s,a=o(a,10),n,e[13],1859775393,5),n=u(n,r,i,s=o(s,10),a,e[11],1859775393,12),a=u(a,n,r,i=o(i,10),s,e[5],1859775393,7),i=h(i,s=u(s,a,n,r=o(r,10),i,e[12],1859775393,5),a,n=o(n,10),r,e[1],2400959708,11),r=h(r,i,s,a=o(a,10),n,e[9],2400959708,12),n=h(n,r,i,s=o(s,10),a,e[11],2400959708,14),a=h(a,n,r,i=o(i,10),s,e[10],2400959708,15),s=h(s,a,n,r=o(r,10),i,e[0],2400959708,14),i=h(i,s,a,n=o(n,10),r,e[8],2400959708,15),r=h(r,i,s,a=o(a,10),n,e[12],2400959708,9),n=h(n,r,i,s=o(s,10),a,e[4],2400959708,8),a=h(a,n,r,i=o(i,10),s,e[13],2400959708,9),s=h(s,a,n,r=o(r,10),i,e[3],2400959708,14),i=h(i,s,a,n=o(n,10),r,e[7],2400959708,5),r=h(r,i,s,a=o(a,10),n,e[15],2400959708,6),n=h(n,r,i,s=o(s,10),a,e[14],2400959708,8),a=h(a,n,r,i=o(i,10),s,e[5],2400959708,6),s=h(s,a,n,r=o(r,10),i,e[6],2400959708,5),r=d(r,i=h(i,s,a,n=o(n,10),r,e[2],2400959708,12),s,a=o(a,10),n,e[4],2840853838,9),n=d(n,r,i,s=o(s,10),a,e[0],2840853838,15),a=d(a,n,r,i=o(i,10),s,e[5],2840853838,5),s=d(s,a,n,r=o(r,10),i,e[9],2840853838,11),i=d(i,s,a,n=o(n,10),r,e[7],2840853838,6),r=d(r,i,s,a=o(a,10),n,e[12],2840853838,8),n=d(n,r,i,s=o(s,10),a,e[2],2840853838,13),a=d(a,n,r,i=o(i,10),s,e[10],2840853838,12),s=d(s,a,n,r=o(r,10),i,e[14],2840853838,5),i=d(i,s,a,n=o(n,10),r,e[1],2840853838,12),r=d(r,i,s,a=o(a,10),n,e[3],2840853838,13),n=d(n,r,i,s=o(s,10),a,e[8],2840853838,14),a=d(a,n,r,i=o(i,10),s,e[11],2840853838,11),s=d(s,a,n,r=o(r,10),i,e[6],2840853838,8),i=d(i,s,a,n=o(n,10),r,e[15],2840853838,5),r=d(r,i,s,a=o(a,10),n,e[13],2840853838,6),s=o(s,10);var f=this._a,p=this._b,g=this._c,m=this._d,y=this._e;f=d(f,p,g,m,y,e[5],1352829926,8),y=d(y,f,p,g=o(g,10),m,e[14],1352829926,9),m=d(m,y,f,p=o(p,10),g,e[7],1352829926,9),g=d(g,m,y,f=o(f,10),p,e[0],1352829926,11),p=d(p,g,m,y=o(y,10),f,e[9],1352829926,13),f=d(f,p,g,m=o(m,10),y,e[2],1352829926,15),y=d(y,f,p,g=o(g,10),m,e[11],1352829926,15),m=d(m,y,f,p=o(p,10),g,e[4],1352829926,5),g=d(g,m,y,f=o(f,10),p,e[13],1352829926,7),p=d(p,g,m,y=o(y,10),f,e[6],1352829926,7),f=d(f,p,g,m=o(m,10),y,e[15],1352829926,8),y=d(y,f,p,g=o(g,10),m,e[8],1352829926,11),m=d(m,y,f,p=o(p,10),g,e[1],1352829926,14),g=d(g,m,y,f=o(f,10),p,e[10],1352829926,14),p=d(p,g,m,y=o(y,10),f,e[3],1352829926,12),y=h(y,f=d(f,p,g,m=o(m,10),y,e[12],1352829926,6),p,g=o(g,10),m,e[6],1548603684,9),m=h(m,y,f,p=o(p,10),g,e[11],1548603684,13),g=h(g,m,y,f=o(f,10),p,e[3],1548603684,15),p=h(p,g,m,y=o(y,10),f,e[7],1548603684,7),f=h(f,p,g,m=o(m,10),y,e[0],1548603684,12),y=h(y,f,p,g=o(g,10),m,e[13],1548603684,8),m=h(m,y,f,p=o(p,10),g,e[5],1548603684,9),g=h(g,m,y,f=o(f,10),p,e[10],1548603684,11),p=h(p,g,m,y=o(y,10),f,e[14],1548603684,7),f=h(f,p,g,m=o(m,10),y,e[15],1548603684,7),y=h(y,f,p,g=o(g,10),m,e[8],1548603684,12),m=h(m,y,f,p=o(p,10),g,e[12],1548603684,7),g=h(g,m,y,f=o(f,10),p,e[4],1548603684,6),p=h(p,g,m,y=o(y,10),f,e[9],1548603684,15),f=h(f,p,g,m=o(m,10),y,e[1],1548603684,13),m=u(m,y=h(y,f,p,g=o(g,10),m,e[2],1548603684,11),f,p=o(p,10),g,e[15],1836072691,9),g=u(g,m,y,f=o(f,10),p,e[5],1836072691,7),p=u(p,g,m,y=o(y,10),f,e[1],1836072691,15),f=u(f,p,g,m=o(m,10),y,e[3],1836072691,11),y=u(y,f,p,g=o(g,10),m,e[7],1836072691,8),m=u(m,y,f,p=o(p,10),g,e[14],1836072691,6),g=u(g,m,y,f=o(f,10),p,e[6],1836072691,6),p=u(p,g,m,y=o(y,10),f,e[9],1836072691,14),f=u(f,p,g,m=o(m,10),y,e[11],1836072691,12),y=u(y,f,p,g=o(g,10),m,e[8],1836072691,13),m=u(m,y,f,p=o(p,10),g,e[12],1836072691,5),g=u(g,m,y,f=o(f,10),p,e[2],1836072691,14),p=u(p,g,m,y=o(y,10),f,e[10],1836072691,13),f=u(f,p,g,m=o(m,10),y,e[0],1836072691,13),y=u(y,f,p,g=o(g,10),m,e[4],1836072691,7),g=l(g,m=u(m,y,f,p=o(p,10),g,e[13],1836072691,5),y,f=o(f,10),p,e[8],2053994217,15),p=l(p,g,m,y=o(y,10),f,e[6],2053994217,5),f=l(f,p,g,m=o(m,10),y,e[4],2053994217,8),y=l(y,f,p,g=o(g,10),m,e[1],2053994217,11),m=l(m,y,f,p=o(p,10),g,e[3],2053994217,14),g=l(g,m,y,f=o(f,10),p,e[11],2053994217,14),p=l(p,g,m,y=o(y,10),f,e[15],2053994217,6),f=l(f,p,g,m=o(m,10),y,e[0],2053994217,14),y=l(y,f,p,g=o(g,10),m,e[5],2053994217,6),m=l(m,y,f,p=o(p,10),g,e[12],2053994217,9),g=l(g,m,y,f=o(f,10),p,e[2],2053994217,12),p=l(p,g,m,y=o(y,10),f,e[13],2053994217,9),f=l(f,p,g,m=o(m,10),y,e[9],2053994217,12),y=l(y,f,p,g=o(g,10),m,e[7],2053994217,5),m=l(m,y,f,p=o(p,10),g,e[10],2053994217,15),p=c(p,g=l(g,m,y,f=o(f,10),p,e[14],2053994217,8),m,y=o(y,10),f,e[12],0,8),f=c(f,p,g,m=o(m,10),y,e[15],0,5),y=c(y,f,p,g=o(g,10),m,e[10],0,12),m=c(m,y,f,p=o(p,10),g,e[4],0,9),g=c(g,m,y,f=o(f,10),p,e[1],0,12),p=c(p,g,m,y=o(y,10),f,e[5],0,5),f=c(f,p,g,m=o(m,10),y,e[8],0,14),y=c(y,f,p,g=o(g,10),m,e[7],0,6),m=c(m,y,f,p=o(p,10),g,e[6],0,8),g=c(g,m,y,f=o(f,10),p,e[2],0,13),p=c(p,g,m,y=o(y,10),f,e[13],0,6),f=c(f,p,g,m=o(m,10),y,e[14],0,5),y=c(y,f,p,g=o(g,10),m,e[0],0,15),m=c(m,y,f,p=o(p,10),g,e[3],0,13),g=c(g,m,y,f=o(f,10),p,e[9],0,11),p=c(p,g,m,y=o(y,10),f,e[11],0,11),m=o(m,10);var b=this._b+i+m|0;this._b=this._c+s+y|0,this._c=this._d+a+f|0,this._d=this._e+n+p|0,this._e=this._a+r+g|0,this._a=b},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=new r(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=a},5636:(e,t,n)=>{var r=n(1048),i=r.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(s(r,t),t.Buffer=a),s(i,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},6132:(e,t,n)=>{"use strict";var r=n(4607),i=n(2672),s=r("RegExp.prototype.exec"),a=n(3468);e.exports=function(e){if(!i(e))throw new a("`regex` must be a RegExp");return function(t){return null!==s(e,t)}}},9893:(e,t,n)=>{var r=n(1309),i=r.types;e.exports=function(e,t){t||(t={});var n,s=void 0===t.limit?25:t.limit;n=e,"[object RegExp]"==={}.toString.call(n)?e=e.source:"string"!=typeof e&&(e=String(e));try{e=r(e)}catch(e){return!1}var a=0;return function e(t,n){if(t.type===i.REPETITION){if(n++,a++,n>1)return!1;if(a>s)return!1}if(t.options)for(var r=0,o=t.options.length;r<o;r++)if(!e({stack:t.options[r]},n))return!1;var c=t.stack||t.value&&t.value.stack;if(!c)return!0;for(r=0;r<c.length;r++)if(!e(c[r],n))return!1;return!0}(e,0)}},5150:(e,t,n)=>{var r=n(1048).Buffer;!function(e){e.parser=function(e,t){return new s(e,t)},e.SAXParser=s,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function s(t,n){if(!(this instanceof s))return new s(t,n);var r=this;!function(e){for(var t=0,n=i.length;t<n;t++)e[i[t]]=""}(r),r.q=r.c="",r.bufferCheckPosition=e.MAX_BUFFER_LENGTH,r.opt=n||{},r.opt.lowercase=r.opt.lowercase||r.opt.lowercasetags,r.looseCase=r.opt.lowercase?"toLowerCase":"toUpperCase",r.tags=[],r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.strict=!!t,r.noscript=!(!t&&!r.opt.noscript),r.state=k.BEGIN,r.strictEntities=r.opt.strictEntities,r.ENTITIES=r.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),r.attribList=[],r.opt.xmlns&&(r.ns=Object.create(d)),r.trackPosition=!1!==r.opt.position,r.trackPosition&&(r.position=r.line=r.column=0),_(r,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),s.prototype={end:function(){M(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return R(n,"Cannot write after close. Assign an onready handler.");if(null===t)return M(n);"object"==typeof t&&(t=t.toString());for(var r=0,s="";s=j(t,r++),n.c=s,s;)switch(n.trackPosition&&(n.position++,"\n"===s?(n.line++,n.column=0):n.column++),n.state){case k.BEGIN:if(n.state=k.BEGIN_WHITESPACE,"\ufeff"===s)continue;V(n,s);continue;case k.BEGIN_WHITESPACE:V(n,s);continue;case k.TEXT:if(n.sawRoot&&!n.closedRoot){for(var a=r-1;s&&"<"!==s&&"&"!==s;)(s=j(t,r++))&&n.trackPosition&&(n.position++,"\n"===s?(n.line++,n.column=0):n.column++);n.textNode+=t.substring(a,r-1)}"<"!==s||n.sawRoot&&n.closedRoot&&!n.strict?(y(s)||n.sawRoot&&!n.closedRoot||D(n,"Text data outside of root node."),"&"===s?n.state=k.TEXT_ENTITY:n.textNode+=s):(n.state=k.OPEN_WAKA,n.startTagPosition=n.position);continue;case k.SCRIPT:"<"===s?n.state=k.SCRIPT_ENDING:n.script+=s;continue;case k.SCRIPT_ENDING:"/"===s?n.state=k.CLOSE_TAG:(n.script+="<"+s,n.state=k.SCRIPT);continue;case k.OPEN_WAKA:if("!"===s)n.state=k.SGML_DECL,n.sgmlDecl="";else if(y(s));else if(v(f,s))n.state=k.OPEN_TAG,n.tagName=s;else if("/"===s)n.state=k.CLOSE_TAG,n.tagName="";else if("?"===s)n.state=k.PROC_INST,n.procInstName=n.procInstBody="";else{if(D(n,"Unencoded <"),n.startTagPosition+1<n.position){var o=n.position-n.startTagPosition;s=new Array(o).join(" ")+s}n.textNode+="<"+s,n.state=k.TEXT}continue;case k.SGML_DECL:(n.sgmlDecl+s).toUpperCase()===c?(C(n,"onopencdata"),n.state=k.CDATA,n.sgmlDecl="",n.cdata=""):n.sgmlDecl+s==="--"?(n.state=k.COMMENT,n.comment="",n.sgmlDecl=""):(n.sgmlDecl+s).toUpperCase()===l?(n.state=k.DOCTYPE,(n.doctype||n.sawRoot)&&D(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===s?(C(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=k.TEXT):b(s)?(n.state=k.SGML_DECL_QUOTED,n.sgmlDecl+=s):n.sgmlDecl+=s;continue;case k.SGML_DECL_QUOTED:s===n.q&&(n.state=k.SGML_DECL,n.q=""),n.sgmlDecl+=s;continue;case k.DOCTYPE:">"===s?(n.state=k.TEXT,C(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=s,"["===s?n.state=k.DOCTYPE_DTD:b(s)&&(n.state=k.DOCTYPE_QUOTED,n.q=s));continue;case k.DOCTYPE_QUOTED:n.doctype+=s,s===n.q&&(n.q="",n.state=k.DOCTYPE);continue;case k.DOCTYPE_DTD:n.doctype+=s,"]"===s?n.state=k.DOCTYPE:b(s)&&(n.state=k.DOCTYPE_DTD_QUOTED,n.q=s);continue;case k.DOCTYPE_DTD_QUOTED:n.doctype+=s,s===n.q&&(n.state=k.DOCTYPE_DTD,n.q="");continue;case k.COMMENT:"-"===s?n.state=k.COMMENT_ENDING:n.comment+=s;continue;case k.COMMENT_ENDING:"-"===s?(n.state=k.COMMENT_ENDED,n.comment=F(n.opt,n.comment),n.comment&&C(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+s,n.state=k.COMMENT);continue;case k.COMMENT_ENDED:">"!==s?(D(n,"Malformed comment"),n.comment+="--"+s,n.state=k.COMMENT):n.state=k.TEXT;continue;case k.CDATA:"]"===s?n.state=k.CDATA_ENDING:n.cdata+=s;continue;case k.CDATA_ENDING:"]"===s?n.state=k.CDATA_ENDING_2:(n.cdata+="]"+s,n.state=k.CDATA);continue;case k.CDATA_ENDING_2:">"===s?(n.cdata&&C(n,"oncdata",n.cdata),C(n,"onclosecdata"),n.cdata="",n.state=k.TEXT):"]"===s?n.cdata+="]":(n.cdata+="]]"+s,n.state=k.CDATA);continue;case k.PROC_INST:"?"===s?n.state=k.PROC_INST_ENDING:y(s)?n.state=k.PROC_INST_BODY:n.procInstName+=s;continue;case k.PROC_INST_BODY:if(!n.procInstBody&&y(s))continue;"?"===s?n.state=k.PROC_INST_ENDING:n.procInstBody+=s;continue;case k.PROC_INST_ENDING:">"===s?(C(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=k.TEXT):(n.procInstBody+="?"+s,n.state=k.PROC_INST_BODY);continue;case k.OPEN_TAG:v(p,s)?n.tagName+=s:(O(n),">"===s?L(n):"/"===s?n.state=k.OPEN_TAG_SLASH:(y(s)||D(n,"Invalid character in tag name"),n.state=k.ATTRIB));continue;case k.OPEN_TAG_SLASH:">"===s?(L(n,!0),B(n)):(D(n,"Forward-slash in opening tag not followed by >"),n.state=k.ATTRIB);continue;case k.ATTRIB:if(y(s))continue;">"===s?L(n):"/"===s?n.state=k.OPEN_TAG_SLASH:v(f,s)?(n.attribName=s,n.attribValue="",n.state=k.ATTRIB_NAME):D(n,"Invalid attribute name");continue;case k.ATTRIB_NAME:"="===s?n.state=k.ATTRIB_VALUE:">"===s?(D(n,"Attribute without value"),n.attribValue=n.attribName,N(n),L(n)):y(s)?n.state=k.ATTRIB_NAME_SAW_WHITE:v(p,s)?n.attribName+=s:D(n,"Invalid attribute name");continue;case k.ATTRIB_NAME_SAW_WHITE:if("="===s)n.state=k.ATTRIB_VALUE;else{if(y(s))continue;D(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",C(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===s?L(n):v(f,s)?(n.attribName=s,n.state=k.ATTRIB_NAME):(D(n,"Invalid attribute name"),n.state=k.ATTRIB)}continue;case k.ATTRIB_VALUE:if(y(s))continue;b(s)?(n.q=s,n.state=k.ATTRIB_VALUE_QUOTED):(D(n,"Unquoted attribute value"),n.state=k.ATTRIB_VALUE_UNQUOTED,n.attribValue=s);continue;case k.ATTRIB_VALUE_QUOTED:if(s!==n.q){"&"===s?n.state=k.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=s;continue}N(n),n.q="",n.state=k.ATTRIB_VALUE_CLOSED;continue;case k.ATTRIB_VALUE_CLOSED:y(s)?n.state=k.ATTRIB:">"===s?L(n):"/"===s?n.state=k.OPEN_TAG_SLASH:v(f,s)?(D(n,"No whitespace between attributes"),n.attribName=s,n.attribValue="",n.state=k.ATTRIB_NAME):D(n,"Invalid attribute name");continue;case k.ATTRIB_VALUE_UNQUOTED:if(!w(s)){"&"===s?n.state=k.ATTRIB_VALUE_ENTITY_U:n.attribValue+=s;continue}N(n),">"===s?L(n):n.state=k.ATTRIB;continue;case k.CLOSE_TAG:if(n.tagName)">"===s?B(n):v(p,s)?n.tagName+=s:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=k.SCRIPT):(y(s)||D(n,"Invalid tagname in closing tag"),n.state=k.CLOSE_TAG_SAW_WHITE);else{if(y(s))continue;S(f,s)?n.script?(n.script+="</"+s,n.state=k.SCRIPT):D(n,"Invalid tagname in closing tag."):n.tagName=s}continue;case k.CLOSE_TAG_SAW_WHITE:if(y(s))continue;">"===s?B(n):D(n,"Invalid characters in closing tag");continue;case k.TEXT_ENTITY:case k.ATTRIB_VALUE_ENTITY_Q:case k.ATTRIB_VALUE_ENTITY_U:var u,h;switch(n.state){case k.TEXT_ENTITY:u=k.TEXT,h="textNode";break;case k.ATTRIB_VALUE_ENTITY_Q:u=k.ATTRIB_VALUE_QUOTED,h="attribValue";break;case k.ATTRIB_VALUE_ENTITY_U:u=k.ATTRIB_VALUE_UNQUOTED,h="attribValue"}";"===s?(n[h]+=U(n),n.entity="",n.state=u):v(n.entity.length?m:g,s)?n.entity+=s:(D(n,"Invalid character in entity name"),n[h]+="&"+n.entity+s,n.entity="",n.state=u);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){for(var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0,s=0,a=i.length;s<a;s++){var o=t[i[s]].length;if(o>n)switch(i[s]){case"textNode":A(t);break;case"cdata":C(t,"oncdata",t.cdata),t.cdata="";break;case"script":C(t,"onscript",t.script),t.script="";break;default:R(t,"Max buffer length exceeded: "+i[s])}r=Math.max(r,o)}var c=e.MAX_BUFFER_LENGTH-r;t.bufferCheckPosition=c+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;A(e=this),""!==e.cdata&&(C(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(C(e,"onscript",e.script),e.script="")}};try{t=n(1983).Stream}catch(e){t=function(){}}var a=e.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function o(e,n){if(!(this instanceof o))return new o(e,n);t.apply(this),this._parser=new s(e,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(e){r.emit("error",e),r._parser.error=null},this._decoder=null,a.forEach(function(e){Object.defineProperty(r,"on"+e,{get:function(){return r._parser["on"+e]},set:function(t){if(!t)return r.removeAllListeners(e),r._parser["on"+e]=t,t;r.on(e,t)},enumerable:!0,configurable:!1})})}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof r&&"function"==typeof r.isBuffer&&r.isBuffer(e)){if(!this._decoder){var t=n(8888).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,n){var r=this;return r._parser["on"+e]||-1===a.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),t.prototype.on.call(r,e,n)};var c="[CDATA[",l="DOCTYPE",u="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",d={xml:u,xmlns:h},f=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function y(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function b(e){return'"'===e||"'"===e}function w(e){return">"===e||y(e)}function v(e,t){return e.test(t)}function S(e,t){return!v(e,t)}var x,E,I,k=0;for(var T in e.STATE={BEGIN:k++,BEGIN_WHITESPACE:k++,TEXT:k++,TEXT_ENTITY:k++,OPEN_WAKA:k++,SGML_DECL:k++,SGML_DECL_QUOTED:k++,DOCTYPE:k++,DOCTYPE_QUOTED:k++,DOCTYPE_DTD:k++,DOCTYPE_DTD_QUOTED:k++,COMMENT_STARTING:k++,COMMENT:k++,COMMENT_ENDING:k++,COMMENT_ENDED:k++,CDATA:k++,CDATA_ENDING:k++,CDATA_ENDING_2:k++,PROC_INST:k++,PROC_INST_BODY:k++,PROC_INST_ENDING:k++,OPEN_TAG:k++,OPEN_TAG_SLASH:k++,ATTRIB:k++,ATTRIB_NAME:k++,ATTRIB_NAME_SAW_WHITE:k++,ATTRIB_VALUE:k++,ATTRIB_VALUE_QUOTED:k++,ATTRIB_VALUE_CLOSED:k++,ATTRIB_VALUE_UNQUOTED:k++,ATTRIB_VALUE_ENTITY_Q:k++,ATTRIB_VALUE_ENTITY_U:k++,CLOSE_TAG:k++,CLOSE_TAG_SAW_WHITE:k++,SCRIPT:k++,SCRIPT_ENDING:k++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(t){var n=e.ENTITIES[t],r="number"==typeof n?String.fromCharCode(n):n;e.ENTITIES[t]=r}),e.STATE)e.STATE[e.STATE[T]]=T;function _(e,t,n){e[t]&&e[t](n)}function C(e,t,n){e.textNode&&A(e),_(e,t,n)}function A(e){e.textNode=F(e.opt,e.textNode),e.textNode&&_(e,"ontext",e.textNode),e.textNode=""}function F(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function R(e,t){return A(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,_(e,"onerror",t),e}function M(e){return e.sawRoot&&!e.closedRoot&&D(e,"Unclosed root tag"),e.state!==k.BEGIN&&e.state!==k.BEGIN_WHITESPACE&&e.state!==k.TEXT&&R(e,"Unexpected end"),A(e),e.c="",e.closed=!0,_(e,"onend"),s.call(e,e.strict,e.opt),e}function D(e,t){if("object"!=typeof e||!(e instanceof s))throw new Error("bad call to strictFail");e.strict&&R(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,C(e,"onopentagstart",n)}function P(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function N(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=P(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==u)D(e,"xml: prefix must be bound to "+u+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==h)D(e,"xmlns: prefix must be bound to "+h+"\nActual: "+e.attribValue);else{var i=e.tag,s=e.tags[e.tags.length-1]||e;i.ns===s.ns&&(i.ns=Object.create(s.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,C(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function L(e,t){if(e.opt.xmlns){var n=e.tag,r=P(e.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(D(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),n.uri=r.prefix);var i=e.tags[e.tags.length-1]||e;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(t){C(e,"onopennamespace",{prefix:t,uri:n.ns[t]})});for(var s=0,a=e.attribList.length;s<a;s++){var o=e.attribList[s],c=o[0],l=o[1],u=P(c,!0),h=u.prefix,d=u.local,f=""===h?"":n.ns[h]||"",p={name:c,value:l,prefix:h,local:d,uri:f};h&&"xmlns"!==h&&!f&&(D(e,"Unbound namespace prefix: "+JSON.stringify(h)),p.uri=h),e.tag.attributes[c]=p,C(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),C(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=k.TEXT:e.state=k.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function B(e){if(!e.tagName)return D(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=k.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=k.SCRIPT);C(e,"onscript",e.script),e.script=""}var t=e.tags.length,n=e.tagName;e.strict||(n=n[e.looseCase]());for(var r=n;t--&&e.tags[t].name!==r;)D(e,"Unexpected close tag");if(t<0)return D(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=k.TEXT);e.tagName=n;for(var i=e.tags.length;i-- >t;){var s=e.tag=e.tags.pop();e.tagName=e.tag.name,C(e,"onclosetag",e.tagName);var a={};for(var o in s.ns)a[o]=s.ns[o];var c=e.tags[e.tags.length-1]||e;e.opt.xmlns&&s.ns!==c.ns&&Object.keys(s.ns).forEach(function(t){var n=s.ns[t];C(e,"onclosenamespace",{prefix:t,uri:n})})}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=k.TEXT}function U(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),i=(t=parseInt(n,16)).toString(16)):(n=n.slice(1),i=(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==n?(D(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function V(e,t){"<"===t?(e.state=k.OPEN_WAKA,e.startTagPosition=e.position):y(t)||(D(e,"Non-whitespace before first tag."),e.textNode=t,e.state=k.TEXT)}function j(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}k=e.STATE,String.fromCodePoint||(x=String.fromCharCode,E=Math.floor,I=function(){var e,t,n=[],r=-1,i=arguments.length;if(!i)return"";for(var s="";++r<i;){var a=Number(arguments[r]);if(!isFinite(a)||a<0||a>1114111||E(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?n.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,n.push(e,t)),(r+1===i||n.length>16384)&&(s+=x.apply(null,n),n.length=0)}return s},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:I,configurable:!0,writable:!0}):String.fromCodePoint=I)}(t)},6108:(e,t,n)=>{"use strict";var r=n(528),i=n(686),s=n(7239)(),a=n(9336),o=n(3468),c=r("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new o("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new o("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,l=!0;if("length"in e&&a){var u=a(e,"length");u&&!u.configurable&&(r=!1),u&&!u.writable&&(l=!1)}return(r||l||!n)&&(s?i(e,"length",t,!0,!0):i(e,"length",t)),e}},1098:(e,t,n)=>{"use strict";var r=n(8228),i=n(1743),s=n(2685),a=n(5433);function o(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}e.exports=function(e,t,n){if(!a(e))return e;if(Array.isArray(t)&&(t=[].concat.apply([],t).join(".")),"string"!=typeof t)return e;for(var c=r(t,{sep:".",brackets:!0}).filter(o),l=c.length,u=-1,h=e;++u<l;){var d=c[u];u===l-1?s(h[d])&&s(n)?h[d]=i({},h[d],n):h[d]=n:(a(h[d])||(h[d]={}),h=h[d])}return e}},1229:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(8764);function s(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}s.prototype.update=function(e,t){e=i(e,t||"utf8");for(var n=this._block,r=this._blockSize,s=e.length,a=this._len,o=0;o<s;){for(var c=a%r,l=Math.min(s-o,r-c),u=0;u<l;u++)n[c+u]=e[o+u];o+=l,(a+=l)%r==0&&this._update(n)}return this._len+=s,this},s.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var s=this._hash();return e?s.toString(e):s},s.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=s},3229:(e,t,n)=>{"use strict";e.exports=function(t){var n=t.toLowerCase(),r=e.exports[n];if(!r)throw new Error(n+" is not supported (we accept pull requests)");return new r},e.exports.sha=n(3675),e.exports.sha1=n(8980),e.exports.sha224=n(947),e.exports.sha256=n(2826),e.exports.sha384=n(9922),e.exports.sha512=n(3699)},3675:(e,t,n)=>{"use strict";var r=n(5615),i=n(1229),s=n(5636).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function c(){this.init(),this._w=o,i.call(this,64,56)}function l(e){return e<<30|e>>>2}function u(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,s=0|this._c,o=0|this._d,c=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=n[h-3]^n[h-8]^n[h-14]^n[h-16];for(var d=0;d<80;++d){var f=~~(d/20),p=0|((t=r)<<5|t>>>27)+u(f,i,s,o)+c+n[d]+a[f];c=o,o=s,s=l(i),i=r,r=p}this._a=r+this._a|0,this._b=i+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},8980:(e,t,n)=>{"use strict";var r=n(5615),i=n(1229),s=n(5636).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],o=new Array(80);function c(){this.init(),this._w=o,i.call(this,64,56)}function l(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function h(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(c,i),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,s=0|this._c,o=0|this._d,c=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=(t=n[d-3]^n[d-8]^n[d-14]^n[d-16])<<1|t>>>31;for(var f=0;f<80;++f){var p=~~(f/20),g=l(r)+h(p,i,s,o)+c+n[f]+a[p]|0;c=o,o=s,s=u(i),i=r,r=g}this._a=r+this._a|0,this._b=i+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=s.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},947:(e,t,n)=>{"use strict";var r=n(5615),i=n(2826),s=n(1229),a=n(5636).Buffer,o=new Array(64);function c(){this.init(),this._w=o,s.call(this,64,56)}r(c,i),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=c},2826:(e,t,n)=>{"use strict";var r=n(5615),i=n(1229),s=n(5636).Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=new Array(64);function c(){this.init(),this._w=o,i.call(this,64,56)}function l(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function h(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function d(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(c,i),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,s=0|this._c,o=0|this._d,c=0|this._e,p=0|this._f,g=0|this._g,m=0|this._h,y=0;y<16;++y)n[y]=e.readInt32BE(4*y);for(;y<64;++y)n[y]=0|(((t=n[y-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[y-7]+f(n[y-15])+n[y-16];for(var b=0;b<64;++b){var w=m+d(c)+l(c,p,g)+a[b]+n[b]|0,v=h(r)+u(r,i,s)|0;m=g,g=p,p=c,c=o+w|0,o=s,s=i,i=r,r=w+v|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=s+this._c|0,this._d=o+this._d|0,this._e=c+this._e|0,this._f=p+this._f|0,this._g=g+this._g|0,this._h=m+this._h|0},c.prototype._hash=function(){var e=s.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=c},9922:(e,t,n)=>{"use strict";var r=n(5615),i=n(3699),s=n(1229),a=n(5636).Buffer,o=new Array(160);function c(){this.init(),this._w=o,s.call(this,128,112)}r(c,i),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=c},3699:(e,t,n)=>{"use strict";var r=n(5615),i=n(1229),s=n(5636).Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],o=new Array(160);function c(){this.init(),this._w=o,i.call(this,128,112)}function l(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function h(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function d(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function y(e,t){return e>>>0<t>>>0?1:0}r(c,i),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,s=0|this._dh,o=0|this._eh,c=0|this._fh,b=0|this._gh,w=0|this._hh,v=0|this._al,S=0|this._bl,x=0|this._cl,E=0|this._dl,I=0|this._el,k=0|this._fl,T=0|this._gl,_=0|this._hl,C=0;C<32;C+=2)t[C]=e.readInt32BE(4*C),t[C+1]=e.readInt32BE(4*C+4);for(;C<160;C+=2){var A=t[C-30],F=t[C-30+1],R=f(A,F),M=p(F,A),D=g(A=t[C-4],F=t[C-4+1]),O=m(F,A),P=t[C-14],N=t[C-14+1],L=t[C-32],B=t[C-32+1],U=M+N|0,V=R+P+y(U,M)|0;V=(V=V+D+y(U=U+O|0,O)|0)+L+y(U=U+B|0,B)|0,t[C]=V,t[C+1]=U}for(var j=0;j<160;j+=2){V=t[j],U=t[j+1];var z=u(n,r,i),G=u(v,S,x),H=h(n,v),$=h(v,n),W=d(o,I),q=d(I,o),X=a[j],Y=a[j+1],K=l(o,c,b),J=l(I,k,T),Z=_+q|0,Q=w+W+y(Z,_)|0;Q=(Q=(Q=Q+K+y(Z=Z+J|0,J)|0)+X+y(Z=Z+Y|0,Y)|0)+V+y(Z=Z+U|0,U)|0;var ee=$+G|0,te=H+z+y(ee,$)|0;w=b,_=T,b=c,T=k,c=o,k=I,o=s+Q+y(I=E+Z|0,E)|0,s=i,E=x,i=r,x=S,r=n,S=v,n=Q+te+y(v=Z+ee|0,Z)|0}this._al=this._al+v|0,this._bl=this._bl+S|0,this._cl=this._cl+x|0,this._dl=this._dl+E|0,this._el=this._el+I|0,this._fl=this._fl+k|0,this._gl=this._gl+T|0,this._hl=this._hl+_|0,this._ah=this._ah+n+y(this._al,v)|0,this._bh=this._bh+r+y(this._bl,S)|0,this._ch=this._ch+i+y(this._cl,x)|0,this._dh=this._dh+s+y(this._dl,E)|0,this._eh=this._eh+o+y(this._el,I)|0,this._fh=this._fh+c+y(this._fl,k)|0,this._gh=this._gh+b+y(this._gl,T)|0,this._hh=this._hh+w+y(this._hl,_)|0},c.prototype._hash=function(){var e=s.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=c},9645:(e,t,n)=>{"use strict";var r=n(7599),i=n(5677),s=n(6420),a=n(8250),o=n(9504);function c(e){r.call(this,null,e),this.options=o.extend({source:"string"},this.options),this.compiler=new s(this.options),this.parser=new a(this.options),Object.defineProperty(this,"compilers",{get:function(){return this.compiler.compilers}}),Object.defineProperty(this,"parsers",{get:function(){return this.parser.parsers}}),Object.defineProperty(this,"regex",{get:function(){return this.parser.regex}})}r.extend(c),c.prototype.capture=function(){return this.parser.capture.apply(this.parser,arguments)},c.prototype.use=function(e){return e.call(this,this),this},c.prototype.parse=function(e,t){this.options=o.extend({},this.options,t);var n=this.parser.parse(e,this.options);return i(n,"parser",this.parser),n},c.prototype.compile=function(e,t){this.options=o.extend({},this.options,t);var n=this.compiler.compile(e,this.options);return i(n,"compiler",this.compiler),n},e.exports=c,e.exports.Compiler=s,e.exports.Parser=a},6420:(e,t,n)=>{"use strict";var r=n(8641),i=n(5677),s=n(124)("snapdragon:compiler"),a=n(9504);function o(e,t){s("initializing","/index.js"),this.options=a.extend({source:"string"},e),this.state=t||{},this.compilers={},this.output="",this.set("eos",function(e){return this.emit(e.val,e)}),this.set("noop",function(e){return this.emit(e.val,e)}),this.set("bos",function(e){return this.emit(e.val,e)}),r(this)}o.prototype={error:function(e,t){var n=t.position||{start:{column:0}},r=this.options.source+" column:"+n.start.column+": "+e,i=new Error(r);if(i.reason=e,i.column=n.start.column,i.source=this.pattern,!this.options.silent)throw i;this.errors.push(i)},define:function(e,t){return i(this,e,t),this},emit:function(e,t){return this.output+=e,e},set:function(e,t){return this.compilers[e]=t,this},get:function(e){return this.compilers[e]},prev:function(e){return this.ast.nodes[this.idx-(e||1)]||{type:"bos",val:""}},next:function(e){return this.ast.nodes[this.idx+(e||1)]||{type:"eos",val:""}},visit:function(e,t,n){var r=this.compilers[e.type];if(this.idx=n,"function"!=typeof r)throw this.error('compiler "'+e.type+'" is not registered',e);return r.call(this,e,t,n)},mapVisit:function(e){if(!Array.isArray(e))throw new TypeError("expected an array");for(var t=e.length,n=-1;++n<t;)this.visit(e[n],e,n);return this},compile:function(e,t){var r=a.extend({},this.options,t);return this.ast=e,this.parsingErrors=this.ast.errors,this.output="",r.sourcemap?(n(8838)(this),this.mapVisit(this.ast.nodes),this.applySourceMaps(),this.map="generator"===r.sourcemap?this.map:this.map.toJSON(),this):(this.mapVisit(this.ast.nodes),this)}},e.exports=o},8250:(e,t,n)=>{"use strict";var r=n(8641),i=n(9208),s=n(6343),a=n(5677),o=n(124)("snapdragon:parser"),c=n(2050),l=n(9504);function u(e){o("initializing","/index.js"),this.options=l.extend({source:"string"},e),this.init(this.options),r(this)}function h(e,t){return e.visited?e:(a(e,"visited",!0),e.nodes?function(e,t){for(var n=e.length,r=-1;++r<n;)h(e[r],t)}(e.nodes,t):t(e))}function d(e){return function(e){return e.nodes&&e.nodes[0].type===e.type+".open"}(e)&&function(e){return e.nodes&&l.last(e.nodes).type===e.type+".close"}(e)}u.prototype={constructor:u,init:function(e){this.orig="",this.input="",this.parsed="",this.column=1,this.line=1,this.regex=new s,this.errors=this.errors||[],this.parsers=this.parsers||{},this.types=this.types||[],this.sets=this.sets||{},this.fns=this.fns||[],this.currentType="root";var t=this.position();this.bos=t({type:"bos",val:""}),this.ast={type:"root",errors:this.errors,nodes:[this.bos]},a(this.bos,"parent",this.ast),this.nodes=[this.ast],this.count=0,this.setCount=0,this.stack=[]},error:function(e,t){var n=t.position||{start:{column:0,line:0}},r=n.start.line,i=n.start.column,s=this.options.source,a=new Error(s+" <line:"+r+" column:"+i+">: "+e);if(a.source=s,a.reason=e,a.pos=n,!this.options.silent)throw a;this.errors.push(a)},define:function(e,t){return a(this,e,t),this},position:function(){var e={line:this.line,column:this.column},t=this;return function(n){return a(n,"position",new c(e,t)),n}},set:function(e,t){return-1===this.types.indexOf(e)&&this.types.push(e),this.parsers[e]=t.bind(this),this},get:function(e){return this.parsers[e]},push:function(e,t){return this.sets[e]=this.sets[e]||[],this.count++,this.stack.push(t),this.sets[e].push(t)},pop:function(e){return this.sets[e]=this.sets[e]||[],this.count--,this.stack.pop(),this.sets[e].pop()},isInside:function(e){return this.sets[e]=this.sets[e]||[],this.sets[e].length>0},isType:function(e,t){return e&&e.type===t},prev:function(e){return this.stack.length>0?l.last(this.stack,e):l.last(this.nodes,e)},consume:function(e){this.input=this.input.substr(e)},updatePosition:function(e,t){var n=e.match(/\n/g);n&&(this.line+=n.length);var r=e.lastIndexOf("\n");this.column=~r?t-r:this.column+t,this.parsed+=e,this.consume(t)},match:function(e){var t=e.exec(this.input);if(t)return this.updatePosition(t[0],t[0].length),t},capture:function(e,t){return"function"==typeof t?this.set.apply(this,arguments):(this.regex.set(e,t),this.set(e,function(){var n=this.parsed,r=this.position(),i=this.match(t);if(i&&i[0]){var s=this.prev(),o=r({type:e,val:i[0],parsed:n,rest:this.input});i[1]&&(o.inner=i[1]),a(o,"inside",this.stack.length>0),a(o,"parent",s),s.nodes.push(o)}}.bind(this)),this)},capturePair:function(e,t,n,r){return this.sets[e]=this.sets[e]||[],this.set(e+".open",function(){var n=this.parsed,i=this.position(),s=this.match(t);if(s&&s[0]){var o=s[0];this.setCount++,this.specialChars=!0;var c=i({type:e+".open",val:o,rest:this.input});void 0!==s[1]&&(c.inner=s[1]);var l=this.prev(),u=i({type:e,nodes:[c]});a(u,"rest",this.input),a(u,"parsed",n),a(u,"prefix",s[1]),a(u,"parent",l),a(c,"parent",u),"function"==typeof r&&r.call(this,c,u),this.push(e,u),l.nodes.push(u)}}),this.set(e+".close",function(){var t=this.position(),r=this.match(n);if(r&&r[0]){var i=this.pop(e),s=t({type:e+".close",rest:this.input,suffix:r[1],val:r[0]});if(!this.isType(i,e)){if(this.options.strict)throw new Error('missing opening "'+e+'"');return this.setCount--,s.escaped=!0,s}"\\"===s.suffix&&(i.escaped=!0,s.escaped=!0),i.nodes.push(s),a(s,"parent",i)}}),this},eos:function(){var e=this.position();if(!this.input){for(var t=this.prev();"root"!==t.type&&!t.visited;){if(!0===this.options.strict)throw new SyntaxError("invalid syntax:"+i.inspect(t,null,2));d(t)||(t.parent.escaped=!0,t.escaped=!0),h(t,function(e){d(e.parent)||(e.parent.escaped=!0,e.escaped=!0)}),t=t.parent}var n=e({type:"eos",val:this.append||""});return a(n,"parent",this.ast),n}},next:function(){for(var e,t=this.parsed,n=this.types.length,r=-1;++r<n;)if(e=this.parsers[this.types[r]].call(this))return a(e,"rest",this.input),a(e,"parsed",t),this.last=e,e},parse:function(e){if("string"!=typeof e)throw new TypeError("expected a string");this.init(this.options),this.orig=e,this.input=e;var t=this;function n(){e=t.input;var n=t.next();if(n){var r=t.prev();r&&(a(n,"parent",r),r.nodes&&r.nodes.push(n)),t.sets.hasOwnProperty(r.type)&&(t.currentType=r.type)}if(t.input&&e===t.input)throw new Error('no parsers registered for: "'+t.input.slice(0,5)+'"')}for(;this.input;)n();if(this.stack.length&&this.options.strict){var r=this.stack.pop();throw this.error("missing opening "+r.type+': "'+this.orig+'"')}var i=this.eos();return"eos"!==this.prev().type&&this.ast.nodes.push(i),this.ast}},e.exports=u},2050:(e,t,n)=>{"use strict";var r=n(5677);e.exports=function(e,t){this.start=e,this.end={line:t.line,column:t.column},r(this,"content",t.orig),r(this,"source",t.options.source)}},8838:(e,t,n)=>{"use strict";var r=n(4818),i=n(9942),s=n(5677),a=n(9504);e.exports=function(e){for(var n in s(e,"_comment",e.comment),e.map=new a.SourceMap.SourceMapGenerator,e.position={line:1,column:1},e.content={},e.files={},t)s(e,n,t[n])},t.updatePosition=function(e){var t=e.match(/\n/g);t&&(this.position.line+=t.length);var n=e.lastIndexOf("\n");this.position.column=~n?e.length-n:this.position.column+e.length},t.emit=function(e,t){var n=t.position||{},r=n.source;return r&&(n.filepath&&(r=a.unixify(n.filepath)),this.map.addMapping({source:r,generated:{line:this.position.line,column:Math.max(this.position.column-1,0)},original:{line:n.start.line,column:n.start.column-1}}),n.content&&this.addContent(r,n),n.filepath&&this.addFile(r,n),this.updatePosition(e),this.output+=e),e},t.addFile=function(e,t){"string"==typeof t.content&&(Object.prototype.hasOwnProperty.call(this.files,e)||(this.files[e]=t.content))},t.addContent=function(e,t){"string"==typeof t.content&&(Object.prototype.hasOwnProperty.call(this.content,e)||this.map.setSourceContent(e,t.content))},t.applySourceMaps=function(){Object.keys(this.files).forEach(function(e){var t=this.files[e];if(this.map.setSourceContent(e,t),!0===this.options.inputSourcemaps){var n=a.sourceMapResolve.resolveSync(t,e,r.readFileSync);if(n){var s=new a.SourceMap.SourceMapConsumer(n.map),o=n.sourcesRelativeTo;this.map.applySourceMap(s,e,a.unixify(i.dirname(o)))}}},this)},t.comment=function(e){return/^# sourceMappingURL=/.test(e.comment)?this.emit("",e.position):this._comment(e)}},9504:(e,t,n)=>{"use strict";t.extend=n(1743),t.SourceMap=n(9715),t.sourceMapResolve=n(2366),t.unixify=function(e){return e.split(/\\+/).join("/")},t.isString=function(e){return e&&"string"==typeof e},t.arrayify=function(e){return"string"==typeof e?[e]:e?Array.isArray(e)?e:[e]:[]},t.last=function(e,t){return e[e.length-(t||1)]}},2366:function(e,t,n){var r,i,s;i=[n(9560),n(6030)],void 0===(s="function"==typeof(r=function(e,t){function n(e,t,n){setImmediate(function(){e(t,n)})}function r(e,t){try{return JSON.parse(e.replace(/^\)\]\}'/,""))}catch(e){throw e.sourceMapData=t,e}}function i(e,t,n){var r=t;try{return String(e(r))}catch(e){throw e.sourceMapData=n,e}}function s(e,t,i,s){var a;try{a=h(e,t)}catch(e){return n(s,e)}if(!a||a.map)return n(s,null,a);i(a.url,function(e,t){if(e)return e.sourceMapData=a,s(e);a.map=String(t);try{a.map=r(a.map,a)}catch(e){return s(e)}s(null,a)})}function a(e,t,n){var s=h(e,t);return!s||s.map||(s.map=i(n,s.url,s),s.map=r(s.map,s)),s}var o=/^data:([^,;]*)(;[^,;]*)*(?:,(.*))?$/,c=/^(?:application|text)\/json$/,l="utf-8";function u(e){if("undefined"==typeof TextDecoder||"undefined"==typeof Uint8Array)return atob(e);var t=function(e){for(var t=atob(e),n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}(e);return new TextDecoder(l,{fatal:!0}).decode(t)}function h(n,i){var s=e.getFrom(n);if(!s)return null;var a=s.match(o);if(a){var l=a[1]||"text/plain",h=a[2]||"",d=a[3]||"",f={sourceMappingURL:s,url:null,sourcesRelativeTo:i,map:d};if(!c.test(l)){var p=new Error("Unuseful data uri mime type: "+l);throw p.sourceMapData=f,p}try{f.map=r(";base64"===h?u(d):decodeURIComponent(d),f)}catch(p){throw p.sourceMapData=f,p}return f}var g=t(i,s);return{sourceMappingURL:s,url:g,sourcesRelativeTo:g,map:null}}function d(e,t,r,i,s){"function"==typeof i&&(s=i,i={});var a=e.sources?e.sources.length:0,o={sourcesResolved:[],sourcesContent:[]};if(0!==a){var c=function(){0==--a&&s(null,o)};g(e,t,i,function(e,t,i){o.sourcesResolved[i]=e,"string"==typeof t?(o.sourcesContent[i]=t,n(c,null)):r(e,function(e,t){o.sourcesContent[i]=e||String(t),c()})})}else n(s,null,o)}function f(e,t,n,r){var i={sourcesResolved:[],sourcesContent:[]};return e.sources&&0!==e.sources.length?(g(e,t,r,function(e,t,r){if(i.sourcesResolved[r]=e,null!==n)if("string"==typeof t)i.sourcesContent[r]=t;else{var s=e;try{i.sourcesContent[r]=String(n(s))}catch(e){i.sourcesContent[r]=e}}}),i):i}var p=/\/?$/;function g(e,n,r,i){var s;r=r||{};for(var a=0,o=e.sources.length;a<o;a++)s=null,"string"==typeof r.sourceRoot?s=r.sourceRoot:"string"==typeof e.sourceRoot&&!1!==r.sourceRoot&&(s=e.sourceRoot),i(null===s||""===s?t(n,e.sources[a]):t(n,s.replace(p,"/"),e.sources[a]),(e.sourcesContent||[])[a],a)}return{resolveSourceMap:s,resolveSourceMapSync:a,resolveSources:d,resolveSourcesSync:f,resolve:function(e,t,n,i,a){if("function"==typeof i&&(a=i,i={}),null===e){var o={sourceMappingURL:null,url:t,sourcesRelativeTo:t,map:null};n(t,function(e,t){if(e)return e.sourceMapData=o,a(e);o.map=String(t);try{o.map=r(o.map,o)}catch(e){return a(e)}c(o)})}else s(e,t,n,function(e,t){return e?a(e):t?void c(t):a(null,null)});function c(e){d(e.map,e.sourcesRelativeTo,n,i,function(t,n){if(t)return a(t);e.sourcesResolved=n.sourcesResolved,e.sourcesContent=n.sourcesContent,a(null,e)})}},resolveSync:function(e,t,n,s){var o;if(null===e)(o={sourceMappingURL:null,url:t,sourcesRelativeTo:t,map:null}).map=i(n,t,o),o.map=r(o.map,o);else if(!(o=a(e,t,n)))return null;var c=f(o.map,o.sourcesRelativeTo,n,s);return o.sourcesResolved=c.sourcesResolved,o.sourcesContent=c.sourcesContent,o},parseMapToJSON:r}})?r.apply(t,i):r)||(e.exports=s)},9560:function(e,t,n){var r,i;void 0===(i="function"==typeof(r=function(){var e=/[#@] sourceMappingURL=([^\s'"]*)/,t=RegExp("(?:/\\*(?:\\s*\r?\n(?://)?)?(?:"+e.source+")\\s*\\*/|//(?:"+e.source+"))\\s*");return{regex:t,_innerRegex:e,getFrom:function(e){var n=e.match(t);return n?n[1]||n[2]||"":null},existsIn:function(e){return t.test(e)},removeFrom:function(e){return e.replace(t,"")},insertBefore:function(e,n){var r=e.match(t);return r?e.slice(0,r.index)+n+e.slice(r.index):e+n}}})?r.call(t,n,t,e):r)||(e.exports=i)},7604:(e,t,n)=>{var r=n(9002),i=Object.prototype.hasOwnProperty,s="undefined"!=typeof Map;function a(){this._array=[],this._set=s?new Map:Object.create(null)}a.fromArray=function(e,t){for(var n=new a,r=0,i=e.length;r<i;r++)n.add(e[r],t);return n},a.prototype.size=function(){return s?this._set.size:Object.getOwnPropertyNames(this._set).length},a.prototype.add=function(e,t){var n=s?e:r.toSetString(e),a=s?this.has(e):i.call(this._set,n),o=this._array.length;a&&!t||this._array.push(e),a||(s?this._set.set(e,o):this._set[n]=o)},a.prototype.has=function(e){if(s)return this._set.has(e);var t=r.toSetString(e);return i.call(this._set,t)},a.prototype.indexOf=function(e){if(s){var t=this._set.get(e);if(t>=0)return t}else{var n=r.toSetString(e);if(i.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')},a.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},a.prototype.toArray=function(){return this._array.slice()},t.C=a},7853:(e,t,n)=>{var r=n(3845);t.encode=function(e){var t,n="",i=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&i,(i>>>=5)>0&&(t|=32),n+=r.encode(t)}while(i>0);return n},t.decode=function(e,t,n){var i,s,a,o,c=e.length,l=0,u=0;do{if(t>=c)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(s=r.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));i=!!(32&s),l+=(s&=31)<<u,u+=5}while(i);n.value=(o=(a=l)>>1,1&~a?o:-o),n.rest=t}},3845:(e,t)=>{var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},7120:(e,t)=>{function n(e,r,i,s,a,o){var c=Math.floor((r-e)/2)+e,l=a(i,s[c],!0);return 0===l?c:l>0?r-c>1?n(c,r,i,s,a,o):o==t.LEAST_UPPER_BOUND?r<s.length?r:-1:c:c-e>1?n(e,c,i,s,a,o):o==t.LEAST_UPPER_BOUND?c:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,r,i,s){if(0===r.length)return-1;var a=n(-1,r.length,e,r,i,s||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&0===i(r[a],r[a-1],!0);)--a;return a}},9980:(e,t,n)=>{var r=n(9002);function i(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}i.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},i.prototype.add=function(e){var t,n,i,s,a,o;n=e,i=(t=this._last).generatedLine,s=n.generatedLine,a=t.generatedColumn,o=n.generatedColumn,s>i||s==i&&o>=a||r.compareByGeneratedPositionsInflated(t,n)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},i.prototype.toArray=function(){return this._sorted||(this._array.sort(r.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.P=i},5776:(e,t)=>{function n(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function r(e,t,i,s){if(i<s){var a=i-1;n(e,(u=i,h=s,Math.round(u+Math.random()*(h-u))),s);for(var o=e[s],c=i;c<s;c++)t(e[c],o)<=0&&n(e,a+=1,c);n(e,a+1,c);var l=a+1;r(e,t,i,l-1),r(e,t,l+1,s)}var u,h}t.g=function(e,t){r(e,t,0,e.length-1)}},3697:(e,t,n)=>{var r=n(9002),i=n(7120),s=n(7604).C,a=n(7853),o=n(5776).g;function c(e,t){var n=e;return"string"==typeof e&&(n=r.parseSourceMapInput(e)),null!=n.sections?new h(n,t):new l(n,t)}function l(e,t){var n=e;"string"==typeof e&&(n=r.parseSourceMapInput(e));var i=r.getArg(n,"version"),a=r.getArg(n,"sources"),o=r.getArg(n,"names",[]),c=r.getArg(n,"sourceRoot",null),l=r.getArg(n,"sourcesContent",null),u=r.getArg(n,"mappings"),h=r.getArg(n,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);c&&(c=r.normalize(c)),a=a.map(String).map(r.normalize).map(function(e){return c&&r.isAbsolute(c)&&r.isAbsolute(e)?r.relative(c,e):e}),this._names=s.fromArray(o.map(String),!0),this._sources=s.fromArray(a,!0),this._absoluteSources=this._sources.toArray().map(function(e){return r.computeSourceURL(c,e,t)}),this.sourceRoot=c,this.sourcesContent=l,this._mappings=u,this._sourceMapURL=t,this.file=h}function u(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function h(e,t){var n=e;"string"==typeof e&&(n=r.parseSourceMapInput(e));var i=r.getArg(n,"version"),a=r.getArg(n,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new s,this._names=new s;var o={line:-1,column:0};this._sections=a.map(function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var n=r.getArg(e,"offset"),i=r.getArg(n,"line"),s=r.getArg(n,"column");if(i<o.line||i===o.line&&s<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=n,{generatedOffset:{generatedLine:i+1,generatedColumn:s+1},consumer:new c(r.getArg(e,"map"),t)}})}c.fromSourceMap=function(e,t){return l.fromSourceMap(e,t)},c.prototype._version=3,c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),c.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return";"===n||","===n},c.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.GREATEST_LOWER_BOUND=1,c.LEAST_UPPER_BOUND=2,c.prototype.eachMapping=function(e,t,n){var i,s=t||null;switch(n||c.GENERATED_ORDER){case c.GENERATED_ORDER:i=this._generatedMappings;break;case c.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;i.map(function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=r.computeSourceURL(a,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}},this).forEach(e,s)},c.prototype.allGeneratedPositionsFor=function(e){var t=r.getArg(e,"line"),n={source:r.getArg(e,"source"),originalLine:t,originalColumn:r.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var s=[],a=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,i.LEAST_UPPER_BOUND);if(a>=0){var o=this._originalMappings[a];if(void 0===e.column)for(var c=o.originalLine;o&&o.originalLine===c;)s.push({line:r.getArg(o,"generatedLine",null),column:r.getArg(o,"generatedColumn",null),lastColumn:r.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++a];else for(var l=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==l;)s.push({line:r.getArg(o,"generatedLine",null),column:r.getArg(o,"generatedColumn",null),lastColumn:r.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++a]}return s},t.SourceMapConsumer=c,l.prototype=Object.create(c.prototype),l.prototype.consumer=c,l.prototype._findSourceIndex=function(e){var t,n=e;if(null!=this.sourceRoot&&(n=r.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},l.fromSourceMap=function(e,t){var n=Object.create(l.prototype),i=n._names=s.fromArray(e._names.toArray(),!0),a=n._sources=s.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=t,n._absoluteSources=n._sources.toArray().map(function(e){return r.computeSourceURL(n.sourceRoot,e,t)});for(var c=e._mappings.toArray().slice(),h=n.__generatedMappings=[],d=n.__originalMappings=[],f=0,p=c.length;f<p;f++){var g=c[f],m=new u;m.generatedLine=g.generatedLine,m.generatedColumn=g.generatedColumn,g.source&&(m.source=a.indexOf(g.source),m.originalLine=g.originalLine,m.originalColumn=g.originalColumn,g.name&&(m.name=i.indexOf(g.name)),d.push(m)),h.push(m)}return o(n.__originalMappings,r.compareByOriginalPositions),n},l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),l.prototype._parseMappings=function(e,t){for(var n,i,s,c,l,h=1,d=0,f=0,p=0,g=0,m=0,y=e.length,b=0,w={},v={},S=[],x=[];b<y;)if(";"===e.charAt(b))h++,b++,d=0;else if(","===e.charAt(b))b++;else{for((n=new u).generatedLine=h,c=b;c<y&&!this._charIsMappingSeparator(e,c);c++);if(s=w[i=e.slice(b,c)])b+=i.length;else{for(s=[];b<c;)a.decode(e,b,v),l=v.value,b=v.rest,s.push(l);if(2===s.length)throw new Error("Found a source, but no line and column");if(3===s.length)throw new Error("Found a source and line, but no column");w[i]=s}n.generatedColumn=d+s[0],d=n.generatedColumn,s.length>1&&(n.source=g+s[1],g+=s[1],n.originalLine=f+s[2],f=n.originalLine,n.originalLine+=1,n.originalColumn=p+s[3],p=n.originalColumn,s.length>4&&(n.name=m+s[4],m+=s[4])),x.push(n),"number"==typeof n.originalLine&&S.push(n)}o(x,r.compareByGeneratedPositionsDeflated),this.__generatedMappings=x,o(S,r.compareByOriginalPositions),this.__originalMappings=S},l.prototype._findMapping=function(e,t,n,r,s,a){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return i.search(e,t,s,a)},l.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},l.prototype.originalPositionFor=function(e){var t={generatedLine:r.getArg(e,"line"),generatedColumn:r.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",r.compareByGeneratedPositionsDeflated,r.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===t.generatedLine){var s=r.getArg(i,"source",null);null!==s&&(s=this._sources.at(s),s=r.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var a=r.getArg(i,"name",null);return null!==a&&(a=this._names.at(a)),{source:s,line:r.getArg(i,"originalLine",null),column:r.getArg(i,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return null==e})},l.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var i,s=e;if(null!=this.sourceRoot&&(s=r.relative(this.sourceRoot,s)),null!=this.sourceRoot&&(i=r.urlParse(this.sourceRoot))){var a=s.replace(/^file:\/\//,"");if("file"==i.scheme&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!i.path||"/"==i.path)&&this._sources.has("/"+s))return this.sourcesContent[this._sources.indexOf("/"+s)]}if(t)return null;throw new Error('"'+s+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(e){var t=r.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var n={source:t,originalLine:r.getArg(e,"line"),originalColumn:r.getArg(e,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,r.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(i>=0){var s=this._originalMappings[i];if(s.source===n.source)return{line:r.getArg(s,"generatedLine",null),column:r.getArg(s,"generatedColumn",null),lastColumn:r.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},h.prototype=Object.create(c.prototype),h.prototype.constructor=c,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var n=0;n<this._sections[t].consumer.sources.length;n++)e.push(this._sections[t].consumer.sources[n]);return e}}),h.prototype.originalPositionFor=function(e){var t={generatedLine:r.getArg(e,"line"),generatedColumn:r.getArg(e,"column")},n=i.search(t,this._sections,function(e,t){return e.generatedLine-t.generatedOffset.generatedLine||e.generatedColumn-t.generatedOffset.generatedColumn}),s=this._sections[n];return s?s.consumer.originalPositionFor({line:t.generatedLine-(s.generatedOffset.generatedLine-1),column:t.generatedColumn-(s.generatedOffset.generatedLine===t.generatedLine?s.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})},h.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var r=this._sections[n].consumer.sourceContentFor(e,!0);if(r)return r}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(-1!==n.consumer._findSourceIndex(r.getArg(e,"source"))){var i=n.consumer.generatedPositionFor(e);if(i)return{line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},h.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],s=i.consumer._generatedMappings,a=0;a<s.length;a++){var c=s[a],l=i.consumer._sources.at(c.source);l=r.computeSourceURL(i.consumer.sourceRoot,l,this._sourceMapURL),this._sources.add(l),l=this._sources.indexOf(l);var u=null;c.name&&(u=i.consumer._names.at(c.name),this._names.add(u),u=this._names.indexOf(u));var h={source:l,generatedLine:c.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(i.generatedOffset.generatedLine===c.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:u};this.__generatedMappings.push(h),"number"==typeof h.originalLine&&this.__originalMappings.push(h)}o(this.__generatedMappings,r.compareByGeneratedPositionsDeflated),o(this.__originalMappings,r.compareByOriginalPositions)}},32:(e,t,n)=>{var r=n(7853),i=n(9002),s=n(7604).C,a=n(9980).P;function o(e){e||(e={}),this._file=i.getArg(e,"file",null),this._sourceRoot=i.getArg(e,"sourceRoot",null),this._skipValidation=i.getArg(e,"skipValidation",!1),this._sources=new s,this._names=new s,this._mappings=new a,this._sourcesContents=null}o.prototype._version=3,o.fromSourceMap=function(e){var t=e.sourceRoot,n=new o({file:e.file,sourceRoot:t});return e.eachMapping(function(e){var r={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(r.source=e.source,null!=t&&(r.source=i.relative(t,r.source)),r.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(r.name=e.name)),n.addMapping(r)}),e.sources.forEach(function(r){var s=r;null!==t&&(s=i.relative(t,r)),n._sources.has(s)||n._sources.add(s);var a=e.sourceContentFor(r);null!=a&&n.setSourceContent(r,a)}),n},o.prototype.addMapping=function(e){var t=i.getArg(e,"generated"),n=i.getArg(e,"original",null),r=i.getArg(e,"source",null),s=i.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,r,s),null!=r&&(r=String(r),this._sources.has(r)||this._sources.add(r)),null!=s&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=n&&n.line,originalColumn:null!=n&&n.column,source:r,name:s})},o.prototype.setSourceContent=function(e,t){var n=e;null!=this._sourceRoot&&(n=i.relative(this._sourceRoot,n)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[i.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[i.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},o.prototype.applySourceMap=function(e,t,n){var r=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');r=e.file}var a=this._sourceRoot;null!=a&&(r=i.relative(a,r));var o=new s,c=new s;this._mappings.unsortedForEach(function(t){if(t.source===r&&null!=t.originalLine){var s=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=s.source&&(t.source=s.source,null!=n&&(t.source=i.join(n,t.source)),null!=a&&(t.source=i.relative(a,t.source)),t.originalLine=s.line,t.originalColumn=s.column,null!=s.name&&(t.name=s.name))}var l=t.source;null==l||o.has(l)||o.add(l);var u=t.name;null==u||c.has(u)||c.add(u)},this),this._sources=o,this._names=c,e.sources.forEach(function(t){var r=e.sourceContentFor(t);null!=r&&(null!=n&&(t=i.join(n,t)),null!=a&&(t=i.relative(a,t)),this.setSourceContent(t,r))},this)},o.prototype._validateMapping=function(e,t,n,r){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||n||r)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:r}))},o.prototype._serializeMappings=function(){for(var e,t,n,s,a=0,o=1,c=0,l=0,u=0,h=0,d="",f=this._mappings.toArray(),p=0,g=f.length;p<g;p++){if(e="",(t=f[p]).generatedLine!==o)for(a=0;t.generatedLine!==o;)e+=";",o++;else if(p>0){if(!i.compareByGeneratedPositionsInflated(t,f[p-1]))continue;e+=","}e+=r.encode(t.generatedColumn-a),a=t.generatedColumn,null!=t.source&&(s=this._sources.indexOf(t.source),e+=r.encode(s-h),h=s,e+=r.encode(t.originalLine-1-l),l=t.originalLine-1,e+=r.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(n=this._names.indexOf(t.name),e+=r.encode(n-u),u=n)),d+=e}return d},o.prototype._generateSourcesContent=function(e,t){return e.map(function(e){if(!this._sourcesContents)return null;null!=t&&(e=i.relative(t,e));var n=i.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)},o.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},o.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.SourceMapGenerator=o},5060:(e,t,n)=>{var r=n(32).SourceMapGenerator,i=n(9002),s=/(\r?\n)/,a="$$$isSourceNode$$$";function o(e,t,n,r,i){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==n?null:n,this.name=null==i?null:i,this[a]=!0,null!=r&&this.add(r)}o.fromStringWithSourceMap=function(e,t,n){var r=new o,a=e.split(s),c=0,l=function(){return e()+(e()||"");function e(){return c<a.length?a[c++]:void 0}},u=1,h=0,d=null;return t.eachMapping(function(e){if(null!==d){if(!(u<e.generatedLine)){var t=(n=a[c]||"").substr(0,e.generatedColumn-h);return a[c]=n.substr(e.generatedColumn-h),h=e.generatedColumn,f(d,t),void(d=e)}f(d,l()),u++,h=0}for(;u<e.generatedLine;)r.add(l()),u++;if(h<e.generatedColumn){var n=a[c]||"";r.add(n.substr(0,e.generatedColumn)),a[c]=n.substr(e.generatedColumn),h=e.generatedColumn}d=e},this),c<a.length&&(d&&f(d,l()),r.add(a.splice(c).join(""))),t.sources.forEach(function(e){var s=t.sourceContentFor(e);null!=s&&(null!=n&&(e=i.join(n,e)),r.setSourceContent(e,s))}),r;function f(e,t){if(null===e||void 0===e.source)r.add(t);else{var s=n?i.join(n,e.source):e.source;r.add(new o(e.originalLine,e.originalColumn,s,t,e.name))}}},o.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(e){this.add(e)},this);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},o.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},o.prototype.walk=function(e){for(var t,n=0,r=this.children.length;n<r;n++)(t=this.children[n])[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},o.prototype.join=function(e){var t,n,r=this.children.length;if(r>0){for(t=[],n=0;n<r-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this},o.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[a]?n.replaceRight(e,t):"string"==typeof n?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this},o.prototype.setSourceContent=function(e,t){this.sourceContents[i.toSetString(e)]=t},o.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);var r=Object.keys(this.sourceContents);for(t=0,n=r.length;t<n;t++)e(i.fromSetString(r[t]),this.sourceContents[r[t]])},o.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e},o.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new r(e),i=!1,s=null,a=null,o=null,c=null;return this.walk(function(e,r){t.code+=e,null!==r.source&&null!==r.line&&null!==r.column?(s===r.source&&a===r.line&&o===r.column&&c===r.name||n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:t.line,column:t.column},name:r.name}),s=r.source,a=r.line,o=r.column,c=r.name,i=!0):i&&(n.addMapping({generated:{line:t.line,column:t.column}}),s=null,i=!1);for(var l=0,u=e.length;l<u;l++)10===e.charCodeAt(l)?(t.line++,t.column=0,l+1===u?(s=null,i=!1):i&&n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:t.line,column:t.column},name:r.name})):t.column++}),this.walkSourceContents(function(e,t){n.setSourceContent(e,t)}),{code:t.code,map:n}},t.SourceNode=o},9002:(e,t)=>{t.getArg=function(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(e){var t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function s(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e){var n=e,r=i(e);if(r){if(!r.path)return e;n=r.path}for(var a,o=t.isAbsolute(n),c=n.split(/\/+/),l=0,u=c.length-1;u>=0;u--)"."===(a=c[u])?c.splice(u,1):".."===a?l++:l>0&&(""===a?(c.splice(u+1,l),l=0):(c.splice(u,2),l--));return""===(n=c.join("/"))&&(n=o?"/":"."),r?(r.path=n,s(r)):n}function o(e,t){""===e&&(e="."),""===t&&(t=".");var n=i(t),o=i(e);if(o&&(e=o.path||"/"),n&&!n.scheme)return o&&(n.scheme=o.scheme),s(n);if(n||t.match(r))return t;if(o&&!o.host&&!o.path)return o.host=t,s(o);var c="/"===t.charAt(0)?t:a(e.replace(/\/+$/,"")+"/"+t);return o?(o.path=c,s(o)):c}t.urlParse=i,t.urlGenerate=s,t.normalize=a,t.join=o,t.isAbsolute=function(e){return"/"===e.charAt(0)||n.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var n=0;0!==t.indexOf(e+"/");){var r=e.lastIndexOf("/");if(r<0)return t;if((e=e.slice(0,r)).match(/^([^\/]+:\/)?\/*$/))return t;++n}return Array(n+1).join("../")+t.substr(e.length+1)};var c=!("__proto__"in Object.create(null));function l(e){return e}function u(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function h(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=c?l:function(e){return u(e)?"$"+e:e},t.fromSetString=c?l:function(e){return u(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,n){var r=h(e.source,t.source);return 0!==r||0!=(r=e.originalLine-t.originalLine)||0!=(r=e.originalColumn-t.originalColumn)||n||0!=(r=e.generatedColumn-t.generatedColumn)||0!=(r=e.generatedLine-t.generatedLine)?r:h(e.name,t.name)},t.compareByGeneratedPositionsDeflated=function(e,t,n){var r=e.generatedLine-t.generatedLine;return 0!==r||0!=(r=e.generatedColumn-t.generatedColumn)||n||0!==(r=h(e.source,t.source))||0!=(r=e.originalLine-t.originalLine)||0!=(r=e.originalColumn-t.originalColumn)?r:h(e.name,t.name)},t.compareByGeneratedPositionsInflated=function(e,t){var n=e.generatedLine-t.generatedLine;return 0!==n||0!=(n=e.generatedColumn-t.generatedColumn)||0!==(n=h(e.source,t.source))||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)?n:h(e.name,t.name)},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,n){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),n){var r=i(n);if(!r)throw new Error("sourceMapURL could not be parsed");if(r.path){var c=r.path.lastIndexOf("/");c>=0&&(r.path=r.path.substring(0,c+1))}t=o(s(r),t)}return a(t)}},9715:(e,t,n)=>{t.SourceMapGenerator=n(32).SourceMapGenerator,t.SourceMapConsumer=n(3697).SourceMapConsumer,t.SourceNode=n(5060).SourceNode},8228:(e,t,n)=>{"use strict";var r=n(1743);function i(e,t,n,r){var s=e.indexOf(t,n);return"\\"===e.charAt(s-1)?i(e,t,s+1):s}function s(e,t){return!0===t.keepDoubleQuotes&&'"'===e||!0===t.keepSingleQuotes&&"'"===e||t.keepQuotes}function a(e,t,n){return"function"==typeof e.keepEscaping?e.keepEscaping(t,n):!0===e.keepEscaping||"\\"===t[n+1]}e.exports=function(e,t,n){if("string"!=typeof e)throw new TypeError("expected a string");"function"==typeof t&&(n=t,t=null),"string"==typeof t&&(t={sep:t});var o,c=r({sep:"."},t),l=c.quotes||['"',"'","`"];!0===c.brackets?o={"<":">","(":")","[":"]","{":"}"}:c.brackets&&(o=c.brackets);var u,h=[],d=[],f=[""],p=c.sep,g=e.length,m=-1;function y(){if(o&&d.length)return o[d[d.length-1]]}for(;++m<g;){var b=e[m],w=e[m+1],v={val:b,idx:m,arr:f,str:e};if(h.push(v),"\\"!==b){if(o&&o[b]){d.push(b);var S=y(),x=m+1;if(-1!==e.indexOf(S,x+1))for(;d.length&&x<g;){var E=e[++x];if("\\"!==E)if(-1===l.indexOf(E)){if(S=y(),d.length&&-1===e.indexOf(S,x+1))break;o[E]?d.push(E):S===E&&d.pop()}else x=i(e,E,x+1);else E++}if(-1===(u=x)){f[f.length-1]+=b;continue}b=e.slice(m,u+1),v.val=b,v.idx=m=u}if(-1!==l.indexOf(b)){if(-1===(u=i(e,b,m+1))){f[f.length-1]+=b;continue}b=!0===s(b,c)?e.slice(m,u+1):e.slice(m+1,u),v.val=b,v.idx=m=u}"function"==typeof n&&(n(v,h),b=v.val,m=v.idx),v.val!==p||!1===v.split?f[f.length-1]+=v.val:f.push("")}else v.val=!0===a(c,e,m)?b+w:w,v.escaped=!0,"function"==typeof n&&n(v),f[f.length-1]+=v.val,m++}return f}},8324:(e,t,n)=>{"use strict";var r=n(6325),i=n(5677),s=n(9208);e.exports=function e(t,n){if("function"!=typeof t)throw new TypeError("expected Parent to be a function.");return function(a,o){if("function"!=typeof a)throw new TypeError("expected Ctor to be a function.");if(s.inherits(a,t),r(a,t),"object"==typeof o){var c=Object.create(o);for(var l in c)a.prototype[l]=c[l]}i(a.prototype,"_parent_",{configurable:!0,set:function(){},get:function(){return t.prototype}}),"function"==typeof n&&n(a,t),a.extend=e(a,n)}}},1983:(e,t,n)=>{e.exports=i;var r=n(46).EventEmitter;function i(){r.call(this)}n(5615)(i,r),i.Readable=n(8199),i.Writable=n(5291),i.Duplex=n(1265),i.Transform=n(9415),i.PassThrough=n(4421),i.finished=n(4869),i.pipeline=n(6815),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function s(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",s),e._isStdio||t&&!1===t.end||(n.on("end",o),n.on("close",c));var a=!1;function o(){a||(a=!0,e.end())}function c(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(u(),0===r.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",i),e.removeListener("drain",s),n.removeListener("end",o),n.removeListener("close",c),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",u),n.removeListener("close",u),e.removeListener("close",u)}return n.on("error",l),e.on("error",l),n.on("end",u),n.on("close",u),e.on("close",u),e.emit("pipe",n),e}},8888:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=l,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,n=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=a(t[r]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--r<n||-2===i?0:(i=a(t[r]))>=0?(i>0&&(e.lastNeed=i-2),i):--r<n||-2===i?0:(i=a(t[r]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},8764:(e,t,n)=>{"use strict";var r=n(5636).Buffer,i=n(9196),s=n(1279),a=ArrayBuffer.isView||function(e){try{return s(e),!0}catch(e){return!1}},o="undefined"!=typeof Uint8Array,c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,l=c&&(r.prototype instanceof Uint8Array||r.TYPED_ARRAY_SUPPORT);e.exports=function(e,t){if(e instanceof r)return e;if("string"==typeof e)return r.from(e,t);if(c&&a(e)){if(0===e.byteLength)return r.alloc(0);if(l){var n=r.from(e.buffer,e.byteOffset,e.byteLength);if(n.byteLength===e.byteLength)return n}var s=e instanceof Uint8Array?e:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),u=r.from(s);if(u.length===e.byteLength)return u}if(o&&e instanceof Uint8Array)return r.from(e);var h=i(e);if(h)for(var d=0;d<e.length;d+=1){var f=e[d];if("number"!=typeof f||f<0||f>255||~~f!==f)throw new RangeError("Array items must be numbers in the range 0-255.")}if(h||r.isBuffer(e)&&e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))return r.from(e);throw new TypeError('The "data" argument must be a string, an Array, a Buffer, a Uint8Array, or a DataView.')}},6464:e=>{e.exports=function(e){if(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new DataView(e.buffer,e.byteOffset,e.byteLength);if(e instanceof ArrayBuffer)return new DataView(e);throw new TypeError("Expected `data` to be an ArrayBuffer, Buffer, Int8Array, Uint8Array or Uint8ClampedArray")}},9815:(e,t,n)=>{"use strict";var r=n(1182);function i(e){for(var t=e.length,n=-1,s=[];++n<t;){var a=e[n];"arguments"===r(a)||Array.isArray(a)?s.push.apply(s,i(a)):"string"==typeof a&&s.push(a)}return s}e.exports=function(e){return"arguments"!==r(e)&&(e=arguments),i(e).join(".")}},5629:(e,t,n)=>{"use strict";var r=n(9893),i=n(5677),s=n(1743),a=n(6837),o={};function c(e,t){if(e instanceof RegExp)return e;if("string"!=typeof e)throw new TypeError("expected a string");if(e.length>65536)throw new Error("expected pattern to be less than 65536 characters");var n=e;if((!t||t&&!1!==t.cache)&&(n=function(e,t){if(!t)return e;var n=e;for(var r in t)t.hasOwnProperty(r)&&(n+=";"+r+"="+String(t[r]));return n}(e,t),o.hasOwnProperty(n)))return o[n];var c=s({},t);!0===c.contains&&(!0===c.negate?c.strictNegate=!1:c.strict=!1),!1===c.strict&&(c.strictOpen=!1,c.strictClose=!1);var l,u=!1!==c.strictOpen?"^":"",h=!1!==c.strictClose?"$":"",d=c.flags||"";!0!==c.nocase||/i/.test(d)||(d+="i");try{if((c.negate||"boolean"==typeof c.strictNegate)&&(e=a.create(e,c)),l=new RegExp(u+"(?:"+e+")"+h,d),!0===c.safe&&!1===r(l))throw new Error("potentially unsafe regular expression: "+l.source)}catch(r){if(!0===c.strictErrors||!0===c.safe)throw r.key=n,r.pattern=e,r.originalOptions=t,r.createdOptions=c,r;try{l=new RegExp("^"+e.replace(/(\W)/g,"\\$1")+"$")}catch(e){l=/.^/}}return!1!==c.cache&&function(e,t,n,r){i(e,"cached",!0),i(e,"pattern",n),i(e,"options",r),i(e,"key",t),o[t]=e}(l,n,e,c),l}e.exports=function(e,t){return Array.isArray(e)?c(e.join("|"),t):c(e,t)},e.exports.makeRe=c},1279:(e,t,n)=>{"use strict";var r=n(3468),i=n(4607)("TypedArray.prototype.buffer",!0),s=n(5943);e.exports=i||function(e){if(!s(e))throw new r("Not a Typed Array");return e.buffer}},4409:(e,t,n)=>{"use strict";var r=n(5433),i=n(5123),s=n(5302),a=n(1098);function o(e){return null==e?[]:Array.isArray(e)?e:[e]}e.exports=function(e,t,n){if(!r(e))throw new TypeError("union-value expects the first argument to be an object.");if("string"!=typeof t)throw new TypeError("union-value expects `prop` to be a string.");var c=o(s(e,t));return a(e,t,i(c,o(n))),e}},6767:(e,t,n)=>{"use strict";var r=n(9537),i=n(8418);e.exports=function(e,t){if(!r(e))throw new TypeError("expected an object.");if(e.hasOwnProperty(t))return delete e[t],!0;if(i(e,t)){for(var n=t.split("."),s=n.pop();n.length&&"\\"===n[n.length-1].slice(-1);)s=n.pop().slice(0,-1)+"."+s;for(;n.length;)e=e[t=n.shift()];return delete e[s]}return!0}},8641:e=>{"use strict";function t(e){return e&&"object"==typeof e&&!Array.isArray(e)}function n(e,t,n){Object.defineProperty(e,t,{configurable:!0,writable:!0,value:n})}e.exports=function e(r,i){if(!t(r)&&"function"!=typeof r)throw new TypeError("expected an object or function");var s=t(i)?i:{},a="string"==typeof s.prop?s.prop:"fns";function o(e,t,n){var i=1;if("string"==typeof e||Array.isArray(e)?(t=function(e,t){return function n(){return this.type===e?t.apply(this,arguments):n}}(e,t),i++):(n=t,t=e),"function"!=typeof t)throw new TypeError("expected a function");var o=this||r,c=o[a],l=[].slice.call(arguments,i);l.unshift(o),"function"==typeof s.hook&&s.hook.apply(o,l);var u=t.apply(o,l);return"function"==typeof u&&-1===c.indexOf(u)&&c.push(u),o}return Array.isArray(r[a])||n(r,a,[]),n(r,"use",o),n(r,"run",function(i){if(t(i)){i.use&&i.run||(n(i,a,i[a]||[]),n(i,"use",o)),i[a]&&-1!==i[a].indexOf(e)||i.use(e);for(var s=(this||r)[a],c=s.length,l=-1;++l<c;)i.use(s[l]);return i}}),r}},5272:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},1531:(e,t,n)=>{"use strict";var r=n(5387),i=n(2625),s=n(2730),a=n(5943);function o(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,l="undefined"!=typeof Symbol,u=o(Object.prototype.toString),h=o(Number.prototype.valueOf),d=o(String.prototype.valueOf),f=o(Boolean.prototype.valueOf);if(c)var p=o(BigInt.prototype.valueOf);if(l)var g=o(Symbol.prototype.valueOf);function m(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function y(e){return"[object Map]"===u(e)}function b(e){return"[object Set]"===u(e)}function w(e){return"[object WeakMap]"===u(e)}function v(e){return"[object WeakSet]"===u(e)}function S(e){return"[object ArrayBuffer]"===u(e)}function x(e){return"undefined"!=typeof ArrayBuffer&&(S.working?S(e):e instanceof ArrayBuffer)}function E(e){return"[object DataView]"===u(e)}function I(e){return"undefined"!=typeof DataView&&(E.working?E(e):e instanceof DataView)}t.isArgumentsObject=r,t.isGeneratorFunction=i,t.isTypedArray=a,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):a(e)||I(e)},t.isUint8Array=function(e){return"Uint8Array"===s(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===s(e)},t.isUint16Array=function(e){return"Uint16Array"===s(e)},t.isUint32Array=function(e){return"Uint32Array"===s(e)},t.isInt8Array=function(e){return"Int8Array"===s(e)},t.isInt16Array=function(e){return"Int16Array"===s(e)},t.isInt32Array=function(e){return"Int32Array"===s(e)},t.isFloat32Array=function(e){return"Float32Array"===s(e)},t.isFloat64Array=function(e){return"Float64Array"===s(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===s(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===s(e)},y.working="undefined"!=typeof Map&&y(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(y.working?y(e):e instanceof Map)},b.working="undefined"!=typeof Set&&b(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(b.working?b(e):e instanceof Set)},w.working="undefined"!=typeof WeakMap&&w(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(w.working?w(e):e instanceof WeakMap)},v.working="undefined"!=typeof WeakSet&&v(new WeakSet),t.isWeakSet=function(e){return v(e)},S.working="undefined"!=typeof ArrayBuffer&&S(new ArrayBuffer),t.isArrayBuffer=x,E.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&E(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=I;var k="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function T(e){return"[object SharedArrayBuffer]"===u(e)}function _(e){return void 0!==k&&(void 0===T.working&&(T.working=T(new k)),T.working?T(e):e instanceof k)}function C(e){return m(e,h)}function A(e){return m(e,d)}function F(e){return m(e,f)}function R(e){return c&&m(e,p)}function M(e){return l&&m(e,g)}t.isSharedArrayBuffer=_,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===u(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===u(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===u(e)},t.isGeneratorObject=function(e){return"[object Generator]"===u(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===u(e)},t.isNumberObject=C,t.isStringObject=A,t.isBooleanObject=F,t.isBigIntObject=R,t.isSymbolObject=M,t.isBoxedPrimitive=function(e){return C(e)||A(e)||F(e)||R(e)||M(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(x(e)||_(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})})},9208:(e,t,n)=>{var r=n(9907),i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},s=/%[sdj%]/g;t.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(l(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(s,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),o=r[n];n<i;o=r[++n])y(o)||!x(o)?a+=" "+o:a+=" "+l(o);return a},t.deprecate=function(e,n){if(void 0!==r&&!0===r.noDeprecation)return e;if(void 0===r)return function(){return t.deprecate(e,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(n);r.traceDeprecation?console.trace(n):console.error(n),i=!0}return e.apply(this,arguments)}};var a={},o=/^$/;if(r.env.NODE_DEBUG){var c=r.env.NODE_DEBUG;c=c.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),o=new RegExp("^"+c+"$","i")}function l(e,n){var r={seen:[],stylize:h};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),d(r,e,r.depth)}function u(e,t){var n=l.styles[t];return n?"["+l.colors[n][0]+"m"+e+"["+l.colors[n][1]+"m":e}function h(e,t){return e}function d(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return w(i)||(i=d(e,i,r)),i}var s=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return b(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}(e,n);if(s)return s;var a=Object.keys(n),o=function(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),I(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(k(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(S(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(I(n))return f(n)}var l,u="",h=!1,x=["{","}"];return g(n)&&(h=!0,x=["[","]"]),k(n)&&(u=" [Function"+(n.name?": "+n.name:"")+"]"),S(n)&&(u=" "+RegExp.prototype.toString.call(n)),E(n)&&(u=" "+Date.prototype.toUTCString.call(n)),I(n)&&(u=" "+f(n)),0!==a.length||h&&0!=n.length?r<0?S(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=h?function(e,t,n,r,i){for(var s=[],a=0,o=t.length;a<o;++a)A(t,String(a))?s.push(p(e,t,n,r,String(a),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(p(e,t,n,r,i,!0))}),s}(e,n,r,o,a):a.map(function(t){return p(e,n,r,o,t,h)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(l,u,x)):x[0]+u+x[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,i,s){var a,o,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?o=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(o=e.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),o||(e.seen.indexOf(c.value)<0?(o=y(n)?d(e,c.value,null):d(e,c.value,n-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map(function(e){return"  "+e}).join("\n").slice(2):"\n"+o.split("\n").map(function(e){return"   "+e}).join("\n")):o=e.stylize("[Circular]","special")),v(a)){if(s&&i.match(/^\d+$/))return o;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.slice(1,-1),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+o}function g(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function b(e){return"number"==typeof e}function w(e){return"string"==typeof e}function v(e){return void 0===e}function S(e){return x(e)&&"[object RegExp]"===T(e)}function x(e){return"object"==typeof e&&null!==e}function E(e){return x(e)&&"[object Date]"===T(e)}function I(e){return x(e)&&("[object Error]"===T(e)||e instanceof Error)}function k(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!a[e])if(o.test(e)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(1531),t.isArray=g,t.isBoolean=m,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=w,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=S,t.types.isRegExp=S,t.isObject=x,t.isDate=E,t.types.isDate=E,t.isError=I,t.types.isNativeError=I,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(5272);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(n=[_((e=new Date).getHours()),_(e.getMinutes()),_(e.getSeconds())].join(":"),[e.getDate(),C[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(5615),t._extend=function(e,t){if(!t||!x(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var F="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function R(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(F&&e[F]){var t;if("function"!=typeof(t=e[F]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,F,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise(function(e,r){t=e,n=r}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(e,r){e?n(e):t(r)});try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),F&&Object.defineProperty(t,F,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=F,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var i=t.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var s=this,a=function(){return i.apply(s,arguments)};e.apply(this,t).then(function(e){r.nextTick(a.bind(null,null,e))},function(e){r.nextTick(R.bind(null,e,a))})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}},2730:(e,t,n)=>{"use strict";var r=n(705),i=n(4834),s=n(8498),a=n(4607),o=n(9336),c=a("Object.prototype.toString"),l=n(1913)(),u="undefined"==typeof globalThis?n.g:globalThis,h=i(),d=a("String.prototype.slice"),f=Object.getPrototypeOf,p=a("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},g={__proto__:null};r(h,l&&o&&f?function(e){var t=new u[e];if(Symbol.toStringTag in t){var n=f(t),r=o(n,Symbol.toStringTag);if(!r){var i=f(n);r=o(i,Symbol.toStringTag)}g["$"+e]=s(r.get)}}:function(e){var t=new u[e],n=t.slice||t.set;n&&(g["$"+e]=s(n))}),e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!l){var t=d(c(e),8,-1);return p(h,t)>-1?t:"Object"===t&&function(e){var t=!1;return r(g,function(n,r){if(!t)try{n(e),t=d(r,1)}catch(e){}}),t}(e)}return o?function(e){var t=!1;return r(g,function(n,r){if(!t)try{"$"+n(e)===r&&(t=d(r,1))}catch(e){}}),t}(e):null}},1603:(e,t,n)=>{e.exports=n(8570)},8570:(e,t,n)=>{!function(){var t;if(e.exports&&!n.g.xmldocAssumeBrowser)t=n(5150);else if(!(t=this.sax))throw new Error("Expected sax to be defined. Make sure you're including sax.js before this file.");function r(e,t){if(!t){var n=c[c.length-1];n.parser&&(t=n.parser)}this.name=e.name,this.attr=e.attributes,this.val="",this.children=[],this.firstChild=null,this.lastChild=null,this.line=t?t.line:null,this.column=t?t.column:null,this.position=t?t.position:null,this.startTagPosition=t?t.startTagPosition:null}function i(e){this.text=e}function s(e){this.cdata=e}function a(e){this.comment=e}function o(e){if(e&&(e=e.toString().trim()),!e)throw new Error("No XML to parse!");var n;this.doctype="",this.parser=t.parser(!0),(n=this.parser).onopentag=l,n.onclosetag=u,n.ontext=h,n.oncdata=d,n.oncomment=f,n.ondoctype=p,n.onerror=g,c=[this];try{this.parser.write(e)}finally{delete this.parser}}r.prototype._addChild=function(e){this.children.push(e),this.firstChild||(this.firstChild=e),this.lastChild=e},r.prototype._opentag=function(e){var t=new r(e);this._addChild(t),c.unshift(t)},r.prototype._closetag=function(){c.shift()},r.prototype._text=function(e){void 0!==this.children&&(this.val+=e,this._addChild(new i(e)))},r.prototype._cdata=function(e){this.val+=e,this._addChild(new s(e))},r.prototype._comment=function(e){void 0!==this.children&&this._addChild(new a(e))},r.prototype._error=function(e){throw e},r.prototype.eachChild=function(e,t){for(var n=0,r=this.children.length;n<r;n++)if("element"===this.children[n].type&&!1===e.call(t,this.children[n],n,this.children))return},r.prototype.childNamed=function(e){for(var t=0,n=this.children.length;t<n;t++){var r=this.children[t];if(r.name===e)return r}},r.prototype.childrenNamed=function(e){for(var t=[],n=0,r=this.children.length;n<r;n++)this.children[n].name===e&&t.push(this.children[n]);return t},r.prototype.childWithAttribute=function(e,t){for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n];if("element"===i.type&&(t&&i.attr[e]===t||!t&&i.attr[e]))return i}},r.prototype.descendantsNamed=function(e){for(var t=[],n=0,r=this.children.length;n<r;n++){var i=this.children[n];"element"===i.type&&(i.name===e&&t.push(i),t=t.concat(i.descendantsNamed(e)))}return t},r.prototype.descendantWithPath=function(e){for(var t=this,n=e.split("."),r=0,i=n.length;r<i;r++){if(!t||"element"!==t.type)return;t=t.childNamed(n[r])}return t},r.prototype.valueWithPath=function(e){var t=e.split("@"),n=this.descendantWithPath(t[0]);return n?t.length>1?n.attr[t[1]]:n.val:void 0},r.prototype.toString=function(e){return this.toStringWithIndent("",e)},r.prototype.toStringWithIndent=function(e,t){var n=e+"<"+this.name,r=t&&t.compressed?"":"\n";for(var i in t&&t.preserveWhitespace,this.attr)Object.prototype.hasOwnProperty.call(this.attr,i)&&(n+=" "+i+'="'+m(this.attr[i])+'"');if(1===this.children.length&&"element"!==this.children[0].type)n+=">"+this.children[0].toString(t)+"</"+this.name+">";else if(this.children.length){n+=">"+r;for(var s=e+(t&&t.compressed?"":"  "),a=0,o=this.children.length;a<o;a++)n+=this.children[a].toStringWithIndent(s,t)+r;n+=e+"</"+this.name+">"}else t&&t.html?-1!==["area","base","br","col","embed","frame","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"].indexOf(this.name)?n+="/>":n+="></"+this.name+">":n+="/>";return n},i.prototype.toString=function(e){return y(m(this.text),e)},i.prototype.toStringWithIndent=function(e,t){return e+this.toString(t)},s.prototype.toString=function(e){return"<![CDATA["+y(this.cdata,e)+"]]>"},s.prototype.toStringWithIndent=function(e,t){return e+this.toString(t)},a.prototype.toString=function(e){return"\x3c!--"+y(m(this.comment),e)+"--\x3e"},a.prototype.toStringWithIndent=function(e,t){return e+this.toString(t)},r.prototype.type="element",i.prototype.type="text",s.prototype.type="cdata",a.prototype.type="comment",function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(o.prototype,r.prototype),o.prototype._opentag=function(e){void 0===this.children?r.call(this,e):r.prototype._opentag.apply(this,arguments)},o.prototype._doctype=function(e){this.doctype+=e};var c=null;function l(){c[0]&&c[0]._opentag.apply(c[0],arguments)}function u(){c[0]&&c[0]._closetag.apply(c[0],arguments)}function h(){c[0]&&c[0]._text.apply(c[0],arguments)}function d(){c[0]&&c[0]._cdata.apply(c[0],arguments)}function f(){c[0]&&c[0]._comment.apply(c[0],arguments)}function p(){c[0]&&c[0]._doctype.apply(c[0],arguments)}function g(){c[0]&&c[0]._error.apply(c[0],arguments)}function m(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function y(e,t){var n=e;return t&&t.trimmed&&e.length>25&&(n=n.substring(0,25).trim()+""),t&&t.preserveWhitespace||(n=n.trim()),n}e.exports&&!n.g.xmldocAssumeBrowser?(e.exports.XmlDocument=o,e.exports.XmlElement=r,e.exports.XmlTextNode=i,e.exports.XmlCDataNode=s,e.exports.XmlCommentNode=a):(this.XmlDocument=o,this.XmlElement=r,this.XmlTextNode=i,this.XmlCDataNode=s,this.XmlCommentNode=a)}()},5192:e=>{class t{constructor(e){this.value=e,this.next=void 0}}class n{constructor(){this.clear()}enqueue(e){const n=new t(e);this._head?(this._tail.next=n,this._tail=n):(this._head=n,this._tail=n),this._size++}dequeue(){const e=this._head;if(e)return this._head=this._head.next,this._size--,e.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let e=this._head;for(;e;)yield e.value,e=e.next}}e.exports=n},113:()=>{},8379:()=>{},3553:()=>{},583:()=>{},4818:()=>{},2798:()=>{},597:()=>{},4834:(e,t,n)=>{"use strict";var r=n(9501),i="undefined"==typeof globalThis?n.g:globalThis;e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof i[r[t]]&&(e[e.length]=r[t]);return e}},8398:(e,t)=>{"use strict";var n={},r=function(e,t,r,i,s){var a=new Worker(n[t]||(n[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(e){var t=e.data,n=t.$e$;if(n){var r=new Error(n[0]);r.code=n[1],r.stack=n[2],s(r,null)}else s(null,t)},a.postMessage(r,i),a},i=Uint8Array,s=Uint16Array,a=Int32Array,o=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),l=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u=function(e,t){for(var n=new s(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new a(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return{b:n,r:i}},h=u(o,2),d=h.b,f=h.r;d[28]=258,f[258]=28;for(var p=u(c,0),g=p.b,m=p.r,y=new s(32768),b=0;b<32768;++b){var w=(43690&b)>>1|(21845&b)<<1;w=(61680&(w=(52428&w)>>2|(13107&w)<<2))>>4|(3855&w)<<4,y[b]=((65280&w)>>8|(255&w)<<8)>>1}var v=function(e,t,n){for(var r=e.length,i=0,a=new s(t);i<r;++i)e[i]&&++a[e[i]-1];var o,c=new s(t);for(i=1;i<t;++i)c[i]=c[i-1]+a[i-1]<<1;if(n){o=new s(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],h=t-e[i],d=c[e[i]-1]++<<h,f=d|(1<<h)-1;d<=f;++d)o[y[d]>>l]=u}else for(o=new s(r),i=0;i<r;++i)e[i]&&(o[i]=y[c[e[i]-1]++]>>15-e[i]);return o},S=new i(288);for(b=0;b<144;++b)S[b]=8;for(b=144;b<256;++b)S[b]=9;for(b=256;b<280;++b)S[b]=7;for(b=280;b<288;++b)S[b]=8;var x=new i(32);for(b=0;b<32;++b)x[b]=5;var E=v(S,9,0),I=v(S,9,1),k=v(x,5,0),T=v(x,5,1),_=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},C=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},A=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},F=function(e){return(e+7)/8|0},R=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new i(e.subarray(t,n))};t.FlateErrorCode={UnexpectedEOF:0,InvalidBlockType:1,InvalidLengthLiteral:2,InvalidDistance:3,StreamFinished:4,NoStreamHandler:5,InvalidHeader:6,NoCallback:7,InvalidUTF8:8,ExtraFieldTooLong:9,InvalidDate:10,FilenameTooLong:11,StreamFinishing:12,InvalidZipData:13,UnknownCompressionMethod:14};var M=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],D=function(e,t,n){var r=new Error(t||M[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,D),!n)throw r;return r},O=function(e,t,n,r){var s=e.length,a=r?r.length:0;if(!s||t.f&&!t.l)return n||new i(0);var u=!n,h=u||2!=t.i,f=t.i;u&&(n=new i(3*s));var p=function(e){var t=n.length;if(e>t){var r=new i(Math.max(2*t,e));r.set(n),n=r}},m=t.f||0,y=t.p||0,b=t.b||0,w=t.l,S=t.d,x=t.m,E=t.n,k=8*s;do{if(!w){m=C(e,y,1);var M=C(e,y+1,3);if(y+=3,!M){var O=e[($=F(y)+4)-4]|e[$-3]<<8,P=$+O;if(P>s){f&&D(0);break}h&&p(b+O),n.set(e.subarray($,P),b),t.b=b+=O,t.p=y=8*P,t.f=m;continue}if(1==M)w=I,S=T,x=9,E=5;else if(2==M){var N=C(e,y,31)+257,L=C(e,y+10,15)+4,B=N+C(e,y+5,31)+1;y+=14;for(var U=new i(B),V=new i(19),j=0;j<L;++j)V[l[j]]=C(e,y+3*j,7);y+=3*L;var z=_(V),G=(1<<z)-1,H=v(V,z,1);for(j=0;j<B;){var $,W=H[C(e,y,G)];if(y+=15&W,($=W>>4)<16)U[j++]=$;else{var q=0,X=0;for(16==$?(X=3+C(e,y,3),y+=2,q=U[j-1]):17==$?(X=3+C(e,y,7),y+=3):18==$&&(X=11+C(e,y,127),y+=7);X--;)U[j++]=q}}var Y=U.subarray(0,N),K=U.subarray(N);x=_(Y),E=_(K),w=v(Y,x,1),S=v(K,E,1)}else D(1);if(y>k){f&&D(0);break}}h&&p(b+131072);for(var J=(1<<x)-1,Z=(1<<E)-1,Q=y;;Q=y){var ee=(q=w[A(e,y)&J])>>4;if((y+=15&q)>k){f&&D(0);break}if(q||D(2),ee<256)n[b++]=ee;else{if(256==ee){Q=y,w=null;break}var te=ee-254;if(ee>264){var ne=o[j=ee-257];te=C(e,y,(1<<ne)-1)+d[j],y+=ne}var re=S[A(e,y)&Z],ie=re>>4;if(re||D(3),y+=15&re,K=g[ie],ie>3&&(ne=c[ie],K+=A(e,y)&(1<<ne)-1,y+=ne),y>k){f&&D(0);break}h&&p(b+131072);var se=b+te;if(b<K){var ae=a-K,oe=Math.min(K,se);for(ae+b<0&&D(3);b<oe;++b)n[b]=r[ae+b]}for(;b<se;++b)n[b]=n[b-K]}}t.l=w,t.p=Q,t.b=b,t.f=m,w&&(m=1,t.m=x,t.d=S,t.n=E)}while(!m);return b!=n.length&&u?R(n,0,b):n.subarray(0,b)},P=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},N=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},L=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var a=n.length,o=n.slice();if(!a)return{t:H,l:0};if(1==a){var c=new i(n[0].s+1);return c[n[0].s]=1,{t:c,l:1}}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var l=n[0],u=n[1],h=0,d=1,f=2;for(n[0]={s:-1,f:l.f+u.f,l,r:u};d!=a-1;)l=n[n[h].f<n[f].f?h++:f++],u=n[h!=d&&n[h].f<n[f].f?h++:f++],n[d++]={s:-1,f:l.f+u.f,l,r:u};var p=o[0].s;for(r=1;r<a;++r)o[r].s>p&&(p=o[r].s);var g=new s(p+1),m=B(n[d-1],g,0);if(m>t){r=0;var y=0,b=m-t,w=1<<b;for(o.sort(function(e,t){return g[t.s]-g[e.s]||e.f-t.f});r<a;++r){var v=o[r].s;if(!(g[v]>t))break;y+=w-(1<<m-g[v]),g[v]=t}for(y>>=b;y>0;){var S=o[r].s;g[S]<t?y-=1<<t-g[S]++-1:++r}for(;r>=0&&y;--r){var x=o[r].s;g[x]==t&&(--g[x],++y)}m=t}return{t:new i(g),l:m}},B=function(e,t,n){return-1==e.s?Math.max(B(e.l,t,n+1),B(e.r,t,n+1)):t[e.s]=n},U=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new s(++t),r=0,i=e[0],a=1,o=function(e){n[r++]=e},c=1;c<=t;++c)if(e[c]==i&&c!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=e[c]}return{c:n.subarray(0,r),n:t}},V=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},j=function(e,t,n){var r=n.length,i=F(t+2);e[i]=255&r,e[i+1]=r>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<r;++s)e[i+s+4]=n[s];return 8*(i+4+r)},z=function(e,t,n,r,i,a,u,h,d,f,p){P(t,p++,n),++i[256];for(var g=L(i,15),m=g.t,y=g.l,b=L(a,15),w=b.t,I=b.l,T=U(m),_=T.c,C=T.n,A=U(w),F=A.c,R=A.n,M=new s(19),D=0;D<_.length;++D)++M[31&_[D]];for(D=0;D<F.length;++D)++M[31&F[D]];for(var O=L(M,7),B=O.t,z=O.l,G=19;G>4&&!B[l[G-1]];--G);var H,$,W,q,X=f+5<<3,Y=V(i,S)+V(a,x)+u,K=V(i,m)+V(a,w)+u+14+3*G+V(M,B)+2*M[16]+3*M[17]+7*M[18];if(d>=0&&X<=Y&&X<=K)return j(t,p,e.subarray(d,d+f));if(P(t,p,1+(K<Y)),p+=2,K<Y){H=v(m,y,0),$=m,W=v(w,I,0),q=w;var J=v(B,z,0);for(P(t,p,C-257),P(t,p+5,R-1),P(t,p+10,G-4),p+=14,D=0;D<G;++D)P(t,p+3*D,B[l[D]]);p+=3*G;for(var Z=[_,F],Q=0;Q<2;++Q){var ee=Z[Q];for(D=0;D<ee.length;++D){var te=31&ee[D];P(t,p,J[te]),p+=B[te],te>15&&(P(t,p,ee[D]>>5&127),p+=ee[D]>>12)}}}else H=E,$=S,W=k,q=x;for(D=0;D<h;++D){var ne=r[D];if(ne>255){N(t,p,H[257+(te=ne>>18&31)]),p+=$[te+257],te>7&&(P(t,p,ne>>23&31),p+=o[te]);var re=31&ne;N(t,p,W[re]),p+=q[re],re>3&&(N(t,p,ne>>5&8191),p+=c[re])}else N(t,p,H[ne]),p+=$[ne]}return N(t,p,H[256]),p+$[256]},G=new a([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),H=new i(0),$=function(e,t,n,r,l,u){var h=u.z||e.length,d=new i(r+h+5*(1+Math.ceil(h/7e3))+l),p=d.subarray(r,d.length-l),g=u.l,y=7&(u.r||0);if(t){y&&(p[0]=u.r>>3);for(var b=G[t-1],w=b>>13,v=8191&b,S=(1<<n)-1,x=u.p||new s(32768),E=u.h||new s(S+1),I=Math.ceil(n/3),k=2*I,T=function(t){return(e[t]^e[t+1]<<I^e[t+2]<<k)&S},_=new a(25e3),C=new s(288),A=new s(32),M=0,D=0,O=u.i||0,P=0,N=u.w||0,L=0;O+2<h;++O){var B=T(O),U=32767&O,V=E[B];if(x[U]=V,E[B]=U,N<=O){var H=h-O;if((M>7e3||P>24576)&&(H>423||!g)){y=z(e,p,0,_,C,A,D,P,L,O-L,y),P=M=D=0,L=O;for(var $=0;$<286;++$)C[$]=0;for($=0;$<30;++$)A[$]=0}var W=2,q=0,X=v,Y=U-V&32767;if(H>2&&B==T(O-Y))for(var K=Math.min(w,H)-1,J=Math.min(32767,O),Z=Math.min(258,H);Y<=J&&--X&&U!=V;){if(e[O+W]==e[O+W-Y]){for(var Q=0;Q<Z&&e[O+Q]==e[O+Q-Y];++Q);if(Q>W){if(W=Q,q=Y,Q>K)break;var ee=Math.min(Y,Q-2),te=0;for($=0;$<ee;++$){var ne=O-Y+$&32767,re=ne-x[ne]&32767;re>te&&(te=re,V=ne)}}}Y+=(U=V)-(V=x[U])&32767}if(q){_[P++]=268435456|f[W]<<18|m[q];var ie=31&f[W],se=31&m[q];D+=o[ie]+c[se],++C[257+ie],++A[se],N=O+W,++M}else _[P++]=e[O],++C[e[O]]}}for(O=Math.max(O,N);O<h;++O)_[P++]=e[O],++C[e[O]];y=z(e,p,g,_,C,A,D,P,L,O-L,y),g||(u.r=7&y|p[y/8|0]<<3,y-=7,u.h=E,u.p=x,u.i=O,u.w=N)}else{for(O=u.w||0;O<h+g;O+=65535){var ae=O+65535;ae>=h&&(p[y/8|0]=g,ae=h),y=j(p,y+1,e.subarray(O,ae))}u.i=h}return R(d,0,r+F(y)+l)},W=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),q=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=W[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}},X=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,s=0|n.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=r+=n[a];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}e=r,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},Y=function(e,t,n,r,s){if(!s&&(s={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),o=new i(a.length+e.length);o.set(a),o.set(e,a.length),e=o,s.w=a.length}return $(e,null==t.level?6:t.level,null==t.mem?s.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,s)},K=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},J=function(e,t,n){for(var r=e(),i=e.toString(),s=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],c=s[a];if("function"==typeof o){t+=";"+c+"=";var l=o.toString();if(o.prototype)if(-1!=l.indexOf("[native code]")){var u=l.indexOf(" ",8)+1;t+=l.slice(u,l.indexOf("(",u))}else for(var h in t+=l,o.prototype)t+=";"+c+".prototype."+h+"="+o.prototype[h].toString();else t+=l}else n[c]=o}return t},Z=[],Q=function(e,t,n,i){if(!Z[n]){for(var s="",a={},o=e.length-1,c=0;c<o;++c)s=J(e[c],s,a);Z[n]={c:J(e[o],s,a),e:a}}var l=K({},Z[n].e);return r(Z[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,l,function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t}(l),i)},ee=function(){return[i,s,a,o,c,l,d,g,I,T,y,M,v,_,C,A,F,R,D,O,Ae,ae,oe]},te=function(){return[i,s,a,o,c,l,f,m,E,S,k,x,y,G,H,v,P,N,L,B,U,V,j,z,F,R,$,Y,ke,ae]},ne=function(){return[ge,be,pe,q,W]},re=function(){return[me,ye]},ie=function(){return[we,pe,X]},se=function(){return[ve]},ae=function(e){return postMessage(e,[e.buffer])},oe=function(e){return e&&{out:e.size&&new i(e.size),dictionary:e.dictionary}},ce=function(e,t,n,r,i,s){var a=Q(n,r,i,function(e,t){a.terminate(),s(e,t)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}},le=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){t.data.length?(e.push(t.data[0],t.data[1]),postMessage([t.data[0].length])):e.flush()}},ue=function(e,t,n,r,i,s,a){var o,c=Q(e,r,i,function(e,n){e?(c.terminate(),t.ondata.call(t,e)):Array.isArray(n)?1==n.length?(t.queuedSize-=n[0],t.ondrain&&t.ondrain(n[0])):(n[1]&&c.terminate(),t.ondata.call(t,e,n[0],n[1])):a(n)});c.postMessage(n),t.queuedSize=0,t.push=function(e,n){t.ondata||D(5),o&&t.ondata(D(4,0,1),null,!!n),t.queuedSize+=e.length,c.postMessage([e,o=n],[e.buffer])},t.terminate=function(){c.terminate()},s&&(t.flush=function(){c.postMessage([])})},he=function(e,t){return e[t]|e[t+1]<<8},de=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},fe=function(e,t){return de(e,t)+4294967296*de(e,t+4)},pe=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},ge=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&pe(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},me=function(e){31==e[0]&&139==e[1]&&8==e[2]||D(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=2+(e[10]|e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},ye=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},be=function(e){return 10+(e.filename?e.filename.length+1:0)},we=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=X();i.p(t.dictionary),pe(e,2,i.d())}},ve=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&D(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&D(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function Se(e,t){return"function"==typeof e&&(t=e,e={}),this.ondata=t,e}var xe=function(){function e(e,t){if("function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new i(98304),this.o.dictionary){var n=this.o.dictionary.subarray(-32768);this.b.set(n,32768-n.length),this.s.i=32768-n.length}}return e.prototype.p=function(e,t){this.ondata(Y(e,this.o,0,0,this.s),t)},e.prototype.push=function(e,t){this.ondata||D(5),this.s.l&&D(4);var n=e.length+this.s.z;if(n>this.b.length){if(n>2*this.b.length-32768){var r=new i(-32768&n);r.set(this.b.subarray(0,this.s.z)),this.b=r}var s=this.b.length-this.s.z;this.b.set(e.subarray(0,s),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(s),32768),this.s.z=e.length-s+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&t,(this.s.z>this.s.w+8191||t)&&(this.p(this.b,t||!1),this.s.w=this.s.i,this.s.i-=2)},e.prototype.flush=function(){this.ondata||D(5),this.s.l&&D(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},e}();t.Deflate=xe;var Ee=function(e,t){ue([te,function(){return[le,xe]}],this,Se.call(this,e,t),function(e){var t=new xe(e.data);onmessage=le(t)},6,1)};function Ie(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),ce(e,t,[te],function(e){return ae(ke(e.data[0],e.data[1]))},0,n)}function ke(e,t){return Y(e,t||{},0,0)}t.AsyncDeflate=Ee,t.deflate=Ie,t.deflateSync=ke;var Te=function(){function e(e,t){"function"==typeof e&&(t=e,e={}),this.ondata=t;var n=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:n?n.length:0},this.o=new i(32768),this.p=new i(0),n&&this.o.set(n)}return e.prototype.e=function(e){if(this.ondata||D(5),this.d&&D(4),this.p.length){if(e.length){var t=new i(this.p.length+e.length);t.set(this.p),t.set(e,this.p.length),this.p=t}}else this.p=e},e.prototype.c=function(e){this.s.i=+(this.d=e||!1);var t=this.s.b,n=O(this.p,this.s,this.o);this.ondata(R(n,t,this.s.b),this.d),this.o=R(n,this.s.b-32768),this.s.b=this.o.length,this.p=R(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}();t.Inflate=Te;var _e=function(e,t){ue([ee,function(){return[le,Te]}],this,Se.call(this,e,t),function(e){var t=new Te(e.data);onmessage=le(t)},7,0)};function Ce(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),ce(e,t,[ee],function(e){return ae(Ae(e.data[0],oe(e.data[1])))},1,n)}function Ae(e,t){return O(e,{i:2},t&&t.out,t&&t.dictionary)}t.AsyncInflate=_e,t.inflate=Ce,t.inflateSync=Ae;var Fe=function(){function e(e,t){this.c=q(),this.l=0,this.v=1,xe.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),this.l+=e.length,xe.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var n=Y(e,this.o,this.v&&be(this.o),t&&8,this.s);this.v&&(ge(n,this.o),this.v=0),t&&(pe(n,n.length-8,this.c.d()),pe(n,n.length-4,this.l)),this.ondata(n,t)},e.prototype.flush=function(){xe.prototype.flush.call(this)},e}();t.Gzip=Fe,t.Compress=Fe;var Re=function(e,t){ue([te,ne,function(){return[le,xe,Fe]}],this,Se.call(this,e,t),function(e){var t=new Fe(e.data);onmessage=le(t)},8,1)};function Me(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),ce(e,t,[te,ne,function(){return[De]}],function(e){return ae(De(e.data[0],e.data[1]))},2,n)}function De(e,t){t||(t={});var n=q(),r=e.length;n.p(e);var i=Y(e,t,be(t),8),s=i.length;return ge(i,t),pe(i,s-8,n.d()),pe(i,s-4,r),i}t.AsyncGzip=Re,t.AsyncCompress=Re,t.gzip=Me,t.compress=Me,t.gzipSync=De,t.compressSync=De;var Oe=function(){function e(e,t){this.v=1,this.r=0,Te.call(this,e,t)}return e.prototype.push=function(e,t){if(Te.prototype.e.call(this,e),this.r+=e.length,this.v){var n=this.p.subarray(this.v-1),r=n.length>3?me(n):4;if(r>n.length){if(!t)return}else this.v>1&&this.onmember&&this.onmember(this.r-n.length);this.p=n.subarray(r),this.v=0}Te.prototype.c.call(this,t),!this.s.f||this.s.l||t||(this.v=F(this.s.p)+9,this.s={i:0},this.o=new i(0),this.push(new i(0),t))},e}();t.Gunzip=Oe;var Pe=function(e,t){var n=this;ue([ee,re,function(){return[le,Te,Oe]}],this,Se.call(this,e,t),function(e){var t=new Oe(e.data);t.onmember=function(e){return postMessage(e)},onmessage=le(t)},9,0,function(e){return n.onmember&&n.onmember(e)})};function Ne(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),ce(e,t,[ee,re,function(){return[Le]}],function(e){return ae(Le(e.data[0],e.data[1]))},3,n)}function Le(e,t){var n=me(e);return n+8>e.length&&D(6,"invalid gzip data"),O(e.subarray(n,-8),{i:2},t&&t.out||new i(ye(e)),t&&t.dictionary)}t.AsyncGunzip=Pe,t.gunzip=Ne,t.gunzipSync=Le;var Be=function(){function e(e,t){this.c=X(),this.v=1,xe.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),xe.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var n=Y(e,this.o,this.v&&(this.o.dictionary?6:2),t&&4,this.s);this.v&&(we(n,this.o),this.v=0),t&&pe(n,n.length-4,this.c.d()),this.ondata(n,t)},e.prototype.flush=function(){xe.prototype.flush.call(this)},e}();t.Zlib=Be;function Ue(e,t){t||(t={});var n=X();n.p(e);var r=Y(e,t,t.dictionary?6:2,4);return we(r,t),pe(r,r.length-4,n.d()),r}t.AsyncZlib=function(e,t){ue([te,ie,function(){return[le,xe,Be]}],this,Se.call(this,e,t),function(e){var t=new Be(e.data);onmessage=le(t)},10,1)},t.zlib=function(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),ce(e,t,[te,ie,function(){return[Ue]}],function(e){return ae(Ue(e.data[0],e.data[1]))},4,n)},t.zlibSync=Ue;var Ve=function(){function e(e,t){Te.call(this,e,t),this.v=e&&e.dictionary?2:1}return e.prototype.push=function(e,t){if(Te.prototype.e.call(this,e),this.v){if(this.p.length<6&&!t)return;this.p=this.p.subarray(ve(this.p,this.v-1)),this.v=0}t&&(this.p.length<4&&D(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Te.prototype.c.call(this,t)},e}();t.Unzlib=Ve;var je=function(e,t){ue([ee,se,function(){return[le,Te,Ve]}],this,Se.call(this,e,t),function(e){var t=new Ve(e.data);onmessage=le(t)},11,0)};function ze(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),ce(e,t,[ee,se,function(){return[Ge]}],function(e){return ae(Ge(e.data[0],oe(e.data[1])))},5,n)}function Ge(e,t){return O(e.subarray(ve(e,t&&t.dictionary),-4),{i:2},t&&t.out,t&&t.dictionary)}t.AsyncUnzlib=je,t.unzlib=ze,t.unzlibSync=Ge;var He=function(){function e(e,t){this.o=Se.call(this,e,t)||{},this.G=Oe,this.I=Te,this.Z=Ve}return e.prototype.i=function(){var e=this;this.s.ondata=function(t,n){e.ondata(t,n)}},e.prototype.push=function(e,t){if(this.ondata||D(5),this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var n=new i(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length)}else this.p=e;this.p.length>2&&(this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(this.o):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(this.o):new this.Z(this.o),this.i(),this.s.push(this.p,t),this.p=null)}},e}();t.Decompress=He;var $e=function(){function e(e,t){He.call(this,e,t),this.queuedSize=0,this.G=Pe,this.I=_e,this.Z=je}return e.prototype.i=function(){var e=this;this.s.ondata=function(t,n,r){e.ondata(t,n,r)},this.s.ondrain=function(t){e.queuedSize-=t,e.ondrain&&e.ondrain(t)}},e.prototype.push=function(e,t){this.queuedSize+=e.length,He.prototype.push.call(this,e,t)},e}();t.AsyncDecompress=$e,t.decompress=function(e,t,n){return n||(n=t,t={}),"function"!=typeof n&&D(7),31==e[0]&&139==e[1]&&8==e[2]?Ne(e,t,n):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Ce(e,t,n):ze(e,t,n)},t.decompressSync=function(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?Le(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Ae(e,t):Ge(e,t)};var We=function(e,t,n,r){for(var s in e){var a=e[s],o=t+s,c=r;Array.isArray(a)&&(c=K(r,a[1]),a=a[0]),a instanceof i?n[o]=[a,c]:(n[o+="/"]=[new i(0),c],We(a,o,n,r))}},qe="undefined"!=typeof TextEncoder&&new TextEncoder,Xe="undefined"!=typeof TextDecoder&&new TextDecoder,Ye=0;try{Xe.decode(H,{stream:!0}),Ye=1}catch(e){}var Ke=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return{s:t,r:R(e,n-1)};i?3==i?(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|r>>10,56320|1023&r)):t+=1&i?String.fromCharCode((31&r)<<6|63&e[n++]):String.fromCharCode((15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}},Je=function(){function e(e){this.ondata=e,Ye?this.t=new TextDecoder:this.p=H}return e.prototype.push=function(e,t){if(this.ondata||D(5),t=!!t,this.t)return this.ondata(this.t.decode(e,{stream:!0}),t),void(t&&(this.t.decode().length&&D(8),this.t=null));this.p||D(4);var n=new i(this.p.length+e.length);n.set(this.p),n.set(e,this.p.length);var r=Ke(n),s=r.s,a=r.r;t?(a.length&&D(8),this.p=null):this.p=a,this.ondata(s,t)},e}();t.DecodeUTF8=Je;var Ze=function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){this.ondata||D(5),this.d&&D(4),this.ondata(Qe(e),this.d=t||!1)},e}();function Qe(e,t){if(t){for(var n=new i(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}if(qe)return qe.encode(e);var s=e.length,a=new i(e.length+(e.length>>1)),o=0,c=function(e){a[o++]=e};for(r=0;r<s;++r){if(o+5>a.length){var l=new i(o+8+(s-r<<1));l.set(a),a=l}var u=e.charCodeAt(r);u<128||t?c(u):u<2048?(c(192|u>>6),c(128|63&u)):u>55295&&u<57344?(c(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++r))>>18),c(128|u>>12&63),c(128|u>>6&63),c(128|63&u)):(c(224|u>>12),c(128|u>>6&63),c(128|63&u))}return R(a,0,o)}function et(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}if(Xe)return Xe.decode(e);var i=Ke(e),s=i.s;return(n=i.r).length&&D(8),s}t.EncodeUTF8=Ze,t.strToU8=Qe,t.strFromU8=et;var tt=function(e){return 1==e?3:e<6?2:9==e?1:0},nt=function(e,t){return t+30+he(e,t+26)+he(e,t+28)},rt=function(e,t,n){var r=he(e,t+28),i=et(e.subarray(t+46,t+46+r),!(2048&he(e,t+8))),s=t+46+r,a=de(e,t+20),o=n&&4294967295==a?it(e,s):[a,de(e,t+24),de(e,t+42)],c=o[0],l=o[1],u=o[2];return[he(e,t+10),c,l,i,s+he(e,t+30)+he(e,t+32),u]},it=function(e,t){for(;1!=he(e,t);t+=4+he(e,t+2));return[fe(e,t+12),fe(e,t+4),fe(e,t+20)]},st=function(e){var t=0;if(e)for(var n in e){var r=e[n].length;r>65535&&D(9),t+=r+4}return t},at=function(e,t,n,r,i,s,a,o){var c=r.length,l=n.extra,u=o&&o.length,h=st(l);pe(e,t,null!=a?33639248:67324752),t+=4,null!=a&&(e[t++]=20,e[t++]=n.os),e[t]=20,t+=2,e[t++]=n.flag<<1|(s<0&&8),e[t++]=i&&8,e[t++]=255&n.compression,e[t++]=n.compression>>8;var d=new Date(null==n.mtime?Date.now():n.mtime),f=d.getFullYear()-1980;if((f<0||f>119)&&D(10),pe(e,t,f<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1),t+=4,-1!=s&&(pe(e,t,n.crc),pe(e,t+4,s<0?-s-2:s),pe(e,t+8,n.size)),pe(e,t+12,c),pe(e,t+14,h),t+=16,null!=a&&(pe(e,t,u),pe(e,t+6,n.attrs),pe(e,t+10,a),t+=14),e.set(r,t),t+=c,h)for(var p in l){var g=l[p],m=g.length;pe(e,t,+p),pe(e,t+2,m),e.set(g,t+4),t+=4+m}return u&&(e.set(o,t),t+=u),t},ot=function(e,t,n,r,i){pe(e,t,101010256),pe(e,t+8,n),pe(e,t+10,n),pe(e,t+12,r),pe(e,t+16,i)},ct=function(){function e(e){this.filename=e,this.c=q(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){this.ondata||D(5),this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}();t.ZipPassThrough=ct;var lt=function(){function e(e,t){var n=this;t||(t={}),ct.call(this,e),this.d=new xe(t,function(e,t){n.ondata(null,e,t)}),this.compression=8,this.flag=tt(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(e){this.ondata(e,null,t)}},e.prototype.push=function(e,t){ct.prototype.push.call(this,e,t)},e}();t.ZipDeflate=lt;var ut=function(){function e(e,t){var n=this;t||(t={}),ct.call(this,e),this.d=new Ee(t,function(e,t,r){n.ondata(e,t,r)}),this.compression=8,this.flag=tt(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){ct.prototype.push.call(this,e,t)},e}();t.AsyncZipDeflate=ut;var ht=function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var t=this;if(this.ondata||D(5),2&this.d)this.ondata(D(4+8*(1&this.d),0,1),null,!1);else{var n=Qe(e.filename),r=n.length,s=e.comment,a=s&&Qe(s),o=r!=e.filename.length||a&&s.length!=a.length,c=r+st(e.extra)+30;r>65535&&this.ondata(D(11,0,1),null,!1);var l=new i(c);at(l,0,e,n,o,-1);var u=[l],h=function(){for(var e=0,n=u;e<n.length;e++){var r=n[e];t.ondata(null,r,!1)}u=[]},d=this.d;this.d=0;var f=this.u.length,p=K(e,{f:n,u:o,o:a,t:function(){e.terminate&&e.terminate()},r:function(){if(h(),d){var e=t.u[f+1];e?e.r():t.d=1}d=1}}),g=0;e.ondata=function(n,r,s){if(n)t.ondata(n,r,s),t.terminate();else if(g+=r.length,u.push(r),s){var a=new i(16);pe(a,0,134695760),pe(a,4,e.crc),pe(a,8,g),pe(a,12,e.size),u.push(a),p.c=g,p.b=c+g+16,p.crc=e.crc,p.size=e.size,d&&p.r(),d=1}else d&&h()},this.u.push(p)}},e.prototype.end=function(){var e=this;2&this.d?this.ondata(D(4+8*(1&this.d),0,1),null,!0):(this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3)},e.prototype.e=function(){for(var e=0,t=0,n=0,r=0,s=this.u;r<s.length;r++)n+=46+(l=s[r]).f.length+st(l.extra)+(l.o?l.o.length:0);for(var a=new i(n+22),o=0,c=this.u;o<c.length;o++){var l=c[o];at(a,e,l,l.f,l.u,-l.c-2,t,l.o),e+=46+l.f.length+st(l.extra)+(l.o?l.o.length:0),t+=l.b}ot(a,e,this.u.length,n,t),this.ondata(null,a,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++)t[e].t();this.d=2},e}();t.Zip=ht,t.zip=function(e,t,n){n||(n=t,t={}),"function"!=typeof n&&D(7);var r={};We(e,"",r,t);var s=Object.keys(r),a=s.length,o=0,c=0,l=a,u=new Array(a),h=[],d=function(){for(var e=0;e<h.length;++e)h[e]()},f=function(e,t){mt(function(){n(e,t)})};mt(function(){f=n});var p=function(){var e=new i(c+22),t=o,n=c-o;c=0;for(var r=0;r<l;++r){var s=u[r];try{var a=s.c.length;at(e,c,s,s.f,s.u,a);var h=30+s.f.length+st(s.extra),d=c+h;e.set(s.c,d),at(e,o,s,s.f,s.u,a,c,s.m),o+=16+h+(s.m?s.m.length:0),c=d+a}catch(e){return f(e,null)}}ot(e,o,u.length,n,t),f(null,e)};a||p();for(var g=function(e){var t=s[e],n=r[t],i=n[0],l=n[1],g=q(),m=i.length;g.p(i);var y=Qe(t),b=y.length,w=l.comment,v=w&&Qe(w),S=v&&v.length,x=st(l.extra),E=0==l.level?0:8,I=function(n,r){if(n)d(),f(n,null);else{var i=r.length;u[e]=K(l,{size:m,crc:g.d(),c:r,f:y,m:v,u:b!=t.length||v&&w.length!=S,compression:E}),o+=30+b+x+i,c+=76+2*(b+x)+(S||0)+i,--a||p()}};if(b>65535&&I(D(11,0,1),null),E)if(m<16e4)try{I(null,ke(i,l))}catch(e){I(e,null)}else h.push(Ie(i,l,I));else I(null,i)},m=0;m<l;++m)g(m);return d},t.zipSync=function(e,t){t||(t={});var n={},r=[];We(e,"",n,t);var s=0,a=0;for(var o in n){var c=n[o],l=c[0],u=c[1],h=0==u.level?0:8,d=(I=Qe(o)).length,f=u.comment,p=f&&Qe(f),g=p&&p.length,m=st(u.extra);d>65535&&D(11);var y=h?ke(l,u):l,b=y.length,w=q();w.p(l),r.push(K(u,{size:l.length,crc:w.d(),c:y,f:I,m:p,u:d!=o.length||p&&f.length!=g,o:s,compression:h})),s+=30+d+m+b,a+=76+2*(d+m)+(g||0)+b}for(var v=new i(a+22),S=s,x=a-s,E=0;E<r.length;++E){var I=r[E];at(v,I.o,I,I.f,I.u,I.c.length);var k=30+I.f.length+st(I.extra);v.set(I.c,I.o+k),at(v,s,I,I.f,I.u,I.c.length,I.o,I.m),s+=16+k+(I.m?I.m.length:0)}return ot(v,s,r.length,x,S),v};var dt=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}();t.UnzipPassThrough=dt;var ft=function(){function e(){var e=this;this.i=new Te(function(t,n){e.ondata(null,t,n)})}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(e){this.ondata(e,null,t)}},e.compression=8,e}();t.UnzipInflate=ft;var pt=function(){function e(e,t){var n=this;t<32e4?this.i=new Te(function(e,t){n.ondata(null,e,t)}):(this.i=new _e(function(e,t,r){n.ondata(e,t,r)}),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=R(e,0)),this.i.push(e,t)},e.compression=8,e}();t.AsyncUnzipInflate=pt;var gt=function(){function e(e){this.onfile=e,this.k=[],this.o={0:dt},this.p=H}return e.prototype.push=function(e,t){var n=this;if(this.onfile||D(5),this.p||D(4),this.c>0){var r=Math.min(this.c,e.length),s=e.subarray(0,r);if(this.c-=r,this.d?this.d.push(s,!this.c):this.k[0].push(s),(e=e.subarray(r)).length)return this.push(e,t)}else{var a=0,o=0,c=void 0,l=void 0;this.p.length?e.length?((l=new i(this.p.length+e.length)).set(this.p),l.set(e,this.p.length)):l=this.p:l=e;for(var u=l.length,h=this.c,d=h&&this.d,f=function(){var e,t=de(l,o);if(67324752==t){a=1,c=o,p.d=null,p.c=0;var r=he(l,o+6),i=he(l,o+8),s=2048&r,d=8&r,f=he(l,o+26),g=he(l,o+28);if(u>o+30+f+g){var m=[];p.k.unshift(m),a=2;var y,b=de(l,o+18),w=de(l,o+22),v=et(l.subarray(o+30,o+=30+f),!s);4294967295==b?(e=d?[-2]:it(l,o),b=e[0],w=e[1]):d&&(b=-1),o+=g,p.c=b;var S={name:v,compression:i,start:function(){if(S.ondata||D(5),b){var e=n.o[i];e||S.ondata(D(14,"unknown compression type "+i,1),null,!1),(y=b<0?new e(v):new e(v,b,w)).ondata=function(e,t,n){S.ondata(e,t,n)};for(var t=0,r=m;t<r.length;t++){var s=r[t];y.push(s,!1)}n.k[0]==m&&n.c?n.d=y:y.push(H,!0)}else S.ondata(null,H,!0)},terminate:function(){y&&y.terminate&&y.terminate()}};b>=0&&(S.size=b,S.originalSize=w),p.onfile(S)}return"break"}if(h){if(134695760==t)return c=o+=12+(-2==h&&8),a=3,p.c=0,"break";if(33639248==t)return c=o-=4,a=3,p.c=0,"break"}},p=this;o<u-4&&"break"!==f();++o);if(this.p=H,h<0){var g=a?l.subarray(0,c-12-(-2==h&&8)-(134695760==de(l,c-16)&&4)):l.subarray(0,o);d?d.push(g,!!a):this.k[+(2==a)].push(g)}if(2&a)return this.push(l.subarray(o),t);this.p=l.subarray(o)}t&&(this.c&&D(13),this.p=null)},e.prototype.register=function(e){this.o[e.compression]=e},e}();t.Unzip=gt;var mt="function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout?setTimeout:function(e){e()};t.unzip=function(e,t,n){n||(n=t,t={}),"function"!=typeof n&&D(7);var r=[],s=function(){for(var e=0;e<r.length;++e)r[e]()},a={},o=function(e,t){mt(function(){n(e,t)})};mt(function(){o=n});for(var c=e.length-22;101010256!=de(e,c);--c)if(!c||e.length-c>65558)return o(D(13,0,1),null),s;var l=he(e,c+8);if(l){var u=l,h=de(e,c+16),d=4294967295==h||65535==u;if(d){var f=de(e,c-12);(d=101075792==de(e,f))&&(u=l=de(e,f+32),h=de(e,f+48))}for(var p=t&&t.filter,g=function(t){var n=rt(e,h,d),c=n[0],u=n[1],f=n[2],g=n[3],m=n[4],y=n[5],b=nt(e,y);h=m;var w=function(e,t){e?(s(),o(e,null)):(t&&(a[g]=t),--l||o(null,a))};if(!p||p({name:g,size:u,originalSize:f,compression:c}))if(c)if(8==c){var v=e.subarray(b,b+u);if(f<524288||u>.8*f)try{w(null,Ae(v,{out:new i(f)}))}catch(e){w(e,null)}else r.push(Ce(v,{size:f},w))}else w(D(14,"unknown compression type "+c,1),null);else w(null,R(e,b,b+u));else w(null,null)},m=0;m<u;++m)g()}else o(null,{});return s},t.unzipSync=function(e,t){for(var n={},r=e.length-22;101010256!=de(e,r);--r)(!r||e.length-r>65558)&&D(13);var s=he(e,r+8);if(!s)return{};var a=de(e,r+16),o=4294967295==a||65535==s;if(o){var c=de(e,r-12);(o=101075792==de(e,c))&&(s=de(e,c+32),a=de(e,c+48))}for(var l=t&&t.filter,u=0;u<s;++u){var h=rt(e,a,o),d=h[0],f=h[1],p=h[2],g=h[3],m=h[4],y=h[5],b=nt(e,y);a=m,l&&!l({name:g,size:f,originalSize:p,compression:d})||(d?8==d?n[g]=Ae(e.subarray(b,b+f),{out:new i(p)}):D(14,"unknown compression type "+d):n[g]=R(e,b,b+f))}return n}},6:e=>{"use strict";e.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},4716:e=>{"use strict";e.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},6646:e=>{"use strict";e.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},8632:e=>{"use strict";e.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')},183:e=>{"use strict";e.exports={rE:"6.6.1"}},1892:e=>{"use strict";e.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BrsDevice:()=>uh,Environment:()=>ie,Interpreter:()=>RE,Preprocessor:()=>VE,Scope:()=>ne,bscs:()=>zI,executeFile:()=>WI,executeTask:()=>qI,lexParseSync:()=>GE,lexer:()=>p,netlib:()=>d,parser:()=>g,preprocessor:()=>w,stats:()=>GI,stdlib:()=>y,terminateReasons:()=>HI,types:()=>m});var e={};__webpack_require__.r(e),__webpack_require__.d(e,{AALiteral:()=>q,ArrayLiteral:()=>W,AtSignGet:()=>j,Binary:()=>B,Call:()=>U,DottedGet:()=>z,Function:()=>V,Grouping:()=>H,IndexedGet:()=>G,Literal:()=>$,Unary:()=>X,Variable:()=>Y});var t={};__webpack_require__.r(t),__webpack_require__.d(t,{Level:()=>at,alert:()=>ft,configure:()=>Dt,crit:()=>pt,debug:()=>wt,deprecated:()=>vt,emerg:()=>dt,entries:()=>lt,err:()=>gt,fancy:()=>kt,format:()=>_t,info:()=>bt,isEnabled:()=>Mt,levelOf:()=>ct,levels:()=>ot,log:()=>ut,notice:()=>yt,warn:()=>mt});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{COPYFILE_EXCL:()=>$t,COPYFILE_FICLONE:()=>Wt,COPYFILE_FICLONE_FORCE:()=>qt,F_OK:()=>jt,O_APPEND:()=>tn,O_CREAT:()=>Jt,O_DIRECT:()=>ln,O_DIRECTORY:()=>nn,O_DSYNC:()=>on,O_EXCL:()=>Zt,O_NOATIME:()=>rn,O_NOCTTY:()=>Qt,O_NOFOLLOW:()=>sn,O_NONBLOCK:()=>un,O_RDONLY:()=>Xt,O_RDWR:()=>Kt,O_SYMLINK:()=>cn,O_SYNC:()=>an,O_TRUNC:()=>en,O_WRONLY:()=>Yt,R_OK:()=>zt,S_IFBLK:()=>gn,S_IFCHR:()=>yn,S_IFDIR:()=>mn,S_IFIFO:()=>bn,S_IFLNK:()=>fn,S_IFMT:()=>hn,S_IFREG:()=>pn,S_IFSOCK:()=>dn,S_IRGRP:()=>_n,S_IROTH:()=>Rn,S_IRUSR:()=>En,S_IRWXG:()=>Tn,S_IRWXO:()=>Fn,S_IRWXU:()=>xn,S_ISGID:()=>vn,S_ISUID:()=>wn,S_ISVTX:()=>Sn,S_IWGRP:()=>Cn,S_IWOTH:()=>Mn,S_IWUSR:()=>In,S_IXGRP:()=>An,S_IXOTH:()=>Dn,S_IXUSR:()=>kn,UV_FS_O_FILEMAP:()=>On,W_OK:()=>Gt,X_OK:()=>Ht,size_max:()=>Pn});var r={};__webpack_require__.r(r),__webpack_require__.d(r,{basename:()=>Rr,dirname:()=>Fr,extname:()=>Mr,format:()=>Dr,formatExt:()=>Ir,isAbsolute:()=>_r,join:()=>Cr,matchesGlob:()=>Pr,normalize:()=>Tr,normalizeString:()=>Er,parse:()=>Or,relative:()=>Ar,resolve:()=>kr,sep:()=>xr});var i={};__webpack_require__.r(i),__webpack_require__.d(i,{link:()=>ls,mkdir:()=>as,open:()=>is,readdir:()=>os,readlink:()=>ss,rename:()=>cs,resolve:()=>rs});var s={};__webpack_require__.r(s),__webpack_require__.d(s,{FileHandle:()=>ka,access:()=>Ka,appendFile:()=>Pa,chmod:()=>Ha,chown:()=>za,constants:()=>n,copyFile:()=>eo,cp:()=>no,exists:()=>_a,glob:()=>io,lchmod:()=>$a,lchown:()=>Ga,link:()=>Ua,lstat:()=>Aa,lutimes:()=>qa,mkdir:()=>La,mkdtemp:()=>Za,mkdtempDisposable:()=>Qa,open:()=>Ma,opendir:()=>to,readFile:()=>Da,readdir:()=>Ba,readlink:()=>ja,realpath:()=>Xa,rename:()=>Ta,rm:()=>Ja,rmdir:()=>Na,stat:()=>Ca,statfs:()=>ro,symlink:()=>Va,truncate:()=>Fa,unlink:()=>Ra,utimes:()=>Wa,watch:()=>Ya,writeFile:()=>Oa});var a={};__webpack_require__.r(a),__webpack_require__.d(a,{attach:()=>Ko,catchMessages:()=>Zo,decodeMessage:()=>Ho,detach:()=>Jo,encodeMessage:()=>Go,from:()=>jo,fromNode:()=>Uo,fromWeb:()=>Bo,fromWebSocket:()=>Vo,handleRequest:()=>Qo,handleResponse:()=>Yo,isMessage:()=>$o,isPort:()=>Lo,request:()=>Xo});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{BigIntStatsFs:()=>jr,Dir:()=>hs,Dirent:()=>us,ReadStream:()=>Sa,Stats:()=>Br,StatsFs:()=>Vr,WriteStream:()=>xa,access:()=>rl,accessSync:()=>Xs,appendFile:()=>Dc,appendFileSync:()=>Is,chmod:()=>Zc,chmodSync:()=>Gs,chown:()=>Kc,chownSync:()=>js,close:()=>Pc,closeSync:()=>Ts,constants:()=>n,copyFile:()=>dl,copyFileSync:()=>Zs,cp:()=>ml,cpSync:()=>na,createReadStream:()=>cl,createWriteStream:()=>ll,exists:()=>kc,existsSync:()=>gs,fchmod:()=>zc,fchmodSync:()=>Ds,fchown:()=>jc,fchownSync:()=>Ms,fdatasync:()=>Bc,fdatasyncSync:()=>As,fstat:()=>Oc,fstatSync:()=>ks,fsync:()=>Lc,fsyncSync:()=>Cs,ftruncate:()=>Nc,ftruncateSync:()=>_s,futimes:()=>Gc,futimesSync:()=>Os,glob:()=>wl,globSync:()=>ia,lchmod:()=>Qc,lchmodSync:()=>Hs,lchown:()=>Jc,lchownSync:()=>zs,link:()=>qc,linkSync:()=>Bs,lopenSync:()=>Ss,lstat:()=>_c,lstatSync:()=>ys,lutimes:()=>tl,lutimesSync:()=>Ws,mkdir:()=>$c,mkdirSync:()=>Ns,mkdtemp:()=>hl,mkdtempDisposableSync:()=>Js,mkdtempSync:()=>Ks,open:()=>Fc,openAsBlob:()=>bl,openSync:()=>vs,opendir:()=>gl,opendirSync:()=>ta,promises:()=>s,read:()=>Vc,readFile:()=>Rc,readFileSync:()=>xs,readSync:()=>Rs,readdir:()=>Wc,readdirSync:()=>Ls,readlink:()=>Yc,readlinkSync:()=>Vs,readv:()=>fl,readvSync:()=>Qs,realpath:()=>nl,realpathSync:()=>qs,rename:()=>Ic,renameSync:()=>ps,rm:()=>ul,rmSync:()=>Ys,rmdir:()=>Hc,rmdirSync:()=>Ps,stat:()=>Tc,statSync:()=>ms,statfs:()=>yl,statfsSync:()=>ra,symlink:()=>Xc,symlinkSync:()=>Us,truncate:()=>Cc,truncateSync:()=>bs,unlink:()=>Ac,unlinkSync:()=>ws,unwatchFile:()=>al,utimes:()=>el,utimesSync:()=>$s,watch:()=>ol,watchFile:()=>sl,write:()=>Uc,writeFile:()=>Mc,writeFileSync:()=>Es,writeSync:()=>Fs,writev:()=>pl,writevSync:()=>ea});var c={};__webpack_require__.r(c),__webpack_require__.d(c,{get:()=>xl,getSync:()=>El,list:()=>Cl,listSync:()=>Al,remove:()=>Tl,removeSync:()=>_l,set:()=>Il,setSync:()=>kl});var l={};__webpack_require__.r(l),__webpack_require__.d(l,{BigIntStatsFs:()=>jr,Dir:()=>hs,Dirent:()=>us,IOC:()=>$l,IOC32:()=>Wl,ReadStream:()=>Sa,Stats:()=>Br,StatsFs:()=>Vr,WriteStream:()=>xa,access:()=>rl,accessSync:()=>Xs,appendFile:()=>Dc,appendFileSync:()=>Is,chmod:()=>Zc,chmodSync:()=>Gs,chown:()=>Kc,chownSync:()=>js,chroot:()=>ns,close:()=>Pc,closeSync:()=>Ts,constants:()=>n,copyFile:()=>dl,copyFileSync:()=>Zs,cp:()=>ml,cpSync:()=>na,createReadStream:()=>cl,createWriteStream:()=>ll,exists:()=>kc,existsSync:()=>gs,fchmod:()=>zc,fchmodSync:()=>Ds,fchown:()=>jc,fchownSync:()=>Ms,fdatasync:()=>Bc,fdatasyncSync:()=>As,fstat:()=>Oc,fstatSync:()=>ks,fsync:()=>Lc,fsyncSync:()=>Cs,ftruncate:()=>Nc,ftruncateSync:()=>_s,futimes:()=>Gc,futimesSync:()=>Os,glob:()=>wl,globSync:()=>ia,ioctl:()=>ql,ioctlSync:()=>Xl,lchmod:()=>Qc,lchmodSync:()=>Hs,lchown:()=>Jc,lchownSync:()=>zs,link:()=>qc,linkSync:()=>Bs,lopenSync:()=>Ss,lstat:()=>_c,lstatSync:()=>ys,lutimes:()=>tl,lutimesSync:()=>Ws,mkdir:()=>$c,mkdirSync:()=>Ns,mkdtemp:()=>hl,mkdtempDisposableSync:()=>Js,mkdtempSync:()=>Ks,mount:()=>Zi,open:()=>Fc,openAsBlob:()=>bl,openSync:()=>vs,opendir:()=>gl,opendirSync:()=>ta,promises:()=>s,read:()=>Vc,readFile:()=>Rc,readFileSync:()=>xs,readSync:()=>Rs,readdir:()=>Wc,readdirSync:()=>Ls,readlink:()=>Yc,readlinkSync:()=>Vs,readv:()=>fl,readvSync:()=>Qs,realpath:()=>nl,realpathSync:()=>qs,rename:()=>Ic,renameSync:()=>ps,rm:()=>ul,rmSync:()=>Ys,rmdir:()=>Hc,rmdirSync:()=>Ps,stat:()=>Tc,statSync:()=>ms,statfs:()=>yl,statfsSync:()=>ra,symlink:()=>Xc,symlinkSync:()=>Us,truncate:()=>Cc,truncateSync:()=>bs,umount:()=>Qi,unlink:()=>Ac,unlinkSync:()=>ws,unwatchFile:()=>al,utimes:()=>el,utimesSync:()=>$s,watch:()=>ol,watchFile:()=>sl,write:()=>Uc,writeFile:()=>Mc,writeFileSync:()=>Es,writeSync:()=>Fs,writev:()=>pl,writevSync:()=>ea,xattr:()=>c});var u={};__webpack_require__.r(u),__webpack_require__.d(u,{DirType:()=>Ni,Dirent:()=>Ui,Handle:()=>Vi,IOC:()=>$l,IOC32:()=>Wl,chroot:()=>ns,deleteFD:()=>Gi,dtToIf:()=>Bi,fromFD:()=>zi,ifToDt:()=>Li,ioctl:()=>ql,ioctlSync:()=>Xl,link:()=>ma,mkdir:()=>fa,mount:()=>Zi,open:()=>ha,readdir:()=>pa,readlink:()=>da,rename:()=>ga,resolve:()=>ua,sync:()=>i,toFD:()=>ji,umount:()=>Qi,xattr:()=>c});var h={};__webpack_require__.r(h),__webpack_require__.d(h,{Async:()=>tc,AsyncMapTransaction:()=>xi,AsyncTransaction:()=>mi,Attributes:()=>qr,BigIntStatsFs:()=>jr,CopyOnWrite:()=>So,CopyOnWriteFS:()=>vo,DeviceFS:()=>Ti,Dir:()=>hs,Dirent:()=>us,ErrnoError:()=>qi,Fetch:()=>Ro,FetchFS:()=>Ao,FileSystem:()=>di,IOC:()=>$l,IOC32:()=>Wl,InMemory:()=>ki,InMemoryStore:()=>Ei,Index:()=>ui,IndexFS:()=>_o,Inode:()=>Qr,InodeFlags:()=>Kr,Journal:()=>wo,MetadataBlock:()=>gc,MutexLock:()=>Pl,Mutexed:()=>Ll,Passthrough:()=>No,PassthroughFS:()=>Oo,Port:()=>sc,PortFS:()=>nc,RPC:()=>a,ReadStream:()=>Sa,Readonly:()=>Bl,SingleBuffer:()=>xc,SingleBufferStore:()=>vc,Stats:()=>Br,StatsFs:()=>Vr,StoreFS:()=>vi,SuperBlock:()=>yc,Sync:()=>Ul,SyncMapTransaction:()=>Si,SyncTransaction:()=>gi,Transaction:()=>pi,WrappedTransaction:()=>yi,WriteStream:()=>xa,_MutexedFS:()=>Nl,_asyncFSKeys:()=>ec,_chown:()=>ci,_fnOpt:()=>Pt,_inode_fields:()=>Xr,_inode_version:()=>Yr,_tempDirName:()=>Sr,access:()=>rl,accessSync:()=>Xs,addDevice:()=>uo,appendFile:()=>Dc,appendFileSync:()=>Is,attachFS:()=>rc,bindContext:()=>Ml,boundContexts:()=>Rl,checkOptions:()=>Nt,chmod:()=>Zc,chmodSync:()=>Gs,chown:()=>Kc,chownSync:()=>js,chroot:()=>ns,close:()=>Pc,closeSync:()=>Ts,configure:()=>fo,configureFileSystem:()=>so,configureSingle:()=>co,constants:()=>n,copyFile:()=>dl,copyFileSync:()=>Zs,cp:()=>ml,cpSync:()=>na,createCredentials:()=>Bt,createReadStream:()=>cl,createWriteStream:()=>ll,credentialsAllowRoot:()=>Ut,decodeDirListing:()=>fr,default:()=>Yl,defaultContext:()=>Vt,detachFS:()=>ic,devices:()=>Di,encodeDirListing:()=>pr,exists:()=>kc,existsSync:()=>gs,fchmod:()=>zc,fchmodSync:()=>Ds,fchown:()=>jc,fchownSync:()=>Ms,fdatasync:()=>Bc,fdatasyncSync:()=>As,fs:()=>l,fstat:()=>Oc,fstatSync:()=>ks,fsync:()=>Lc,fsyncSync:()=>Cs,ftruncate:()=>Nc,ftruncateSync:()=>_s,fullDevice:()=>Fi,futimes:()=>Gc,futimesSync:()=>Os,glob:()=>wl,globSync:()=>ia,globToRegex:()=>wr,hasAccess:()=>oi,ioctl:()=>ql,ioctlSync:()=>Xl,isBackend:()=>Ot,isBackendConfig:()=>Lt,isBlockDevice:()=>ii,isCharacterDevice:()=>si,isDirectory:()=>ti,isFIFO:()=>ai,isFile:()=>ei,isSocket:()=>ri,isSymbolicLink:()=>ni,lchmod:()=>Qc,lchmodSync:()=>Hs,lchown:()=>Jc,lchownSync:()=>zs,link:()=>qc,linkSync:()=>Bs,log:()=>t,lopenSync:()=>Ss,lstat:()=>_c,lstatSync:()=>ys,lutimes:()=>tl,lutimesSync:()=>Ws,mkdir:()=>$c,mkdirSync:()=>Ns,mkdtemp:()=>hl,mkdtempDisposableSync:()=>Js,mkdtempSync:()=>Ks,mount:()=>Zi,mounts:()=>Ji,normalizeMode:()=>gr,normalizeOptions:()=>br,normalizePath:()=>yr,normalizeTime:()=>mr,nullDevice:()=>Ci,open:()=>Fc,openAsBlob:()=>bl,openSync:()=>vs,opendir:()=>gl,opendirSync:()=>ta,promises:()=>s,randomDevice:()=>Ri,read:()=>Vc,readFile:()=>Rc,readFileSync:()=>xs,readSync:()=>Rs,readdir:()=>Wc,readdirSync:()=>Ls,readlink:()=>Yc,readlinkSync:()=>Vs,readv:()=>fl,readvSync:()=>Qs,realpath:()=>nl,realpathSync:()=>qs,rename:()=>Ic,renameSync:()=>ps,resolveMountConfig:()=>oo,resolveRemoteMount:()=>ac,rm:()=>ul,rmSync:()=>Ys,rmdir:()=>Hc,rmdirSync:()=>Ps,rootIno:()=>Hr,stat:()=>Tc,statSync:()=>ms,statfs:()=>yl,statfsSync:()=>ra,symlink:()=>Xc,symlinkSync:()=>Us,sync:()=>po,truncate:()=>Cc,truncateSync:()=>bs,umount:()=>Qi,unlink:()=>Ac,unlinkSync:()=>ws,unwatchFile:()=>al,userModifiableFlags:()=>Zr,userVisibleFlags:()=>Jr,utimes:()=>el,utimesSync:()=>$s,version:()=>li,vfs:()=>u,waitOnline:()=>vr,watch:()=>ol,watchFile:()=>sl,withExceptionContext:()=>Ki,withPath:()=>Xi,wrap:()=>Yi,write:()=>Uc,writeFile:()=>Mc,writeFileSync:()=>Es,writeSync:()=>Fs,writev:()=>pl,writevSync:()=>ea,xattr:()=>c,zeroDevice:()=>Ai});var d={};__webpack_require__.r(d),__webpack_require__.d(d,{download:()=>wd,getExternalIp:()=>vd,getHost:()=>kd,isValidHostname:()=>Id,isValidIP:()=>Ed,resolveHostToIP:()=>xd});var f={};__webpack_require__.r(f),__webpack_require__.d(f,{Assignment:()=>Wd,Block:()=>Xd,BlockEnd:()=>Ud,ContinueFor:()=>Kd,ContinueForReason:()=>Vd,ContinueWhile:()=>Jd,ContinueWhileReason:()=>zd,Dim:()=>qd,DottedSet:()=>ff,End:()=>cf,ExitFor:()=>Zd,ExitForReason:()=>jd,ExitWhile:()=>Qd,ExitWhileReason:()=>Gd,Expression:()=>Yd,For:()=>uf,ForEach:()=>hf,Function:()=>ef,Goto:()=>sf,GotoLabel:()=>Hd,If:()=>tf,Increment:()=>nf,IndexedSet:()=>pf,Label:()=>af,Library:()=>gf,Print:()=>rf,Return:()=>of,ReturnValue:()=>$d,Stop:()=>lf,Throw:()=>yf,TryCatch:()=>mf,While:()=>df});var p={};__webpack_require__.r(p),__webpack_require__.d(p,{GlobalFunctions:()=>kf,KeyWords:()=>xf,Lexeme:()=>wf,Lexer:()=>Ff,Location:()=>Ef,ReservedWords:()=>Sf,isToken:()=>If});var g={};__webpack_require__.r(g),__webpack_require__.d(g,{Expr:()=>e,ParseError:()=>Rf,Parser:()=>Lf,Stmt:()=>f});var m={};__webpack_require__.r(m),__webpack_require__.d(m,{ArrayGrid:()=>yS,Audio:()=>IS,BrsBoolean:()=>D,BrsComponent:()=>L,BrsInterface:()=>N,BrsInvalid:()=>O,BrsObjects:()=>Jv,BrsString:()=>M,BusySpinner:()=>BS,Button:()=>RS,ButtonGroup:()=>MS,Callable:()=>Ch,ChannelStore:()=>VS,CheckList:()=>AS,ContentNode:()=>Zv,Dialog:()=>gS,Double:()=>mh,Float:()=>bh,Font:()=>fS,Group:()=>tS,Int32:()=>vh,Int64:()=>ph,Keyboard:()=>sS,KeyboardDialog:()=>mS,Label:()=>hS,LabelList:()=>CS,LayoutGroup:()=>cS,MarkupGrid:()=>vS,MarkupList:()=>SS,MiniKeyboard:()=>aS,MismatchReason:()=>Th,Node:()=>Bf,NumberKinds:()=>zS,Overhang:()=>xS,Panel:()=>lS,Poster:()=>pS,PrimitiveKinds:()=>HS,RSGPalette:()=>US,RadioButtonList:()=>FS,Rectangle:()=>uS,RequestState:()=>Ew,RoAppInfo:()=>Ev,RoAppManager:()=>Xf,RoAppMemoryMonitor:()=>lp,RoArray:()=>Kh,RoAssociativeArray:()=>Fh,RoAudioMetadata:()=>sv,RoAudioPlayer:()=>av,RoAudioPlayerEvent:()=>Fd,RoAudioResource:()=>yv,RoBitmap:()=>Vb,RoBoolean:()=>bd,RoByteArray:()=>gd,RoChannelStore:()=>cp,RoChannelStoreEvent:()=>Dd,RoCompositor:()=>$b,RoDateTime:()=>up,RoDeviceCrypto:()=>ip,RoDeviceInfo:()=>Fv,RoDeviceInfoEvent:()=>Od,RoDouble:()=>gh,RoEVPCipher:()=>Zf,RoEVPDigest:()=>ep,RoFileSystem:()=>Ov,RoFloat:()=>yh,RoFont:()=>yp,RoFontRegistry:()=>gw,RoFunction:()=>Rh,RoHMAC:()=>np,RoHttpAgent:()=>mv,RoImageMetadata:()=>tv,RoInput:()=>gp,RoInputEvent:()=>Ad,RoInt:()=>wh,RoInvalid:()=>Pv,RoList:()=>td,RoLocalization:()=>wv,RoLongInteger:()=>fh,RoMessagePort:()=>pp,RoPath:()=>yd,RoRegex:()=>fp,RoRegion:()=>zb,RoRegistry:()=>Sv,RoRegistrySection:()=>xv,RoRemoteInfo:()=>Rv,RoSGNode:()=>Wh,RoSGNodeEvent:()=>Ld,RoSGScreen:()=>Kv,RoSGScreenEvent:()=>Bd,RoScreen:()=>yw,RoSocketAddress:()=>Bv,RoSprite:()=>Hb,RoString:()=>md,RoSystemLog:()=>mp,RoSystemLogEvent:()=>Cd,RoTextureManager:()=>Sw,RoTextureRequest:()=>kw,RoTimespan:()=>qf,RoURLEvent:()=>Td,RoURLTransfer:()=>gv,RoUniversalControlEvent:()=>_d,RoUtils:()=>Xv,RoVideoPlayer:()=>ov,RoVideoPlayerEvent:()=>Rd,RoXMLElement:()=>fv,RoXMLList:()=>cv,RowList:()=>bS,SGNodeFactory:()=>Dh,SGNodeType:()=>_h,SGRoot:()=>Qv,Scene:()=>nS,ScrollingLabel:()=>dS,SoundEffect:()=>kS,StandardDialog:()=>DS,StandardProgressDialog:()=>OS,StdDlgContentArea:()=>PS,StdDlgProgressItem:()=>LS,StdDlgTitleArea:()=>NS,StdlibArgument:()=>kh,Task:()=>Vf,TextEditBox:()=>oS,Timer:()=>ES,TrickPlayBar:()=>TS,Uninitialized:()=>P,ValidDateFormats:()=>tx,ValueKind:()=>T,Video:()=>_S,ZoomRowList:()=>wS,brsValueOf:()=>rx,compareVersions:()=>Yf,createAudioResource:()=>bv,createBitmap:()=>jb,createNodeByType:()=>Oh,createRegion:()=>Gb,createSceneByType:()=>Ph,createScreen:()=>bw,customNodeExists:()=>Nh,fromAssociativeArray:()=>sx,fromContentNode:()=>ox,fromSGNode:()=>lx,getBrsValueFromFieldType:()=>F,getFloatingPointPrecision:()=>hx,getFontRegistry:()=>mw,getNodeType:()=>$h,getTextureManager:()=>xw,getValueKindFromFieldType:()=>A,initializeNode:()=>Lh,initializeTask:()=>Bh,isAnyNumber:()=>ZS,isBoxable:()=>se,isBoxedNumber:()=>JS,isBrsBoolean:()=>WS,isBrsCallable:()=>qS,isBrsEvent:()=>QS,isBrsNumber:()=>jS,isBrsString:()=>$S,isBrsType:()=>ex,isComparable:()=>R,isInvalid:()=>ux,isIterable:()=>XS,isNumberComp:()=>YS,isNumberKind:()=>GS,isSGNodeType:()=>Mh,isStringComp:()=>KS,isSubtypeCheck:()=>Hh,isUnboxable:()=>ae,jsValueOf:()=>cx,sgRoot:()=>eS,subtypeHierarchy:()=>Gh,toAssociativeArray:()=>nx,toContentNode:()=>ax,toSGNode:()=>ix,tryCoerce:()=>Sh});var y={};__webpack_require__.r(y),__webpack_require__.d(y,{Abs:()=>Mx,Asc:()=>tE,Atn:()=>jx,Box:()=>mE,Cdbl:()=>Dx,Chr:()=>nE,Cint:()=>Ox,CopyFile:()=>bx,Cos:()=>zx,CreateDirectory:()=>xx,CreateObject:()=>yx,Csng:()=>Px,DeleteDirectory:()=>Sx,DeleteFile:()=>vx,Exp:()=>$x,FindMemberFunction:()=>gx,Fix:()=>Nx,FormatDrive:()=>Ex,FormatJson:()=>Fx,GetGlobalAA:()=>bE,GetInterface:()=>px,Instr:()=>sE,Int:()=>Lx,LCase:()=>eE,Left:()=>rE,Len:()=>aE,ListDir:()=>Ix,Log:()=>Wx,MatchFiles:()=>_x,Mid:()=>oE,MoveFile:()=>wx,ObjFun:()=>mx,ParseJson:()=>Rx,Pos:()=>Kx,ReadAsciiFile:()=>kx,RebootSystem:()=>dx,Right:()=>iE,Rnd:()=>Xx,Run:()=>Zx,RunGarbageCollector:()=>fx,STRING:()=>uE,Sgn:()=>Vx,Sin:()=>Gx,Sleep:()=>wE,Sqr:()=>qx,Str:()=>cE,StrI:()=>lE,StrToI:()=>pE,StringI:()=>hE,Substitute:()=>dE,Tab:()=>Yx,Tan:()=>Hx,Tr:()=>SE,Type:()=>gE,UCase:()=>Qx,UpTime:()=>yE,Val:()=>fE,Wait:()=>vE,WriteAsciiFile:()=>Tx});var b={};__webpack_require__.r(b),__webpack_require__.d(b,{BrightScript:()=>PE,Declaration:()=>NE,Error:()=>BE,If:()=>LE});var w={};__webpack_require__.r(w),__webpack_require__.d(w,{Chunk:()=>b,Parser:()=>UE,Preprocessor:()=>jE,getBsConst:()=>zE});var v=__webpack_require__(46);function S(e){return Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.width)&&Number.isFinite(e.height)}function x(e,t,n){const r=void 0!==n?n[0]:0,i=void 0!==n?n[1]:0,s=Math.cos(-t),a=Math.sin(-t),o=[{x:-r,y:-i},{x:e.width-r,y:-i},{x:e.width-r,y:e.height-i},{x:-r,y:e.height-i}].map(e=>({x:e.x*s-e.y*a,y:e.x*a+e.y*s})),c=Math.min(...o.map(e=>e.x)),l=Math.max(...o.map(e=>e.x)),u=Math.min(...o.map(e=>e.y)),h=Math.max(...o.map(e=>e.y));return{x:e.x+c+r,y:e.y+u+i,width:l-c,height:h-u}}function E(e,t){const n=Math.cos(-t),r=Math.sin(-t);return[e[0]*n-e[1]*r,e[0]*r+e[1]*n]}function I(e,t){if(!S(e))return{...t};if(!S(t))return{...e};const n=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return{x:n,y:r,width:Math.max(e.x+e.width,t.x+t.width)-n,height:Math.max(e.y+e.height,t.y+t.height)-r}}function k(e){let t=-1;return e.length&&(6===(e=(e=(e=e.startsWith("#")?e.slice(1):e).startsWith("0x")?e.slice(2):e).padStart(6,"0")).length&&(e+="FF"),t=Number.parseInt(e,16),t=Number.isNaN(t)?-1:0|t),t}var T,_=__webpack_require__(2507),C=__webpack_require__.n(_);function A(e){switch(e.toLowerCase()){case"bool":case"boolean":return T.Boolean;case"color":case"int":case"integer":return T.Int32;case"longinteger":return T.Int64;case"float":return T.Float;case"time":case"double":return T.Double;case"uri":case"str":case"string":return T.String;case"function":return T.Callable;case"node":case"font":case"roarray":case"array":case"roassociativearray":case"assocarray":case"rect2d":case"vector2d":case"floatarray":case"intarray":case"boolarray":case"stringarray":case"vector2darray":case"rect2darray":case"colorarray":case"timearray":case"nodearray":return T.Object;default:return T.Invalid}}function F(e,t){let n;switch(e.toLowerCase()){case"bool":case"boolean":n=t?D.from("true"===t.toLowerCase()):D.False;break;case"int":case"integer":n=new vh(t?Number.parseInt(t):0);break;case"longinteger":n=new ph(t?C().fromString(t):0);break;case"float":n=new bh(t?Number.parseFloat(t):0);break;case"time":case"double":n=new mh(t?Number.parseFloat(t):0);break;case"node":n=new Pv;break;case"font":n=new fS,n instanceof fS&&t?.startsWith("font:")&&!n.setSystemFont(t.slice(5).toLowerCase())&&(n=O.Instance);break;case"roarray":case"array":case"vector2d":case"rect2d":case"boolarray":case"floatarray":case"intarray":case"timearray":n=function(e){if(!e?.trim().startsWith("[")||!e?.trim().endsWith("]"))return O.Instance;try{const t=JSON.parse(e);return Array.isArray(t)?new Kh(t.map(e=>rx(e))):O.Instance}catch{return O.Instance}}(t??"");break;case"roassociativearray":case"assocarray":case"object":n=O.Instance;break;case"uri":case"str":case"string":n=new M(t??"");break;case"color":n=new vh(-1),t?.length&&(n=new vh(k(t)));break;default:n=P.Instance}return n}function R(e){return"lessThan"in e&&"greaterThan"in e&&"getValue"in e}!function(e){e[e.Interface=0]="Interface",e[e.Invalid=1]="Invalid",e[e.Boolean=2]="Boolean",e[e.String=3]="String",e[e.Int32=4]="Int32",e[e.Int64=5]="Int64",e[e.Float=6]="Float",e[e.Double=7]="Double",e[e.Callable=8]="Callable",e[e.Uninitialized=9]="Uninitialized",e[e.Dynamic=10]="Dynamic",e[e.Void=11]="Void",e[e.Object=12]="Object"}(T||(T={})),function(e){e.toString=function(t,n=!1){switch(t){case e.Interface:return"Interface";case e.Invalid:return n?"roInvalid":"Invalid";case e.Boolean:return n?"roBoolean":"Boolean";case e.String:return n?"roString":"String";case e.Int32:return n?"roInteger":"Integer";case e.Int64:return"LongInteger";case e.Float:return n?"roFloat":"Float";case e.Double:return n?"roFloat":"Double";case e.Callable:return"Function";case e.Dynamic:return"Dynamic";case e.Void:return"Void";case e.Uninitialized:return"<uninitialized>";case e.Object:return"Object"}},e.fromString=function(t){switch(t.toLowerCase()){case"interface":return e.Interface;case"invalid":return e.Invalid;case"boolean":return e.Boolean;case"string":return e.String;case"integer":return e.Int32;case"longinteger":return e.Int64;case"float":return e.Float;case"double":return e.Double;case"function":return e.Callable;case"dynamic":return e.Dynamic;case"void":return e.Void;case"<uninitialized>":return e.Uninitialized;case"object":return e.Object;default:return}}}(T||(T={}));class M{value;inArray;kind=T.String;constructor(e,t=!1){this.value=e,this.inArray=t}lessThan(e){return KS(e)?D.from(this.value<e.getValue()):D.False}greaterThan(e){return KS(e)?D.from(this.value>e.getValue()):D.False}equalTo(e){return KS(e)?D.from(this.value===e.getValue()):D.False}getValue(){return this.value}toString(e){return e?`"${this.value}"`:this.value}concat(e){return KS(e)?new M(this.value+e.getValue()):new M(this.value+e.toString())}box(){return new md(this)}}class D{value;inArray;kind=T.Boolean;constructor(e,t=!1){this.value=e,this.inArray=t}toBoolean(){return this.value}static False=new D(!1);static True=new D(!0);static from(e){return e?D.True:D.False}lessThan(e){return D.False}greaterThan(e){return D.False}equalTo(e){return e.kind===T.Boolean||jS(e)?D.from(this.toBoolean()===e.toBoolean()):D.False}getValue(){return this.value}toString(e){return this.value.toString()}box(){return new bd(this)}and(e){return e.kind!==T.Boolean?D.from(this.value&&e.toBoolean()):D.from(this.value&&e.value)}or(e){return e.kind!==T.Boolean?D.from(this.value||e.toBoolean()):D.from(this.value||e.value)}not(){return D.from(!this.value)}}class O{kind=T.Invalid;inArray=!1;static Instance=new O;lessThan(e){return D.False}greaterThan(e){return D.False}equalTo(e){return e.kind===T.Invalid||e instanceof Pv?D.True:D.False}getValue(){return O.Instance}toString(e){return"invalid"}box(){return new Pv}}class P{kind=T.Uninitialized;static Instance=new P;lessThan(e){return D.False}greaterThan(e){return D.False}getValue(){}equalTo(e){return e.kind===T.String?D.from(e.value===this.toString().toLowerCase()):D.False}toString(e){return"<UNINITIALIZED>"}}class N{name;kind=T.Interface;methodNames;constructor(e,t){this.name=e,this.methodNames=new Set(Array.from(t).map(e=>e.toLowerCase()))}getInterfaceName(){return this.name}hasMethod(e){return this.methodNames.has(e.toLowerCase())}toString(){return`<Interface: ${this.name}>`}equalTo(e){return D.False}}class L{methods=new Map;componentName;filter="";references;returnFlag;interfaces=new Map;constructor(e){this.componentName=e,this.references=0,this.returnFlag=!1}getComponentName(){return this.componentName}hasInterface(e){return this.interfaces.has(e.toLowerCase())}setFilter(e){this.filter=e.toLowerCase()}registerMethods(e){for(const[t,n]of Object.entries(e)){const e=new Set(n.filter(e=>e.name?.toLowerCase()).map(e=>e.name?.toLowerCase()));this.interfaces.set(t.toLowerCase(),new N(t,e)),this.appendMethods(n)}}appendMethods(e){for(const t of e)this.methods.set((t.name||"").toLowerCase(),t)}getMethod(e){const t=e.toLowerCase();if(""!==this.filter){const e=this.interfaces.get(this.filter);return this.filter="",e?.hasMethod(t)?this.methods.get(t):void 0}return this.methods.get(t)}getReferenceCount(){return this.references}setReturn(e){this.returnFlag=e}addReference(){if(this.references++,1===this.references){const e=zI.get(this.componentName)??0;zI.set(this.componentName,e+1)}}removeReference(){if(this.references--,0===this.references&&!this.returnFlag){const e=zI.get(this.componentName);e&&zI.set(this.componentName,e-1),this.dispose()}return this.references}dispose(){}}class B{left;token;right;constructor(e,t,n){this.left=e,this.token=t,this.right=n}accept(e){return e.visitBinary(this)}get location(){return{file:this.token.location.file,start:this.left.location.start,end:this.right.location.end}}}class U{callee;closingParen;args;optional;static MaximumArguments=32;constructor(e,t,n,r=!1){this.callee=e,this.closingParen=t,this.args=n,this.optional=r}accept(e){return e.visitCall(this)}get location(){return{file:this.closingParen.location.file,start:this.callee.location.start,end:this.closingParen.location.end}}}class V{parameters;returns;body;keyword;end;constructor(e,t,n,r,i){this.parameters=e,this.returns=t,this.body=n,this.keyword=r,this.end=i}accept(e){return e.visitAnonymousFunction(this)}get location(){return{file:this.keyword.location.file,start:this.keyword.location.start,end:this.end.location.end}}}class j{obj;name;optional;constructor(e,t,n=!1){this.obj=e,this.name=t,this.optional=n}accept(e){return e.visitAtSignGet(this)}get location(){return{file:this.obj.location.file,start:this.obj.location.start,end:this.name.location.end}}}class z{obj;name;optional;constructor(e,t,n=!1){this.obj=e,this.name=t,this.optional=n}accept(e){return e.visitDottedGet(this)}get location(){return{file:this.obj.location.file,start:this.obj.location.start,end:this.name.location.end}}}class G{obj;indexes;closingSquare;optional;constructor(e,t,n,r=!1){this.obj=e,this.indexes=t,this.closingSquare=n,this.optional=r}accept(e){return e.visitIndexedGet(this)}get location(){return{file:this.obj.location.file,start:this.obj.location.start,end:this.closingSquare.location.end}}}class H{tokens;expression;constructor(e,t){this.tokens=e,this.expression=t}accept(e){return e.visitGrouping(this)}get location(){return{file:this.tokens.left.location.file,start:this.tokens.left.location.start,end:this.tokens.right.location.end}}}class ${value;_location;constructor(e,t){this.value=e,this._location=t}accept(e){return e.visitLiteral(this)}get location(){return this._location??{file:"(internal)",start:{line:-1,column:-1},end:{line:-1,column:-1}}}}class W{elements;open;close;constructor(e,t,n){this.elements=e,this.open=t,this.close=n}accept(e){return e.visitArrayLiteral(this)}get location(){return{file:this.open.location.file,start:this.open.location.start,end:this.close.location.end}}}class q{elements;open;close;constructor(e,t,n){this.elements=e,this.open=t,this.close=n}accept(e){return e.visitAALiteral(this)}get location(){return{file:this.open.location.file,start:this.open.location.start,end:this.close.location.end}}}class X{operator;right;constructor(e,t){this.operator=e,this.right=t}accept(e){return e.visitUnary(this)}get location(){return{file:this.operator.location.file,start:this.operator.location.start,end:this.right.location.end}}}class Y{name;constructor(e){this.name=e}accept(e){return e.visitVariable(this)}get location(){return this.name.location}}class K extends Error{location;backTrace;constructor(e,t,n){super(e),this.location=t,this.backTrace=n}format(){return K.format(this.message,this.location)}static format(e,t){let n;if(t.start.line===t.end.line){let e=`${t.start.column}`;t.start.column!==t.end.column&&(e+=`-${t.end.column}`),n=`${t.file}(${t.start.line},${e})`}else n=`${t.file}(${t.start.line},${t.start.column},${t.end.line},${t.end.line})`;return`${n}: ${e}`}}class J extends K{errorDetail;backTrace;extraFields;constructor(e,t,n,r){super(e.message,t,n),this.errorDetail=e,this.backTrace=n,this.extraFields=r}}const Z={NextWithoutFor:{errno:0,message:"Next Without For."},BadSyntax:{message:"Syntax Error.",errno:2},ReturnedWithoutGosub:{message:"Return Without Gosub.",errno:4},OutOfData:{message:"Out of Data on READ.",errno:6},BadFunctionOrArrayParam:{message:"Invalid parameter passed to function/array (e.g neg matrix dim or sqr root).",errno:8},OutOfMemory:{message:"Out Of Memory.",errno:12},MissingLineNumber:{message:"Label/Line Not Found.",errno:14},IndexOutOfBounds:{message:"Array subscript out of bounds.",errno:16},RedimensionArray:{message:"Attempted to redimension an array.",errno:18},DivideByZero:{message:"Divide by Zero.",errno:20},TypeMismatch:{message:"Type Mismatch.",errno:24},OutOfMemoryStringOp:{message:"Out of Memory when doing string operation.",errno:26},StringTooLong:{message:"String Too Long.",errno:28},BadBitShift:{message:"Invalid Bitwise Shift.",errno:30},NoContinue:{message:"Continue Not Allowed.",errno:32},OutOfRange:{message:"Constant Out Of Range",errno:34},ExecutionTimeout:{message:"Execution timeout",errno:35},InvalidFormatSpecifier:{message:"Invalid Format Specifier",errno:36},MalformedThrow:{message:"Invalid argument to Throw",errno:38},UserDefined:{message:"User-specified exception",errno:40},TooManyTasks:{message:"Too many task threads",errno:41},RunNotSupported:{message:"run() is unsupported.",errno:140},ContinueForWithoutFor:{message:"Continue For is not inside a For loop",errno:141},ContinueWhileWithoutWhile:{message:"Continue While is not inside a While",errno:142},TryContainsLabel:{message:"Labels are illegal inside a TRY clause.",errno:143},EvalDisabled:{message:"eval() is deprecated. You must eliminate usage of eval().",errno:144},FunctionNotFound:{message:"Function is not defined in component's namespace",errno:145},NameShadowsBuiltin:{message:"Syntax Error. Builtin function call expected.",errno:157},VarShadowsFunctionName:{message:"Variable name cannot be the same as that of a declared function.",errno:160},LabelLimitExceeded:{message:"Too Many Labels. Internal Label table size exceeded.",errno:161},ClassNotFound:{message:"Class Not Found.",errno:162},InterfaceTooLarge:{message:"Interface has too many functions for bytecode.",errno:163},NoInitializer:{message:"Assignment initializer missing.",errno:164},ExitForWithoutFor:{message:"Exit For is not inside a For loop.",errno:165},Deprecated:{message:"Statement type no longer supported.",errno:166},BadType:{message:"Type is Invalid.",errno:167},MissingReturnType:{message:"Function must have a return type.",errno:168},ReturnWithoutValue:{message:"Return must return a value.",errno:169},ReturnWithValue:{message:"Return can not have a return-value if inside a Sub or Function with Void return type.",errno:170},TypeMismatchForEachIndex:{message:"For-Each index variable must be 'dynamic' type.",errno:171},MissingMainFunction:{message:"No Main() Found.",errno:172},DuplicateSub:{message:"SUB or FUNCTION defined twice.",errno:173},LimitExceeded:{message:"Internal limit size exceeded.",errno:174},ExitWhileWithoutWhile:{message:"Exit While is not inside a While.",errno:175},TooManyVariables:{message:"Variable table size exceeded.",errno:176},TooManyConstants:{message:"Constant table size exceeded.",errno:177},FunctionNotExpected:{message:"Function not expected here.",errno:178},UnterminatedString:{message:"String missing ending quote.",errno:179},DuplicateLabel:{message:"Label/LineNumber defined more than once.",errno:180},UnterminatedBlock:{message:"A block (such as FOR/NEXT or IF/ENDIF) was not terminated correctly.",errno:181},BadNext:{message:"Variable in NEXT does not match correct FOR.",errno:182},EndOfFile:{message:"Unexpected End-Of-File.",errno:183},CannotReadFile:{message:"Error loading file.",errno:185},LineNumberSequenceError:{message:"Classic BASIC style line number is out of sequence.",errno:186},NoLineNumber:{message:"Line Number not found where expected.",errno:187},IfWithoutEndIf:{message:"ENDIF Missing.",errno:189},WhileWithoutEndWhile:{message:"While Statement is missing a matching EndWhile.",errno:190},EndWhileWithoutWhile:{message:"EndWhile Without While.",errno:191},ExceptionThrownOnStack:{message:"UNEXPECTED INTERNAL (Exception on stack)",errno:222},StackOverflow:{message:"Stack overflow.",errno:223},NotAFunction:{message:"Function Call Operator ( ) attempted on non-function.",errno:224},UnsupportedUnicode:{message:"Error: Unicode not supported.",errno:225},ValueReturn:{message:"Return from non-function.",errno:226},BadNumberOfIndexes:{message:"Invalid number of Array indexes.",errno:227},BadLHS:{message:"Invalid value for left-side of expression.",errno:228},MissingReturnValue:{message:"Function does not have a required return.",errno:229},UninitializedFunction:{message:"Use of a reference to a function/sub that is not initialized.",errno:230},UndimmedArray:{message:"Array operation attempted on variable not DIM'd.",errno:231},NonNumericArrayIndex:{message:"Attempt to use a non-numeric array index not allowed.",errno:232},UninitializedVariable:{message:"Use of uninitialized variable.",errno:233},TypelessOperation:{message:"Operation on UnTyped operand(s) attempted.",errno:235},DotOnNonObject:{message:"'Dot' Operator attempted with invalid BrightScript Component or interface reference.",errno:236},NonStaticInterfaceCall:{message:"Interface function calls from type rotINTERFACE must by static.",errno:237},NotWaitable:{message:"Tried to Wait on an BrightScript Component that does not have MessagePort interface.",errno:238},NotPrintable:{message:"Non printable value.",errno:239},ReturnValueIgnored:{message:"Function returns a value that is ignored.",errno:240},WrongNumberOfParams:{message:"Wrong number of function parameters.",errno:241},TooManyParams:{message:"Too many function parameters (internal limit exceeded).",errno:242},InterfaceNotAMember:{message:"Interface not a member of BrightScript Component",errno:243},MemberFunctionNotFound:{message:"Member function not found in BrightScript Component or interface.",errno:244},RoWrongNumberOfParams:{message:"BrightScript Component function call does not have the correct number of parameters.",errno:245},ObjectClassNotFound:{message:"BrightScript Component Class not Found.",errno:246},Stop:{message:"STOP",errno:247},Break:{message:"BREAK",errno:248},StackUnderflow:{message:"Stack Underflow.",errno:249},MissingParenthesis:{message:"Missing Parentheses",errno:250},UndefinedOperator:{message:"Unsupported expression operator.",errno:251},NormalEnd:{message:"Normal End.",errno:252},UndefinedOpCode:{message:"Undefined Op Code.",errno:253},Internal:{message:"UNEXPECTED INTERNAL.",errno:254},Okay:{message:"OKAY",errno:255}};function Q(e){postMessage(`error,${e.format()}`)}class ee extends J{constructor(e){const t=Z.TypeMismatch;let n=`${t.message} ${e.message} `;e.cast?e.right&&(n+=`"${T.toString(te(e.right.type))}"`,n+=` to "${T.toString(te(e.left.type))}"`):(n+=`"${T.toString(te(e.left.type))}"`,e.right&&(n+=` and "${T.toString(te(e.right.type))}"`)),n+=".",super({errno:t.errno,message:n},e.left.location)}}function te(e){return"number"==typeof e?e:e.kind}var ne;!function(e){e[e.Global=0]="Global",e[e.Module=1]="Module",e[e.Function=2]="Function"}(ne||(ne={}));class re extends Error{constructor(e){super(e)}}class ie{constructor(e,t){this.rootM=t||e,this.function.set("m",e),e.addReference(),this.mPointer=e}global=new Map;module=new Map;locations=new Map;function=new Map;mPointer;rootM;hostNode;gotoLabel="";continueFor=!1;continueForEach=0;define(e,t,n,r){let i;const s=t.toLowerCase();if("global"===s&&e===ne.Function&&n.kind!==T.Interface&&r)throw new ee({message:"Unable to cast",left:{type:this.global.get("global"),location:r},right:{type:n,location:r},cast:!0});switch(e){case ne.Function:{i=this.function,n instanceof L&&n.addReference();const e=i.get(s);e instanceof L&&e.removeReference();break}case ne.Module:i=this.module,this.locations.set(s,r);break;case ne.Global:default:i=this.global}i.set(s,n)}getDefinedLocation(e){return this.locations.get(e.toLowerCase())}setM(e,t=!0){this.mPointer=e,t&&this.function.set("m",this.mPointer)}getRootM(){return this.rootM}setRootM(e){this.rootM=e}remove(e,t=ne.Function){const n=e.toLowerCase();switch(t){case ne.Module:this.module.delete(n);break;case ne.Function:if(this.function.has(n)){const e=this.function.get(n);e instanceof L&&e.removeReference(),this.function.delete(n)}}}removeReferences(){for(let[e,t]of this.function)t instanceof L&&t.removeReference()}get(e){let t=e.text.toLowerCase();if("line_num"===t)return new vh(e.location.start.line);let n=[this.function,this.module,this.global].find(e=>e.has(t));if(n)return n.get(t);throw new re(`Undefined variable '${e.text}'`)}has(e,t=[ne.Global,ne.Module,ne.Function]){if("m"===e.text.toLowerCase())return!0;let n=e.text.toLowerCase();return null!=t.map(e=>{switch(e){case ne.Global:return this.global;case ne.Module:return this.module;case ne.Function:return this.function}}).find(e=>e.has(n))}getList(e){switch(e){case ne.Global:return this.global;case ne.Module:return this.module;case ne.Function:return this.function}}createSubEnvironment(e=!0){let t=new ie(this.mPointer,this.rootM);return t.global=this.global,t.hostNode=this.hostNode,e?(t.module=this.module,t.locations=this.locations):(t.module=new Map,t.locations=new Map),t}}function se(e){return"box"in e&&"inArray"in e}function ae(e){return"unbox"in e&&"copy"in e}var oe=__webpack_require__(9907);const ce=["Off","On","Instant replay","When mute"];function le(e){const t=e.trim().toLowerCase();return ce.find(e=>e.toLowerCase()===t)}const ue="common:/certs/ca-bundle.crt",he=function(){let e=!1,t=!1,n=!1,r=!1,i=!1,s=!1,a=!1,o=!1,c=!1,l=!1,u=!1;if("undefined"!=typeof window&&(e=!0,t=("chrome"in window||window.Intl&&"v8BreakIterator"in Intl)&&"CSS"in window),"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent){let e=navigator.userAgent;e.includes("Electron")?(i=!0,t=!0):/Firefox\D+(\d+)/.test(e)?n=!0:/^((?!chrome|android).)*safari/i.test(e)&&(r=!0),/Android/.test(e)?s=!0:/CrOS/.test(e)?a=!0:/iP[ao]d|iPhone/i.test(e)?o=!0:/Mac OS/.test(e)&&!/like Mac OS/.test(e)?c=!0:/Linux/.test(e)?l=!0:/Windows/.test(e)&&(u=!0)}else"android"===oe.platform?s=!0:"darwin"===oe.platform?c=!0:"linux"===oe.platform?l=!0:"win32"===oe.platform&&(u=!0);return{inBrowser:e,inChromium:t,inFirefox:n,inSafari:r,inElectron:i,inAndroid:s,inChromeOS:a,inIOS:o,inLinux:l,inMacOS:c,inWindows:u}}(),de={developerId:"34c6fceca75e456f25e7e99531e2425c6c1de443",friendlyName:"BrightScript Engine Library",deviceModel:"8000X",firmwareVersion:"48G.04E05531A",clientId:"6c5bf3a5-b2a5-4918-824d-7691d5c85364",RIDA:"f51ac698-bc60-4409-aae3-8fc3abc025c4",countryCode:"US",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,locale:"en_US",clockFormat:"12h",displayMode:"720p",captionMode:"Off",captionStyle:[],captionLanguage:"en",assets:new ArrayBuffer(0),maxSimulStreams:2,remoteControls:[],customFeatures:[],connectionInfo:{type:"WiredConnection",name:"eth1",gateway:"127.0.0.1",ip:"127.0.0.1",dns:["8.8.8.8","8.8.4.4"],quality:"Excellent"},localIps:["eth1,127.0.0.1"],startTime:Date.now(),audioVolume:50,audioLanguage:"en",maxFps:60,tmpVolSize:33554432,cacheFSVolSize:33554432},fe=new Map([["default","cc-serif"],["serif fixed width","cc-serif-fixed"],["serif proportional","cc-serif"],["sans serif fixed width","cc-sans-serif-fixed"],["sans serif proportional","cc-sans-serif"],["casual","cc-casual"],["cursive","cc-cursive"],["small caps","cc-small-caps"]]),pe=new Map([["default",[29,43.5]],["extra small",[20,30]],["small",[21.5,32]],["medium",[29,43.5]],["large",[37.5,56]],["extra large",[40.5,61]]]),ge=new Map([["default","#B0B0B0"],["bright white","#FFFFFF"],["white","#B0B0B0"],["black","#000000"],["red","#CA0000"],["green","#00BB00"],["blue","#0304D0"],["yellow","#B2B400"],["magenta","#C500C5"],["cyan","#00BBB9"]]),me=new Map([["default",1],["off",0],["25%",.25],["50%",.5],["75%",.75],["100%",1]]),ye=new Map([["mode",Array.from(ce)],["text/font",Array.from(fe.keys())],["text/effect",["default","none","raised","depressed","uniform","drop shadow (left)","drop shadow (right)"]],["text/size",Array.from(pe.keys())],["text/color",Array.from(ge.keys())],["text/opacity",Array.from(me.keys())],["background/color",Array.from(ge.keys())],["background/opacity",Array.from(me.keys())],["window/color",Array.from(ge.keys())],["window/opacity",Array.from(me.keys())],["track",["default"]],["track_composite",["default"]],["track_analog",["default"]],["muted",["unmuted","muted"]]]);var be,we,ve;function Se(){let e=Math.floor(16777216*Math.random()).toString(16);for(;e.length<6;)e="0"+e;return e.toUpperCase()}!function(e){e[e.INIT=0]="INIT",e[e.RUN=1]="RUN",e[e.STOP=2]="STOP",e[e.DONE=3]="DONE"}(be||(be={})),function(e){e.UNKNOWN="EXIT_UNKNOWN",e.CRASHED="EXIT_BRIGHTSCRIPT_CRASH",e.UNKFUNC="EXIT_BRIGHTSCRIPT_UNK_FUNC",e.FINISHED="EXIT_USER_NAV",e.SETTINGS="EXIT_SETTINGS_UPDATE",e.POWER="EXIT_POWER_MODE",e.PACKAGED="EXIT_PACKAGER_DONE",e.INVALID="EXIT_INVALID_PCODE",e.PASSWORD="EXIT_MISSING_PASSWORD",e.UNPACK="EXIT_UNPACK_FAILED"}(we||(we={})),function(e){e[e.DBG=0]="DBG",e[e.BUF=1]="BUF",e[e.VDO=2]="VDO",e[e.VDX=3]="VDX",e[e.VSE=4]="VSE",e[e.VLP=5]="VLP",e[e.VPS=6]="VPS",e[e.VDR=7]="VDR",e[e.VAT=8]="VAT",e[e.VTT=9]="VTT",e[e.SND=10]="SND",e[e.SDX=11]="SDX",e[e.SPS=12]="SPS",e[e.SDR=13]="SDR",e[e.WAV=14]="WAV",e[e.WAV1=15]="WAV1",e[e.WAV2=16]="WAV2",e[e.WAV3=17]="WAV3",e[e.MUHS=18]="MUHS",e[e.MHSL=19]="MHSL",e[e.MBWD=20]="MBWD",e[e.CEC=21]="CEC",e[e.HDMI=22]="HDMI",e[e.RID=23]="RID",e[e.KEY=24]="KEY",e[e.MOD=25]="MOD"}(ve||(ve={}));const xe=ve.HDMI+15;var Ee,Ie,ke,Te,_e;!function(e){e[e.IR=10]="IR",e[e.WD=20]="WD",e[e.BT=30]="BT",e[e.SIM=40]="SIM",e[e.ECP=50]="ECP",e[e.RMOB=60]="RMOB"}(Ee||(Ee={})),function(e){e[e.BSCS=0]="BSCS",e[e.BT=1]="BT",e[e.CLASSES=2]="CLASSES",e[e.CONT=3]="CONT",e[e.EXIT=4]="EXIT",e[e.EXPR=5]="EXPR",e[e.HELP=6]="HELP",e[e.LAST=7]="LAST",e[e.LIST=8]="LIST",e[e.NEXT=9]="NEXT",e[e.STATS=10]="STATS",e[e.STEP=11]="STEP",e[e.THREAD=12]="THREAD",e[e.THREADS=13]="THREADS",e[e.VAR=14]="VAR",e[e.BREAK=15]="BREAK",e[e.PAUSE=16]="PAUSE"}(Ie||(Ie={})),function(e){e[e.SELECTED=0]="SELECTED",e[e.FULL=1]="FULL",e[e.PARTIAL=2]="PARTIAL",e[e.PAUSED=3]="PAUSED",e[e.RESUMED=4]="RESUMED",e[e.FINISHED=5]="FINISHED",e[e.FAILED=6]="FAILED",e[e.LOADING=7]="LOADING",e[e.START_STREAM=8]="START_STREAM",e[e.START_PLAY=9]="START_PLAY",e[e.POSITION=10]="POSITION",e[e.TOO_MANY=11]="TOO_MANY"}(ke||(ke={})),function(e){e[e.Network=0]="Network",e[e.Http=-1]="Http",e[e.TimeOut=-2]="TimeOut",e[e.Unknown=-3]="Unknown",e[e.EmptyList=-4]="EmptyList",e[e.Unsupported=-5]="Unsupported",e[e.DRM=-6]="DRM"}(Te||(Te={})),function(e){e[e.DEBUG_EXPR=0]="DEBUG_EXPR",e[e.MEDIA_TRACKS=1]="MEDIA_TRACKS",e[e.SYS_LOG=2]="SYS_LOG",e[e.INPUT=3]="INPUT"}(_e||(_e={}));const Ce=["select","navsingle","navmulti","deadend"],Ae=new Set(["wav","mp2","mp3","m4a","aac","ogg","oga","ac3","wma","flac"]),Fe=new Set(["mp4","m4v","mkv","mov"]);function Re(e,t=""){return(e>>>0).toString(16).padStart(8,t)}function Me(e){let t=[];return e&&(t=e.trimEnd().split("\n")),t}function De(e){const t=new Map;if(e.length>0){const n="0123456789ACDEFGHJKLMNPRSTUVWXY";t.set("major",n.indexOf(e.charAt(2)).toString()),t.set("minor",e.slice(4,5)),t.set("revision",e.slice(5,6)),t.set("build",e.slice(8,12)),t.set("plid",e.slice(0,2))}return t}function Oe(){let e=new Date;return`${new Intl.DateTimeFormat("en-GB",{month:"2-digit",timeZone:"UTC"}).format(e)}-${new Intl.DateTimeFormat("en-GB",{day:"2-digit",timeZone:"UTC"}).format(e)} ${new Intl.DateTimeFormat("en-GB",{hour:"2-digit",timeZone:"UTC"}).format(e)}:${new Intl.DateTimeFormat("en-GB",{minute:"2-digit",timeZone:"UTC"}).format(e)}:${new Intl.DateTimeFormat("en-GB",{second:"2-digit",timeZone:"UTC"}).format(e)}.${e.getMilliseconds()}`}const Pe=class{offset=8;queue=[];lengthIdx=0;versionIdx=1;buffer;view;maxSize;atomicView;isProcessing=!1;constructor(e,t){e=e??32768,this.maxSize=t??3145728,this.buffer=new SharedArrayBuffer(e,{maxByteLength:this.maxSize}),this.view=new Uint8Array(this.buffer),this.atomicView=new Int32Array(this.buffer,0,2),Atomics.store(this.atomicView,this.lengthIdx,0),Atomics.store(this.atomicView,this.versionIdx,0)}setBuffer(e){this.buffer=e,this.view=new Uint8Array(this.buffer),this.atomicView=new Int32Array(this.buffer,0,2),this.maxSize=Math.max(this.maxSize,this.buffer.byteLength)}getBuffer(){return this.buffer}getVersion(){return Atomics.load(this.atomicView,this.versionIdx)}waitStore(e,t,n=1e4){this.queue.push({obj:e,version:t,timeout:n}),this.processQueue()}waitVersion(e,t){return Atomics.wait(this.atomicView,this.versionIdx,e,t)}processQueue(){if(this.isProcessing||0===this.queue.length)return;this.isProcessing=!0;const{obj:e,version:t,timeout:n}=this.queue[0];if("function"==typeof Atomics.waitAsync){const r=Atomics.waitAsync(this.atomicView,this.versionIdx,t,n);r.async?r.value.then(t=>{"ok"===t?(this.store(e),console.debug("[SharedObject] Buffer released. Stored data.",e.field,this.getVersion())):console.error("[SharedObject] Error storing shared data",t,e.field),this.queue.shift(),this.isProcessing=!1,this.processQueue()}):"not-equal"===r.value?(this.store(e),console.debug("[SharedObject] Buffer is free. Stored data.",e.field,this.getVersion()),this.queue.shift(),this.isProcessing=!1,this.processQueue()):(console.error("[SharedObject] Error storing shared data: timeout",e.field),this.queue.shift(),this.isProcessing=!1,this.processQueue())}else{const r=Date.now(),i=()=>{Atomics.load(this.atomicView,this.versionIdx)!==t?(console.debug("[SharedObject] Buffer is free. Storing data."),this.store(e),this.queue.shift(),this.isProcessing=!1,this.processQueue()):Date.now()-r<n?setTimeout(i,10):(console.error("[SharedObject] Error storing shared data: timeout",e.field),this.queue.shift(),this.isProcessing=!1,this.processQueue())};i()}}store(e){const t=JSON.stringify(e),n=(new TextEncoder).encode(t),r=n.length;this.ensureCapacity(r+8)&&(this.view.set(n,8),Atomics.store(this.atomicView,this.lengthIdx,r),Atomics.add(this.atomicView,this.versionIdx,1),Atomics.notify(this.atomicView,this.versionIdx))}load(e=!1){const t=Atomics.load(this.atomicView,0);if(t<1)return{};const n=this.view.subarray(this.offset,this.offset+t),r=(new TextDecoder).decode(new Uint8Array(n).buffer);e&&(Atomics.store(this.atomicView,this.versionIdx,0),Atomics.notify(this.atomicView,this.versionIdx));try{return JSON.parse(r)}catch(e){return console.error("Error parsing data:",e,r),{}}}ensureCapacity(e){if(e>this.maxSize)return console.error(`[SharedObject] Buffer is full. Cannot store more data. ${e} > ${this.maxSize}`),!1;if(e>this.buffer.byteLength){let t=Math.min(this.maxSize,Math.max(2*e,2*this.buffer.byteLength));try{this.buffer.grow(t),this.view=new Uint8Array(this.buffer),this.atomicView=new Int32Array(this.buffer,0,2)}catch(e){return console.error("[SharedObject] Error growing buffer:",e),!1}}return!0}};var Ne=__webpack_require__(9942),Le=__webpack_require__.n(Ne),Be=__webpack_require__(8985);class Ue extends Be{[Symbol.toStringTag]="List";constructor(e){super(),e&&this.push(...e)}data=new Set;toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return Array.from(this.data)}toString(){return this.join(",")}_set(e,t,n=!1){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const r=Array.from(this.data);r.splice(e,+n,t),this.data=new Set(r),this.emit("update")}set(e,t){this._set(e,t,!0)}deleteAt(e){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(e))}insert(e,t=this.data.size){this._set(t,e,!1)}at(e){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(e)}pop(){const e=Array.from(this.data).pop();return void 0!==e&&this.delete(e),e}push(...e){for(const t of e)this.add(t);return this.data.size}join(e){return Array.from(this.data).join(e)}splice(e,t,...n){if(Math.abs(e)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const r=Array.from(this.data),i=r.splice(e,t,...n);return this.data=new Set(r),this.emit("update"),i}add(e){return this.data.add(e),this.emit("update"),this.emit("add",e),this}clear(){this.data.clear(),this.emit("update")}delete(e){const t=this.data.delete(e);return this.emit("update"),t}has(e){return this.data.has(e)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[Symbol.iterator](){return this.data[Symbol.iterator]()}}function Ve(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function je(e,...t){return function(e){const n=Object.entries(e);return Object.fromEntries(n.filter(([e,n])=>(e=>!t.flat().includes(e))(e)))}(e)}function ze(e){try{return JSON.parse(e),!0}catch{return!1}}function Ge(e,t){return Object.fromEntries(Object.entries(e).map(([e,n])=>[e,"function"==typeof n?n.bind(t):n]))}function He(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function $e(e){throw e&&"object"==typeof e&&function(e){const t=[];for(let n=e;n&&!["Function","Object"].includes(n.constructor.name);n=Object.getPrototypeOf(n))t.push(n.constructor.name);return t}(e).includes("Error")&&Error?.captureStackTrace(e,$e),e}const We=Intl.NumberFormat("en",{notation:"compact"});function qe(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}We.format.bind(We);const Xe=new TextEncoder;function Ye(e){return Xe.encode(e)}const Ke=new TextDecoder;function Je(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return Ke.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),Ke.decode(t)}function Ze(e){const t=e.replace(/-/g,""),n=new Uint8Array(16);for(let e=0;e<16;e++)n[e]=parseInt(t.slice(2*e,2*e+2),16);return n}var Qe;!function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.ESRCH=3]="ESRCH",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.E2BIG=7]="E2BIG",e[e.ENOEXEC=8]="ENOEXEC",e[e.EBADF=9]="EBADF",e[e.ECHILD=10]="ECHILD",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EIDRM=43]="EIDRM",e[e.ECHRNG=44]="ECHRNG",e[e.EL2NSYNC=45]="EL2NSYNC",e[e.EL3HLT=46]="EL3HLT",e[e.EL3RST=47]="EL3RST",e[e.ENRNG=48]="ENRNG",e[e.EUNATCH=49]="EUNATCH",e[e.ECSI=50]="ECSI",e[e.EL2HLT=51]="EL2HLT",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.EBADSLT=57]="EBADSLT",e[e.EBFONT=59]="EBFONT",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.ENOPKG=65]="ENOPKG",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.EADV=68]="EADV",e[e.ESRMNT=69]="ESRMNT",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EMULTIHOP=72]="EMULTIHOP",e[e.EDOTDOT=73]="EDOTDOT",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.ENOTUNIQ=76]="ENOTUNIQ",e[e.EBADFD=77]="EBADFD",e[e.EREMCHG=78]="EREMCHG",e[e.ELIBACC=79]="ELIBACC",e[e.ELIBBAD=80]="ELIBBAD",e[e.ELIBSCN=81]="ELIBSCN",e[e.ELIBMAX=82]="ELIBMAX",e[e.ELIBEXEC=83]="ELIBEXEC",e[e.EILSEQ=84]="EILSEQ",e[e.ERESTART=85]="ERESTART",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.EUSERS=87]="EUSERS",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.EPFNOSUPPORT=96]="EPFNOSUPPORT",e[e.EAFNOSUPPORT=97]="EAFNOSUPPORT",e[e.EADDRINUSE=98]="EADDRINUSE",e[e.EADDRNOTAVAIL=99]="EADDRNOTAVAIL",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ECONNABORTED=103]="ECONNABORTED",e[e.ECONNRESET=104]="ECONNRESET",e[e.ENOBUFS=105]="ENOBUFS",e[e.EISCONN=106]="EISCONN",e[e.ENOTCONN=107]="ENOTCONN",e[e.ESHUTDOWN=108]="ESHUTDOWN",e[e.ETOOMANYREFS=109]="ETOOMANYREFS",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EEUCLEAN=117]="EEUCLEAN",e[e.ENOTNAM=118]="ENOTNAM",e[e.ENAVAIL=119]="ENAVAIL",e[e.EISNAM=120]="EISNAM",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT",e[e.ENOMEDIUM=123]="ENOMEDIUM",e[e.EMEDIUMTYPE=124]="EMEDIUMTYPE",e[e.ECANCELED=125]="ECANCELED",e[e.ENOKEY=126]="ENOKEY",e[e.EKEYEXPIRED=127]="EKEYEXPIRED",e[e.EKEYREVOKED=128]="EKEYREVOKED",e[e.EKEYREJECTED=129]="EKEYREJECTED",e[e.EOWNERDEAD=130]="EOWNERDEAD",e[e.ENOTRECOVERABLE=131]="ENOTRECOVERABLE",e[e.ERFKILL=132]="ERFKILL",e[e.EHWPOISON=133]="EHWPOISON"}(Qe||(Qe={}));const et={[Qe.EPERM]:"Operation not permitted",[Qe.ENOENT]:"No such file or directory",[Qe.ESRCH]:"No such process",[Qe.EINTR]:"Interrupted system call",[Qe.EIO]:"Input/output error",[Qe.ENXIO]:"No such device or address",[Qe.E2BIG]:"Argument list too long",[Qe.ENOEXEC]:"Exec format error",[Qe.EBADF]:"Bad file descriptor",[Qe.ECHILD]:"No child processes",[Qe.EAGAIN]:"Resource temporarily unavailable",[Qe.ENOMEM]:"Out of memory",[Qe.EACCES]:"Permission denied",[Qe.EFAULT]:"Bad address",[Qe.ENOTBLK]:"Block device required",[Qe.EBUSY]:"Resource busy or locked",[Qe.EEXIST]:"File exists",[Qe.EXDEV]:"Invalid cross-device link",[Qe.ENODEV]:"No such device",[Qe.ENOTDIR]:"File is not a directory",[Qe.EISDIR]:"File is a directory",[Qe.EINVAL]:"Invalid argument",[Qe.ENFILE]:"Too many open files in system",[Qe.EMFILE]:"Too many open files",[Qe.ETXTBSY]:"Text file busy",[Qe.EFBIG]:"File is too big",[Qe.ENOSPC]:"No space left on disk",[Qe.ESPIPE]:"Illegal seek",[Qe.EROFS]:"Cannot modify a read-only file system",[Qe.EMLINK]:"Too many links",[Qe.EPIPE]:"Broken pipe",[Qe.EDOM]:"Numerical argument out of domain",[Qe.ERANGE]:"Numerical result out of range",[Qe.EDEADLK]:"Resource deadlock would occur",[Qe.ENAMETOOLONG]:"File name too long",[Qe.ENOLCK]:"No locks available",[Qe.ENOSYS]:"Function not implemented",[Qe.ENOTEMPTY]:"Directory is not empty",[Qe.ELOOP]:"Too many levels of symbolic links",[Qe.ENOMSG]:"No message of desired type",[Qe.EIDRM]:"Identifier removed",[Qe.ECHRNG]:"Channel number out of range",[Qe.EL2NSYNC]:"Level 2 not synchronized",[Qe.EL3HLT]:"Level 3 halted",[Qe.EL3RST]:"Level 3 reset",[Qe.ENRNG]:"Link number out of range",[Qe.EUNATCH]:"Protocol driver not attached",[Qe.ECSI]:"No CSI structure available",[Qe.EL2HLT]:"Level 2 halted",[Qe.EBADE]:"Invalid exchange",[Qe.EBADR]:"Invalid request descriptor",[Qe.EXFULL]:"Exchange full",[Qe.ENOANO]:"No anode",[Qe.EBADRQC]:"Invalid request code",[Qe.EBADSLT]:"Invalid slot",[Qe.EBFONT]:"Bad font file format",[Qe.ENOSTR]:"Device not a stream",[Qe.ENODATA]:"No data available",[Qe.ETIME]:"Timer expired",[Qe.ENOSR]:"Out of streams resources",[Qe.ENONET]:"Machine is not on the network",[Qe.ENOPKG]:"Package not installed",[Qe.EREMOTE]:"Object is remote",[Qe.ENOLINK]:"Link has been severed",[Qe.EADV]:"Advertise error",[Qe.ESRMNT]:"Srmount error",[Qe.ECOMM]:"Communication error on send",[Qe.EPROTO]:"Protocol error",[Qe.EMULTIHOP]:"Multihop attempted",[Qe.EDOTDOT]:"RFS specific error",[Qe.EBADMSG]:"Bad message",[Qe.EOVERFLOW]:"Value too large for defined data type",[Qe.ENOTUNIQ]:"Name not unique on network",[Qe.EBADFD]:"File descriptor in bad state",[Qe.EREMCHG]:"Remote address changed",[Qe.ELIBACC]:"Can not access a needed shared library",[Qe.ELIBBAD]:"Accessing a corrupted shared library",[Qe.ELIBSCN]:".lib section in a.out corrupted",[Qe.ELIBMAX]:"Attempting to link in too many shared libraries",[Qe.ELIBEXEC]:"Cannot exec a shared library directly",[Qe.EILSEQ]:"Invalid or incomplete multibyte or wide character",[Qe.ERESTART]:"Interrupted system call should be restarted",[Qe.ESTRPIPE]:"Streams pipe error",[Qe.EUSERS]:"Too many users",[Qe.ENOTSOCK]:"Socket operation on non-socket",[Qe.EDESTADDRREQ]:"Destination address required",[Qe.EMSGSIZE]:"Message too long",[Qe.EPROTOTYPE]:"Protocol wrong type for socket",[Qe.ENOPROTOOPT]:"Protocol not available",[Qe.EPROTONOSUPPORT]:"Protocol not supported",[Qe.ESOCKTNOSUPPORT]:"Socket type not supported",[Qe.ENOTSUP]:"Operation is not supported",[Qe.EPFNOSUPPORT]:"Protocol family not supported",[Qe.EAFNOSUPPORT]:"Address family not supported by protocol",[Qe.EADDRINUSE]:"Address already in use",[Qe.EADDRNOTAVAIL]:"Cannot assign requested address",[Qe.ENETDOWN]:"Network is down",[Qe.ENETUNREACH]:"Network is unreachable",[Qe.ENETRESET]:"Network dropped connection on reset",[Qe.ECONNABORTED]:"Software caused connection abort",[Qe.ECONNRESET]:"Connection reset by peer",[Qe.ENOBUFS]:"No buffer space available",[Qe.EISCONN]:"Transport endpoint is already connected",[Qe.ENOTCONN]:"Transport endpoint is not connected",[Qe.ESHUTDOWN]:"Cannot send after transport endpoint shutdown",[Qe.ETOOMANYREFS]:"Too many references: cannot splice",[Qe.ETIMEDOUT]:"Connection timed out",[Qe.ECONNREFUSED]:"Connection refused",[Qe.EHOSTDOWN]:"Host is down",[Qe.EHOSTUNREACH]:"No route to host",[Qe.EALREADY]:"Operation already in progress",[Qe.EINPROGRESS]:"Operation now in progress",[Qe.ESTALE]:"Stale file handle",[Qe.EEUCLEAN]:"Structure needs cleaning",[Qe.ENOTNAM]:"Not a XENIX named type file",[Qe.ENAVAIL]:"No XENIX semaphores available",[Qe.EISNAM]:"Is a named type file",[Qe.EREMOTEIO]:"Remote I/O error",[Qe.EDQUOT]:"Disk quota exceeded",[Qe.ENOMEDIUM]:"No medium found",[Qe.EMEDIUMTYPE]:"Wrong medium type",[Qe.ECANCELED]:"Operation canceled",[Qe.ENOKEY]:"Required key not available",[Qe.EKEYEXPIRED]:"Key has expired",[Qe.EKEYREVOKED]:"Key has been revoked",[Qe.EKEYREJECTED]:"Key was rejected by service",[Qe.EOWNERDEAD]:"Owner died",[Qe.ENOTRECOVERABLE]:"State not recoverable",[Qe.ERFKILL]:"Operation not possible due to RF-kill",[Qe.EHWPOISON]:"Memory page has hardware error"};function tt(e){let t=`${e.code}: ${et[e.errno]}, ${e.syscall}`;return e.path&&(t+=` '${e.path}'`),e.dest&&(t+=` -> '${e.dest}'`),e.message&&!e.message.startsWith(et[e.errno])&&(t+=` (${e.message})`),e.message=t,e}class nt extends Error{errno;code;path;dest;syscall;constructor(e,t,n={}){const r=Qe[e];super(t||""),this.errno=e,this.code=r,Object.assign(this,je(n,"message")),t||tt(this),Error.captureStackTrace?.(this,this.constructor)}toString(){return this.message}toJSON(){const e={errno:this.errno,code:this.code,stack:this.stack,message:this.message};return this.path&&(e.path=this.path),this.dest&&(e.dest=this.dest),this.syscall&&(e.syscall=this.syscall),e}static fromJSON(e){const t=e.syscall?new nt(e.errno,!1,e):new nt(e.errno,e.message);return t.stack=e.stack,t}}function rt(e,t,n,r){"string"==typeof t&&(t={syscall:t,path:n,dest:r});const i=new nt(Qe[e],!1,t??{});return Error.captureStackTrace?.(i,rt),i}function it(e,t){const n=new nt(Qe[e],t??et[Qe[e]]);return Error.captureStackTrace?.(n,it),n}function st(e,t,n){const r="string"==typeof e?{syscall:e}:e;return t&&(r.path=t),n&&(r.dest=n),function(e){throw Object.assign(e,r),tt(e),e}}var at;!function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"}(at||(at={}));const ot=["emergency","alert","critical","error","warning","notice","info","debug"];function ct(e){return ot.indexOf(e)}const lt=new Ue;function ut(e,t){if(!Mt)return;const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};lt.add(n),At(n)}function ht(e){return function(t){return ut(e,t.toString()),t}}const dt=ht(at.EMERG),ft=ht(at.ALERT),pt=ht(at.CRIT),gt=ht(at.ERR),mt=ht(at.WARN),yt=ht(at.NOTICE),bt=ht(at.INFO),wt=ht(at.DEBUG);function vt(e){ut(at.WARN,e+" is deprecated and should not be used.")}function St(e,t){return`[${t}m${e}[0m`}function xt(e){return"["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] "}const Et={ansi:{[at.EMERG]:"1;4;37;41",[at.ALERT]:"1;37;41",[at.CRIT]:"1;35",[at.ERR]:"1;31",[at.WARN]:"1;33",[at.NOTICE]:"1;36",[at.INFO]:"1;37",[at.DEBUG]:"0;2;37"},css:{[at.EMERG]:"font-weight: bold; text-decoration: underline; color: white; background-color: red;",[at.ALERT]:"font-weight: bold; color: white; background-color: red;",[at.CRIT]:"font-weight: bold; color: magenta;",[at.ERR]:"font-weight: bold; color: red;",[at.WARN]:"font-weight: bold; color: yellow;",[at.NOTICE]:"font-weight: bold; color: cyan;",[at.INFO]:"font-weight: bold; color: white;",[at.DEBUG]:"opacity: 0.8; color: white;"}},It={ansi:{[at.EMERG]:"1;31",[at.ALERT]:"1;31",[at.CRIT]:"1;31",[at.ERR]:"31",[at.WARN]:"33",[at.NOTICE]:"1;37",[at.INFO]:"37",[at.DEBUG]:"2;37"},css:{[at.EMERG]:"font-weight: bold; color: red;",[at.ALERT]:"font-weight: bold; color: red;",[at.CRIT]:"font-weight: bold; color: red;",[at.ERR]:"color: red;",[at.WARN]:"color: yellow;",[at.NOTICE]:"font-weight: bold; color: white;",[at.INFO]:"color: white;",[at.DEBUG]:"opacity: 0.8; color: white;"}};function kt({style:e,colorize:t}){return function*(n){"css"==e&&(yield"level"==t?"%c%s %c%s":"%c%s %c%s%s %c%s"),yield*"ansi"==e?[St(xt(n),"2;37")]:["opacity: 0.8; color: white;",xt(n)];const r="ansi"==e?[St(ot[n.level].toUpperCase(),Et.ansi[n.level])]:[Et.css[n.level],ot[n.level].toUpperCase()];if("level"==t)return yield*r,void(yield n.message);n.level<at.CRIT&&(yield*r),"ansi"==e?yield St(n.message,It.ansi[n.level]):yield*[It.css[n.level],n.message]}}let Tt=e=>[xt(e),e.message];function _t(e){const t=Tt(e);return"string"==typeof t?[t]:Array.from(t)}let Ct=console.error;function At(e){e.level>Ft||Ct(..._t(e))}let Ft=at.ALERT,Rt=!1,Mt=!0;function Dt(e){if(Tt=e.format??Tt,Ct=e.output??Ct,Ft="string"==typeof e.level?ct(e.level):e.level??Ft,Mt=e.enabled??Mt,Rt=e.stack??Rt,e.dumpBacklog)for(const e of lt)At(e)}function Ot(e){return null!=e&&"object"==typeof e&&"create"in e&&"function"==typeof e.create}function Pt(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),e&&Object.defineProperty(t,"name",{value:e}),t}function Nt(e,t){if("object"!=typeof t||null===t)throw gt(it("EINVAL","Invalid options"));for(const[n,r]of Object.entries(e.options)){const e=t?.[n];if(null==e){if(!r.required){wt("Using default for option: "+n);continue}throw gt(it("EINVAL","Missing required option: "+n))}const i=(t,n=e)=>{return"function"==typeof t?(r=t)&&r.constructor===Function&&void 0!==r.prototype&&(Function.prototype!==Object.getPrototypeOf(r)||Object.getOwnPropertyNames(r.prototype).length>1)?e instanceof t:t(e):typeof e===t||e?.constructor?.name===t;var r};if(Array.isArray(r.type)?r.type.some(e=>i(e)):i(r.type))continue;const s="object"==typeof e&&"constructor"in e?e.constructor.name:typeof e,a=e=>"function"==typeof e?"type"!=e.name?e.name:e.toString():e,o=Array.isArray(r.type)?`one of ${r.type.map(a).join(", ")}`:a(r.type);throw gt(it("EINVAL",`Incorrect type for "${n}": ${s} (expected ${o})`))}}function Lt(e){return null!=e&&"object"==typeof e&&"backend"in e&&Ot(e.backend)}function Bt(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}function Ut(e){return!!e&&(!e.uid||!e.gid||!e.euid||!e.egid||e.groups.some(e=>!e))}const Vt={id:0,root:"/",pwd:"/",credentials:Bt({uid:0,gid:0}),descriptors:new Map,parent:null,children:[]},jt=0,zt=4,Gt=2,Ht=1,$t=1,Wt=2,qt=4,Xt=0,Yt=1,Kt=2,Jt=64,Zt=128,Qt=256,en=512,tn=1024,nn=65536,rn=262144,sn=131072,an=1052672,on=4096,cn=32768,ln=16384,un=2048,hn=61440,dn=49152,fn=40960,pn=32768,gn=24576,mn=16384,yn=8192,bn=4096,wn=2048,vn=1024,Sn=512,xn=448,En=256,In=128,kn=64,Tn=56,_n=32,Cn=16,An=8,Fn=7,Rn=4,Mn=2,Dn=1,On=0,Pn=4294967295;function Nn(e){class t extends DataView{length;type=e;*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this[e]}constructor(t,n,r){return super("object"==typeof t?t:new ArrayBuffer((t??0)*e.size),n,r),this.length="number"==typeof t?t:Math.floor(this.byteLength/e.size),new Proxy(this,{get(t,n){if(n in t)return t[n];const r=parseInt(n.toString());if(!Number.isSafeInteger(r))throw it("EINVAL","Invalid index: "+n.toString());return e.get(t.buffer,t.byteOffset+r*e.size)},set(t,n,r){const i=parseInt(n.toString());if(!Number.isSafeInteger(i))throw it("EINVAL","Invalid index: "+n.toString());return e.set(t.buffer,t.byteOffset+i*e.size,r),!0}})}}for(const e of Object.getOwnPropertyNames(DataView.prototype))(e.startsWith("get")||e.startsWith("set"))&&Object.defineProperty(t.prototype,e,{enumerable:!1,configurable:!1,writable:!1,value:void 0});return t}class Ln{type;length;name;size;__arrayType;constructor(e,t){this.type=e,this.length=t,this.name=`${e.name}[${t}]`,this.size=e.size*t,this.array=Nn(this),this.__arrayType=e.array?e.array:Nn(e)}get=(e,t)=>new this.__arrayType(e,t,this.size);set=(e,t,n)=>{for(let r=0;r<this.length;r++)this.type.set(e,t+r*this.type.size,n[r])};array}function Bn(e){return("object"==typeof e||"function"==typeof e)&&null!=e&&(e instanceof Ln?Bn(e.type):"name"in e&&"size"in e&&"get"in e&&"set"in e&&"string"==typeof e.name&&"number"==typeof e.size&&"function"==typeof e.get&&"function"==typeof e.set&&Un.has(e.name)&&Un.get(e.name)?.name===e.name)}const Un=new Map;function Vn(e){if(Un.has(e.name))throw new ReferenceError(`Type is already registered: ${e.name}`);Un.set(e.name,e)}class jn{type;init;constructor(e,t){this.type=e,this.init=t;const n=n=>new jn(new Ln(e,n),t);return Object.setPrototypeOf(n,new.target.prototype),Object.assign(n,{type:e,init:t}),n}align(e){return new jn(this.type,{...this.init,align:e})}countedBy(e){return new jn(this.type,{...this.init,countedBy:e})}bigEndian(){return new jn(this.type,{...this.init,bigEndian:!0})}toInit(){return{type:this.type,...this.init}}$type(){return new jn(this.type,this.init)}}function zn(e,t=0){return new jn(new Ln(e,t),{})}function Gn(e,t,n={}){if(!e)throw it("EINVAL","Invalid name for struct field");"symbol"==typeof e&&console.warn("Symbol used for struct field name will be coerced to string: "+e.toString());const r=e.toString(),i=Object.assign(function(e){return Bn(e)?{type:e}:e instanceof jn?e.toInit():e}(t),n);if(!Bn(i.type))throw it("EINVAL",`Invalid type for struct field "${r}"`);return{name:r,offset:0,type:i.type,countedBy:i.countedBy,alignment:i.align??i.type.size,decl:i.type instanceof Ln?`${i.typeName??i.type.type.name} ${r}[${i.type.length}]${i.countedBy?` counted_by(${i.countedBy})`:""}`:`${i.typeName??i.type.name} ${r}`,littleEndian:!i.bigEndian}}function Hn(e){throw"offset is outside the bounds of the DataView"!==e.message?e:it("EFAULT","Segmentation fault")}function $n(e,t,n,r){try{"string"==typeof n&&(n=n.charCodeAt(0));const i=e.byteOffset+t.offset+(r??0)*t.type.size;return void t.type.set(e.buffer,i,n)}catch(e){Hn(e)}}function Wn(e,t){try{return t.type.get(e.buffer,e.byteOffset+t.offset)}catch(e){Hn(e)}}const qn=Symbol("DataView");function Xn(e){return e[qn]??=new DataView(e),e[qn]}const Yn={name:"int8",size:1,array:Int8Array,get:(e,t)=>Xn(e).getInt8(t),set:(e,t,n)=>Xn(e).setInt8(t,n)},Kn={name:"uint8",size:1,array:Uint8Array,get:(e,t)=>Xn(e).getUint8(t),set:(e,t,n)=>Xn(e).setUint8(t,n)},Jn={int8:Yn,uint8:Kn,int16:{name:"int16",size:2,array:Int16Array,get:(e,t)=>Xn(e).getInt16(t,!0),set:(e,t,n)=>Xn(e).setInt16(t,n,!0)},uint16:{name:"uint16",size:2,array:Uint16Array,get:(e,t)=>Xn(e).getUint16(t,!0),set:(e,t,n)=>Xn(e).setUint16(t,n,!0)},int32:{name:"int32",size:4,array:Int32Array,get:(e,t)=>Xn(e).getInt32(t,!0),set:(e,t,n)=>Xn(e).setInt32(t,n,!0)},uint32:{name:"uint32",size:4,array:Uint32Array,get:(e,t)=>Xn(e).getUint32(t,!0),set:(e,t,n)=>Xn(e).setUint32(t,n,!0)},int64:{name:"int64",size:8,array:BigInt64Array,get:(e,t)=>Xn(e).getBigInt64(t,!0),set:(e,t,n)=>Xn(e).setBigInt64(t,n,!0)},uint64:{name:"uint64",size:8,array:BigUint64Array,get:(e,t)=>Xn(e).getBigUint64(t,!0),set:(e,t,n)=>Xn(e).setBigUint64(t,n,!0)},float32:{name:"float32",size:4,array:Float32Array,get:(e,t)=>Xn(e).getFloat32(t,!0),set:(e,t,n)=>Xn(e).setFloat32(t,n,!0)},float64:{name:"float64",size:8,array:Float64Array,get:(e,t)=>Xn(e).getFloat64(t,!0),set:(e,t,n)=>Xn(e).setFloat64(t,n,!0)}},Zn=Object.keys(Jn);for(const e of Object.values(Jn))Vn(e);const Qn={...Jn,...Object.fromEntries(Zn.map(e=>{return[(t=e,t.at(0).toUpperCase()+t.slice(1)),Jn[e]];var t})),char:Kn},er=Object.keys(Qn);function tr(e){return"char"==e?"uint8":e.toLowerCase()}function nr(e){e.metadata??={};const t=e.metadata.structInit??{};return e.metadata.structInit={fields:[...t.fields??[]]},e.metadata.structInit}function rr(e,...t){const n=t.reduce((e,t)=>({...e,...t}),{});return"object"==typeof this&&Object.assign(n,this),function(t,r){const i=nr(r);let s=1;const a={};let o=0;const c=e=>{o=Math.ceil(o/e)*e};for(const e of i.fields)n.isPacked||c(e.alignment),n.isUnion?o=Math.max(o,e.type.size):(e.offset=o,o+=e.type.size),a[e.name]=e,s=Math.max(s,e.alignment);n.alignment??=s,n.isPacked||c(n.alignment),r.metadata.struct={fields:a,size:o,alignment:n.isPacked?1:n.alignment,isUnion:n.isUnion??!1};class l extends t{constructor(...e){e.length||(e=[new ArrayBuffer(o),0,o]),super(...e);for(const e of Object.values(a))Object.defineProperty(this,e.name,{enumerable:!0,configurable:!0,get(){return Wn(this,e)},set(t){$n(this,e,t)}})}}const u=e=>({writable:!1,enumerable:!1,configurable:!1,value:e});return Object.defineProperties(l,{name:u(e),size:u(o),alignment:u(n.alignment),isUnion:u(!!n.isUnion),fields:u(a),get:u((e,t)=>new l(e,t)),set:u((e,t,n)=>{const r=new Uint8Array(n.buffer,n.byteOffset,o),i=new Uint8Array(e,t,o);if(n.buffer!==e||n.byteOffset!==t)for(let e=0;e<o;e++)i[e]=r[e]}),[Symbol.toStringTag]:u(`[struct ${e}]`)}),Vn(l),l}}function ir(e,t={}){return function(n,r){if("accessor"!=r.kind)throw it("EINVAL","Field must be an accessor");const i=nr(r),s=Gn(r.name,e,t);return i.fields.push(s),{get(){return Wn(this,s)},set(e){$n(this,s,e)}}}}function sr(e){const t=Jn[tr(e)];return function(n,r){return"number"==typeof n?ir(new Ln(t,n),{typeName:e,...r}):ir(t,{typeName:e})(n,r&&"name"in r?r:$e(it("EINVAL","Invalid decorator context object")))}}Symbol.metadata??=Symbol.for("Symbol.metadata"),rr.packed=rr.bind({isPacked:!0}),rr.align=function(e){return rr.bind({alignment:e})};const ar=Object.fromEntries(er.map(e=>[e,sr(e)]));function or(e){return e}function cr(e){return"function"==typeof e&&"prototype"in e&&"fields"in e&&"object"==typeof e.fields&&Bn(e)}function lr(e,t,...n){const r=n.reduce((e,t)=>({...e,...t}),{});"object"==typeof this&&Object.assign(r,this);let i=1,s=0;const a=e=>{s=Math.ceil(s/e)*e},o=Object.create(null);for(const[e,n]of Object.entries(t)){if("number"==typeof e)throw new TypeError("Field names can not be numbers");const t=Gn(e,n);r.isPacked||a(t.alignment),r.isUnion?s=Math.max(s,t.type.size):(t.offset=s,s+=t.type.size),o[t.name]=t,i=Math.max(i,t.alignment)}r.alignment??=i,r.isPacked||a(r.alignment);class c extends DataView{static name=e;constructor(e=new ArrayBuffer(s),t,n){super(e,t,n??s);for(const e of Object.values(o))Object.defineProperty(this,e.name,{enumerable:!0,configurable:!0,get(){return Wn(this,e)},set(t){$n(this,e,t)}})}}for(const e of Object.getOwnPropertyNames(DataView.prototype))(e.startsWith("get")||e.startsWith("set"))&&Object.defineProperty(c.prototype,e,{enumerable:!1,configurable:!1,writable:!1,value:void 0});const l=c,u=e=>({writable:!1,enumerable:!1,configurable:!1,value:e});return Object.defineProperties(l,{size:u(s),alignment:u(r.alignment),isUnion:u(!!r.isUnion),fields:u(o),get:u((e,t)=>new l(e,t)),set:u((e,t,n)=>{const r=new Uint8Array(n.buffer,n.byteOffset,s),i=new Uint8Array(e,t,s);if(n.buffer!==e||n.byteOffset!==t)for(let e=0;e<s;e++)i[e]=r[e]}),[Symbol.toStringTag]:u(`[struct ${e}]`)}),Vn(l),l}function ur(e){if(Bn(e))return e.size;if(null==e)return 0;if("object"==typeof e&&Bn(e.constructor))return e.constructor.size;if(Array.isArray(e)){let t=0;for(let n=0;n<e.length;n++)t+=ur(e[n]);return t}if("string"==typeof e)return function(e){if(!function(e){return er.includes(e.toString())}(e))throw it("EINVAL","Not a valid primitive type: "+e)}(e),Jn[tr(e)].size;throw new TypeError(`Unable to resolve size of \`${e.toString()}\``)}function hr(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const n=hr(e.buffer,t);return new e.constructor(n,e.byteOffset,t)}const n="undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const n=new SharedArrayBuffer(t);return new Uint8Array(n).set(new Uint8Array(e)),n}try{return e.transfer(t)}catch{const n=new ArrayBuffer(t);return new Uint8Array(n).set(new Uint8Array(e)),n}}or.typed=function(e){return e},lr.extend=function(e,t,n,...r){return lr(t,{...e.fields,...n},...r)},lr.packed=lr.bind({isPacked:!0}),lr.align=function(e){return lr.bind({alignment:e})},Object.fromEntries(Object.entries(Qn).map(([e,t])=>[e,new jn(t,{typeName:e})]));class dr extends DataView{constructor(e,t,n){const{buffer:r,byteOffset:i,byteLength:s}=new Uint8Array(e,t,n);super(r,i,s)}}for(const e of Object.getOwnPropertyNames(DataView.prototype))(e.startsWith("get")||e.startsWith("set"))&&Object.defineProperty(dr.prototype,e,{value:()=>{throw new ReferenceError("Do not use DataView methods on a BufferView.")},writable:!1,enumerable:!1,configurable:!1});function fr(e){return JSON.parse(Je(e),(e,t)=>""==e?t:"string"==typeof t?BigInt(t).toString(16).slice(0,Math.min(t.length,8)):t)}function pr(e){return Ye(JSON.stringify(e))}function gr(e,t){if("number"==typeof e)return e;if("string"==typeof e){const t=parseInt(e,8);if(!isNaN(t))return t}if("number"==typeof t)return t;throw it("EINVAL","Invalid mode: "+e?.toString())}function mr(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw it("EINVAL","Invalid time.")}}function yr(e,t=!1){if(e instanceof URL){if("file:"!=e.protocol)throw it("EINVAL","URLs must use the file: protocol");e=e.pathname}if((e=e.toString()).startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw it("EINVAL","Path can not contain null character");if(0==e.length)throw it("EINVAL","Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:kr(e)}function br(e,t="utf8",n,r=0){return"object"!=typeof e||null===e?{encoding:"string"==typeof e?e:t??null,flag:n,mode:r}:{encoding:"string"==typeof e?.encoding?e.encoding:t??null,flag:"string"==typeof e?.flag?e.flag:n,mode:gr("mode"in e?e?.mode:null,r)}}function wr(e){return e=e.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${e}$`)}async function vr(e){const t=Promise.withResolvers();setTimeout(()=>t.reject(it("ETIMEDOUT")),500),e.on("online",t.resolve),await t.promise}function Sr(e){return`/tmp/${yr(e,!0)}${Date.now()}-${Math.random().toString(36).slice(2)}`}const xr="/";function Er(e,t){let n="",r=0,i=-1,s=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if("/"==a)break;a="/"}if("/"==a){if(i===o-1||1===s);else if(2===s){if(n.length<2||2!==r||"."!==n.at(-1)||"."!==n.at(-2)){if(n.length>2){const e=n.lastIndexOf("/");-1===e?(n="",r=0):(n=n.slice(0,e),r=n.length-1-n.lastIndexOf("/")),i=o,s=0;continue}if(0!==n.length){n="",r=0,i=o,s=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(i+1,o):n=e.slice(i+1,o),r=o-i-1;i=o,s=0}else"."===a&&-1!==s?++s:s=-1}return n}function Ir(e){return e?`${"."===e[0]?"":"."}${e}`:""}function kr(...e){let t="";for(const n of[...e.reverse(),this?.pwd??Vt.pwd])if(n?.length&&(t=`${n}/${t}`,n.startsWith("/")))break;const n=t.startsWith("/");return t=Er(t,!n),n?`/${t}`:t.length?t:"/"}function Tr(e){if(!e.length)return".";const t="/"===e[0],n="/"===e.at(-1);return(e=Er(e,!t)).length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function _r(e){return e.startsWith("/")}function Cr(...e){if(!e.length)return".";const t=e.filter(e=>e).join("/");return t?.length?Tr(t):"."}function Ar(e,t){if(e===t)return"";if((e=kr.call(this,e))===(t=kr.call(this,t)))return"";const n=e.length,r=n-1,i=t.length-1,s=r<i?r:i;let a=-1,o=0;for(;o<s;o++){const n=e[1+o];if(n!==t[1+o])break;"/"===n&&(a=o)}if(o===s)if(i>s){if("/"===t[1+o])return t.slice(1+o+1);if(0===o)return t.slice(1+o)}else r>s&&("/"===e[1+o]?a=o:0===o&&(a=0));let c="";for(o=1+a+1;o<=n;++o)o!==n&&"/"!==e[o]||(c+=0===c.length?"..":"/..");return`${c}${t.slice(1+a)}`}function Fr(e){if(0===e.length)return".";const t="/"===e[0];let n=-1,r=!0;for(let t=e.length-1;t>=1;--t)if("/"===e[t]){if(!r){n=t;break}}else r=!1;return-1===n?t?"/":".":t&&1===n?"//":e.slice(0,n)}function Rr(e,t){let n=0,r=-1,i=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let s=t.length-1,a=-1;for(let o=e.length-1;o>=0;--o)if("/"===e[o]){if(!i){n=o+1;break}}else-1===a&&(i=!1,a=o+1),s>=0&&(e[o]===t[s]?-1==--s&&(r=o):(s=-1,r=a));return n===r?r=a:-1===r&&(r=e.length),e.slice(n,r)}for(let t=e.length-1;t>=0;--t)if("/"===e[t]){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}function Mr(e){let t=-1,n=0,r=-1,i=!0,s=0;for(let a=e.length-1;a>=0;--a)if("/"!==e[a])-1===r&&(i=!1,r=a+1),"."===e[a]?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1);else if(!i){n=a+1;break}return-1===t||-1===r||0===s||1===s&&t===r-1&&t===n+1?"":e.slice(t,r)}function Dr(e){!function(e){if("object"!=typeof e)throw new TypeError('"pathObject" is not an object')}(e);const t=e.dir||e.root,n=e.base||`${e.name||""}${Ir(e.ext)}`;return t?t===e.root?`${t}${n}`:`${t}/${n}`:n}function Or(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(0===e.length)return n;const r=t?1:0;let i=-1,s=0,a=-1,o=!0,c=e.length-1,l=0;for(;c>=r;--c)if("/"!==e[c])-1===a&&(o=!1,a=c+1),"."===e[c]?-1===i?i=c:1!==l&&(l=1):-1!==i&&(l=-1);else if(!o){s=c+1;break}if(-1!==a){const r=0===s&&t?1:s;-1===i||0===l||1===l&&i===a-1&&i===s+1?n.base=n.name=e.slice(r,a):(n.name=e.slice(r,i),n.base=e.slice(r,a),n.ext=e.slice(i,a))}return s>0?n.dir=e.slice(0,s-1):t&&(n.dir="/"),n}function Pr(e,t){return wr(e).test(t)}const Nr=BigInt(1e3);class Lr{_convert(e){return this._isBigint?BigInt(e):Number(e)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(e){}mode;dev=this._convert(0);ino=this._convert(0);rdev=this._convert(0);nlink=this._convert(1);blksize=this._convert(4096);uid=this._convert(0);gid=this._convert(0);atimeMs;get atime(){return new Date(Number(this.atimeMs))}set atime(e){this.atimeMs=this._convert(e.getTime())}mtimeMs;get mtime(){return new Date(Number(this.mtimeMs))}set mtime(e){this.mtimeMs=this._convert(e.getTime())}ctimeMs;get ctime(){return new Date(Number(this.ctimeMs))}set ctime(e){this.ctimeMs=this._convert(e.getTime())}birthtimeMs;get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(e){this.birthtimeMs=this._convert(e.getTime())}size;data;flags;version;constructor({atimeMs:e,mtimeMs:t,ctimeMs:n,birthtimeMs:r,uid:i,gid:s,size:a,mode:o,ino:c,...l}={}){const u=Date.now();this.atimeMs=this._convert(e??u),this.mtimeMs=this._convert(t??u),this.ctimeMs=this._convert(n??u),this.birthtimeMs=this._convert(r??u),this.uid=this._convert(i??0),this.gid=this._convert(s??0),this.size=this._convert(a??0),this.ino=this._convert(c??0),this.mode=this._convert(o??420&pn),this.mode&hn||(this.mode=this.mode|this._convert(pn)),Object.assign(this,l)}isFile(){return(this.mode&hn)===pn}isDirectory(){return(this.mode&hn)===mn}isSymbolicLink(){return(this.mode&hn)===fn}isSocket(){return(this.mode&hn)===dn}isBlockDevice(){return(this.mode&hn)===gn}isCharacterDevice(){return(this.mode&hn)===yn}isFIFO(){return(this.mode&hn)===bn}toJSON(){return Ve(this,Xr)}hasAccess(e,t){return oi(t,this._isBigint?new Br(this):this,e)}get atimeNs(){return BigInt(this.atimeMs)*Nr}get mtimeNs(){return BigInt(this.mtimeMs)*Nr}get ctimeNs(){return BigInt(this.ctimeMs)*Nr}get birthtimeNs(){return BigInt(this.birthtimeMs)*Nr}}class Br extends Lr{_isBigint=!1}class Ur extends Lr{_isBigint=!0}class Vr{type=525687744115;bsize=4096;blocks=0;bfree=0;bavail=0;files=Pn;ffree=Pn}class jr{type=BigInt("0x7a656e6673");bsize=BigInt(4096);blocks=BigInt(0);bfree=BigInt(0);bavail=BigInt(0);files=BigInt(Pn);ffree=BigInt(Pn)}var zr=function(e,t,n,r,i,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=r.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?r.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var g in r)p[g]="access"===g?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[l],p);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(h.get=o),(o=a(m.set))&&(h.set=o),(o=a(m.init))&&i.unshift(o)}else(o=a(m))&&("field"===c?i.unshift(o):h[l]=o)}u&&Object.defineProperty(u,r.name,h),d=!0},Gr=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0};const Hr=0,$r=3968;let Wr=(()=>{var e,t;let n,r,i,s,a=[rr.packed("Attribute")],o=[],c=or.typed(Uint8Array),l=[],u=[],h=[],d=[];return class extends c{static{r=this}static{const f="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;i=[(e=ar).uint32.bind(e)],s=[(t=ar).uint32.bind(t)],zr(this,null,i,{kind:"accessor",name:"keySize",static:!1,private:!1,access:{has:e=>"keySize"in e,get:e=>e.keySize,set:(e,t)=>{e.keySize=t}},metadata:f},l,u),zr(this,null,s,{kind:"accessor",name:"valueSize",static:!1,private:!1,access:{has:e=>"valueSize"in e,get:e=>e.valueSize,set:(e,t)=>{e.valueSize=t}},metadata:f},h,d),zr(null,n={value:r},a,{kind:"class",name:r.name,metadata:f},null,o),r=n.value,f&&Object.defineProperty(r,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:f}),Gr(r,o)}#e=Gr(this,l,void 0);get keySize(){return this.#e}set keySize(e){this.#e=e}#t=(Gr(this,u),Gr(this,h,void 0));get valueSize(){return this.#t}set valueSize(e){this.#t=e}get name(){return Je(this.subarray(8,8+this.keySize))}set name(e){const t=Ye(e);if(8+t.length+this.valueSize>$r)throw it("EOVERFLOW");this.set(t,8),this.keySize=t.length}get value(){return this.subarray(8+this.keySize,this.size)}set value(e){if(8+this.keySize+e.length>$r)throw it("EOVERFLOW");this.valueSize=e.length,this.set(e,8+this.keySize)}get size(){return 8+this.keySize+this.valueSize}constructor(){super(...arguments),Gr(this,d)}},r})(),qr=(()=>{var e;let t,n,r,i=[rr.packed("Attributes")],s=[],a=dr,o=[],c=[];return class extends a{static{n=this}static{const l="function"==typeof Symbol&&Symbol.metadata?Object.create(a[Symbol.metadata]??null):void 0;r=[(e=ar).uint32.bind(e)],zr(this,null,r,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:l},o,c),zr(null,t={value:n},i,{kind:"class",name:n.name,metadata:l},null,s),n=t.value,l&&Object.defineProperty(n,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:l}),Gr(n,s)}#n=Gr(this,o,void 0);get size(){return this.#n}set size(e){this.#n=e}get byteSize(){let e=this.byteOffset+ur(this);for(let t=0;t<this.size;t++)e+=new Wr(this.buffer,e).size;return e}has(e){let t=this.byteOffset+ur(this);for(let n=0;n<this.size;n++){const n=new Wr(this.buffer,t);if(n.name==e)return!0;t+=n.size}return!1}get(e){let t=this.byteOffset+ur(this);for(let n=0;n<this.size;n++){const n=new Wr(this.buffer,t);if(n.name==e)return n.value;t+=n.size}}set(e,t){let n,r=this.byteOffset+ur(this);for(let t=0;t<this.size;t++){const t=new Wr(this.buffer,r);t.name==e&&(n=[r,t.size]),r+=t.size}const i=new Uint8Array(this.buffer);if(n){const[e,t]=n;r-=t,i.copyWithin(e,e+t,r+t),i.fill(0,r,r+t),this.size--}const s=new Wr(this.buffer,r);s.name=e,s.value=t,this.size++}remove(e){let t,n=this.byteOffset+ur(this);for(let r=0;r<this.size;r++){const r=new Wr(this.buffer,n);r.name==e&&(t=[n,r.size]),n+=r.size}if(!t)return!1;const[r,i]=t,s=new Uint8Array(this.buffer);return s.copyWithin(r,r+i,n),s.fill(0,n-i,n),this.size--,!0}copyFrom(e){const{byteSize:t}=e;new Uint8Array(this.buffer,this.byteOffset,t).set(new Uint8Array(e.buffer,e.byteOffset,t))}*keys(){let e=this.byteOffset+ur(this);for(let t=0;t<this.size;t++){const t=new Wr(this.buffer,e);yield t.name,e+=t.size}}*values(){let e=this.byteOffset+ur(this);for(let t=0;t<this.size;t++){const t=new Wr(this.buffer,e);yield t.value,e+=t.size}}*entries(){let e=this.byteOffset+ur(this);for(let t=0;t<this.size;t++){const t=new Wr(this.buffer,e);yield[t.name,t.value],e+=t.size}}constructor(){super(...arguments),Gr(this,c)}},n})();const Xr=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],Yr=5;var Kr;!function(e){e[e.Sync=1]="Sync",e[e.NoAtime=2]="NoAtime",e[e.Append=4]="Append",e[e.Immutable=8]="Immutable",e[e.Dead=16]="Dead",e[e.NoQuota=32]="NoQuota",e[e.Dirsync=64]="Dirsync",e[e.NoCMtime=128]="NoCMtime",e[e.SwapFile=256]="SwapFile",e[e.Private=512]="Private",e[e.IMA=1024]="IMA",e[e.AutoMount=2048]="AutoMount",e[e.NoSec=4096]="NoSec",e[e.DAX=8192]="DAX",e[e.Encrypted=16384]="Encrypted",e[e.CaseFold=32768]="CaseFold",e[e.Verity=65536]="Verity",e[e.KernelFile=131072]="KernelFile"}(Kr||(Kr={}));const Jr=253951,Zr=229631;let Qr=(()=>{var e,t,n,r,i,s,a,o,c,l,u,h,d,f,p,g;let m,y,b,w,v,S,x,E,I,k,T,_,C,A,F,R,M,D,O,P,N,L=[rr.packed("Inode")],B=[],U=dr,V=[],j=[],z=[],G=[],H=[],$=[],W=[],q=[],X=[],Y=[],K=[],J=[],Z=[],Q=[],ee=[],te=[],ne=[],re=[],ie=[],se=[],ae=[],oe=[],ce=[],le=[],ue=[],he=[],de=[],fe=[],pe=[],ge=[],me=[],ye=[],be=[],we=[],ve=[],Se=[],xe=[],Ee=[];var Ie=class extends U{static{y=this}static{const ke="function"==typeof Symbol&&Symbol.metadata?Object.create(U[Symbol.metadata]??null):void 0;b=[(e=ar).uint32.bind(e)],w=[(t=ar).uint32.bind(t)],v=[(n=ar).uint32.bind(n)],S=[(r=ar).uint16.bind(r)],x=[(i=ar).uint32.bind(i)],E=[(s=ar).uint32.bind(s)],I=[(a=ar).uint32.bind(a)],k=[(o=ar).float64.bind(o)],T=[(c=ar).float64.bind(c)],_=[(l=ar).float64.bind(l)],C=[(u=ar).float64.bind(u)],A=[(h=ar).uint32.bind(h)],F=[(d=ar).uint32.bind(d)],R=[(f=ar).uint32.bind(f)],M=[(p=ar).uint16.bind(p)],D=[(g=ar).uint32.bind(g)],O=[ar.uint8(48)],P=[ir(qr)],N=[ar.uint8($r)],zr(this,null,b,{kind:"accessor",name:"data",static:!1,private:!1,access:{has:e=>"data"in e,get:e=>e.data,set:(e,t)=>{e.data=t}},metadata:ke},V,j),zr(this,null,w,{kind:"accessor",name:"__data_old",static:!1,private:!1,access:{has:e=>"__data_old"in e,get:e=>e.__data_old,set:(e,t)=>{e.__data_old=t}},metadata:ke},z,G),zr(this,null,v,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:ke},H,$),zr(this,null,S,{kind:"accessor",name:"mode",static:!1,private:!1,access:{has:e=>"mode"in e,get:e=>e.mode,set:(e,t)=>{e.mode=t}},metadata:ke},W,q),zr(this,null,x,{kind:"accessor",name:"nlink",static:!1,private:!1,access:{has:e=>"nlink"in e,get:e=>e.nlink,set:(e,t)=>{e.nlink=t}},metadata:ke},X,Y),zr(this,null,E,{kind:"accessor",name:"uid",static:!1,private:!1,access:{has:e=>"uid"in e,get:e=>e.uid,set:(e,t)=>{e.uid=t}},metadata:ke},K,J),zr(this,null,I,{kind:"accessor",name:"gid",static:!1,private:!1,access:{has:e=>"gid"in e,get:e=>e.gid,set:(e,t)=>{e.gid=t}},metadata:ke},Z,Q),zr(this,null,k,{kind:"accessor",name:"atimeMs",static:!1,private:!1,access:{has:e=>"atimeMs"in e,get:e=>e.atimeMs,set:(e,t)=>{e.atimeMs=t}},metadata:ke},ee,te),zr(this,null,T,{kind:"accessor",name:"birthtimeMs",static:!1,private:!1,access:{has:e=>"birthtimeMs"in e,get:e=>e.birthtimeMs,set:(e,t)=>{e.birthtimeMs=t}},metadata:ke},ne,re),zr(this,null,_,{kind:"accessor",name:"mtimeMs",static:!1,private:!1,access:{has:e=>"mtimeMs"in e,get:e=>e.mtimeMs,set:(e,t)=>{e.mtimeMs=t}},metadata:ke},ie,se),zr(this,null,C,{kind:"accessor",name:"ctimeMs",static:!1,private:!1,access:{has:e=>"ctimeMs"in e,get:e=>e.ctimeMs,set:(e,t)=>{e.ctimeMs=t}},metadata:ke},ae,oe),zr(this,null,A,{kind:"accessor",name:"ino",static:!1,private:!1,access:{has:e=>"ino"in e,get:e=>e.ino,set:(e,t)=>{e.ino=t}},metadata:ke},ce,le),zr(this,null,F,{kind:"accessor",name:"__ino_old",static:!1,private:!1,access:{has:e=>"__ino_old"in e,get:e=>e.__ino_old,set:(e,t)=>{e.__ino_old=t}},metadata:ke},ue,he),zr(this,null,R,{kind:"accessor",name:"flags",static:!1,private:!1,access:{has:e=>"flags"in e,get:e=>e.flags,set:(e,t)=>{e.flags=t}},metadata:ke},de,fe),zr(this,null,M,{kind:"accessor",name:"__after_flags",static:!1,private:!1,access:{has:e=>"__after_flags"in e,get:e=>e.__after_flags,set:(e,t)=>{e.__after_flags=t}},metadata:ke},pe,ge),zr(this,null,D,{kind:"accessor",name:"version",static:!1,private:!1,access:{has:e=>"version"in e,get:e=>e.version,set:(e,t)=>{e.version=t}},metadata:ke},me,ye),zr(this,null,O,{kind:"accessor",name:"__padding",static:!1,private:!1,access:{has:e=>"__padding"in e,get:e=>e.__padding,set:(e,t)=>{e.__padding=t}},metadata:ke},be,we),zr(this,null,P,{kind:"accessor",name:"attributes",static:!1,private:!1,access:{has:e=>"attributes"in e,get:e=>e.attributes,set:(e,t)=>{e.attributes=t}},metadata:ke},ve,Se),zr(this,null,N,{kind:"accessor",name:"__data",static:!1,private:!1,access:{has:e=>"__data"in e,get:e=>e.__data,set:(e,t)=>{e.__data=t}},metadata:ke},xe,Ee),zr(null,m={value:y},L,{kind:"class",name:y.name,metadata:ke},null,B),Ie=y=m.value,ke&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ke}),Gr(y,B)}constructor(...e){let t={};if("object"!=typeof e[0]||null===e[0]||ArrayBuffer.isView(e[0])||(t=e[0],e=[ur(Ie)]),super(...e),Gr(this,Ee),this.byteLength<ur(Ie))throw pt(it("EIO",`Buffer is too small to create an inode (${this.byteLength} bytes)`));Object.assign(this,t),this.atimeMs||=Date.now(),this.mtimeMs||=Date.now(),this.ctimeMs||=Date.now(),this.birthtimeMs||=Date.now(),this.ino&&!this.nlink&&mt(`Inode ${this.ino} has an nlink of 0`)}#r=Gr(this,V,void 0);get data(){return this.#r}set data(e){this.#r=e}#i=(Gr(this,j),Gr(this,z,void 0));get __data_old(){return this.#i}set __data_old(e){this.#i=e}#n=(Gr(this,G),Gr(this,H,void 0));get size(){return this.#n}set size(e){this.#n=e}#s=(Gr(this,$),Gr(this,W,void 0));get mode(){return this.#s}set mode(e){this.#s=e}#a=(Gr(this,q),Gr(this,X,void 0));get nlink(){return this.#a}set nlink(e){this.#a=e}#o=(Gr(this,Y),Gr(this,K,void 0));get uid(){return this.#o}set uid(e){this.#o=e}#c=(Gr(this,J),Gr(this,Z,void 0));get gid(){return this.#c}set gid(e){this.#c=e}#l=(Gr(this,Q),Gr(this,ee,void 0));get atimeMs(){return this.#l}set atimeMs(e){this.#l=e}#u=(Gr(this,te),Gr(this,ne,void 0));get birthtimeMs(){return this.#u}set birthtimeMs(e){this.#u=e}#h=(Gr(this,re),Gr(this,ie,void 0));get mtimeMs(){return this.#h}set mtimeMs(e){this.#h=e}#d=(Gr(this,se),Gr(this,ae,void 0));get ctimeMs(){return this.#d}set ctimeMs(e){this.#d=e}#f=(Gr(this,oe),Gr(this,ce,void 0));get ino(){return this.#f}set ino(e){this.#f=e}#p=(Gr(this,le),Gr(this,ue,void 0));get __ino_old(){return this.#p}set __ino_old(e){this.#p=e}#g=(Gr(this,he),Gr(this,de,void 0));get flags(){return this.#g}set flags(e){this.#g=e}#m=(Gr(this,fe),Gr(this,pe,void 0));get __after_flags(){return this.#m}set __after_flags(e){this.#m=e}#y=(Gr(this,ge),Gr(this,me,void 0));get version(){return this.#y}set version(e){this.#y=e}#b=(Gr(this,ye),Gr(this,be,void 0));get __padding(){return this.#b}set __padding(e){this.#b=e}#w=(Gr(this,we),Gr(this,ve,void 0));get attributes(){return this.#w}set attributes(e){this.#w=e}#v=(Gr(this,Se),Gr(this,xe,void 0));get __data(){return this.#v}set __data(e){this.#v=e}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Ve(this,Xr),attributes:this.attributes}}toStats(){return new Br(this)}update(e){if(!e)return!1;let t=!1;for(const n of Xr)void 0!==e[n]&&"ino"!=n&&"data"!=n&&this[n]!==e[n]&&("atimeMs"==n&&this.flags&Kr.NoAtime||(this[n]=e[n],t=!0));return e.attributes&&(this.attributes.copyFrom(e.attributes),t=!0),t&&(this.ctimeMs=Date.now()),t}};return Ie=y})();function ei(e){return(e.mode&hn)===pn}function ti(e){return(e.mode&hn)===mn}function ni(e){return(e.mode&hn)===fn}function ri(e){return(e.mode&hn)===dn}function ii(e){return(e.mode&hn)===gn}function si(e){return(e.mode&hn)===yn}function ai(e){return(e.mode&hn)===bn}function oi(e,t,n){const r=e?.credentials||Vt.credentials;if(ni(t)||0===r.euid||0===r.egid)return!0;let i=0;return r.uid===t.uid&&(t.mode&En&&(i|=zt),t.mode&In&&(i|=Gt),t.mode&kn&&(i|=Ht)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&_n&&(i|=zt),t.mode&Cn&&(i|=Gt),t.mode&An&&(i|=Ht)),t.mode&Rn&&(i|=zt),t.mode&Mn&&(i|=Gt),t.mode&Dn&&(i|=Ht),(i&n)===n}function ci(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<Pn?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<Pn?e.gid=n:r=!1,r}const li=1;class ui extends Map{maxSize=Pn;toJSON(){return{version:li,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([e,t])=>[e,t.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let e=this.size*ur(Qr);for(const t of this.values())e+=t.size;return e}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(e){for(const[t,n]of this)if(n.ino==e||n.data==e)return t}getByID(e){return this.entryByID(e)?.inode}entryByID(e){for(const[t,n]of this)if(n.ino==e||n.data==e)return{path:t,inode:n}}directoryEntries(e){const t=this.get(e);if(!t)throw it("ENOENT");if((t.mode&hn)!=mn)throw it("ENOTDIR");const n={};for(const t of this.keys())Fr(t)==e&&t!=e&&(n[Rr(t)]=this.get(t).ino);return n}_alloc(){return Math.max(...[...this.values()].flatMap(e=>[e.ino,e.data]))+1}directories(){const e=new Map;for(const[t,n]of this){if((n.mode&hn)!=mn)continue;const r={};for(const e of this.keys())Fr(e)==t&&e!=t&&(r[Rr(e)]=this.get(e).ino);e.set(t,r)}return e}fromJSON(e){if(e.version!=li)throw it("EINVAL","Index version mismatch");this.clear();for(const[t,n]of Object.entries(e.entries))n.data??=qe(1,Pn),"/"==t&&(n.ino=0),this.set(t,new Qr(n));return this}static parse(e){if(!ze(e))throw it("EINVAL","Invalid JSON");const t=JSON.parse(e),n=new ui;return n.fromJSON(t),n}}const hi=4096;class di{type;name;label;_mountPoint;_uuid=crypto.randomUUID();get uuid(){return this._uuid}attributes=new Map;constructor(e,t){this.type=e,this.name=t,this.streamRead===di.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===di.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){return`${this.name} ${this.label?JSON.stringify(this.label):""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(e){try{return await this.stat(e),!0}catch(e){return"ENOENT"!=e.code}}existsSync(e){try{return this.statSync(e),!0}catch(e){return"ENOENT"!=e.code}}streamRead(e,t){return new ReadableStream({start:async n=>{const{size:r}=await this.stat(e),{start:i=0,end:s=r}=t;for(let t=i;t<s;t+=hi){const r=t+hi>s?s-t:hi,i=new Uint8Array(r);await this.read(e,i,t,t+r).catch(n.error.bind(n)),n.enqueue(i)}n.close()},type:"bytes"})}streamWrite(e,t){let n=t.start??0;return new WritableStream({write:async(t,r)=>{let i=!1;const s=e=>{i=!0,r.error(e)},{size:a}=await this.stat(e);await this.write(e,t,n).catch(s),i||(n+=t.byteLength,await this.touch(e,{mtimeMs:Date.now(),size:Math.max(a,n)}).catch(s))}})}}class fi{id;_size;options;regions=[];get size(){return this._size}set size(e){if(e>=this._size)this._size=e;else{this._size=e;for(let t=this.regions.length-1;t>=0;t--){const n=this.regions[t];if(n.offset>=e){this.regions.splice(t,1);continue}const r=e-n.offset;n.data.byteLength>r&&(n.data=n.data.subarray(0,r)),n.ranges=n.ranges.filter(t=>t.start<e).map(t=>t.end>e?{start:t.start,end:e}:t)}}}constructor(e,t,n,r){this.id=e,this._size=t,this.options=n,n.sparse??=!0,n.sparse||this.regions.push({offset:0,data:new Uint8Array(t),ranges:[]}),r?.set(e,this)}collect(){if(!this.options.sparse)return;const{regionGapThreshold:e=4095}=this.options;for(let t=0;t<this.regions.length-1;){const n=this.regions[t],r=this.regions[t+1];r.offset-(n.offset+n.data.byteLength)>e?t++:(n.ranges.push(...r.ranges),n.ranges.sort((e,t)=>e.start-t.start),n.ranges=n.ranges.reduce((e,t)=>(!e.length||e.at(-1).end<t.start?e.push(t):e.at(-1).end=Math.max(e.at(-1).end,t.end),e),[]),n.data=hr(n.data,r.offset+r.data.byteLength),n.data.set(r.data,r.offset-n.offset),this.regions.splice(t+1,1))}}missing(e,t){const n=[];for(const r of this.regions){if(r.offset>=t)break;for(const i of r.ranges)if(!(i.end<=e)){if(i.start>=t)break;if(i.start>e&&n.push({start:e,end:Math.min(i.start,t)}),i.end>e&&(e=Math.max(e,i.end)),e>=t)break}if(e>=t)break}return e<t&&n.push({start:e,end:t}),n}cached(e,t){const n=[];for(const r of this.regions){if(r.offset>=t)break;for(const i of r.ranges)if(!(i.end<=e)){if(i.start>=t)break;n.push({start:Math.max(e,i.start),end:Math.min(t,i.end)})}}n.sort((e,t)=>e.start-t.start);const r=[];for(const e of n){const t=r.at(-1);t&&e.start<=t.end?t.end=Math.max(t.end,e.end):r.push(e)}return r}regionAt(e){if(this.regions.length)for(const t of this.regions){if(t.offset>e)break;if(e>=t.offset&&e<t.offset+t.data.byteLength)return t}}add(e,t){const n=t+e.byteLength,r=this.regionAt(t);if(r)return r.data=hr(r.data,n),r.data.set(e,t),r.ranges.push({start:t,end:n}),r.ranges.sort((e,t)=>e.start-t.start),this.collect(),this;const i={data:e,offset:t,ranges:[{start:t,end:n}]},s=this.regions.findIndex(e=>e.offset>t);return-1==s?this.regions.push(i):this.regions.splice(s,0,i),this.collect(),this}}Promise.withResolvers??=(mt("Using a polyfill of Promise.withResolvers"),function(){let e,t;const n=new Promise((n,r)=>{e=n,t=r});return{promise:n,resolve:e,reject:t}}),Symbol.dispose??=(mt("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")),Symbol.asyncDispose??=(mt("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")),globalThis.crypto.randomUUID??=(mt("Using a polyfill of crypto.randomUUID"),function(){const e=crypto.getRandomValues(new Uint8Array(16));e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=[...e].map(e=>e.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}),Uint8Array.prototype.toBase64??=(mt("Using a polyfill of Uint8Array.prototype.toBase64"),function(){return btoa(String.fromCharCode(...this))}),Uint8Array.fromBase64??=(mt("Using a polyfill of Uint8Array.fromBase64"),function(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}),Uint8Array.prototype.toHex??=(mt("Using a polyfill of Uint8Array.prototype.toHex"),function(){return[...this].map(e=>e.toString(16).padStart(2,"0")).join("")}),Uint8Array.fromHex??=(mt("Using a polyfill of Uint8Array.fromHex"),function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return t});class pi{store;constructor(e){this.store=e}}class gi extends pi{async get(e,t,n){return this.getSync(e,t,n)}async set(e,t,n){return this.setSync(e,t,n)}async remove(e){return this.removeSync(e)}}class mi extends pi{asyncDone=Promise.resolve();async(e){this.asyncDone=this.asyncDone.then(()=>e)}_cached(e,t){this.store.cache??=new Map;const n=this.store.cache.get(e);return n?(t&&(n.size=t.size),n):t?new fi(e,t.size,{},this.store.cache):void 0}getSync(e,t,n){const r=this._cached(e);if(!r)return;n??=r.size;const i=r.missing(t,n);for(const{start:t,end:n}of i)this.async(this.get(e,t,n));if(i.length)throw it("EAGAIN");const s=r.regionAt(t);if(s)return s.data.subarray(t-s.offset,n-s.offset);mt("Missing cache region for "+e)}setSync(e,t,n){this.async(this.set(e,t,n))}removeSync(e){this.async(this.remove(e)),this.store.cache?.delete(e)}}class yi{raw;fs;done=!1;flag(e){return this.raw.store.flags?.includes(e)??!1}constructor(e,t){this.raw=e,this.fs=t}originalData=new Map;modifiedKeys=new Set;keys(){return this.raw.keys()}async get(e,t=0,n){const r=await this.raw.get(e,t,n);return this.stash(e),r}getSync(e,t=0,n){const r=this.raw.getSync(e,t,n);return this.stash(e),r}async set(e,t,n=0){await this.markModified(e,n,t.byteLength);const r=t instanceof Uint8Array?t:new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await this.raw.set(e,r,n)}setSync(e,t,n=0){this.markModifiedSync(e,n,t.byteLength);const r=t instanceof Uint8Array?t:new Uint8Array(t.buffer,t.byteOffset,t.byteLength);this.raw.setSync(e,r,n)}async remove(e){await this.markModified(e,0,void 0),await this.raw.remove(e)}removeSync(e){this.markModifiedSync(e,0,void 0),this.raw.removeSync(e)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[e,t]of this.originalData)if(this.modifiedKeys.has(e))if(t.some(e=>!e.data))await this.raw.remove(e),this.fs._remove(e);else for(const n of t.reverse())await this.raw.set(e,n.data,n.offset);this.done=!0}}abortSync(){if(!this.done){for(const[e,t]of this.originalData)if(this.modifiedKeys.has(e))if(t.some(e=>!e.data))this.raw.removeSync(e),this.fs._remove(e);else for(const n of t.reverse())this.raw.setSync(e,n.data,n.offset);this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(e,t,n=0){this.originalData.has(e)||this.originalData.set(e,[]),this.originalData.get(e).push({data:t,offset:n})}async markModified(e,t,n){this.modifiedKeys.add(e);const r=n?t+n:void 0;try{this.stash(e,await this.raw.get(e,t,r),t)}catch(n){if(!(this.raw instanceof mi))throw n;const i=this.raw._cached(e);if(!i)throw n;for(const n of i.cached(t,r??t))this.stash(e,await this.raw.get(e,n.start,n.end),n.start)}}markModifiedSync(e,t,n){this.modifiedKeys.add(e);const r=n?t+n:void 0;try{this.stash(e,this.raw.getSync(e,t,r),t)}catch(n){if(!(this.raw instanceof mi))throw n;const i=this.raw._cached(e);if(!i)throw n;for(const n of i.cached(t,r??t))this.stash(e,this.raw.getSync(e,n.start,n.end),n.start)}}}var bi=function(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},wi=function(e){return function(t){function n(n){t.error=t.hasError?new e(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(e,function(t){return n(t),e()})}else i|=1}catch(e){n(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class vi extends di{store;_ids=new Map([["/",0]]);_paths=new Map([[0,new Set("/")]]);_path(e){const[t]=this._paths.get(e)??[];return t}_add(e,t){this._paths.has(e)||this._paths.set(e,new Set),this._paths.get(e).add(t),this._ids.set(t,e)}_remove(e){for(const t of this._paths.get(e)??[])this._ids.delete(t);this._paths.delete(e)}_move(e,t){const n=[];for(const[r,i]of this._ids){const s=Ar(e,r);if(s.startsWith(".."))continue;let a=Cr(t,s);a.endsWith("/")&&(a=a.slice(0,-1)),n.push({oldKey:r,newKey:a,ino:i})}for(const{oldKey:e,newKey:t,ino:r}of n){this._ids.delete(e),this._ids.set(t,r);const n=this._paths.get(r);n?(n.delete(e),n.add(t)):mt("Missing paths in table for ino "+r)}}_initialized=!1;async ready(){this._initialized||(this.attributes.has("no_async_preload")||this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(e){super(e.type??1802921587,e.name),this.store=e,e.fs=this,this._uuid=e.uuid??this.uuid,this.label=e.label,wt(this.name+": supports features: "+this.store.flags?.join(", "))}usage(){return this.store.usage?.()||{totalSpace:0,freeSpace:0}}async loadIndex(e){const t={stack:[],error:void 0,hasError:!1};try{const n=bi(t,this.transaction(),!0),r=e.directories();for(const[t,i]of e)this._add(i.ino,t),await n.set(i.ino,i),r.has(t)&&await n.set(i.data,pr(r.get(t)));await n.commit()}catch(e){t.error=e,t.hasError=!0}finally{const e=wi(t);e&&await e}}loadIndexSync(e){const t={stack:[],error:void 0,hasError:!1};try{const n=bi(t,this.transaction(),!1),r=e.directories();for(const[t,i]of e)this._add(i.ino,t),n.setSync(i.ino,i),r.has(t)&&n.setSync(i.data,pr(r.get(t)));n.commitSync()}catch(e){t.error=e,t.hasError=!0}finally{wi(t)}}async createIndex(){const e={stack:[],error:void 0,hasError:!1};try{const t=new ui,n=bi(e,this.transaction(),!0),r=[["/",0]],i=He(it("EDEADLK"));for(;r.length;){const[e,i]=r.shift(),s=new Qr(await n.get(i));if(t.set(e,s),s.mode&mn){const t=fr(await n.get(s.data)??$e(it("ENODATA")));for(const[n,i]of Object.entries(t))r.push([Cr(e,n),i])}}return i(),t}catch(t){e.error=t,e.hasError=!0}finally{const t=wi(e);t&&await t}}createIndexSync(){const e={stack:[],error:void 0,hasError:!1};try{const t=new ui,n=bi(e,this.transaction(),!1),r=[["/",0]],i=He(it("EDEADLK"));for(;r.length;){const[e,i]=r.shift(),s=new Qr(n.getSync(i));if(t.set(e,s),s.mode&mn){const t=fr(n.getSync(s.data)??$e(it("ENODATA")));for(const[n,i]of Object.entries(t))r.push([Cr(e,n),i])}}return i(),t}catch(t){e.error=t,e.hasError=!0}finally{wi(e)}}async rename(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!0),i=Or(e),s=Or(t),a=await this.findInode(r,i.dir),o=fr(await r.get(a.data)??$e(it("ENODATA")));if(!o[i.base])throw it("ENOENT");const c=o[i.base];if(c!=this._ids.get(e)&&gt(`Ino mismatch while renaming ${e} to ${t}`),delete o[i.base],(s.dir+"/").startsWith(e+"/"))throw it("EBUSY");const l=s.dir==i.dir,u=l?a:await this.findInode(r,s.dir),h=l?o:fr(await r.get(u.data)??$e(it("ENODATA")));if(h[s.base]){const e=new Qr(await r.get(h[s.base])??$e(it("ENOENT")));if(!ei(e))throw it("EISDIR");await r.remove(e.data),await r.remove(h[s.base])}h[s.base]=c,await r.set(a.data,pr(o)),await r.set(u.data,pr(h)),await r.commit(),this._move(e,t)}catch(e){n.error=e,n.hasError=!0}finally{const e=wi(n);e&&await e}}renameSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!1),i=Or(e),s=Or(t),a=this.findInodeSync(r,i.dir),o=fr(r.getSync(a.data)??$e(it("ENODATA")));if(!o[i.base])throw it("ENOENT");const c=o[i.base];if(c!=this._ids.get(e)&&gt(`Ino mismatch while renaming ${e} to ${t}`),delete o[i.base],(s.dir+"/").startsWith(e+"/"))throw it("EBUSY");const l=s.dir===i.dir,u=l?a:this.findInodeSync(r,s.dir),h=l?o:fr(r.getSync(u.data)??$e(it("ENODATA")));if(h[s.base]){const e=new Qr(r.getSync(h[s.base])??$e(it("ENOENT")));if(!ei(e))throw it("EISDIR");r.removeSync(e.data),r.removeSync(h[s.base])}h[s.base]=c,r.setSync(a.data,pr(o)),r.setSync(u.data,pr(h)),r.commitSync(),this._move(e,t)}catch(e){n.error=e,n.hasError=!0}finally{wi(n)}}async stat(e){const t={stack:[],error:void 0,hasError:!1};try{const n=bi(t,this.transaction(),!0);return await this.findInode(n,e)}catch(e){t.error=e,t.hasError=!0}finally{const e=wi(t);e&&await e}}statSync(e){const t={stack:[],error:void 0,hasError:!1};try{const n=bi(t,this.transaction(),!1);return this.findInodeSync(n,e)}catch(e){t.error=e,t.hasError=!0}finally{wi(t)}}async touch(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!0),i=await this.findInode(r,e);i.update(t)&&(this._add(i.ino,e),r.setSync(i.ino,i)),await r.commit()}catch(e){n.error=e,n.hasError=!0}finally{const e=wi(n);e&&await e}}touchSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!1),i=this.findInodeSync(r,e);i.update(t)&&(this._add(i.ino,e),r.setSync(i.ino,i)),r.commitSync()}catch(e){n.error=e,n.hasError=!0}finally{wi(n)}}async createFile(e,t){return t.mode|=pn,await this.commitNew(e,t,new Uint8Array)}createFileSync(e,t){return t.mode|=pn,this.commitNewSync(e,t,new Uint8Array)}async unlink(e){return this.remove(e,!1)}unlinkSync(e){this.removeSync(e,!1)}async rmdir(e){if((await this.readdir(e)).length)throw it("ENOTEMPTY");await this.remove(e,!0)}rmdirSync(e){if(this.readdirSync(e).length)throw it("ENOTEMPTY");this.removeSync(e,!0)}async mkdir(e,t){return t.mode|=mn,await this.commitNew(e,t,Ye("{}"))}mkdirSync(e,t){return t.mode|=mn,this.commitNewSync(e,t,Ye("{}"))}async readdir(e){const t={stack:[],error:void 0,hasError:!1};try{const n=bi(t,this.transaction(),!0),r=await this.findInode(n,e);return Object.keys(fr(await n.get(r.data)??$e(it("ENOENT"))))}catch(e){t.error=e,t.hasError=!0}finally{const e=wi(t);e&&await e}}readdirSync(e){const t={stack:[],error:void 0,hasError:!1};try{const n=bi(t,this.transaction(),!1),r=this.findInodeSync(n,e);return Object.keys(fr(n.getSync(r.data)??$e(it("ENOENT"))))}catch(e){t.error=e,t.hasError=!0}finally{wi(t)}}async sync(){}syncSync(){}async link(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!0),i=Fr(t),s=await this.findInode(r,i),a=fr(await r.get(s.data)??$e(it("ENOENT"))),o=await this.findInode(r,e);o.nlink++,a[Rr(t)]=o.ino,this._add(o.ino,t),await r.set(o.ino,o),await r.set(s.data,pr(a)),await r.commit()}catch(e){n.error=e,n.hasError=!0}finally{const e=wi(n);e&&await e}}linkSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!1),i=Fr(t),s=this.findInodeSync(r,i),a=fr(r.getSync(s.data)??$e(it("ENOENT"))),o=this.findInodeSync(r,e);o.nlink++,a[Rr(t)]=o.ino,this._add(o.ino,t),r.setSync(o.ino,o),r.setSync(s.data,pr(a)),r.commitSync()}catch(e){n.error=e,n.hasError=!0}finally{wi(n)}}async read(e,t,n,r){const i={stack:[],error:void 0,hasError:!1};try{const s=bi(i,this.transaction(),!0),a=await this.findInode(s,e);if(0==a.size)return;const o=await s.get(a.data,n,r)??$e(it("ENODATA")),c=s.flag("partial")?o:o.subarray(n,r);c.byteLength>t.byteLength&&gt(`Trying to place ${c.byteLength} bytes into a ${t.byteLength} byte buffer on read`),t.set(c)}catch(e){i.error=e,i.hasError=!0}finally{const e=wi(i);e&&await e}}readSync(e,t,n,r){const i={stack:[],error:void 0,hasError:!1};try{const s=bi(i,this.transaction(),!1),a=this.findInodeSync(s,e);if(0==a.size)return;const o=s.getSync(a.data,n,r)??$e(it("ENODATA")),c=s.flag("partial")?o:o.subarray(n,r);c.byteLength>t.byteLength&&gt(`Trying to place ${c.byteLength} bytes into a ${t.byteLength} byte buffer on read`),t.set(c)}catch(e){i.error=e,i.hasError=!0}finally{wi(i)}}async write(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=bi(r,this.transaction(),!0),s=await this.findInode(i,e);let a=t;i.flag("partial")||(a=hr(await i.get(s.data)??new Uint8Array,n+t.byteLength),a.set(t,n),n=0),await i.set(s.data,a,n),this._add(s.ino,e),await i.commit()}catch(e){r.error=e,r.hasError=!0}finally{const e=wi(r);e&&await e}}writeSync(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=bi(r,this.transaction(),!1),s=this.findInodeSync(i,e);let a=t;i.flag("partial")||(a=hr(i.getSync(s.data)??new Uint8Array,n+t.byteLength),a.set(t,n),n=0),i.setSync(s.data,a,n),this._add(s.ino,e),i.commitSync()}catch(e){r.error=e,r.hasError=!0}finally{wi(r)}}transaction(){return new yi(this.store.transaction(),this)}async checkRoot(){const e={stack:[],error:void 0,hasError:!1};try{const t=bi(e,this.transaction(),!0);if(await t.get(Hr))return;const n=new Qr({ino:Hr,data:1,mode:511|mn});await t.set(n.data,Ye("{}")),this._add(Hr,"/"),await t.set(Hr,n),await t.commit()}catch(t){e.error=t,e.hasError=!0}finally{const t=wi(e);t&&await t}}checkRootSync(){const e={stack:[],error:void 0,hasError:!1};try{const t=bi(e,this.transaction(),!1);if(t.getSync(Hr))return;const n=new Qr({ino:Hr,data:1,mode:511|mn});t.setSync(n.data,Ye("{}")),this._add(Hr,"/"),t.setSync(Hr,n),t.commitSync()}catch(t){e.error=t,e.hasError=!0}finally{wi(e)}}async _populate(){const e={stack:[],error:void 0,hasError:!1};try{if(this._initialized)return void mt("Attempted to populate tables after initialization");wt("Populating tables with existing store metadata");const t=bi(e,this.transaction(),!0),n=await t.get(Hr);if(!n){yt("Store does not have a root inode");const e=new Qr({ino:Hr,data:1,mode:511|mn});return await t.set(e.data,Ye("{}")),this._add(Hr,"/"),await t.set(Hr,e),void await t.commit()}if(n.length<ur(Qr))return void pt("Store contains an invalid root inode. Refusing to populate tables");const r=new Set;let i=0;const s=[["/",Hr]];for(;s.length>0;){i++;const[e,n]=s.shift();this._add(n,e);const a=await t.get(n);if(!a){mt("Store is missing data for inode: "+n);continue}if(a.length<ur(Qr)){mt(`Invalid inode size for ino ${n}: ${a.length}`);continue}const o=new Qr(a);if((o.mode&mn)!=mn||r.has(n))continue;r.add(n);const c=await t.get(o.data);if(!c){mt("Store is missing directory data: "+o.data);continue}const l=fr(c);for(const[t,n]of Object.entries(l))s.push([Cr(e,t),n])}wt(`Added ${i} existing inode(s) from store`)}catch(t){e.error=t,e.hasError=!0}finally{const t=wi(e);t&&await t}}async _findInode(e,t,n=new Set){if(n.has(t))throw pt(it("EIO","Infinite loop detected while finding inode"));if(n.add(t),"/"==t)return new Qr(await e.get(Hr)??$e(it("ENODATA")));const{dir:r,base:i}=Or(t),s=await this._findInode(e,r,n),a=fr(await e.get(s.data)??$e(it("ENODATA")));if(!(i in a))throw it("ENOENT");return new Qr(await e.get(a[i])??$e(it("ENODATA")))}_findInodeSync(e,t,n=new Set){if(n.has(t))throw pt(it("EIO","Infinite loop detected while finding inode"));if(n.add(t),"/"==t)return new Qr(e.getSync(Hr)??$e(it("ENOENT")));const{dir:r,base:i}=Or(t),s=this._findInodeSync(e,r,n),a=fr(e.getSync(s.data)??$e(it("ENODATA")));if(!(i in a))throw it("ENOENT");return new Qr(e.getSync(a[i])??$e(it("ENODATA")))}async findInode(e,t){if(this.attributes.has("no_id_tables"))return await this._findInode(e,t);const n=this._ids.get(t);if(void 0===n)throw it("ENOENT");return new Qr(await e.get(n)??$e(it("ENOENT")))}findInodeSync(e,t){if(this.attributes.has("no_id_tables"))return this._findInodeSync(e,t);const n=this._ids.get(t);if(void 0===n)throw it("ENOENT");return new Qr(e.getSync(n)??$e(it("ENOENT")))}_lastID;allocNew(e){this._lastID??=Math.max(...this._paths.keys()),this._lastID+=2;const t=this._lastID;if(t>Pn)throw gt(it("ENOSPC","No IDs available"));return this._add(t,e),t}async commitNew(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{if("/"==e)throw it("EEXIST");const i=bi(r,this.transaction(),!0),{dir:s,base:a}=Or(e),o=await this.findInode(i,s),c=fr(await i.get(o.data)??$e(it("ENOENT")));if(c[a])throw it("EEXIST");const l=this.allocNew(e),u=new Qr({...t,ino:l,data:l+1,size:n.byteLength,nlink:1});return await i.set(u.ino,u),await i.set(u.data,n),c[a]=u.ino,await i.set(o.data,pr(c)),await i.commit(),u}catch(e){r.error=e,r.hasError=!0}finally{const e=wi(r);e&&await e}}commitNewSync(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{if("/"==e)throw it("EEXIST");const i=bi(r,this.transaction(),!1),{dir:s,base:a}=Or(e),o=this.findInodeSync(i,s),c=fr(i.getSync(o.data)??$e(it("ENOENT")));if(c[a])throw it("EEXIST");const l=this.allocNew(e),u=new Qr({...t,ino:l,data:l+1,size:n.byteLength,nlink:1});return i.setSync(u.ino,u),i.setSync(u.data,n),c[a]=u.ino,i.setSync(o.data,pr(c)),i.commitSync(),u}catch(e){r.error=e,r.hasError=!0}finally{wi(r)}}async remove(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!0),{dir:i,base:s}=Or(e),a=await this.findInode(r,i),o=fr(await r.get(a.data)??$e(it("ENOENT")));if(!o[s])throw it("ENOENT");const c=o[s],l=new Qr(await r.get(c)??$e(it("ENOENT")));if(delete o[s],!t&&ti(l))throw it("EISDIR");await r.set(a.data,pr(o)),l.nlink>1?(l.update({nlink:l.nlink-1}),await r.set(l.ino,l)):(await r.remove(l.data),await r.remove(c),this._remove(c)),await r.commit()}catch(e){n.error=e,n.hasError=!0}finally{const e=wi(n);e&&await e}}removeSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=bi(n,this.transaction(),!1),{dir:i,base:s}=Or(e),a=this.findInodeSync(r,i),o=fr(r.getSync(a.data)??$e(it("ENOENT"))),c=o[s];if(!c)throw it("ENOENT");const l=new Qr(r.getSync(c)??$e(it("ENOENT")));if(delete o[s],!t&&ti(l))throw it("EISDIR");r.setSync(a.data,pr(o)),l.nlink>1?(l.update({nlink:l.nlink-1}),r.setSync(l.ino,l)):(r.removeSync(l.data),r.removeSync(c),this._remove(c)),r.commitSync()}catch(e){n.error=e,n.hasError=!0}finally{wi(n)}}}class Si extends gi{async keys(){return this.store.keys()}async get(e){return await(this.store.getAsync?.(e)??this.store.get(e))}getSync(e){return this.store.get(e)}setSync(e,t){this.store.set(e,t)}removeSync(e){this.store.delete(e)}}class xi extends mi{async keys(){return await this.asyncDone,this.store.keys()}async get(e,t,n){return await this.asyncDone,await this.store.get(e,t,n)}getSync(e,t,n){return this.store.cached(e,t,n)}async set(e,t,n=0){await this.asyncDone,await this.store.set(e,t,n)}async remove(e){await this.asyncDone,await this.store.delete(e)}}class Ei extends Map{maxSize;label;flags=[];name="tmpfs";constructor(e=Pn,t){super(),this.maxSize=e,this.label=t}async sync(){}transaction(){return new Si(this)}get bytes(){let e=4*this.size;for(const t of this.values())e+=t.byteLength;return e}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const Ii={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new vi(new Ei(e,t));return n.checkRootSync(),n}},ki=Ii;class Ti extends vi{devices=new Map;devicesWithDriver(e,t){if(t&&"string"==typeof e)throw gt(it("EINVAL","Can not fetch devices using only a driver name"));const n=[];for(const r of this.devices.values())t&&r.driver!=e||("string"==typeof e?e:e.name)==r.driver.name&&n.push(r);return n}_createDevice(e,t={}){let n=1;const r=Array.from(this.devices.values()).at(-1);for(;this.store.has(n)||r?.inode.ino==n;)n++;const i=e.init?.(n,t),s={data:{},minor:0,major:0,...je(i??{},"metadata"),driver:e,inode:new Qr({mode:438|yn,...i?.metadata})},a="/"+(s.name||e.name)+(e.singleton?"":this.devicesWithDriver(e).length);if(this.existsSync(a))throw it("EEXIST");return this.devices.set(a,s),bt("Initialized device: "+this._mountPoint+a),s}addDefaults(){this._createDevice(Ci),this._createDevice(Ai),this._createDevice(Fi),this._createDevice(Ri),this._createDevice(Mi),wt("Added default devices")}constructor(){super(new Ei(16777216,"devfs"))}async rename(e,t){if(this.devices.has(e))throw it("EPERM");if(this.devices.has(t))throw it("EEXIST");return super.rename(e,t)}renameSync(e,t){if(this.devices.has(e))throw it("EPERM");if(this.devices.has(t))throw it("EEXIST");return super.renameSync(e,t)}async stat(e){const t=this.devices.get(e);return t?t.inode:super.stat(e)}statSync(e){const t=this.devices.get(e);return t?t.inode:super.statSync(e)}async touch(e,t){const n=this.devices.get(e);n?n.inode.update(t):await super.touch(e,t)}touchSync(e,t){const n=this.devices.get(e);n?n.inode.update(t):super.touchSync(e,t)}async createFile(e,t){if(this.devices.has(e))throw it("EEXIST");return super.createFile(e,t)}createFileSync(e,t){if(this.devices.has(e))throw it("EEXIST");return super.createFileSync(e,t)}async unlink(e){if(this.devices.has(e))throw it("EPERM");return super.unlink(e)}unlinkSync(e){if(this.devices.has(e))throw it("EPERM");return super.unlinkSync(e)}async rmdir(e){return super.rmdir(e)}rmdirSync(e){return super.rmdirSync(e)}async mkdir(e,t){if(this.devices.has(e))throw it("EEXIST");return super.mkdir(e,t)}mkdirSync(e,t){if(this.devices.has(e))throw it("EEXIST");return super.mkdirSync(e,t)}async readdir(e){const t=await super.readdir(e);for(const n of this.devices.keys())Fr(n)==e&&t.push(Rr(n));return t}readdirSync(e){const t=super.readdirSync(e);for(const n of this.devices.keys())Fr(n)==e&&t.push(Rr(n));return t}async link(e,t){if(this.devices.has(e))throw it("EPERM");if(this.devices.has(t))throw it("EEXIST");return super.link(e,t)}linkSync(e,t){if(this.devices.has(e))throw it("EPERM");if(this.devices.has(t))throw it("EEXIST");return super.linkSync(e,t)}async sync(){for(const e of this.devices.values())e.driver.sync?.(e);return super.sync()}syncSync(){for(const e of this.devices.values())e.driver.sync?.(e);return super.syncSync()}async read(e,t,n,r){const i=this.devices.get(e);i?i.driver.read(i,t,n,r):await super.read(e,t,n,r)}readSync(e,t,n,r){const i=this.devices.get(e);i?i.driver.read(i,t,n,r):super.readSync(e,t,n,r)}async write(e,t,n){const r=this.devices.get(e);if(!r)return await super.write(e,t,n);r.driver.write(r,t,n)}writeSync(e,t,n){const r=this.devices.get(e);if(!r)return super.writeSync(e,t,n);r.driver.write(r,t,n)}}const _i=new Uint8Array,Ci={name:"null",singleton:!0,init:()=>({major:1,minor:3}),read:()=>_i,write(){}},Ai={name:"zero",singleton:!0,init:()=>({major:1,minor:5}),read(e,t,n,r){t.fill(0,n,r)},write(){}},Fi={name:"full",singleton:!0,init:()=>({major:1,minor:7}),read(e,t,n,r){t.fill(0,n,r)},write(){throw it("ENOSPC")}},Ri={name:"random",singleton:!0,init:()=>({major:1,minor:8}),read(e,t){for(let e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())},write(){}},Mi={name:"console",singleton:!0,init:(e,{output:t=e=>console.log(e)}={})=>({major:5,minor:1,data:{output:t}}),read:()=>_i,write(e,t,n){const r=Je(t);e.data.output(r,n)}},Di={null:Ci,zero:Ai,full:Fi,random:Ri,console:Mi};var Oi=__webpack_require__(1048);let Pi=!0;var Ni;function Li(e){return(61440&e)>>12}function Bi(e){return e<<12}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.FIFO=1]="FIFO",e[e.CHR=2]="CHR",e[e.DIR=4]="DIR",e[e.BLK=6]="BLK",e[e.REG=8]="REG",e[e.LNK=10]="LNK",e[e.SOCK=12]="SOCK",e[e.WHT=14]="WHT"}(Ni||(Ni={}));class Ui{ino;type;path;name}class Vi{context;path;fs;internalPath;flag;inode;_buffer;_position=0;get position(){return this.flag&tn?this.inode.size:this._position}set position(e){this._position=e}dirty=!1;closed=!1;get isClosed(){return this.closed}constructor(e,t,n,r,i,s){this.context=e,this.path=t,this.fs=n,this.internalPath=r,this.flag=i,this.inode=s}get _isSync(){return!!(this.flag&an||this.inode.flags&Kr.Sync||this.fs.attributes.has("sync"))}[Symbol.dispose](){this.closeSync()}syncSync(){if(this.closed)throw rt("EBADF","sync",this.path);this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasyncSync(){return this.syncSync()}closeSync(){if(this.closed)throw rt("EBADF","close",this.path);this.syncSync(),this.disposeSync()}disposeSync(e){if(this.closed)throw rt("EBADF","close",this.path);if(this.dirty&&!e)throw rt("EBUSY","close",this.path);this.closed=!0}truncateSync(e){if(e<0)throw rt("EINVAL","truncate",this.path);if(this.closed)throw rt("EBADF","truncate",this.path);if(!(this.flag&Yt||this.flag&Kt))throw rt("EBADF","truncate",this.path);if(this.fs.attributes.has("readonly"))throw rt("EROFS","truncate",this.path);if(this.inode.flags&Kr.Immutable)throw rt("EPERM","truncate",this.path);this.dirty=!0,this.inode.mtimeMs=Date.now(),this.inode.size=e,this.inode.ctimeMs=Date.now(),this._isSync&&this.syncSync()}writeSync(e,t=0,n=e.byteLength-t,r=this.position){if(this.closed)throw rt("EBADF","write",this.path);if(!(this.flag&Yt||this.flag&Kt))throw rt("EBADF","write",this.path);if(this.fs.attributes.has("readonly"))throw rt("EROFS","write",this.path);if(this.inode.flags&Kr.Immutable)throw rt("EPERM","write",this.path);this.dirty=!0;const i=r+n,s=e.subarray(t,t+n);return!si(this.inode)&&!ii(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=r+s.byteLength,this.fs.writeSync(this.internalPath,s,r),this._isSync&&this.syncSync(),s.byteLength}readSync(e,t=0,n=e.byteLength-t,r=this.position){if(this.closed)throw rt("EBADF","read",this.path);if(this.flag&Yt)throw rt("EBADF","read",this.path);this.inode.flags&Kr.NoAtime||this.fs.attributes.has("no_atime")||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=r+n;!si(this.inode)&&!ii(this.inode)&&i>this.inode.size&&(i=r+Math.max(this.inode.size-r,0)),this._position=i;const s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return this.fs.readSync(this.internalPath,s.subarray(t,t+n),r,i),this._isSync&&this.syncSync(),i-r}chmodSync(e){if(this.closed)throw rt("EBADF","chmod",this.path);this.dirty=!0,this.inode.mode=this.inode.mode&(e>hn?~hn:hn)|e,(this._isSync||e>hn)&&this.syncSync()}chownSync(e,t){if(this.closed)throw rt("EBADF","chmod",this.path);this.dirty=!0,ci(this.inode,e,t),this._isSync&&this.syncSync()}utimesSync(e,t){if(this.closed)throw rt("EBADF","utimes",this.path);this.dirty=!0,this.inode.atimeMs=e,this.inode.mtimeMs=t,this._isSync&&this.syncSync()}async[Symbol.asyncDispose](){await this.close()}async sync(){if(this.closed)throw rt("EBADF","sync",this.path);this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}async close(){if(this.closed)throw rt("EBADF","close",this.path);await this.sync(),this.dispose()}dispose(e){if(this.closed)throw rt("EBADF","close",this.path);if(this.dirty&&!e)throw rt("EBUSY","close",this.path);this.closed=!0}stat(){if(this.closed)throw rt("EBADF","stat",this.path);return this.inode}async truncate(e){if(e<0)throw rt("EINVAL","truncate",this.path);if(this.closed)throw rt("EBADF","truncate",this.path);if(!(this.flag&Yt||this.flag&Kt))throw rt("EBADF","truncate",this.path);if(this.fs.attributes.has("readonly"))throw rt("EROFS","truncate",this.path);if(this.inode.flags&Kr.Immutable)throw rt("EPERM","truncate",this.path);this.dirty=!0,this.inode.mtimeMs=Date.now(),this.inode.size=e,this.inode.ctimeMs=Date.now(),this._isSync&&await this.sync()}async write(e,t=0,n=e.byteLength-t,r=this.position){if(this.closed)throw rt("EBADF","write",this.path);if(!(this.flag&Yt||this.flag&Kt))throw rt("EBADF","write",this.path);if(this.fs.attributes.has("readonly"))throw rt("EROFS","write",this.path);if(this.inode.flags&Kr.Immutable)throw rt("EPERM","write",this.path);this.dirty=!0;const i=r+n,s=e.subarray(t,t+n);return!si(this.inode)&&!ii(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=r+s.byteLength,await this.fs.write(this.internalPath,s,r),this._isSync&&await this.sync(),s.byteLength}async read(e,t=0,n=e.byteLength-t,r=this.position){if(this.closed)throw rt("EBADF","read",this.path);if(this.flag&Yt)throw rt("EBADF","read",this.path);this.inode.flags&Kr.NoAtime||this.fs.attributes.has("no_atime")||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=r+n;!si(this.inode)&&!ii(this.inode)&&i>this.inode.size&&(i=r+Math.max(this.inode.size-r,0)),this._position=i;const s=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);return await this.fs.read(this.internalPath,s.subarray(t,t+n),r,i),this._isSync&&await this.sync(),i-r}async chmod(e){if(this.closed)throw rt("EBADF","chmod",this.path);this.dirty=!0,this.inode.mode=this.inode.mode&(e>hn?~hn:hn)|e,(this._isSync||e>hn)&&await this.sync()}async chown(e,t){if(this.closed)throw rt("EBADF","chown",this.path);this.dirty=!0,ci(this.inode,e,t),this._isSync&&await this.sync()}async utimes(e,t){if(this.closed)throw rt("EBADF","utimes",this.path);this.dirty=!0,this.inode.atimeMs=e,this.inode.mtimeMs=t,this._isSync&&await this.sync()}streamRead(e){if(this.closed)throw rt("EBADF","streamRead",this.path);return this.fs.streamRead(this.internalPath,e)}streamWrite(e){if(this.closed)throw rt("EBADF","write",this.path);if(this.inode.flags&Kr.Immutable)throw rt("EPERM","write",this.path);if(this.fs.attributes.has("readonly"))throw rt("EROFS","write",this.path);return this.fs.streamWrite(this.internalPath,e)}}function ji(e){const t=e.context?.descriptors??Vt.descriptors,n=Math.max(t.size?Math.max(...t.keys())+1:0,4);return t.set(n,e),n}function zi(e,t){const n=(e?.descriptors??Vt.descriptors).get(t);if(!n)throw it("EBADF");return n}function Gi(e,t){return(e?.descriptors??Vt.descriptors).delete(t)}const Hi=/[rwasx]{1,2}\+?/;function $i(e){if("number"==typeof e)return e;if(!Hi.test(e))throw it("EINVAL","Invalid flag string: "+e);return function(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw it("EINVAL","Invalid flag string: "+e);let t=e.includes("r")?Xt:Jt;return e.includes("w")&&(t|=en),e.includes("a")&&(t|=tn),e.includes("+")?t|=Kt:e.includes("r")||(t|=Yt),e.includes("s")&&(t|=an),e.includes("x")&&(t|=Zt),t}(e)}function Wi(e){let t=0;return e&Yt||(t|=zt),(e&Yt||e&Kt)&&(t|=Gt),t}const qi=nt;function Xi(e,t){return e.path=t,e}function Yi(e,t,n,r){const i="string"==typeof n?{path:n,dest:r,syscall:t.endsWith("Sync")?t.slice(0,-4):t}:n,s=e[t];if("function"!=typeof s)throw new TypeError(`${t} is not a function`);return function(...t){try{return s.call(e,...t)}catch(e){throw tt(Object.assign(e,i))}}}function Ki(e,t){return new Proxy(e,{get(e,n){const r=Reflect.get(e,n);return"function"!=typeof r?r:function n(...i){try{const s=r.apply(e,i);return s instanceof Promise?s.catch(e=>{if("code"in e)throw tt(Object.assign(e,t));if(e in Qe){const r=rt(e,t);Error.captureStackTrace(r,n)}throw e}):s}catch(e){throw tt(Object.assign(e,t))}}}})}const Ji=new Map;function Zi(e,t){if("/"!=e[0]&&(e="/"+e),e=kr.call(this,e),Ji.has(e))throw gt(it("EINVAL","Mount point is already in use: "+e));t._mountPoint=e,Ji.set(e,t),bt(`Mounted ${t.name} on ${e}`),wt(`${t.name} attributes: ${[...t.attributes].map(([e,t])=>null!=t?e+"="+t:e).join(", ")}`)}function Qi(e){"/"!=e[0]&&(e="/"+e),e=kr.call(this,e),Ji.has(e)?(Ji.delete(e),yt("Unmounted "+e)):mt(e+" is already unmounted")}function es(e,t,n){const r=t?.root||Vt.root,i={path:e,...n};e=yr(Cr(r,e));const s=[...Ji].sort((e,t)=>e[0].length>t[0].length?-1:1);for(const[t,n]of s){if(o=e,"/"!==(a=t)&&a!==o&&(a.endsWith("/")||(a+="/"),!o.startsWith(a)))continue;""===(e=e.slice(t.length>1?t.length:0))&&(e="/");const s=n.attributes.get("case_fold");return"lower"===s&&(e=e.toLowerCase()),"upper"===s&&(e=e.toUpperCase()),{fs:Ki(n,i),path:e,mountPoint:t,root:r}}var a,o;throw ft(new nt(Qe.EIO,"No file system for "+e))}function ts(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||Pn),files:(t?BigInt:Number)(n.totalNodes||Pn),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function ns(e){const t=this??Vt;if(!Ut(t.credentials))throw it("EPERM","Can not chroot() as non-root user");t.root??="/";const n=Cr(t.root,e);for(const e of t.descriptors?.values()??[]){if(!e.path.startsWith(t.root))throw rt("EBUSY","chroot",e.path);e.path=e.path.slice(t.root.length)}if(n.length>t.root.length)throw it("EPERM","Can not chroot() outside of current root");t.root=n}function rs(e,t,n,r){try{const i=es(t,e),s=i.fs.statSync(i.path);return!ni(s)||n?{...i,fullPath:t,stats:s}:rs(e,kr.call(e,Fr(t),ss.call(e,t)),n,r)}catch(e){if(tt(Object.assign(e,{syscall:"stat",path:t})),n)throw e}const{base:i,dir:s}=Or(t),a="/"==s?"/":rs(e,s,!1,r).fullPath,o=Cr(a,i),c=es(o,e);let l;try{l=c.fs.statSync(c.path)}catch(e){if("ENOENT"===e.code)return{...c,fullPath:t};throw tt(Object.assign(e,{syscall:"stat",path:o}))}return ni(l)?rs(e,kr.call(e,a,ss.call(e,o)),!1,r):{...c,fullPath:o,stats:l}}function is(e,t){e=yr(e);const n=gr(t.mode,420),r=$i(t.flag);e=t.preserveSymlinks?e:rs(this,e).fullPath;const{fs:i,path:s}=es(e,this);let a;try{a=i.statSync(s)}catch{}if(!a){if(!(r&Jt))throw rt("ENOENT","open",e);const a=i.statSync(Fr(s));if(Pi&&!oi(this,a,Gt))throw rt("EACCES","open",e);if(!ti(a))throw rt("ENOTDIR","open",e);if(!t.allowDirectory&&n&mn)throw rt("EISDIR","open",e);if(Pi&&!oi(this,a,Gt))throw rt("EACCES","open",e);const{euid:o,egid:c}=this?.credentials??Vt.credentials,l=i.createFileSync(s,{mode:n,uid:a.mode&wn?a.uid:o,gid:a.mode&vn?a.gid:c});return new Vi(this,e,i,s,r,l)}if(Pi&&(!oi(this,a,n)||!oi(this,a,Wi(r))))throw rt("EACCES","open",e);if(r&Zt)throw rt("EEXIST","open",e);const o=new Vi(this,e,i,s,r,a);if(!t.allowDirectory&&a.mode&mn)throw rt("EISDIR","open",e);return r&en&&o.truncateSync(0),o}function ss(e){e=yr(e);const{fs:t,stats:n,path:r}=rs(this,e,!0);if(!n)throw rt("ENOENT","readlink",e);if(Pi&&!oi(this,n,zt))throw rt("EACCES","readlink",e);if(!ni(n))throw rt("EINVAL","readlink",e);const i=n.size,s=new Uint8Array(i);return t.readSync(r,s,0,i),Je(s)}function as(e,t={}){e=yr(e);const{fs:n,path:r}=rs(this,e),{euid:i,egid:s}=this?.credentials??Vt.credentials,{mode:a=511,recursive:o}=t,c=(e,t,r)=>{if(Pi&&!oi(this,r,Gt))throw rt("EACCES","mkdir",Fr(e));const o=n.mkdirSync(t,{mode:a,uid:r.mode&wn?r.uid:i,gid:r.mode&vn?r.gid:s});return la(this,"rename",e),o};if(!o)return void c(e,r,n.statSync(Fr(r)));const l=[];for(let t=r,i=e;!n.existsSync(t);t=Fr(t),i=Fr(i))l.unshift({resolved:t,original:i});if(!l.length)return;const u=[n.statSync(Fr(l[0].resolved))];for(const[e,t]of l.entries())u.push(c(t.original,t.resolved,u[e]));return l[0].original}function os(e,t={}){e=yr(e);const{fs:n,path:r}=rs(this,e),i=n.statSync(r);if(Pi&&!oi(this,i,zt))throw rt("EACCES","readdir",e);if(!ti(i))throw rt("ENOTDIR","readdir",e);const s=n.readdirSync(r),a=[],o=e=>{let i;try{i=n.statSync(Cr(r,e))}catch(e){if("ENOENT"==e.code)return;throw e}const s=new Ui;if(s.ino=i.ino,s.type=Li(i.mode),s.path=e,s.name=Rr(e),a.push(s),!ti(i)||!t?.recursive)return;const c=n.readdirSync(Cr(r,e));for(const t of c)o(Cr(e,t))};for(const e of s)o(e);return a}function cs(e,t){const n={syscall:"rename",path:e=yr(e),dest:t=yr(t)},r=rs(this,e,!0,n),i=es(t,this,n);if(r.fs.uuid!==i.fs.uuid)throw rt("EXDEV",n);if(i.path.startsWith(r.path+"/"))throw rt("EBUSY",n);if(!r.stats)throw rt("ENOENT",n);const s=r.fs,a=s.statSync(Fr(r.path)),o=s.statSync(Fr(i.path));let c;try{c=s.statSync(i.path)}catch(e){if("ENOENT"!=e.code)throw e}if(Pi&&(!oi(this,a,zt)||!oi(this,o,Gt)))throw rt("EACCES",n);if(c&&!ti(r.stats)&&ti(c))throw rt("EISDIR",n);if(c&&ti(r.stats)&&!ti(c))throw rt("ENOTDIR",n);r.fs.renameSync(r.path,i.path),la(this,"rename",e),la(this,"change",t)}function ls(e,t){e=yr(e);const n={syscall:"link",path:t=yr(t),dest:e},{fs:r,path:i}=es(e,this,n),s=es(t,this,n);if(r.uuid!==s.fs.uuid)throw rt("EXDEV",n);const a=r.statSync(i);if(Pi){if(!oi(this,a,zt))throw rt("EACCES",n);if(!oi(this,r.statSync(Fr(i)),zt))throw rt("EACCES",n);if(!oi(this,r.statSync(Fr(s.path)),Gt))throw rt("EACCES",n)}return r.linkSync(i,s.path)}Zi("/",ki.create({label:"root"}));class us{ino;type;_name;get name(){const e=Oi.Buffer.from(this._name);return"buffer"==this._encoding?e:e.toString(this._encoding)}_encoding;_parentPath;get parentPath(){return this._parentPath}get path(){return mt("Dirent.path was removed in Node v24, use parentPath instead"),this._parentPath}static from(e,t){const n=new us,{base:r,dir:i}=Or(e.path);return n._parentPath=i||".",n._name=r,n.ino=e.ino,n.type=e.type,n._encoding=t,n}isFile(){return this.type===Ni.REG}isDirectory(){return this.type===Ni.DIR}isBlockDevice(){return this.type===Ni.BLK}isCharacterDevice(){return this.type===Ni.CHR}isSymbolicLink(){return this.type===Ni.LNK}isFIFO(){return this.type===Ni.FIFO}isSocket(){return this.type===Ni.SOCK}}class hs{path;context;closed=!1;checkClosed(){if(this.closed)throw it("EBADF","Can not use closed Dir")}_entries;constructor(e,t){this.path=e,this.context=t}close(e){if(this.closed=!0,!e)return Promise.resolve();e(null)}closeSync(){this.closed=!0}async _read(){return this.checkClosed(),this._entries??=await Ba.call(this.context,this.path,{withFileTypes:!0}),this._entries.length?this._entries.shift()??null:null}read(e){if(!e)return this._read();this._read().then(t=>e(null,t))}readSync(){return this.checkClosed(),this._entries??=Ls.call(this.context,this.path,{withFileTypes:!0}),this._entries.length?this._entries.shift()??null:null}async next(){const e=await this._read();return e?{done:!1,value:e}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.dispose](){this.closed||this.closeSync()}async[Symbol.asyncDispose](){this.closed||await this.close()}}var ds=function(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},fs=function(e){return function(t){function n(n){t.error=t.hasError?new e(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(e,function(t){return n(t),e()})}else i|=1}catch(e){n(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function ps(e,t){return cs.call(this,e,t)}function gs(e){e=yr(e);try{const{fs:t,path:n}=rs(this,e);return t.existsSync(n)}catch(e){if(e.errno==Qe.ENOENT)return!1;throw e}}function ms(e,t){e=yr(e);const{fs:n,path:r}=rs(this,e);let i;try{i=n.statSync(r)}catch(t){throw tt(Object.assign(t,{path:e}))}if(Pi&&!oi(this,i,zt))throw rt("EACCES",{syscall:"stat",path:e});return t?.bigint?new Ur(i):new Br(i)}function ys(e,t){e=yr(e);const{base:n,dir:r}=Or(e),{fs:i,path:s}=rs(this,r),a=Yi(i,"statSync",e)(n?Cr(s,n):s);if(Pi&&!oi(this,a,zt))throw rt("EACCES",{syscall:"lstat",path:e});return t?.bigint?new Ur(a):new Br(a)}function bs(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=ds(n,is.call(this,e,{flag:"r+"}),!1);if(t||=0,t<0)throw rt("EINVAL","truncate",e.toString());r.truncateSync(t)}catch(e){n.error=e,n.hasError=!0}finally{fs(n)}}function ws(e){e=yr(e);const{fs:t,path:n}=es(e,this);try{if(Pi&&!oi(this,t.statSync(n),Gt))throw rt("EACCES","unlink");t.unlinkSync(n)}catch(t){throw tt(Object.assign(t,{path:e}))}la(this,"rename",e.toString())}function vs(e,t,n=jt){return ji(is.call(this,e,{flag:t,mode:n}))}function Ss(e,t,n){return ji(is.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function xs(e,t={}){const n={stack:[],error:void 0,hasError:!1};try{const r=br(t,null,"r",420);if($i(r.flag)&Yt)throw rt("EBADF","read",e.toString());const i=ds(n,"number"==typeof e?zi(this,e):is.call(this,e.toString(),{flag:r.flag,mode:420,preserveSymlinks:!1}),!1),{size:s}=i.stat(),a=Oi.Buffer.alloc(s);return i.readSync(a,0,s,0),r.encoding?a.toString(r.encoding):a}catch(e){n.error=e,n.hasError=!0}finally{fs(n)}}function Es(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const i=br(n,"utf8","w+",420),s=$i(i.flag);if(!(s&Yt||s&Kt))throw new nt(Qe.EINVAL,"Flag passed to writeFile must allow for writing");if("string"!=typeof t&&!i.encoding)throw new nt(Qe.EINVAL,"Encoding not specified");const a="string"==typeof t?Oi.Buffer.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new nt(Qe.EINVAL,"Data not specified");ds(r,"number"==typeof e?zi(this,e):is.call(this,e.toString(),{flag:s,mode:i.mode,preserveSymlinks:!0}),!1).writeSync(a,0,a.byteLength,0),la(this,"change",e.toString())}catch(e){r.error=e,r.hasError=!0}finally{fs(r)}}function Is(e,t,n={}){const r=br(n,"utf8","a+",420),i=$i(r.flag);if(!(i&tn))throw new nt(Qe.EINVAL,"Flag passed to appendFile must allow for appending");if("string"!=typeof t&&!r.encoding)throw new nt(Qe.EINVAL,"Encoding not specified");const s="string"==typeof t?Oi.Buffer.from(t,r.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a="number"==typeof e?zi(this,e):is.call(this,yr(e),{flag:i,mode:r.mode,preserveSymlinks:!0});a.writeSync(s,0,s.byteLength),"number"!=typeof a&&a.closeSync()}function ks(e,t){const n=zi(this,e).stat();return t?.bigint?new Ur(n):new Br(n)}function Ts(e){zi(this,e).closeSync(),Gi(this,e)}function _s(e,t=0){if(t||=0,t<0)throw new nt(Qe.EINVAL);zi(this,e).truncateSync(t)}function Cs(e){zi(this,e).syncSync()}function As(e){zi(this,e).datasyncSync()}function Fs(e,t,n,r,i){let s,a,o,c;if("string"==typeof t){c="number"==typeof n?n:null;const e="string"==typeof r?r:"utf8";a=0,s=Oi.Buffer.from(t,e),o=s.byteLength}else s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,c="number"==typeof i?i:null;const l=zi(this,e);c??=l.position;const u=l.writeSync(s,a,o,c);return la(this,"change",l.path),u}function Rs(e,t,n,r,i){const s=zi(this,e),a="object"==typeof n?n.offset:n;if("object"==typeof n&&(r=n.length,i=n.position),i&&i>Number.MAX_SAFE_INTEGER)throw rt("EINVAL");return"bigint"==typeof i&&(i=Number(i)),i=Number.isSafeInteger(i)?i:s.position,s.readSync(t,a,r,i)}function Ms(e,t,n){zi(this,e).chownSync(t,n)}function Ds(e,t){const n=gr(t,-1);if(n<0)throw new nt(Qe.EINVAL,"Invalid mode.");zi(this,e).chmodSync(n)}function Os(e,t,n){zi(this,e).utimesSync(mr(t),mr(n))}function Ps(e){e=yr(e);const{fs:t,path:n}=rs(this,e),r=Yi(t,"statSync",e)(n);if(!ti(r))throw rt("ENOTDIR","rmdir",e);if(Pi&&!oi(this,r,Gt))throw rt("EACCES","rmdir",e);Yi(t,"rmdirSync",e)(n),la(this,"rename",e.toString())}function Ns(e,t){t="object"==typeof t?t:{mode:t};const n=gr(t?.mode,511);return as.call(this,e,{...t,mode:n})}function Ls(e,t){t="object"==typeof t?t:{encoding:t},e=yr(e);const n=[],r=os.call(this,e,t??void 0);for(const e of r)t?.withFileTypes?n.push(us.from(e,t.encoding)):"buffer"==t?.encoding?n.push(Oi.Buffer.from(e.path)):n.push(e.path);return n}function Bs(e,t){return ls.call(this,e,t)}function Us(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new TypeError("Invalid symlink type: "+n);t=yr(t);const i=ds(r,is.call(this,t,{flag:"wx",mode:420}),!1);i.writeSync(Ye(yr(e,!0))),i.chmodSync(fn)}catch(e){r.error=e,r.hasError=!0}finally{fs(r)}}function Vs(e,t){const n=Oi.Buffer.from(ss.call(this,e)),r="object"==typeof t?t?.encoding:t;return"buffer"==r?n:n.toString(r??"utf-8")}function js(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{ds(r,is.call(this,e,{flag:"r+",mode:jt}),!1).chownSync(t,n)}catch(e){r.error=e,r.hasError=!0}finally{fs(r)}}function zs(e,t,n){const r=Ss.call(this,e,"r+");Ms.call(this,r,t,n),Ts.call(this,r)}function Gs(e,t){const n=vs.call(this,e,"r+");Ds.call(this,n,t),Ts.call(this,n)}function Hs(e,t){const n=Ss.call(this,e,"r+");Ds.call(this,n,t),Ts.call(this,n)}function $s(e,t,n){const r=vs.call(this,e,"r+");Os.call(this,r,t,n),Ts.call(this,r)}function Ws(e,t,n){const r=Ss.call(this,e,"r+");Os.call(this,r,t,n),Ts.call(this,r)}function qs(e,t){const n="string"==typeof t?t:t?.encoding??"utf8";e=yr(e);const{fullPath:r}=rs(this,e);if("utf8"==n||"utf-8"==n)return r;const i=Oi.Buffer.from(r,"utf-8");return"buffer"==n?i:i.toString(n)}function Xs(e,t=384){if(Pi&&!oi(this,ms.call(this,e),t))throw new nt(Qe.EACCES)}function Ys(e,t){let n;e=yr(e);try{n=ys.bind(this)(e)}catch(e){if("ENOENT"!=e.code||!t?.force)throw e}if(n)switch(n.mode&hn){case mn:if(t?.recursive)for(const n of Ls.call(this,e))Ys.call(this,Cr(e,n),t);Ps.call(this,e);break;case pn:case fn:case gn:case yn:ws.call(this,e);break;default:throw rt("ENOSYS","rm",e)}}function Ks(e,t){const n="object"==typeof t?t?.encoding:t||"utf8",r=Sr(e);return Ns.call(this,r),"buffer"==n?Oi.Buffer.from(r):r}function Js(e,t){const n=Sr(e);Ns.call(this,n);const r=()=>Ys(n,{recursive:!0,force:!0});return{path:n,remove:r,[Symbol.dispose]:r}}function Zs(e,t,n){if(e=yr(e),t=yr(t),n&&n&$t&&gs(t))throw rt("EEXIST","copyFile",t);Es.call(this,t,xs(e)),la(this,"rename",t.toString())}function Qs(e,t,n){const r=zi(this,e);let i=0;for(const e of t)i+=r.readSync(e,0,e.byteLength,n+i);return i}function ea(e,t,n){const r=zi(this,e);let i=0;for(const e of t)i+=r.writeSync(new Uint8Array(e.buffer),0,e.byteLength,n+i);return i}function ta(e,t){return e=yr(e),new hs(e,this)}function na(e,t,n){e=yr(e),t=yr(t);const r=ys.call(this,e);if(n?.errorOnExist&&gs.call(this,t))throw rt("EEXIST","cp",t);switch(r.mode&hn){case mn:if(!n?.recursive)throw rt("EISDIR","cp",e);Ns.call(this,t,{recursive:!0});for(const r of Ls.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(Cr(e,r.name),Cr(t,r.name))||na.call(this,Cr(e,r.name),Cr(t,r.name),n);break;case pn:case fn:Zs.call(this,e,t);break;default:throw rt("ENOSYS","cp",e)}n?.preserveTimestamps&&$s.call(this,t,r.atime,r.mtime)}function ra(e,t){e=yr(e);const{fs:n}=es(e,this);return ts(n,t?.bigint)}function ia(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:i=()=>!1}=t,s=e.map(wr),a=[];return function e(t){const n=Ls(t,{withFileTypes:r,encoding:"utf8"});for(const o of n){const n=r?Cr(o.parentPath,o.name):t+"/"+o;("function"!=typeof i?i.some(e=>Pr(e,n)):i(r?o:n))||(ms(n).isDirectory()&&s.some(e=>e.source.includes(".*"))&&e(n),s.some(e=>e.test(n.replace(/^\/+/g,"")))&&a.push(r?o:n.replace(/^\/+/g,"")))}}(n),a}class sa extends Be{_context;path;off(e,t,n,r){return super.off(e,t,n,r)}removeListener(e,t,n,r){return super.removeListener(e,t,n,r)}constructor(e,t){super(),this._context=e,this.path=t}setMaxListeners(){throw rt("ENOSYS","Watcher.setMaxListeners")}getMaxListeners(){throw rt("ENOSYS","Watcher.getMaxListeners")}prependListener(){throw rt("ENOSYS","Watcher.prependListener")}prependOnceListener(){throw rt("ENOSYS","Watcher.prependOnceListener")}rawListeners(){throw rt("ENOSYS","Watcher.rawListeners")}ref(){return this}unref(){return this}}class aa extends sa{options;realpath;constructor(e,t,n){super(e,t),this.options=n,this.realpath=e?.root?Cr(e.root,t):t,function(e,t){const n=yr(e);ca.has(n)||ca.set(n,new Set),ca.get(n).add(t)}(this.realpath,this)}close(){super.emit("close"),function(e,t){const n=yr(e);ca.has(n)&&(ca.get(n).delete(t),0===ca.get(n).size&&ca.delete(n))}(this.realpath,this)}[Symbol.dispose](){this.close()}}class oa extends sa{options;intervalId;previous;constructor(e,t,n){super(e,t),this.options=n,this.start()}onInterval(){try{const n=ms(this.path);e=this.previous,t=n,(e.size!=t.size||+e.atime!=+t.atime||+e.mtime!=+t.mtime||+e.ctime!=+t.ctime||e.mode!=t.mode)&&(this.emit("change",n,this.previous),this.previous=n)}catch(e){this.emit("error",e)}var e,t}start(){const e=this.options.interval||5e3;try{this.previous=ms(this.path)}catch(e){return void this.emit("error",e)}this.intervalId=setInterval(this.onInterval.bind(this),e),this.options.persistent||"object"!=typeof this.intervalId||this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const ca=new Map;function la(e,t,n){e&&(n=Cr(e.root??"/",n));for(let e=n=yr(n);"/"!=e;e=Fr(e)){const r=ca.get(e);if(r)for(const i of r)i.emit("change",t,Ar.call(i._context,e,n)||Rr(n))}}async function ua(e,t,n,r){if(n){const n=es(t,e,r),i=await n.fs.stat(n.path).catch(()=>{});return{...n,fullPath:t,stats:i}}try{const i=es(t,e),s=await i.fs.stat(i.path);if(!ni(s))return{...i,fullPath:t,stats:s};const a=kr.call(e,Fr(t),await da.call(e,t));return await ua(e,a,n,r)}catch{}const{base:i,dir:s}=Or(t),a="/"==s?"/":(await ua(e,s,!1,r)).fullPath,o=Cr(a,i),c=es(o,e),l=await c.fs.stat(c.path).catch(e=>{if("ENOENT"!=e.code)throw tt(Object.assign(e,{syscall:"stat",path:o}))});if(!l)return{...c,fullPath:t};if(!ni(l))return{...c,fullPath:o,stats:l};const u=kr.call(e,a,await da.call(e,o));return await ua(e,u,!1,r)}async function ha(e,t,n){t=yr(t);const r=gr(n.mode,420),i=$i(n.flag),s={syscall:"open",path:t},{fs:a,path:o,stats:c}=await ua(e,t,n.preserveSymlinks,s);if(!c){if(!(i&Jt))throw rt("ENOENT",s);const c=await a.stat(Fr(o));if(Pi&&!oi(e,c,Gt))throw rt("EACCES","open",Fr(t));if(!ti(c))throw rt("ENOTDIR","open",Fr(t));if(!n.allowDirectory&&r&mn)throw rt("EISDIR","open",t);const{euid:l,egid:u}=e?.credentials??Vt.credentials,h=await a.createFile(o,{mode:r,uid:c.mode&wn?c.uid:l,gid:c.mode&vn?c.gid:u});return new Vi(e,t,a,o,i,h)}if(Pi&&!oi(e,c,Wi(i)))throw rt("EACCES",s);if(i&Zt)throw rt("EEXIST",s);const l=new Vi(e,t,a,o,i,c);if(!n.allowDirectory&&r&mn)throw rt("EISDIR","open",t);return i&en&&await l.truncate(0),l}async function da(e){const t={syscall:"readlink",path:e=yr(e)},{fs:n,stats:r,path:i}=await ua(this,e,!0,t);if(!r)throw rt("ENOENT",t);if(Pi&&!oi(this,r,zt))throw rt("EACCES",t);if(!ni(r))throw rt("EINVAL",t);const s=r.size,a=new Uint8Array(s);return await n.read(i,a,0,s),Je(a)}async function fa(e,t={}){e=yr(e);const{euid:n,egid:r}=this?.credentials??Vt.credentials,{mode:i=511,recursive:s}=t,{fs:a,path:o}=es(e,this,{syscall:"mkdir"}),c=async(e,t,s)=>{if(Pi&&!oi(this,s,Gt))throw rt("EACCES","mkdir",e);const o=await a.mkdir(t,{mode:i,uid:s.mode&wn?s.uid:n,gid:s.mode&vn?s.gid:r});return la(this,"rename",e),o};if(!s)return void await c(e,o,await a.stat(Fr(o)));const l=[];let u=e;for(let e=o;!await a.exists(e);e=Fr(e),u=Fr(u))l.unshift([u,e]);if(!l.length)return;const h=[await a.stat(Fr(l[0][1]))];for(const[e,[t,n]]of l.entries())h.push(await c(t,n,h[e]));return l[0][0]}async function pa(e,t={}){const n={syscall:"readdir",path:e=yr(e)},{fs:r,path:i,stats:s}=await ua(this,e,!1,n);if(!s)throw rt("ENOENT",n);if(Pi&&!oi(this,s,zt))throw rt("EACCES",n);if(!ti(s))throw rt("ENOTDIR",n);const a=await r.readdir(i),o=[],c=async e=>{const n=await r.stat(Cr(i,e)).catch(e=>{if("ENOENT"!=e.code)throw e});if(!n)return;const s=new Ui;if(s.ino=n.ino,s.type=Li(n.mode),s.path=e,s.name=Rr(e),o.push(s),!t.recursive||!ti(n))return;const a=await r.readdir(Cr(i,e));for(const t of a)await c(Cr(e,t))};return await Promise.all(a.map(c)),o}async function ga(e,t){const n={syscall:"rename",path:e=yr(e),dest:t=yr(t)},r=await ua(this,e,!0,n),i=es(t,this,n);if(r.fs.uuid!==i.fs.uuid)throw rt("EXDEV",n);if(i.path.startsWith(r.path+"/"))throw rt("EBUSY",n);if(!r.stats)throw rt("ENOENT",n);const s=r.fs,a=await s.stat(Fr(r.path)),o=await s.stat(Fr(i.path)),c=await s.stat(i.path).catch(e=>{if("ENOENT"==e.code)return null;throw e});if(Pi&&(!oi(this,a,zt)||!oi(this,o,Gt)))throw rt("EACCES",n);if(c&&!ti(r.stats)&&ti(c))throw rt("EISDIR",n);if(c&&ti(r.stats)&&!ti(c))throw rt("ENOTDIR",n);await r.fs.rename(r.path,i.path),la(this,"rename",e),la(this,"change",t)}async function ma(e,t){e=yr(e);const n={syscall:"link",path:t=yr(t),dest:e},{fs:r,path:i}=es(e,this,n),s=es(t,this,n);if(r.uuid!=s.fs.uuid)throw rt("EXDEV",n);const a=await r.stat(i);if(Pi){if(!oi(this,a,zt))throw rt("EACCES",n);if(!oi(this,await r.stat(Fr(i)),zt))throw rt("EACCES",n);if(!oi(this,await r.stat(Fr(s.path)),Gt))throw rt("EACCES",n)}return await r.link(i,s.path)}class ya extends Be{input;output;terminal;line="";_cursor=0;get cursor(){return this._cursor}_buffer="";_closed=!1;_paused=!1;_prompt="";_history=[];_historyIndex=-1;_currentLine="";constructor(e,t,n,r=!1){super(),this.input=e,this.output=t,this.terminal=r,this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}_onData=e=>{if(!this._paused&&!this._closed){this._buffer+="string"==typeof e?e:e.toString("utf8");for(let e=this._buffer.indexOf("\n");e>=0;e=this._buffer.indexOf("\n")){let t=this._buffer.substring(0,e);t.endsWith("\r")&&(t=t.substring(0,t.length-1)),this._buffer=this._buffer.substring(e+1),this.line=t,t.trim()&&!t.trim().match(/^\s*$/)&&this._history.at(-1)!=t&&(this._history.push(t),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",t)}}};close(){if(!this._closed){if(this._closed=!0,this.input?.removeAllListeners?.(),this._buffer.length){const e=this._buffer;this._buffer="",this.line=e,this.emit("line",e)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused||(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause")),this}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(e){this._prompt=e}getPrompt(){return this._prompt}prompt(e){if(!this.output)return;if(!e)return void this.output.write(this._prompt);const{cols:t}=this.getCursorPos();this.output.write(this._prompt),this._cursor=t}write(e,t){if(!this._closed){if(e){const t="string"==typeof e?e:e.toString("utf8");this._onData(t)}if(t&&this.terminal)switch((t.ctrl?"^":"")+t.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;wa(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const e=this.line.length-this._cursor;if(!e)return;wa(this.output,e,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output)return;if(this._cursor>=this.line.length)return;const e=this.line.slice(0,this._cursor);ba(this.output,1),this.line=e;break}case"^u":{if(!this.output||!this._cursor)return;const e=this.line.slice(this._cursor);ba(this.output,0),wa(this.output,0,0),this.output.write(this._prompt+e),this.line=e,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let e=this._cursor-1;for(;e>=0&&" "===this.line[e];)e--;for(;e>=0&&" "!==this.line[e];)e--;const t=this.line.slice(0,e+1)+this.line.slice(this._cursor),n=e+1;this._renderLine(t),this._cursor=n,this._cursor=n,wa(this.output,-t.length,0),wa(this.output,n,0);break}case"^return":case"^enter":this._onData("\n");break;case"return":case"enter":this._onData((e?"string"==typeof e?e:e.toString("utf8"):"")+"\n");break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),"up"==t.name&&this._historyIndex>0)this._historyIndex--;else{if(!("down"==t.name&&this._historyIndex<this._history.length-1))return"down"==t.name&&this._historyIndex==this._history.length-1?(this._historyIndex=this._history.length,void this._renderLine(this._currentLine)):void 0;this._historyIndex++}const e=this._history[this._historyIndex];this._renderLine(e);break}case"left":case"right":{const e="left"==t.name?-1:1;if(!this.output)return;const n=Math.max(0,Math.min(this.line.length,this._cursor+e));if(n==this._cursor)return;wa(this.output,e,0),this._cursor=n,this._cursor=n;break}case"backspace":{if(!this.output||!this._cursor)return;const e=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(e),this._cursor=--this._cursor,this._cursor>0&&(wa(this.output,-this._cursor,0),wa(this.output,this._cursor,0));break}case"delete":{if(!this.output)return;if(this._cursor>=this.line.length)return;const e=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);ba(this.output,0),wa(this.output,0,0),this.output.write(this._prompt+e),this.line=e,wa(this.output,-e.length,0),wa(this.output,this._cursor,0);break}}}}_renderLine(e){this.output&&(ba(this.output,0),wa(this.output,0,0),this.output.write(this._prompt+e),this.line=e,this._cursor=e.length,this._cursor=e.length)}question(e,t,n){const r="function"==typeof t?t:n;!this._closed&&this.output?(this.output.write(e),this.once("line",r)):r("")}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(e,t){const n=this.listeners(e);return this.removeAllListeners(e),this.on(e,t),n.forEach(this.on.bind(this,e)),this}prependOnceListener(e,t){const n=this.listeners(e);return this.removeAllListeners(e),this.once(e,t),n.forEach(this.on.bind(this,e)),this}setMaxListeners(){return mt("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return mt("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let e=!1;return{next:async()=>{if(e)return{done:e,value:void 0};const{resolve:t,promise:n}=Promise.withResolvers();return this.once("line",e=>t({value:e,done:!1})),this.once("close",()=>{e=!0,t({value:void 0,done:e})}),n},return:async t=>(e||(e=!0,this.close()),{done:e,value:t}),throw:async t=>{throw e||(e=!0,this.close()),t},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{e||(e=!0,this.close())}}}[Symbol.dispose](){this.close()}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:e,promise:t}=Promise.withResolvers();this.once("close",()=>e()),this.close(),await t}rawListeners(e){return this.listeners(e)}}function ba(e,t){return e.write(t>=0?"\r[K":"[K"),!0}function wa(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`[${-t}D`:t>0&&(r+=`[${t}C`),n<0?r+=`[${-n}A`:n>0&&(r+=`[${n}B`),r&&e.write(r),!0}var va=__webpack_require__(8521);class Sa extends va.Readable{pending=!0;_path="<unknown>";_bytesRead=0;reader;ready;constructor(e={},t){super({...e,encoding:e.encoding??void 0}),this.ready=Promise.resolve(t).then(t=>{this._path=t.vfs.path;const n=t.readableWebStream({start:e.start,end:e.end});this.reader=n.getReader(),this.pending=!1}).catch(e=>{this.destroy(e)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:e,value:t}=await this.reader.read();if(e)return void this.push(null);this._bytesRead+=t.byteLength,this.push(t)}catch(e){this.destroy(new nt(Qe.EIO,e.toString()))}}close(e=()=>null){try{this.destroy(),this.emit("close"),e(null)}catch(t){e(new nt(Qe.EIO,t.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(e){return super.wrap(e),this}}class xa extends va.Writable{pending=!0;_path="<unknown>";_bytesWritten=0;writer;ready;constructor(e={},t){super(e),this.ready=Promise.resolve(t).then(t=>{this._path=t.vfs.path;const n=t.writableWebStream({start:e.start});this.writer=n.getWriter(),this.pending=!1}).catch(e=>this.destroy(e))}async _write(e,t,n){if(await this.ready,!this.writer)return n(mt(rt("EAGAIN","write",this._path)));if("buffer"!=t)return n(mt(rt("ENOTSUP","write",this._path)));const r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);try{await this.writer.write(r),this._bytesWritten+=e.byteLength,n()}catch(e){n(new nt(Qe.EIO,e.toString()))}}async _final(e){if(await this.ready,!this.writer)return e();try{await this.writer.close(),e()}catch(t){e(new nt(Qe.EIO,t.toString()))}}close(e=()=>null){try{this.destroy(),this.emit("close"),e(null)}catch(t){e(new nt(Qe.EIO,t.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var Ea=function(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Ia=function(e){return function(t){function n(n){t.error=t.hasError?new e(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(e,function(t){return n(t),e()})}else i|=1}catch(e){n(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class ka{context;fd;vfs;constructor(e,t){this.context=e,this.fd=t,this.vfs=zi(e,t)}_emitChange(){la(this.context,"change",this.vfs.path)}async chown(e,t){await this.vfs.chown(e,t),this._emitChange()}async chmod(e){const t=gr(e,-1);if(t<0)throw rt("EINVAL","chmod",this.vfs.path);await this.vfs.chmod(t),this._emitChange()}datasync(){return this.sync()}async sync(){await this.vfs.sync()}async truncate(e=0){await this.vfs.truncate(e),this._emitChange()}async utimes(e,t){e=mr(e),t=mr(t),await this.vfs.utimes(e,t),this._emitChange()}async appendFile(e,t={}){const n=br(t,"utf8","a",420);if(!($i(n.flag)&tn))throw rt("EBADF","write",this.vfs.path);const r="string"==typeof e?Oi.Buffer.from(e,n.encoding):e;await this.vfs.write(r,0,r.length),this._emitChange()}async read(e,t,n,r){if("object"==typeof t&&null!=t&&(r=t.position,n=t.length,t=t.offset),ArrayBuffer.isView(e)||"object"!=typeof e||(r=e.position,n=e.length,t=e.offset,e=e.buffer),r&&r>Number.MAX_SAFE_INTEGER)throw rt("EINVAL");return"bigint"==typeof r&&(r=Number(r)),r=Number.isSafeInteger(r)?r:this.vfs.position,e||=new Uint8Array(this.vfs.inode.size),t??=0,{bytesRead:await this.vfs.read(e,t,n??e.byteLength-t,r),buffer:e}}async readFile(e){const t=br(e,null,"r",292);if($i(t.flag)&Yt)throw rt("EBADF","read",this.vfs.path);const{size:n}=await this.stat(),r=new Uint8Array(n);await this.vfs.read(r,0,n,0);const i=Oi.Buffer.from(r);return t.encoding?i.toString(t.encoding):i}readableWebStream(e={}){if(this.vfs.isClosed)throw rt("EBADF","readableWebStream",this.vfs.path);return this.vfs.fs.streamRead(this.vfs.internalPath,e)}writableWebStream(e={}){if(this.vfs.isClosed)throw rt("EBADF","writableWebStream",this.vfs.path);if(this.vfs.inode.flags&Kr.Immutable)throw rt("EPERM","writableWebStream",this.vfs.path);return this.vfs.fs.streamWrite(this.vfs.internalPath,e)}readLines(e){if(this.vfs.isClosed||this.vfs.flag&Yt)throw rt("EBADF","read",this.vfs.path);return function(e){return"input"in e?new ya(e.input,e.output,e.completer,e.terminal):new ya(e,void 0,void 0,void 0)}({input:this.createReadStream(e),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(e){if(this.vfs.isClosed)throw rt("EBADF","stat",this.vfs.path);if(Pi&&!oi(this.context,this.vfs.inode,zt))throw rt("EACCES","stat",this.vfs.path);return e?.bigint?new Ur(this.vfs.inode):new Br(this.vfs.inode)}async write(e,t,n,r){let i,s,a;"object"==typeof t&&null!=t&&(n=t.length,r=t.position,t=t.offset),"string"==typeof e?(r="number"==typeof t?t:null,s=0,i=Oi.Buffer.from(e,"string"==typeof n?n:"utf8"),a=i.length):(i=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),s=t??0,a="number"==typeof n?n:i.byteLength,r="number"==typeof r?r:null),r??=this.vfs.position;const o=await this.vfs.write(i,s,a,r);return this._emitChange(),{buffer:e,bytesWritten:o}}async writeFile(e,t={}){const n=br(t,"utf8","w",420),r=$i(n.flag);if(!(r&Yt||r&Kt))throw rt("EBADF","writeFile",this.vfs.path);const i="string"==typeof e?Oi.Buffer.from(e,n.encoding):e;await this.vfs.write(i,0,i.length,0),this._emitChange()}async close(){await this.vfs.close(),Gi(this.context,this.fd)}async writev(e,t){"number"==typeof t&&(this.vfs.position=t);let n=0;for(const t of e)n+=(await this.write(t)).bytesWritten;return{bytesWritten:n,buffers:e}}async readv(e,t){"number"==typeof t&&(this.vfs.position=t);let n=0;for(const t of e)n+=(await this.read(t)).bytesRead;return{bytesRead:n,buffers:e}}createReadStream(e={}){if(this.vfs.isClosed||this.vfs.flag&Yt)throw rt("EBADF","createReadStream",this.vfs.path);return new Sa(e,this)}createWriteStream(e={}){if(this.vfs.isClosed)throw rt("EBADF","createWriteStream",this.vfs.path);if(this.vfs.inode.flags&Kr.Immutable)throw rt("EPERM","createWriteStream",this.vfs.path);if(this.vfs.fs.attributes.has("readonly"))throw rt("EROFS","createWriteStream",this.vfs.path);return new xa(e,this)}}async function Ta(e,t){await ga.call(this,e,t)}async function _a(e){e=yr(e);try{const{fs:t,path:n}=await ua(this,e);return await t.exists(n)}catch(e){if(e instanceof nt&&"ENOENT"==e.code)return!1;throw e}}async function Ca(e,t){e=yr(e);const{fs:n,path:r}=await ua(this,e),i={syscall:"stat",path:e},s=await n.stat(r).catch(st(i));if(Pi&&!oi(this,s,zt))throw rt("EACCES",i);return t?.bigint?new Ur(s):new Br(s)}async function Aa(e,t){const n={syscall:"lstat",path:e=yr(e)},{base:r,dir:i}=Or(e),{fs:s,path:a}=await ua(this,i),o=await s.stat(r?Cr(a,r):a).catch(st(n));if(Pi&&!oi(this,o,zt))throw rt("EACCES",n);return t?.bigint?new Ur(o):new Br(o)}async function Fa(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=Ea(n,await Ma.call(this,e,"r+"),!0);await r.truncate(t)}catch(e){n.error=e,n.hasError=!0}finally{const e=Ia(n);e&&await e}}async function Ra(e){e=yr(e);const{fs:t,path:n}=es(e,this),r={syscall:"unlink",path:e},i=await t.stat(n).catch(st(r));if(Pi&&!oi(this,i,Gt))throw rt("EACCES",r);await t.unlink(n).catch(st(r)),la(this,"rename",e.toString())}async function Ma(e,t="r",n=420){const r=await ha(this,e,{flag:t,mode:n});return new ka(this,ji(r))}async function Da(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=br(t,null,"r",292),i=Ea(n,"object"==typeof e&&"fd"in e?e:await Ma.call(this,e,r.flag,r.mode),!0);return await i.readFile(r)}catch(e){n.error=e,n.hasError=!0}finally{const e=Ia(n);e&&await e}}async function Oa(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=br(n,"utf8","w+",420),s=Ea(r,e instanceof ka?e:await Ma.call(this,e.toString(),i.flag,i.mode),!0),a="string"==typeof t?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if("string"!=typeof a&&!(a instanceof Uint8Array))throw new TypeError('The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t);await s.writeFile(a,i)}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function Pa(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=br(n,"utf8","a",420),s=$i(i.flag),a={syscall:"write",path:e instanceof ka?e.vfs.path:e.toString()};if(!(s&tn))throw rt("EBADF",a);const o="string"==typeof t?Oi.Buffer.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength),c=Ea(r,"object"==typeof e&&"fd"in e?e:await Ma.call(this,e,i.flag,i.mode),!0);await c.appendFile(o,i)}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function Na(e){e=yr(e);const{fs:t,path:n}=await ua(this,e),r={syscall:"rmdir",path:e},i=await t.stat(n).catch(st(r));if(!i)throw rt("ENOENT",r);if(!ti(i))throw rt("ENOTDIR",r);if(Pi&&!oi(this,i,Gt))throw rt("EACCES",r);await t.rmdir(n).catch(st(r)),la(this,"rename",e.toString())}async function La(e,t){t="object"==typeof t?t:{mode:t};const n=gr(t?.mode,511);return await fa.call(this,e,{...t,mode:n})}async function Ba(e,t){e=yr(e);const n="object"==typeof t&&null!=t?t:{encoding:t,withFileTypes:!1,recursive:!1},r=await pa.call(this,e,n),i=[];for(const e of r)n.withFileTypes?i.push(us.from(e,n.encoding)):"buffer"==n.encoding?i.push(Oi.Buffer.from(e.path)):i.push(e.path);return i}async function Ua(e,t){return await ma.call(this,e,t)}async function Va(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new TypeError("Invalid symlink type: "+n);if(t=yr(t),await _a.call(this,t))throw rt("EEXIST","symlink",t);const i=Ea(r,await ha(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0),s=Ye(yr(e,!0));await i.write(s,0,s.length,0),await i.chmod(fn)}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function ja(e,t){e=yr(e);const n=Oi.Buffer.from(await da.call(this,e),"utf-8"),r="object"==typeof t?t?.encoding:t;return"buffer"==r?n:n.toString(r??"utf-8")}async function za(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=Ea(r,await Ma.call(this,e,"r+"),!0);await i.chown(t,n)}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function Ga(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=Ea(r,await ha(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0);await i.chown(t,n)}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function Ha(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ea(n,await Ma.call(this,e,"r+"),!0);await r.chmod(t)}catch(e){n.error=e,n.hasError=!0}finally{const e=Ia(n);e&&await e}}async function $a(e,t){const n={stack:[],error:void 0,hasError:!1};try{t=gr(t);const r=Ea(n,await ha(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0);await r.chmod(t)}catch(e){n.error=e,n.hasError=!0}finally{const e=Ia(n);e&&await e}}async function Wa(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=Ea(r,await ha(this,e,{flag:"r+",allowDirectory:!0}),!0);await i.utimes(mr(t),mr(n))}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function qa(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=Ea(r,await ha(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0);await i.utimes(mr(t),mr(n))}catch(e){r.error=e,r.hasError=!0}finally{const e=Ia(r);e&&await e}}async function Xa(e,t){const n="string"==typeof t?t:t?.encoding??"utf8";e=yr(e);const{fullPath:r}=await ua(this,e);if("utf8"==n||"utf-8"==n)return r;const i=Oi.Buffer.from(r,"utf-8");return"buffer"==n?i:i.toString(n)}function Ya(e,t={}){const n=new aa(this,e.toString(),"string"!=typeof t?t:{encoding:t}),r=[];let i=!1;function s(){i=!0,n.close();for(const e of r)e({value:null,done:i});return r.length=0,Promise.resolve({value:void 0,done:!0})}return n.on("change",(e,t)=>{r.shift()?.({value:{eventType:e,filename:t},done:!1})}),{async next(){if(i)return Promise.resolve({value:void 0,done:i});const{promise:e,resolve:t}=Promise.withResolvers();return r.push(t),e},return:s,throw:s,async[Symbol.asyncDispose](){await s()},[Symbol.asyncIterator](){return this}}}async function Ka(e,t=jt){if(Pi&&!(await Ca.call(this,e)).hasAccess(t,this))throw rt("EACCES","access",e.toString())}async function Ja(e,t){e=yr(e);const n=await Aa.call(this,e).catch(e=>{if("ENOENT"!=e.code||!t?.force)throw e});if(n)switch(n.mode&hn){case mn:if(t?.recursive)for(const n of await Ba.call(this,e))await Ja.call(this,Cr(e,n),t);await Na.call(this,e);break;case pn:case fn:case gn:case yn:await Ra.call(this,e);break;default:throw rt("ENOSYS","rm",e)}}async function Za(e,t){const n="object"==typeof t?t?.encoding:t||"utf8",r=Sr(e);return await La.call(this,r),"buffer"==n?Oi.Buffer.from(r):r}async function Qa(e,t){const n=Sr(e);await La.call(this,n);const r=()=>Ja(n,{recursive:!0,force:!0});return{path:n,remove:r,[Symbol.asyncDispose]:r}}async function eo(e,t,n){if(e=yr(e),t=yr(t),n&&n&$t&&await _a.call(this,t))throw rt("EEXIST","copyFile",t);await Oa.call(this,t,await Da.call(this,e)),la(this,"rename",t.toString())}function to(e,t){return e=yr(e),Promise.resolve(new hs(e,this))}async function no(e,t,n){e=yr(e),t=yr(t);const r=await Aa.call(this,e);if(n?.errorOnExist&&await _a.call(this,t))throw rt("EEXIST","cp",t);switch(r.mode&hn){case mn:{if(!n?.recursive)throw rt("EISDIR","cp",e);const[r]=await Promise.all([Ba.call(this,e,{withFileTypes:!0}),La.call(this,t,{recursive:!0})]),i=async r=>{n.filter&&!n.filter(Cr(e,r.name),Cr(t,r.name))||await no.call(this,Cr(e,r.name),Cr(t,r.name),n)};await Promise.all(r.map(i));break}case pn:case fn:await eo.call(this,e,t);break;default:throw rt("ENOSYS","cp",e)}n?.preserveTimestamps&&await Wa.call(this,t,r.atime,r.mtime)}async function ro(e,t){e=yr(e);const{fs:n}=es(e,this);return Promise.resolve(ts(n,t?.bigint))}function io(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:i=()=>!1}=t||{},s=e.map(wr);return async function*e(t){const n=await Ba(t,{withFileTypes:r,encoding:"utf8"});for(const a of n){const n=r?Cr(a.parentPath,a.name):t+"/"+a;("function"!=typeof i?i.some(e=>Pr(e,n)):i(r?a:n))||((await Ca(n)).isDirectory()&&s.some(e=>e.source.includes(".*"))&&(yield*e(n)),s.some(e=>e.test(n.replace(/^\/+/g,"")))&&(yield r?a:n.replace(/^\/+/g,"")))}}(n)}function so(e,t){t.disableAsyncCache&&e.attributes.set("no_async_preload"),t.caseFold&&e.attributes.set("case_fold",t.caseFold)}function ao(e){return Lt(e)||Ot(e)||e instanceof di}async function oo(e,t=0){if("object"!=typeof e||null==e)throw gt(it("EINVAL","Invalid options on mount configuration"));if(!ao(e))throw gt(it("EINVAL","Invalid mount configuration"));if(e instanceof di)return await e.ready(),e;Ot(e)&&(e={backend:e});for(const[n,r]of Object.entries(e))if("backend"!=n&&ao(r)){if(bt("Resolving nested mount configuration: "+n),t>10)throw gt(it("EINVAL","Invalid configuration, too deep and possibly infinite"));e[n]=await oo(r,++t)}const{backend:n}=e;if("function"==typeof n.isAvailable&&!await n.isAvailable(e))throw gt(it("EPERM","Backend not available: "+n.name));Nt(n,e);const r=await n.create(e);return so(r,e),await r.ready(),r}async function co(e){if(!ao(e))throw new TypeError("Invalid single mount point configuration");const t=await oo(e);Qi("/"),Zi("/",t)}async function lo(e,t){if("/"==e)return void Zi(e,t);const n=await Ca(e).catch(()=>null);if(n){if(!n.isDirectory())throw it("ENOTDIR","Missing directory at mount point: "+e)}else await La(e,{recursive:!0});Zi(e,t)}function uo(e,t){const n=Ji.get("/dev");if(!(n instanceof Ti))throw pt(it("ENOTSUP","/dev does not exist or is not a device file system"));return n._createDevice(e,t)}const ho=["/tmp","/var","/etc"];async function fo(e){var t;if(Object.assign(Vt.credentials,Bt({uid:e.uid||0,gid:e.gid||0})),t=!e.disableAccessChecks,Pi=t,e.log&&Dt(e.log),e.mounts)for(const[t,n]of Object.entries(e.mounts).sort(([e],[t])=>e.length>t.length?1:-1)){const r=t.startsWith("/")?t:"/"+t;Lt(n)&&(n.disableAsyncCache??=e.disableAsyncCache||!1,n.caseFold??=e.caseFold),"/"==r&&Qi("/"),await lo(r,await oo(n))}for(const t of Ji.values())so(t,e);if(e.addDevices&&!Ji.has("/dev")){const e=new Ti;e.addDefaults(),await e.ready(),await lo("/dev",e)}if(e.defaultDirectories)for(const e of ho)await _a(e)?(await Ca(e)).isDirectory()||mt("Default directory exists but is not a directory: "+e):await La(e)}async function po(){for(const e of Ji.values())await e.sync()}const go=["delete"];function mo(e){return go.includes(e)}const yo=Math.max(...go.map(e=>e.length)),bo="#journal@v0\n";class wo extends Be{entries=[];toString(){return bo+this.entries.map(e=>`${e.op.padEnd(yo)} ${e.path}`).join("\n")}fromString(e){if(!e.startsWith(bo))throw gt(it("EINVAL","Invalid journal contents, refusing to parse"));for(const t of e.split("\n")){if(t.startsWith("#"))continue;const[e,n]=t.split(/\s+/);mo(e)?this.entries.push({op:e,path:n}):mt("Unknown operation in journal (skipping): "+e)}return this}add(e,t){this.entries.push({op:e,path:t}),this.emit("update",e,t),this.emit(e,t)}has(e,t){const n=JSON.stringify({op:e,path:t});for(const e of this.entries)if(JSON.stringify(e)===n)return!0;return!1}isDeleted(e){let t=!1;for(const n of this.entries)n.path==e&&"delete"===n.op&&(t=!0);return t}}class vo extends di{readable;writable;journal;async ready(){await this.readable.ready(),await this.writable.ready()}constructor(e,t,n=new wo){if(super(1651862636,e.name),this.readable=e,this.writable=t,this.journal=n,t.attributes.has("no_write"))throw gt(it("EINVAL","Writable file system can not be written to"));e.attributes.set("no_write")}isDeleted(e){return this.journal.isDeleted(e)}usage(){return this.readable.usage()}async sync(){await this.writable.sync()}syncSync(){this.writable.syncSync()}async read(e,t,n,r){return await this.writable.exists(e)?await this.writable.read(e,t,n,r):await this.readable.read(e,t,n,r)}readSync(e,t,n,r){return this.writable.existsSync(e)?this.writable.readSync(e,t,n,r):this.readable.readSync(e,t,n,r)}async write(e,t,n){return await this.copyForWrite(e),await this.writable.write(e,t,n)}writeSync(e,t,n){return this.copyForWriteSync(e),this.writable.writeSync(e,t,n)}async rename(e,t){await this.copyForWrite(e);try{await this.writable.rename(e,t)}catch{if(this.isDeleted(e))throw it("ENOENT")}}renameSync(e,t){this.copyForWriteSync(e);try{this.writable.renameSync(e,t)}catch{if(this.isDeleted(e))throw it("ENOENT")}}async stat(e){try{return await this.writable.stat(e)}catch{if(this.isDeleted(e))throw it("ENOENT");return await this.readable.stat(e)}}statSync(e){try{return this.writable.statSync(e)}catch{if(this.isDeleted(e))throw it("ENOENT");return this.readable.statSync(e)}}async touch(e,t){await this.copyForWrite(e),await this.writable.touch(e,t)}touchSync(e,t){this.copyForWriteSync(e),this.writable.touchSync(e,t)}async createFile(e,t){return await this.createParentDirectories(e),await this.writable.createFile(e,t)}createFileSync(e,t){return this.createParentDirectoriesSync(e),this.writable.createFileSync(e,t)}async link(e,t){await this.copyForWrite(e),await this.writable.link(e,t)}linkSync(e,t){this.copyForWriteSync(e),this.writable.linkSync(e,t)}async unlink(e){if(!await this.exists(e))throw it("ENOENT");await this.writable.exists(e)&&await this.writable.unlink(e),await this.exists(e)&&this.journal.add("delete",e)}unlinkSync(e){if(!this.existsSync(e))throw it("ENOENT");this.writable.existsSync(e)&&this.writable.unlinkSync(e),this.existsSync(e)&&this.journal.add("delete",e)}async rmdir(e){if(!await this.exists(e))throw it("ENOENT");if(await this.writable.exists(e)&&await this.writable.rmdir(e),await this.exists(e)){if((await this.readdir(e)).length)throw it("ENOTEMPTY");this.journal.add("delete",e)}}rmdirSync(e){if(!this.existsSync(e))throw it("ENOENT");if(this.writable.existsSync(e)&&this.writable.rmdirSync(e),this.existsSync(e)){if(this.readdirSync(e).length)throw it("ENOTEMPTY");this.journal.add("delete",e)}}async mkdir(e,t){if(await this.exists(e))throw it("EEXIST");return await this.createParentDirectories(e),await this.writable.mkdir(e,t)}mkdirSync(e,t){if(this.existsSync(e))throw it("EEXIST");return this.createParentDirectoriesSync(e),this.writable.mkdirSync(e,t)}async readdir(e){if(this.isDeleted(e)||!await this.exists(e))throw it("ENOENT");const t=await this.readable.exists(e)?await this.readable.readdir(e):[];if(await this.writable.exists(e))for(const n of await this.writable.readdir(e))t.includes(n)||t.push(n);return t.filter(t=>!this.isDeleted(Cr(e,t)))}readdirSync(e){if(this.isDeleted(e)||!this.existsSync(e))throw it("ENOENT");const t=this.readable.existsSync(e)?this.readable.readdirSync(e):[];if(this.writable.existsSync(e))for(const n of this.writable.readdirSync(e))t.includes(n)||t.push(n);return t.filter(t=>!this.isDeleted(Cr(e,t)))}streamRead(e,t){return this.writable.existsSync(e)?this.writable.streamRead(e,t):this.readable.streamRead(e,t)}streamWrite(e,t){return this.copyForWriteSync(e),this.writable.streamWrite(e,t)}createParentDirectoriesSync(e){const t=[],n=He(it("EDEADLK"));for(let n=Fr(e);!this.writable.existsSync(n);n=Fr(n))t.push(n);n(),t.length&&wt("COW: Creating parent directories: "+t.join(", "));for(const e of t.reverse())this.writable.mkdirSync(e,this.statSync(e))}async createParentDirectories(e){const t=[],n=He(it("EDEADLK",e));for(let n=Fr(e);!await this.writable.exists(n);n=Fr(n))t.push(n);n(),t.length&&wt("COW: Creating parent directories: "+t.join(", "));for(const e of t.reverse())await this.writable.mkdir(e,await this.stat(e))}copyForWriteSync(e){if(!this.existsSync(e))throw it("ENOENT");this.writable.existsSync(Fr(e))||this.createParentDirectoriesSync(e),this.writable.existsSync(e)||this.copyToWritableSync(e)}async copyForWrite(e){if(!await this.exists(e))throw it("ENOENT");if(await this.writable.exists(Fr(e))||await this.createParentDirectories(e),!await this.writable.exists(e))return this.copyToWritable(e)}copyToWritableSync(e){const t=this.readable.statSync(e);if(ti(t)){this.writable.mkdirSync(e,t);for(const t of this.readable.readdirSync(e))this.copyToWritableSync(Cr(e,t));return}const n=new Uint8Array(t.size);this.readable.readSync(e,n,0,n.byteLength),this.writable.createFileSync(e,t),this.writable.touchSync(e,t),this.writable.writeSync(e,n,0)}async copyToWritable(e){const t=await this.readable.stat(e);if(ti(t)){await this.writable.mkdir(e,t);for(const t of await this.readable.readdir(e))await this.copyToWritable(Cr(e,t));return}const n=new Uint8Array(t.size);await this.readable.read(e,n,0,t.size),await this.writable.createFile(e,t),await this.writable.touch(e,t),await this.writable.write(e,n,0)}}const So={name:"CopyOnWrite",options:{writable:{type:"object",required:!0},readable:{type:"object",required:!0},journal:{type:"object",required:!1}},async create(e){const t=await oo(e.readable),n=await oo(e.writable);return new vo(t,n,e.journal)}},xo=new Map;async function Eo(e,t={},n=!1){const r=await fetch(e,t).catch(e=>{throw{tag:"fetch",message:e.message}});if(!r.ok)throw{tag:"status",response:r};const i=await r.arrayBuffer().catch(e=>{if(!n)throw{tag:"buffer",response:r,message:e.message}});return{response:r,data:i?new Uint8Array(i):void 0}}async function Io(e,t,n={}){const r=new Request(e,n);if("number"!=typeof t.start||"number"!=typeof t.end){const{data:r}=await Eo(e,n);return new fi(e,r.byteLength,t,xo).add(r,0),r}if("number"!=typeof t.size){t.warn?.(e+": Size not provided, an additional HEAD request is being made");const{headers:n}=await fetch(r,{method:"HEAD"}),i=parseInt(n.get("Content-Length")??"");if("number"!=typeof i)throw{tag:"size",message:"Response is missing content-length header and no size was provided"};t.size=i}const{size:i,start:s,end:a}=t,o=xo.get(e)??new fi(e,i,t,xo);r.headers.set("If-Range",(new Date).toUTCString());for(const{start:n,end:c}of o.missing(s,a)){const{data:l,response:u}=await Eo(r,{headers:{Range:`bytes=${n}-${c}`}});if(206!=u.status)return t.warn?.(e+": Remote does not support range requests with bytes. Falling back to full data."),new fi(e,i,t,xo).add(l,0),l.subarray(s,a);o.add(l,n)}o.collect();const c=o.regionAt(s);return c.data.subarray(s-c.offset,a-c.offset)}async function ko(e,t,n,r={}){xo.has(e)||new fi(e,n.size??t.byteLength,n,xo);const i=xo.get(e),{offset:s=0,method:a="POST"}=n;if(!n.cacheOnly){const n=new Headers(r.headers||{});if(n.get("Content-Type")||n.set("Content-Type","application/octet-stream"),!n.get("Content-Range")&&(0!==s||t.byteLength!==i.size)){const e=s,r=s+t.byteLength-1,a=Math.max(i.size,r+1);n.set("Content-Range",`bytes ${e}-${r}/${a}`)}await Eo(new Request(e,{...r,method:a,headers:n,body:t.buffer instanceof ArrayBuffer?t:Uint8Array.from(t)}),{},!0)}i.add(t,s)}async function To(e,t={},n={}){t.cacheOnly||await Eo(new Request(e,n),{method:"DELETE"},!0),xo.delete(e)}class _o extends di{index;constructor(e,t,n=new ui){super(e,t),this.index=n}usage(){return this.index.usage()}pathsForRename(e,t){if(!this.index.has(e))throw it("ENOENT");if((Fr(t)+"/").startsWith(e+"/"))throw it("EBUSY");const n=[];for(const[r,i]of this.index.entries()){const s=Ar(e,r);if(s.startsWith(".."))continue;let a=Cr(t,s);a.endsWith("/")&&(a=a.slice(0,-1)),n.push({from:r,to:a,inode:i})}return n.sort((e,t)=>t.from.length-e.from.length),n}async rename(e,t){if(e==t)return;const n=this.pathsForRename(e,t),r=new Map;for(const{from:e,to:t,inode:i}of n){const n=new Uint8Array(i.size);await this.read(e,n,0,i.size),r.set(t,n),this.index.delete(e),await this.remove(e),this.index.has(t)&&await this.remove(t)}n.reverse();for(const{to:e,inode:t}of n){const n=r.get(e);this.index.set(e,t),(t.mode&hn)==mn?await(this._mkdir?.(e,t)):await this.write(e,n,0)}}renameSync(e,t){if(e==t)return;const n=this.pathsForRename(e,t),r=new Map;for(const{from:e,to:t,inode:i}of n){const n=new Uint8Array(i.size);this.readSync(e,n,0,i.size),r.set(t,n),this.index.delete(e),this.removeSync(e),this.index.has(t)&&this.removeSync(t)}n.reverse();for(const{to:e,inode:t}of n){const n=r.get(e);this.index.set(e,t),(t.mode&hn)==mn?this._mkdirSync?.(e,t):this.writeSync(e,n,0)}}async stat(e){const t=this.index.get(e);if(!t)throw it("ENOENT");return t}statSync(e){const t=this.index.get(e);if(!t)throw it("ENOENT");return t}async touch(e,t){(this.index.get(e)??$e(it("ENOENT"))).update(t)}touchSync(e,t){(this.index.get(e)??$e(it("ENOENT"))).update(t)}_remove(e,t){const n=this.index.get(e);if(!n)throw it("ENOENT");const r=(n.mode&hn)==mn;if(!r&&!t)throw it("ENOTDIR");if(r&&t)throw it("EISDIR");r||this.index.delete(e)}async unlink(e){this._remove(e,!0),await this.remove(e)}unlinkSync(e){this._remove(e,!0),this.removeSync(e)}async rmdir(e){if(this._remove(e,!1),(await this.readdir(e)).length)throw it("ENOTEMPTY");this.index.delete(e),await this.remove(e)}rmdirSync(e){if(this._remove(e,!1),this.readdirSync(e).length)throw it("ENOTEMPTY");this.index.delete(e),this.removeSync(e)}create(e,t){if(this.index.has(e))throw it("EEXIST");const n=this.index.get(Fr(e));if(!n)throw it("ENOENT");const r=this.index._alloc(),i=new Qr({ino:r,data:r+1,mode:t.mode,size:0,uid:n.mode&wn?n.uid:t.uid,gid:n.mode&vn?n.gid:t.gid,nlink:1});return this.index.set(e,i),i}async createFile(e,t){return t.mode|=pn,this.create(e,t)}createFileSync(e,t){return t.mode|=pn,this.create(e,t)}async mkdir(e,t){t.mode|=mn;const n=this.create(e,t);return await(this._mkdir?.(e,t)),n}mkdirSync(e,t){t.mode|=mn;const n=this.create(e,t);return this._mkdirSync?.(e,t),n}link(e,t){throw it("ENOSYS")}linkSync(e,t){throw it("ENOSYS")}async readdir(e){return Object.keys(this.index.directoryEntries(e))}readdirSync(e){return Object.keys(this.index.directoryEntries(e))}async sync(){}syncSync(){}}function Co(e){if(!("tag"in e))throw gt(it("EIO",e.stack));switch(e.tag){case"fetch":throw gt(it("EREMOTEIO",e.message));case"status":throw gt(it(e.response.status>500?"EREMOTEIO":"EIO","Response status code is "+e.response.status));case"size":throw gt(it("EBADE",e.message));case"buffer":throw gt(it("EIO","Failed to decode buffer"))}}class Ao extends _o{baseUrl;requestInit;remoteWrite;_asyncDone=Promise.resolve();_async(e){this._asyncDone=this._asyncDone.then(()=>e)}constructor(e,t,n={},r){super(544106099,"nfs",e),this.baseUrl=t,this.requestInit=n,this.remoteWrite=r}async remove(e){await To(this.baseUrl+e,{warn:mt,cacheOnly:!this.remoteWrite},this.requestInit)}removeSync(e){this._async(To(this.baseUrl+e,{warn:mt,cacheOnly:!this.remoteWrite},this.requestInit))}async read(e,t,n=0,r){const i=this.index.get(e);if(!i)throw it("ENOENT");if(r-n==0)return;const s=await Io(this.baseUrl+e,{start:n,end:r,size:i.size,warn:mt},this.requestInit).catch(Co).catch(()=>{});if(!s)throw it("ENODATA");t.set(s)}readSync(e,t,n=0,r){const i=this.index.get(e);if(!i)throw it("ENOENT");if(r-n==0)return;const{data:s,missing:a}=function(e,t){const n=xo.get(e);if(!n)return t.size?{data:new Uint8Array(0),missing:[{start:0,end:t.size??0}]}:(t.warn?.(e+": Size not provided and cache is empty, can not determine missing range"),{data:void 0,missing:[]});const{start:r=0,end:i=n.size}=t,s=new Uint8Array(i-r);for(const e of n.regions)if(!(e.offset+e.data.byteLength<=r)){if(e.offset>=i)break;for(const t of e.ranges){if(t.end<=r)continue;if(t.start>=i)break;const n=Math.max(t.start,r),a=Math.min(t.end,i);n>=a||s.set(e.data.subarray(n-e.offset,a-e.offset),n-r)}}return{data:s,missing:n.missing(r,i)}}(this.baseUrl+e,{start:n,end:r,size:i.size,warn:mt});if(!s)throw it("ENODATA");if(a.length)throw this._async(Io(this.baseUrl+e,{start:n,end:r,size:i.size,warn:mt})),it("EAGAIN");t.set(s)}async write(e,t,n){const r=this.index.get(e);if(!r)throw it("ENOENT");r.update({mtimeMs:Date.now(),size:Math.max(r.size,t.byteLength+n)}),await ko(this.baseUrl+e,t,{offset:n,warn:mt,cacheOnly:!this.remoteWrite},this.requestInit).catch(Co)}writeSync(e,t,n){const r=this.index.get(e);if(!r)throw it("ENOENT");r.update({mtimeMs:Date.now(),size:Math.max(r.size,t.byteLength+n)}),this._async(ko(this.baseUrl+e,t,{offset:n,warn:mt,cacheOnly:!this.remoteWrite},this.requestInit).catch(Co))}}const Fo={name:"Fetch",options:{index:{type:["string","object"],required:!1},baseUrl:{type:"string",required:!0},requestInit:{type:"object",required:!1},remoteWrite:{type:"boolean",required:!1}},isAvailable:()=>"function"==typeof globalThis.fetch,async create(e){const t=new URL(e.baseUrl);t.pathname=yr(t.pathname);let n=t.toString();"/"==n.at(-1)&&(n=n.slice(0,-1)),e.index??="index.json";const r=new ui;if("string"!=typeof e.index)r.fromJSON(e.index);else{const t=await Io(e.index,{warn:mt},e.requestInit).catch(Co);r.fromJSON(JSON.parse(Je(t)))}const i=new Ao(r,n,e.requestInit,e.remoteWrite);if(e.disableAsyncCache)return i;for(const[t,i]of r)i.mode&pn&&await Io(n+t,{warn:mt},e.requestInit).catch(Co);return i}},Ro=Fo;var Mo=function(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Do=function(e){return function(t){function n(n){t.error=t.hasError?new e(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(e,function(t){return n(t),e()})}else i|=1}catch(e){n(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class Oo extends di{nodeFS;prefix;constructor(e,t){super(1852793957,"nodefs"),this.nodeFS=e,this.prefix=t}usage(){const e=this.nodeFS.statfsSync(this.prefix);return{totalSpace:e.bsize*e.blocks,freeSpace:e.bsize*e.bfree}}path(e){return this.prefix+e}async rename(e,t){await this.nodeFS.promises.rename(this.path(e),this.path(t))}renameSync(e,t){this.nodeFS.renameSync(this.path(e),this.path(t))}async stat(e){return await this.nodeFS.promises.stat(this.path(e))}statSync(e){return this.nodeFS.statSync(this.path(e))}async touch(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Mo(n,await this.nodeFS.promises.open(this.path(e),"r"),!0);await r.chmod(t.mode);try{await r.chown(t.uid,t.gid)}catch(e){gt("Failed to chown passthrough file: "+e.message)}}catch(e){n.error=e,n.hasError=!0}finally{const e=Do(n);e&&await e}}touchSync(e,t){this.nodeFS.chmodSync(this.path(e),t.mode);try{this.nodeFS.chownSync(this.path(e),t.uid,t.gid)}catch(e){gt("Failed to chown passthrough file: "+e.message)}}async unlink(e){await this.nodeFS.promises.unlink(this.path(e))}unlinkSync(e){this.nodeFS.unlinkSync(this.path(e))}async mkdir(e,t){return await this.nodeFS.promises.mkdir(this.path(e),t),await this.nodeFS.promises.stat(this.path(e))}mkdirSync(e,t){return this.nodeFS.mkdirSync(this.path(e),t),this.nodeFS.statSync(this.path(e))}async readdir(e){return await this.nodeFS.promises.readdir(this.path(e))}readdirSync(e){return this.nodeFS.readdirSync(this.path(e))}async createFile(e,t){if(ti(t))await this.nodeFS.promises.mkdir(this.path(e),{mode:t.mode});else{const t={stack:[],error:void 0,hasError:!1};try{const n=Mo(t,await this.nodeFS.promises.open(this.path(e),"wx"),!0);await n.close()}catch(e){t.error=e,t.hasError=!0}finally{const e=Do(t);e&&await e}}return await this.nodeFS.promises.stat(this.path(e))}createFileSync(e,t){if(ti(t))this.nodeFS.mkdirSync(this.path(e),{mode:t.mode});else{const t=this.nodeFS.openSync(this.path(e),"wx");this.nodeFS.closeSync(t)}return this.nodeFS.statSync(this.path(e))}async rmdir(e){await this.nodeFS.promises.rmdir(this.path(e))}rmdirSync(e){this.nodeFS.rmdirSync(this.path(e))}async sync(){mt("Sync on passthrough is unnecessary")}syncSync(){mt("Sync on passthrough is unnecessary")}async link(e,t){await this.nodeFS.promises.link(this.path(e),this.path(t))}linkSync(e,t){this.nodeFS.linkSync(this.path(e),this.path(t))}async read(e,t,n,r){const i={stack:[],error:void 0,hasError:!1};try{const s=Mo(i,await this.nodeFS.promises.open(this.path(e),"r"),!0);await s.read({buffer:t,offset:n,length:r-n})}catch(e){i.error=e,i.hasError=!0}finally{const e=Do(i);e&&await e}}readSync(e,t,n,r){const i=this.nodeFS.openSync(this.path(e),"r");try{this.nodeFS.readSync(i,t,{offset:n,length:r-n})}finally{this.nodeFS.closeSync(i)}}async write(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=Mo(r,await this.nodeFS.promises.open(this.path(e),"w"),!0);await i.write(t,n)}catch(e){r.error=e,r.hasError=!0}finally{const e=Do(r);e&&await e}}writeSync(e,t,n){const r=this.nodeFS.openSync(this.path(e),"w");try{this.nodeFS.writeSync(r,t,n)}finally{this.nodeFS.closeSync(r)}}}const Po={name:"Passthrough",options:{fs:{type:"object",required:!0},prefix:{type:"string",required:!0}},create:({fs:e,prefix:t})=>new Oo(e,kr(t))},No=Po;function Lo(e){return null!=e&&"object"==typeof e&&"channel"in e&&"send"in e&&"addHandler"in e&&"removeHandler"in e}function Bo(e){const t=new Map;return{channel:e,send:e.postMessage.bind(e),addHandler(n){const r=e=>n(e.data);t.set(n,r),e.addEventListener("message",r)},removeHandler(n){e.removeEventListener("message",t.get(n))}}}function Uo(e){return{channel:e,send:e.postMessage.bind(e),addHandler:e.on.bind(e,"message"),removeHandler:e.off.bind(e,"message")}}function Vo(e){return{channel:e,send(t){e.send(Go(t))},addHandler(t){e.addEventListener("message",e=>{t(Ho(e.data))})},removeHandler(t){e.removeEventListener("message",e=>{t(Ho(e.data))})}}}function jo(e){if(Lo(e))return e;if(e instanceof WebSocket)return Vo(e);if("on"in e)return Uo(e);if("addEventListener"in e)return Bo(e);throw gt(it("EINVAL","Invalid port type"))}const zo=1;function Go(e){return`Z${zo}${JSON.stringify(e,(e,t)=>{if("_zenfs"!=e)return t instanceof Uint8Array?"$"+t.toBase64():t})}`}function Ho(e){if(!e.startsWith("Z"))return{};e=e.slice(1);const t=parseInt(e);if(isNaN(t))return mt("Ignoring encoded message with missing version"),{};if(!ze(e=e.slice(t.toString().length)))return mt("Ignoring encoded message with invalid JSON"),{};if(t!=zo)throw gt(it("EPROTONOSUPPORT",`Version mismatch in RPC message encoding (got ${t}, expected ${zo})`));return{...JSON.parse(e,(e,t)=>"string"==typeof t&&t.startsWith("$")?Uint8Array.fromBase64(t.slice(1)):t),_zenfs:!0}}function $o(e){return"object"==typeof e&&null!=e&&"_zenfs"in e&&!!e._zenfs}function Wo(e){const t=qo.get(e);t&&(t.timeout&&(clearTimeout(t.timeout),"object"==typeof t.timeout&&t.timeout.unref()),qo.delete(e))}const qo=new Map;function Xo(e,{port:t,timeout:n=1e3,fs:r}){const i="\n"+(new Error).stack.slice(6);if(!t)throw gt(it("EINVAL","Can not make an RPC request without a port"));const{resolve:s,reject:a,promise:o}=Promise.withResolvers(),c=Math.random().toString(16).slice(5),l=setTimeout(()=>{const e=gt(it("ETIMEDOUT","RPC request timed out"));e.stack+=i,Wo(c),a(e)},n),u={resolve:s,reject:a,promise:o,fs:r,timeout:l};return qo.set(c,u),t.send({...e,_zenfs:!0,id:c,stack:i}),o}function Yo(e){if(!$o(e))return;if(!qo.has(e.id)){const t=gt(it("EIO","Invalid RPC id: "+e.id));throw t.stack+=e.stack,t}const{resolve:t,reject:n}=qo.get(e.id);if(e.error){const t=nt.fromJSON({code:"EIO",errno:Qe.EIO,...e.error});return t.stack+=e.stack,Wo(e.id),void n(t)}Wo(e.id),t(["stat","createFile","mkdir"].includes(e.method)?new Qr(e.value):e.value)}function Ko(e,t){if(!e)throw gt(it("EINVAL","Cannot attach to non-existent port"));bt("Attached handler to port: "+t.name),e.addHandler(t)}function Jo(e,t){if(!e)throw gt(it("EINVAL","Cannot detach from non-existent port"));bt("Detached handler from port: "+t.name),e.removeHandler(t)}function Zo(e){const t=[],n=t.push.bind(t);return Ko(e,n),async function(r){Jo(e,n);for(const n of t){const t="data"in n?n.data:n;await Qo(e,r,t)}}}async function Qo(e,t,n){if(!$o(n))return;let r,i;try{switch(n.method){case"read":{const[e,i,s,a]=n.args;await t.read(e,i,s,a),r=i;break}case"stat":case"createFile":case"mkdir":{const e=await t[n.method](...n.args),i=e instanceof Qr?e:new Qr(e);r=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);break}case"touch":{const[e,i]=n.args;await t.touch(e,new Qr(i)),r=void 0;break}default:r=await t[n.method](...n.args)}}catch(e){i=e instanceof nt?e.toJSON():Ve(e,"message","stack")}e.send({_zenfs:!0,...Ve(n,"id","method","stack"),error:i,value:r},[])}const ec=["rename","stat","touch","createFile","unlink","rmdir","mkdir","readdir","exists","link","sync","read","write"];function tc(e){return class extends e{async done(){return this.sync()}queueDone(){return this.sync()}_promise=Promise.resolve();_async(e){this._promise=this._promise.finally(()=>e())}_isInitialized=!1;_skippedCacheUpdates=0;constructor(...e){super(...e),this._patchAsync()}async ready(){if(await super.ready(),!this._isInitialized&&!this.attributes.has("no_async_preload")){if(await this._promise,this.checkSync(),await this._sync.ready(),this._sync instanceof vi&&this instanceof vi){const e=this._sync.transaction(),t=this.transaction(),n=[];for(const r of await t.keys())n.push(t.get(r).then(t=>e.setSync(r,t)));return await Promise.all(n),void(this._isInitialized=!0)}try{await this.crossCopy("/"),wt(`Skipped ${this._skippedCacheUpdates} updates to the sync cache during initialization`),this._isInitialized=!0}catch(e){throw this._isInitialized=!1,pt(e)}}}checkSync(){if(this.attributes.has("no_async_preload"))throw it("ENOTSUP","Sync preloading has been disabled for this async file system");if(!this._sync)throw pt(it("ENOTSUP","No sync cache is attached to this async file system"))}renameSync(e,t){this.checkSync(),this._sync.renameSync(e,t),this._async(()=>this.rename(e,t))}statSync(e){return this.checkSync(),this._sync.statSync(e)}touchSync(e,t){this.checkSync(),this._sync.touchSync(e,t),this._async(()=>this.touch(e,t))}createFileSync(e,t){this.checkSync();const n=this._sync.createFileSync(e,t);return this._async(()=>this.createFile(e,t)),n}unlinkSync(e){this.checkSync(),this._sync.unlinkSync(e),this._async(()=>this.unlink(e))}rmdirSync(e){this.checkSync(),this._sync.rmdirSync(e),this._async(()=>this.rmdir(e))}mkdirSync(e,t){this.checkSync();const n=this._sync.mkdirSync(e,t);return this._async(()=>this.mkdir(e,t)),n}readdirSync(e){return this.checkSync(),this._sync.readdirSync(e)}linkSync(e,t){this.checkSync(),this._sync.linkSync(e,t),this._async(()=>this.link(e,t))}async sync(){!this.attributes.has("no_async_preload")&&this._sync&&this._sync.syncSync(),await this._promise.catch(()=>{})}syncSync(){this.checkSync(),this._sync.syncSync()}existsSync(e){return this.checkSync(),this._sync.existsSync(e)}readSync(e,t,n,r){this.checkSync(),this._sync.readSync(e,t,n,r)}writeSync(e,t,n){this.checkSync(),this._sync.writeSync(e,t,n),this._async(()=>this.write(e,t,n))}streamWrite(e,t){this.checkSync();const n=this._sync.streamWrite(e,t).getWriter(),r=super.streamWrite(e,t).getWriter();return new WritableStream({async write(e,t){await Promise.all([n.write(e),r.write(e)]).catch(t.error.bind(t))},async close(){await Promise.all([n.close(),r.close()])},async abort(e){await Promise.all([n.abort(e),r.abort(e)])}})}async crossCopy(e){this.checkSync();const t=await this.stat(e);if(!ti(t)){this._sync.createFileSync(e,t);const n=new Uint8Array(t.size);return await this.read(e,n,0,t.size),this._sync.writeSync(e,n,0),void this._sync.touchSync(e,t)}"/"!==e&&(this._sync.mkdirSync(e,t),this._sync.touchSync(e,t));const n=[];for(const t of await this.readdir(e))n.push(this.crossCopy(Cr(e,t)));await Promise.all(n)}_patchAsync(){const e=["read","readdir","stat","exists"],t=ec.filter(t=>!e.includes(t));for(const n of t){const r=this[n].bind(this);function i(e,t){if(t||(t=new Error,Error.captureStackTrace(t,i)),!t.stack)return!1;const r=t.stack.split("\n").slice(e).join("\n");return r.includes(`at <computed> [as ${n}]`)||r.includes(`at async <computed> [as ${n}]`)||r.includes(`${n}Sync `)}this[n]=async(...e)=>{const t=await r(...e);if(i(2))return t;if(!this._isInitialized)return this._skippedCacheUpdates++,t;try{this._sync?.[`${n}Sync`]?.(...e)}catch(e){if(i(3,e))return t;throw e.message+=" (Out of sync!)",gt(e)}return t}}wt(`Async: patched ${t.length} methods`)}}}class nc extends(tc(di)){channel;timeout;port;_sync=ki.create({label:"tmpfs:port"});constructor(e,t=250){super(1886351988,"portfs"),this.channel=e,this.timeout=t,this.port=jo(e),Ko(this.port,Yo)}rpc(e,...t){return Xo({method:e,args:t},{port:this.port,timeout:this.timeout,fs:this})}async ready(){await this.rpc("ready"),await super.ready()}rename(e,t){return this.rpc("rename",e,t)}async stat(e){const t=await this.rpc("stat",e);return t instanceof Qr?t:new Qr(t)}async touch(e,t){const n=t instanceof Qr?t:new Qr(t);await this.rpc("touch",e,new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}async sync(){await super.sync(),await this.rpc("sync")}async createFile(e,t){t instanceof Qr&&(t=t.toJSON());const n=await this.rpc("createFile",e,t);return n instanceof Qr?n:new Qr(n)}unlink(e){return this.rpc("unlink",e)}rmdir(e){return this.rpc("rmdir",e)}async mkdir(e,t){t instanceof Qr&&(t=t.toJSON());const n=await this.rpc("mkdir",e,t);return n instanceof Qr?n:new Qr(n)}readdir(e){return this.rpc("readdir",e)}exists(e){return this.rpc("exists",e)}link(e,t){return this.rpc("link",e,t)}async read(e,t,n,r){t.set(await this.rpc("read",e,t,n,r))}write(e,t,n){return this.rpc("write",e,t,n)}}function rc(e,t){const n=jo(e);Ko(n,e=>Qo(n,t,e))}function ic(e,t){const n=jo(e);Jo(n,e=>Qo(n,t,e))}const sc={name:"Port",options:{port:{type:[EventTarget,function(e){return"object"==typeof e&&"on"in e}],required:!0},timeout:{type:"number",required:!1}},create:e=>new nc(e.port,e.timeout)};async function ac(e,t,n=0){const r=jo(e),i=Zo(r),s=await oo(t,n);return rc(r,s),await i(s),bt("Resolved remote mount: "+s.toString()),s}const oc=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let e=0;e<8;e++)t=1&t?2197175160^t>>>1:t>>>1;oc[e]=t}var cc=function(e,t,n,r,i,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=r.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?r.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var g in r)p[g]="access"===g?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[l],p);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(h.get=o),(o=a(m.set))&&(h.set=o),(o=a(m.init))&&i.unshift(o)}else(o=a(m))&&("field"===c?i.unshift(o):h[l]=o)}u&&Object.defineProperty(u,r.name,h),d=!0},lc=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0},uc=function(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},hc=function(e){return function(t){function n(n){t.error=t.hasError?new e(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(e,function(t){return n(t),e()})}else i|=1}catch(e){n(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});const dc=e=>"0x"+e.toString(16).padStart(8,"0"),{format:fc}=new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:2,unit:"byte",unitDisplay:"narrow"});let pc=(()=>{var e,t,n,r;let i,s,a,o,c,l,u=[rr.packed("MetadataEntry")],h=[],d=dr,f=[],p=[],g=[],m=[],y=[],b=[],w=[],v=[];return class extends d{static{s=this}static{const S="function"==typeof Symbol&&Symbol.metadata?Object.create(d[Symbol.metadata]??null):void 0;a=[(e=ar).uint32.bind(e)],o=[(t=ar).uint32.bind(t)],c=[(n=ar).uint32.bind(n)],l=[(r=ar).uint32.bind(r)],cc(this,null,a,{kind:"accessor",name:"id",static:!1,private:!1,access:{has:e=>"id"in e,get:e=>e.id,set:(e,t)=>{e.id=t}},metadata:S},f,p),cc(this,null,o,{kind:"accessor",name:"offset_",static:!1,private:!1,access:{has:e=>"offset_"in e,get:e=>e.offset_,set:(e,t)=>{e.offset_=t}},metadata:S},g,m),cc(this,null,c,{kind:"accessor",name:"offset",static:!1,private:!1,access:{has:e=>"offset"in e,get:e=>e.offset,set:(e,t)=>{e.offset=t}},metadata:S},y,b),cc(this,null,l,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:S},w,v),cc(null,i={value:s},u,{kind:"class",name:s.name,metadata:S},null,h),s=i.value,S&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:S}),lc(s,h)}#S=lc(this,f,void 0);get id(){return this.#S}set id(e){this.#S=e}#x=(lc(this,p),lc(this,g,void 0));get offset_(){return this.#x}set offset_(e){this.#x=e}#E=(lc(this,m),lc(this,y,void 0));get offset(){return this.#E}set offset(e){this.#E=e}#n=(lc(this,b),lc(this,w,void 0));get size(){return this.#n}set size(e){this.#n=e}toString(){return`<MetadataEntry @ ${dc(this.byteOffset)}>`}constructor(){super(...arguments),lc(this,v)}},s})(),gc=(()=>{var e,t,n,r;let i,s,a,o,c,l,u,h=[rr.packed("MetadataBlock")],d=[],f=or.typed(Int32Array),p=[],g=[],m=[],y=[],b=[],w=[],v=[],S=[],x=[],E=[];var I=class extends f{static{s=this}static{const k="function"==typeof Symbol&&Symbol.metadata?Object.create(f[Symbol.metadata]??null):void 0;a=[(e=ar).uint32.bind(e)],o=[(t=ar).uint64.bind(t)],c=[(n=ar).uint32.bind(n)],l=[ir(zn(pc,255))],u=[(r=ar).int32.bind(r)],cc(this,null,a,{kind:"accessor",name:"checksum",static:!1,private:!1,access:{has:e=>"checksum"in e,get:e=>e.checksum,set:(e,t)=>{e.checksum=t}},metadata:k},p,g),cc(this,null,o,{kind:"accessor",name:"timestamp",static:!1,private:!1,access:{has:e=>"timestamp"in e,get:e=>e.timestamp,set:(e,t)=>{e.timestamp=t}},metadata:k},m,y),cc(this,null,c,{kind:"accessor",name:"previous_offset",static:!1,private:!1,access:{has:e=>"previous_offset"in e,get:e=>e.previous_offset,set:(e,t)=>{e.previous_offset=t}},metadata:k},b,w),cc(this,null,l,{kind:"accessor",name:"items",static:!1,private:!1,access:{has:e=>"items"in e,get:e=>e.items,set:(e,t)=>{e.items=t}},metadata:k},v,S),cc(this,null,u,{kind:"accessor",name:"locked",static:!1,private:!1,access:{has:e=>"locked"in e,get:e=>e.locked,set:(e,t)=>{e.locked=t}},metadata:k},x,E),cc(null,i={value:s},h,{kind:"class",name:s.name,metadata:k},null,d),I=s=i.value,k&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k})}static lockIndex=function(e,t){let n;if(cr(e))n=e;else{if(!cr(e.constructor))throw it("EINVAL","Type is not a struct or struct constructor");n=e.constructor}const{fields:r}=n;if(!(t in r))throw it("EINVAL","Struct does not have field: "+t);return r[t].offset}(I,"locked")/Int32Array.BYTES_PER_ELEMENT;#I=lc(this,p,void 0);get checksum(){return this.#I}set checksum(e){this.#I=e}#k=(lc(this,g),lc(this,m,BigInt(Date.now())));get timestamp(){return this.#k}set timestamp(e){this.#k=e}#T=(lc(this,y),lc(this,b,void 0));get previous_offset(){return this.#T}set previous_offset(e){this.#T=e}_previous=lc(this,w);get previous(){if(this.previous_offset)return this._previous??=new I(this.buffer,this.previous_offset),this._previous}#_=lc(this,v,void 0);get items(){return this.#_}set items(e){this.#_=e}toString(e=!1){if(!e)return`<MetadataBlock @ ${dc(this.byteOffset)}>`;let t=[`---- Metadata block at ${dc(this.byteOffset)} ----`,`Checksum: ${dc(this.checksum)}`,`Last updated: ${new Date(Number(this.timestamp)).toLocaleString()}`,`Previous block: ${dc(this.previous_offset)}`,"Entries:"].join("\n");for(const e of this.items)e.offset&&(t+=`\n\t${dc(e.id)}: ${fc(e.size).padStart(5)} at ${dc(e.offset)}`);return t}#C=(lc(this,S),lc(this,x,void 0));get locked(){return this.#C}set locked(e){this.#C=e}waitUnlocked(e=0){if(e>5)throw pt(it("EBUSY",`sbfs: exceeded max attempts waiting for metadata block at ${dc(this.byteOffset)} to be unlocked`));if(Atomics.load(this,I.lockIndex))switch(Atomics.wait(this,I.lockIndex,1)){case"ok":break;case"not-equal":return e++,gt(`sbfs: waiting for metadata block at ${dc(this.byteOffset)} to be unlocked (${e}/5)`),this.waitUnlocked(e);case"timed-out":throw pt(it("EBUSY",`sbfs: timed out waiting for metadata block at ${dc(this.byteOffset)} to be unlocked`))}}lock(){this.waitUnlocked(),Atomics.store(this,I.lockIndex,1);const e=()=>{Atomics.store(this,I.lockIndex,0),Atomics.notify(this,I.lockIndex,1)};return e[Symbol.dispose]=e,e}constructor(){super(...arguments),lc(this,E)}static{lc(s,d)}};return I=s})();const mc=1651715706;let yc=(()=>{var e,t,n,r,i,s,a,o,c,l;let u,h,d,f,p,g,m,y,b,w,v,S,x,E,I,k=[rr.packed("Superblock")],T=[],_=or.typed(BigUint64Array),C=[],A=[],F=[],R=[],M=[],D=[],O=[],P=[],N=[],L=[],B=[],U=[],V=[],j=[],z=[],G=[],H=[],$=[],W=[],q=[],X=[],Y=[],K=[],J=[],Z=[],Q=[];var ee=class extends _{static{h=this}static{const te="function"==typeof Symbol&&Symbol.metadata?Object.create(_[Symbol.metadata]??null):void 0;d=[(e=ar).uint32.bind(e)],f=[(t=ar).uint32.bind(t)],p=[(n=ar).uint16.bind(n)],g=[(r=ar).uint16.bind(r)],m=[(i=ar).uint32.bind(i)],y=[(s=ar).uint64.bind(s)],b=[(a=ar).uint64.bind(a)],w=[ar.uint8(16)],v=[(o=ar).uint32.bind(o)],S=[(c=ar).uint32.bind(c)],x=[(l=ar).uint32.bind(l)],E=[ar.char(64)],I=[ar.char(132)],cc(this,null,d,{kind:"accessor",name:"checksum",static:!1,private:!1,access:{has:e=>"checksum"in e,get:e=>e.checksum,set:(e,t)=>{e.checksum=t}},metadata:te},C,A),cc(this,null,f,{kind:"accessor",name:"magic",static:!1,private:!1,access:{has:e=>"magic"in e,get:e=>e.magic,set:(e,t)=>{e.magic=t}},metadata:te},F,R),cc(this,null,p,{kind:"accessor",name:"version",static:!1,private:!1,access:{has:e=>"version"in e,get:e=>e.version,set:(e,t)=>{e.version=t}},metadata:te},M,D),cc(this,null,g,{kind:"accessor",name:"inode_format",static:!1,private:!1,access:{has:e=>"inode_format"in e,get:e=>e.inode_format,set:(e,t)=>{e.inode_format=t}},metadata:te},O,P),cc(this,null,m,{kind:"accessor",name:"flags",static:!1,private:!1,access:{has:e=>"flags"in e,get:e=>e.flags,set:(e,t)=>{e.flags=t}},metadata:te},N,L),cc(this,null,y,{kind:"accessor",name:"used_bytes",static:!1,private:!1,access:{has:e=>"used_bytes"in e,get:e=>e.used_bytes,set:(e,t)=>{e.used_bytes=t}},metadata:te},B,U),cc(this,null,b,{kind:"accessor",name:"total_bytes",static:!1,private:!1,access:{has:e=>"total_bytes"in e,get:e=>e.total_bytes,set:(e,t)=>{e.total_bytes=t}},metadata:te},V,j),cc(this,null,w,{kind:"accessor",name:"uuid",static:!1,private:!1,access:{has:e=>"uuid"in e,get:e=>e.uuid,set:(e,t)=>{e.uuid=t}},metadata:te},z,G),cc(this,null,v,{kind:"accessor",name:"metadata_block_size",static:!1,private:!1,access:{has:e=>"metadata_block_size"in e,get:e=>e.metadata_block_size,set:(e,t)=>{e.metadata_block_size=t}},metadata:te},H,$),cc(this,null,S,{kind:"accessor",name:"metadata_offset_",static:!1,private:!1,access:{has:e=>"metadata_offset_"in e,get:e=>e.metadata_offset_,set:(e,t)=>{e.metadata_offset_=t}},metadata:te},W,q),cc(this,null,x,{kind:"accessor",name:"metadata_offset",static:!1,private:!1,access:{has:e=>"metadata_offset"in e,get:e=>e.metadata_offset,set:(e,t)=>{e.metadata_offset=t}},metadata:te},X,Y),cc(this,null,E,{kind:"accessor",name:"label",static:!1,private:!1,access:{has:e=>"label"in e,get:e=>e.label,set:(e,t)=>{e.label=t}},metadata:te},K,J),cc(this,null,I,{kind:"accessor",name:"_padding",static:!1,private:!1,access:{has:e=>"_padding"in e,get:e=>e._padding,set:(e,t)=>{e._padding=t}},metadata:te},Z,Q),cc(null,u={value:h},k,{kind:"class",name:h.name,metadata:te},null,T),ee=h=u.value,te&&Object.defineProperty(h,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:te}),lc(h,T)}constructor(...e){if(super(...e),lc(this,Q),this.magic!=mc){mt("sbfs: Invalid magic value, assuming this is a fresh super block");const e=new gc(this.buffer,ur(ee));return Object.assign(this,{metadata:e,metadata_offset:e.byteOffset,used_bytes:BigInt(ur(ee)+ur(gc)),total_bytes:BigInt(this.buffer.byteLength),magic:mc,version:1,inode_format:Yr,metadata_block_size:ur(gc),uuid:Ze(crypto.randomUUID())}),wc(this),void wc(e)}if(this.checksum!==bc(this))throw pt(it("EIO","sbfs: checksum mismatch for super block"));if(this.metadata=new gc(this.buffer,this.metadata_offset),this.metadata.checksum!==bc(this.metadata))throw pt(it("EIO",`sbfs: checksum mismatch for metadata block (saved ${dc(this.metadata.checksum)}, computed ${dc(bc(this.metadata))})`));if(this.inode_format!=Yr)throw pt(it("EIO","sbfs: inode format mismatch"));if(this.metadata_block_size!=ur(gc))throw pt(it("EIO","sbfs: metadata block size mismatch"))}#I=lc(this,C,void 0);get checksum(){return this.#I}set checksum(e){this.#I=e}#A=(lc(this,A),lc(this,F,void 0));get magic(){return this.#A}set magic(e){this.#A=e}#y=(lc(this,R),lc(this,M,void 0));get version(){return this.#y}set version(e){this.#y=e}#F=(lc(this,D),lc(this,O,void 0));get inode_format(){return this.#F}set inode_format(e){this.#F=e}#g=(lc(this,P),lc(this,N,void 0));get flags(){return this.#g}set flags(e){this.#g=e}#R=(lc(this,L),lc(this,B,void 0));get used_bytes(){return this.#R}set used_bytes(e){this.#R=e}#M=(lc(this,U),lc(this,V,void 0));get total_bytes(){return this.#M}set total_bytes(e){this.#M=e}#D=(lc(this,j),lc(this,z,void 0));get uuid(){return this.#D}set uuid(e){this.#D=e}#O=(lc(this,G),lc(this,H,void 0));get metadata_block_size(){return this.#O}set metadata_block_size(e){this.#O=e}#P=(lc(this,$),lc(this,W,void 0));get metadata_offset_(){return this.#P}set metadata_offset_(e){this.#P=e}#N=(lc(this,q),lc(this,X,void 0));get metadata_offset(){return this.#N}set metadata_offset(e){this.#N=e}metadata=lc(this,Y);#L=lc(this,K,void 0);get label(){return this.#L}set label(e){this.#L=e}#B=(lc(this,J),lc(this,Z,void 0));get _padding(){return this.#B}set _padding(e){this.#B=e}rotateMetadata(){const e=this.used_bytes%BigInt(4);Atomics.add(this,2,e);const t=Number(Atomics.add(this,2,BigInt(ur(gc)))),n=new gc(this.buffer,t);return n.previous_offset=this.metadata_offset,this.metadata=n,this.metadata_offset=n.byteOffset,wc(n),wc(this),wt(`sbfs: rotated metadata block at ${dc(n.previous_offset)} with new block at ${dc(t)}`),n}isUnused(e,t){if(!t)return!0;if(e+t>this.total_bytes||e<ur(ee))return!1;for(let n=this.metadata;n;n=n.previous){if(e<n.byteOffset+ur(gc)&&e+t>n.byteOffset)return!1;for(const r of n.items)if(r.offset&&(e>=r.offset&&e<r.offset+r.size||e+t>r.offset&&e+t<=r.offset+r.size||e<=r.offset&&e+t>=r.offset+r.size))return!1}return!0}};return ee=h})();function bc(e){let t=ur(e)-4;return e instanceof gc&&(t-=Int32Array.BYTES_PER_ELEMENT),function(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^oc[255&(t^e[n])];return(4294967295^t)>>>0}(new Uint8Array(e.buffer,e.byteOffset+4,t))}function wc(e){e instanceof gc&&(e.timestamp=BigInt(Date.now())),e.checksum=bc(e)}class vc extends dr{flags=[];name="sbfs";type=1935828595;get uuid(){return function(e){const t=Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20)}`}(this.superblock.uuid)}superblock;_view;_u8;constructor(...e){if(super(...e),this.byteLength<ur(yc)+ur(gc))throw pt(it("EINVAL","sbfs: Buffer is too small for a file system"));this._view=new DataView(this.buffer,this.byteOffset,this.byteLength),this._u8=new Uint8Array(this.buffer,this.byteOffset,this.byteLength),this.superblock=new yc(this.buffer,this.byteOffset)}*keys(){const e=new Set;for(let t=this.superblock.metadata;t;t=t.previous){t.waitUnlocked();for(const n of t.items)n.offset&&!e.has(n.id)&&(e.add(n.id),yield n.id)}}get(e){for(let t=this.superblock.metadata;t;t=t.previous){t.waitUnlocked();for(const n of t.items){if(!n.offset||n.id!=e)continue;const t=this.byteOffset+n.offset;return new Uint8Array(this.buffer.slice(t,t+n.size))}}}set(e,t){const n={stack:[],error:void 0,hasError:!1};try{if(0===e&&t.length<ur(Qr))throw ft(it("EIO",`sbfs: tried to set ${t.length} bytes for id 0!`));for(let n=this.superblock.metadata;n;n=n.previous){n.waitUnlocked();for(const r of n.items){const i={stack:[],error:void 0,hasError:!1};try{if(!r.offset||r.id!=e)continue;return uc(i,n.lock(),!1),t.length==r.size?void this._u8.set(t,r.offset):t.length<r.size||this.superblock.isUnused(r.offset,t.length)?(this._u8.set(t,r.offset),r.size=t.length,void wc(n)):(r.offset=Number(Atomics.add(this.superblock,2,BigInt(t.length))),r.size=t.length,this._u8.set(t,r.offset),wc(n),void wc(this.superblock))}catch(e){i.error=e,i.hasError=!0}finally{hc(i)}}}let r=Array.from(this.superblock.metadata.items).find(e=>!e.offset);r||(this.superblock.rotateMetadata(),r=this.superblock.metadata.items[0]),uc(n,this.superblock.metadata.lock(),!1);const i=Number(Atomics.add(this.superblock,2,BigInt(t.length)));r.id=e,r.offset=i,r.size=t.length,this._u8.set(t,i),wc(this.superblock.metadata),wc(this.superblock)}catch(e){n.error=e,n.hasError=!0}finally{hc(n)}}delete(e){for(let t=this.superblock.metadata;t;t=t.previous){t.waitUnlocked();for(const n of t.items)if(n.id==e)return n.offset=0,n.size=0,n.id=0,void wc(t)}}_fs;get fs(){return this._fs}set fs(e){"SharedArrayBuffer"===this.buffer.constructor.name&&e?.attributes.set("no_id_tables",!0),this._fs=e}sync(){return Promise.resolve()}usage(){return{totalSpace:Number(this.superblock.total_bytes),freeSpace:Number(this.superblock.total_bytes-this.superblock.used_bytes)}}transaction(){return new Si(this)}}const Sc={name:"SingleBuffer",options:{buffer:{type:"object",required:!0}},create(e){const t=new vi(ArrayBuffer.isView(e.buffer)?new vc(e.buffer.buffer,e.buffer.byteOffset,e.buffer.byteLength):new vc(e.buffer));return t.checkRootSync(),t}},xc=Sc,Ec=()=>{};function Ic(e,t,n=Ec){Ta.call(this,e,t).then(()=>n(null)).catch(n)}function kc(e,t=Ec){_a.call(this,e).then(t).catch(()=>t(!1))}function Tc(e,t,n=Ec){n="function"==typeof t?t:n,Ca.call(this,e,"function"!=typeof t?t:{}).then(e=>n(null,e)).catch(n)}function _c(e,t,n=Ec){n="function"==typeof t?t:n,Aa.call(this,e,"function"!=typeof t?t:{}).then(e=>n(null,e)).catch(n)}function Cc(e,t=0,n=Ec){n="function"==typeof t?t:n;const r="number"==typeof t?t:0;Fa.call(this,e,r).then(()=>n(null)).catch(n)}function Ac(e,t=Ec){Ra.call(this,e).then(()=>t(null)).catch(t)}function Fc(e,t,n,r=Ec){const i=gr(n,420);r="function"==typeof n?n:r,Ma.call(this,e,t,i).then(e=>r(null,e.fd)).catch(r)}function Rc(e,t,n=Ec){n="function"==typeof t?t:n,Da.call(this,e,"function"==typeof t?null:t).then(e=>n(null,e)).catch(n)}function Mc(e,t,n,r=Ec){r="function"==typeof n?n:r,Oa.call(this,e,t,"function"!=typeof n?n:null).then(()=>r(null)).catch(r)}function Dc(e,t,n,r=Ec){const i="function"!=typeof n?n:void 0;r="function"==typeof n?n:r,Pa.call(this,e,t,i).then(()=>r(null)).catch(r)}function Oc(e,t,n=Ec){n="function"==typeof t?t:n,new ka(this,e).stat().then(e=>n(null,"object"==typeof t&&t?.bigint?new Ur(e):e)).catch(n)}function Pc(e,t=Ec){new ka(this,e).close().then(()=>t(null)).catch(t)}function Nc(e,t,n=Ec){const r="number"==typeof t?t:0;n="function"==typeof t?t:n;const i=new ka(this,e);if(r<0)throw it("EINVAL");i.truncate(r).then(()=>n(null)).catch(n)}function Lc(e,t=Ec){new ka(this,e).sync().then(()=>t(null)).catch(t)}function Bc(e,t=Ec){new ka(this,e).datasync().then(()=>t(null)).catch(t)}function Uc(e,t,n,r,i,s=Ec){let a,o,c,l,u;const h=new ka(this,e);if("string"==typeof t){switch(u="utf8",typeof n){case"function":s=n;break;case"number":l=n,u="string"==typeof r?r:"utf8",s="function"==typeof i?i:s;break;default:return void(s="function"==typeof r?r:"function"==typeof i?i:s)(it("EINVAL"))}a=Oi.Buffer.from(t),o=0,c=a.length;const e=s;h.write(a,o,c,l).then(({bytesWritten:t})=>e(null,t,a.toString(u))).catch(e)}else{a=Oi.Buffer.from(t.buffer),o=n,c=r,l="number"==typeof i?i:null;const e="function"==typeof i?i:s;h.write(a,o,c,l).then(({bytesWritten:t})=>e(null,t,a)).catch(e)}}function Vc(e,t,n,r,i,s=Ec){new ka(this,e).read(t,n,r,i).then(({bytesRead:e,buffer:t})=>s(null,e,t)).catch(s)}function jc(e,t,n,r=Ec){new ka(this,e).chown(t,n).then(()=>r(null)).catch(r)}function zc(e,t,n){new ka(this,e).chmod(t).then(()=>n(null)).catch(n)}function Gc(e,t,n,r=Ec){new ka(this,e).utimes(t,n).then(()=>r(null)).catch(r)}function Hc(e,t=Ec){Na.call(this,e).then(()=>t(null)).catch(t)}function $c(e,t,n=Ec){La.call(this,e,t).then(()=>n(null)).catch(n)}function Wc(e,t,n=Ec){n="function"==typeof t?t:n;const r="function"!=typeof t?t:{};Ba.call(this,e,r).then(e=>n(null,e)).catch(n)}function qc(e,t,n=Ec){Ua.call(this,e,t).then(()=>n(null)).catch(n)}function Xc(e,t,n,r=Ec){const i="string"==typeof n?n:"file";r="function"==typeof n?n:r,Va.call(this,e,t,i).then(()=>r(null)).catch(r)}function Yc(e,t,n=Ec){n="function"==typeof t?t:n,ja.call(this,e).then(e=>n(null,e)).catch(n)}function Kc(e,t,n,r=Ec){za.call(this,e,t,n).then(()=>r(null)).catch(r)}function Jc(e,t,n,r=Ec){Ga.call(this,e,t,n).then(()=>r(null)).catch(r)}function Zc(e,t,n=Ec){Ha.call(this,e,t).then(()=>n(null)).catch(n)}function Qc(e,t,n=Ec){$a.call(this,e,t).then(()=>n(null)).catch(n)}function el(e,t,n,r=Ec){Wa.call(this,e,t,n).then(()=>r(null)).catch(r)}function tl(e,t,n,r=Ec){qa.call(this,e,t,n).then(()=>r(null)).catch(r)}function nl(e,t,n=Ec){n="function"==typeof t?t:n,Xa.call(this,e,"function"==typeof t?null:t).then(e=>n(null,e)).catch(n)}function rl(e,t,n=Ec){const r="number"==typeof t?t:zt;n="function"==typeof t?t:n,Ka.call(this,e,r).then(()=>n(null)).catch(n)}const il=new Map;function sl(e,t,n){const r=yr(e),i="function"!=typeof t?t:{};if("function"==typeof t&&(n=t),!n)throw rt("EINVAL","watch",e.toString());if(il.has(r)){const e=il.get(r);return void(e&&e.listeners.add(n))}const s=new oa(this,r,i);s.on("change",(e,t)=>{const n=il.get(r);if(n)for(const r of n.listeners)r(e,t)}),il.set(r,{watcher:s,listeners:new Set})}function al(e,t=Ec){const n=yr(e),r=il.get(n);r&&(t&&t!==Ec?r.listeners.delete(t):r.listeners.clear(),0===r.listeners.size&&(r.watcher.stop(),il.delete(n)))}function ol(e,t,n){const r=new aa(this,yr(e),"object"==typeof t?t:{});return n="function"==typeof t?t:n,r.on("change",n||Ec),r}function cl(e,t){t="object"==typeof t?t:{encoding:t};const n=Ma.call(this,e,"r",t?.mode);return new Sa({...t,autoClose:!0},n)}function ll(e,t){t="object"==typeof t?t:{encoding:t};const n=Ma.call(this,e,"w",t?.mode);return new xa(t,n)}function ul(e,t,n=Ec){n="function"==typeof t?t:n,Ja.call(this,e,"function"==typeof t?void 0:t).then(()=>n(null)).catch(n)}function hl(e,t,n=Ec){n="function"==typeof t?t:n,Za.call(this,e,"function"!=typeof t?t:null).then(e=>n(null,e)).catch(n)}function dl(e,t,n,r=Ec){r="function"==typeof n?n:r,eo.call(this,e,t,"function"==typeof n?void 0:n).then(()=>r(null)).catch(r)}function fl(e,t,n,r=Ec){r="function"==typeof n?n:r,new ka(this,e).readv(t,"function"==typeof n?void 0:n).then(({buffers:e,bytesRead:t})=>r(null,t,e)).catch(r)}function pl(e,t,n,r=Ec){r="function"==typeof n?n:r,new ka(this,e).writev(t,"function"==typeof n?void 0:n).then(({buffers:e,bytesWritten:t})=>r(null,t,e)).catch(r)}function gl(e,t,n=Ec){n="function"==typeof t?t:n,to.call(this,e,"function"==typeof t?void 0:t).then(e=>n(null,e)).catch(n)}function ml(e,t,n,r=Ec){r="function"==typeof n?n:r,no.call(this,e,t,"function"==typeof n?void 0:n).then(()=>r(null)).catch(r)}function yl(e,t,n=Ec){n="function"==typeof t?t:n,ro.call(this,e,"function"==typeof t?void 0:t).then(e=>n(null,e)).catch(n)}async function bl(e,t){const n=await Ma.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function wl(e,t,n=Ec){n="function"==typeof t?t:n,async function(e){const t=[];for await(const n of e)t.push(n);return t}(io.call(this,e,"function"==typeof t?void 0:t)).then(e=>n(null,e??[])).catch(e=>n(e))}const vl=[];function Sl(e,t,n,r){if(!t.startsWith("user.")&&!vl.includes(t))throw rt("ENOTSUP",r,n)}async function xl(e,t,n={}){e=yr(e);const{fs:r,path:i}=es(e,this);Sl(0,t,e,"xattr.get");const s=await r.stat(i).catch(st("xattr.get",e));if(Pi&&!oi(this,s,zt))throw rt("EACCES","xattr.get",e);s.attributes??=new qr;const a=s.attributes.get(t);if(!a)throw rt("ENODATA","xattr.get",e);const o=Oi.Buffer.from(a);return"buffer"!=n.encoding&&n.encoding?o.toString(n.encoding):o}function El(e,t,n={}){Sl(0,t,e=yr(e),"xattr.get");const{fs:r,path:i}=es(e,this);let s;try{s=r.statSync(i)}catch(t){throw tt(Object.assign(t,{path:e}))}if(Pi&&!oi(this,s,zt))throw rt("EACCES","xattr.get",e);s.attributes??=new qr;const a=s.attributes.get(t);if(!a)throw rt("ENODATA","xattr.get",e);const o=Oi.Buffer.from(a);return"buffer"!=n.encoding&&n.encoding?o.toString(n.encoding):o}async function Il(e,t,n,r={}){e=yr(e);const{fs:i,path:s}=es(e,this);Sl(0,t,e,"xattr.set");const a=await i.stat(s).catch(st("xattr.set",e));if(Pi&&!oi(this,a,Gt))throw rt("EACCES","xattr.set",e);a.attributes??=new qr;const o=a.attributes.get(t);if(r.create&&o)throw rt("EEXIST","xattr.set",e);if(r.replace&&!o)throw rt("ENODATA","xattr.set",e);a.attributes.set(t,Oi.Buffer.from(n)),await i.touch(s,a).catch(st("xattr.set",e))}function kl(e,t,n,r={}){e=yr(e);const{fs:i,path:s}=es(e,this);let a;Sl(0,t,e,"xattr.set");try{a=i.statSync(s)}catch(t){throw tt(Object.assign(t,{path:e}))}if(Pi&&!oi(this,a,Gt))throw rt("EACCES","xattr.set",e);a.attributes??=new qr;const o=a.attributes.get(t);if(r.create&&o)throw rt("EEXIST","xattr.set",e);if(r.replace&&!o)throw rt("ENODATA","xattr.set",e);a.attributes.set(t,Oi.Buffer.from(n));try{i.touchSync(s,a)}catch(t){throw tt(Object.assign(t,{path:e}))}}async function Tl(e,t){e=yr(e);const{fs:n,path:r}=es(e,this);Sl(0,t,e,"xattr.remove");const i=await n.stat(r).catch(st("xattr.remove",e));if(Pi&&!oi(this,i,Gt))throw rt("EACCES","xattr.remove",e);if(i.attributes??=new qr,!i.attributes.get(t))throw rt("ENODATA","xattr.remove",e);i.attributes.remove(t),await n.touch(r,i)}function _l(e,t){e=yr(e);const{fs:n,path:r}=es(e,this);let i;Sl(0,t,e,"xattr.remove");try{i=n.statSync(r)}catch(t){throw tt(Object.assign(t,{path:e}))}if(Pi&&!oi(this,i,Gt))throw rt("EACCES","xattr.remove",e);if(i.attributes??=new qr,!i.attributes.get(t))throw rt("ENODATA","xattr.remove",e);i.attributes.remove(t);try{n.touchSync(r,i)}catch(t){throw tt(Object.assign(t,{path:e}))}}async function Cl(e){e=yr(e);const{fs:t,path:n}=es(e,this),r=await t.stat(n).catch(st("xattr.list",e));return r.attributes?r.attributes.keys().toArray():[]}function Al(e){e=yr(e);const{fs:t,path:n}=es(e,this);let r;try{r=t.statSync(n)}catch(t){throw tt(Object.assign(t,{path:e}))}return r.attributes?r.attributes.keys().toArray():[]}let Fl=1;const Rl=new Map;function Ml({root:e=this?.root||"/",pwd:t=this?.pwd||"/",credentials:n=structuredClone(Vt.credentials)}={}){const i=this??Vt,a={id:Fl++,root:e,pwd:t,credentials:Bt(n),descriptors:new Map,parent:i,children:[]},l={...a,fs:{...Ge(o,a),promises:Ge(s,a),xattr:Ge(c,a)},path:Ge(r,a),bind:e=>{const t=Ml.call(a,e);return a.children.push(t),t}};return Rl.set(a.id,l),l}var Dl=function(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Ol=function(e){return function(t){function n(n){t.error=t.hasError?new e(n,t.error,"An error was suppressed during disposal."):n,t.hasError=!0}var r,i=0;return function e(){for(;r=t.stack.pop();)try{if(!r.async&&1===i)return i=0,t.stack.push(r),Promise.resolve().then(e);if(r.dispose){var s=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(s).then(e,function(t){return n(t),e()})}else i|=1}catch(e){n(e)}if(1===i)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}()}}("function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class Pl{previous;current=Promise.withResolvers();_isLocked=!0;get isLocked(){return this._isLocked}constructor(e){this.previous=e}async done(){await(this.previous?.done()),await this.current.promise}unlock(){this.current.resolve(),this._isLocked=!1}[Symbol.dispose](){this.unlock()}}class Nl{_fs;get type(){return this._fs.type}get name(){return this._fs.name}get label(){return this._fs.label}set label(e){this._fs.label=e}get attributes(){return this._fs.attributes}get _uuid(){return this._fs._uuid}set _uuid(e){this._fs._uuid=e}get uuid(){return this._fs.uuid}async ready(){return await this._fs.ready()}usage(){return this._fs.usage()}currentLock;addLock(){const e=new Pl(this.currentLock);return this.currentLock=e,e}async lock(e=5e3){const t=this.currentLock,n=this.addLock(),r=(new Error).stack;return setTimeout(()=>{if(n.isLocked){const e=it("EDEADLK");throw e.stack+=r?.slice(5),gt(e)}},e),await(t?.done()),n}lockSync(){if(this.currentLock?.isLocked)throw gt(it("EBUSY"));return this.addLock()}get isLocked(){return!!this.currentLock?.isLocked}async rename(e,t){const n={stack:[],error:void 0,hasError:!1};try{Dl(n,await this.lock(),!1),await this._fs.rename(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}renameSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,this.lockSync(),!1),this._fs.renameSync(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}async stat(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,await this.lock(),!1),await this._fs.stat(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}statSync(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,this.lockSync(),!1),this._fs.statSync(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}async touch(e,t){const n={stack:[],error:void 0,hasError:!1};try{Dl(n,await this.lock(),!1),await this._fs.touch(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}touchSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{Dl(n,this.lockSync(),!1),this._fs.touchSync(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}async createFile(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,await this.lock(),!1),await this._fs.createFile(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}createFileSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,this.lockSync(),!1),this._fs.createFileSync(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}async unlink(e){const t={stack:[],error:void 0,hasError:!1};try{Dl(t,await this.lock(),!1),await this._fs.unlink(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}unlinkSync(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,this.lockSync(),!1),this._fs.unlinkSync(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}async rmdir(e){const t={stack:[],error:void 0,hasError:!1};try{Dl(t,await this.lock(),!1),await this._fs.rmdir(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}rmdirSync(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,this.lockSync(),!1),this._fs.rmdirSync(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}async mkdir(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,await this.lock(),!1),await this._fs.mkdir(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}mkdirSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,this.lockSync(),!1),this._fs.mkdirSync(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}async readdir(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,await this.lock(),!1),await this._fs.readdir(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}readdirSync(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,this.lockSync(),!1),this._fs.readdirSync(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}async exists(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,await this.lock(),!1),await this._fs.exists(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}existsSync(e){const t={stack:[],error:void 0,hasError:!1};try{return Dl(t,this.lockSync(),!1),this._fs.existsSync(e)}catch(e){t.error=e,t.hasError=!0}finally{Ol(t)}}async link(e,t){const n={stack:[],error:void 0,hasError:!1};try{Dl(n,await this.lock(),!1),await this._fs.link(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}linkSync(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,this.lockSync(),!1),this._fs.linkSync(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}async sync(){const e={stack:[],error:void 0,hasError:!1};try{Dl(e,await this.lock(),!1),await this._fs.sync()}catch(t){e.error=t,e.hasError=!0}finally{Ol(e)}}syncSync(){const e={stack:[],error:void 0,hasError:!1};try{return Dl(e,this.lockSync(),!1),this._fs.syncSync()}catch(t){e.error=t,e.hasError=!0}finally{Ol(e)}}async read(e,t,n,r){const i={stack:[],error:void 0,hasError:!1};try{return Dl(i,await this.lock(),!1),await this._fs.read(e,t,n,r)}catch(e){i.error=e,i.hasError=!0}finally{Ol(i)}}readSync(e,t,n,r){const i={stack:[],error:void 0,hasError:!1};try{return Dl(i,this.lockSync(),!1),this._fs.readSync(e,t,n,r)}catch(e){i.error=e,i.hasError=!0}finally{Ol(i)}}async write(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{return Dl(r,await this.lock(),!1),await this._fs.write(e,t,n)}catch(e){r.error=e,r.hasError=!0}finally{Ol(r)}}writeSync(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{return Dl(r,this.lockSync(),!1),this._fs.writeSync(e,t,n)}catch(e){r.error=e,r.hasError=!0}finally{Ol(r)}}streamRead(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,this.lockSync(),!1),this._fs.streamRead(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}streamWrite(e,t){const n={stack:[],error:void 0,hasError:!1};try{return Dl(n,this.lockSync(),!1),this._fs.streamWrite(e,t)}catch(e){n.error=e,n.hasError=!0}finally{Ol(n)}}}function Ll(e){return class extends Nl{constructor(...t){super(),this._fs=new e(...t)}}}function Bl(e){return class extends e{constructor(...e){super(...e),this.attributes.set("no_write")}async rename(){throw it("EROFS")}renameSync(){throw it("EROFS")}async createFile(){throw it("EROFS")}createFileSync(){throw it("EROFS")}async unlink(){throw it("EROFS")}unlinkSync(){throw it("EROFS")}async rmdir(){throw it("EROFS")}rmdirSync(){throw it("EROFS")}async mkdir(){throw it("EROFS")}mkdirSync(){throw it("EROFS")}async link(){throw it("EROFS")}linkSync(){throw it("EROFS")}async touch(){throw it("EROFS")}touchSync(){throw it("EROFS")}async sync(){throw it("EROFS")}syncSync(){throw it("EROFS")}async write(){throw it("EROFS")}writeSync(){throw it("EROFS")}streamWrite(){throw it("EROFS")}}}function Ul(e){return class extends e{async exists(e){return this.existsSync(e)}async rename(e,t){return this.renameSync(e,t)}async stat(e){return this.statSync(e)}async touch(e,t){return this.touchSync(e,t)}async createFile(e,t){return this.createFileSync(e,t)}async unlink(e){return this.unlinkSync(e)}async rmdir(e){return this.rmdirSync(e)}async mkdir(e,t){return this.mkdirSync(e,t)}async readdir(e){return this.readdirSync(e)}async link(e,t){return this.linkSync(e,t)}async sync(){return this.syncSync()}async read(e,t,n,r){return this.readSync(e,t,n,r)}async write(e,t,n){return this.writeSync(e,t,n)}}}var Vl,jl=function(e,t,n,r,i,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=r.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?r.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var g in r)p[g]="access"===g?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[l],p);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(h.get=o),(o=a(m.set))&&(h.set=o),(o=a(m.init))&&i.unshift(o)}else(o=a(m))&&("field"===c?i.unshift(o):h[l]=o)}u&&Object.defineProperty(u,r.name,h),d=!0},zl=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0};!function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"}(Vl||(Vl={}));let Gl=(()=>{var e,t,n,r,i;let s,a,o,c,l,u,h,d,f=[rr("fsxattr")],p=[],g=dr,m=[],y=[],b=[],w=[],v=[],S=[],x=[],E=[],I=[],k=[],T=[],_=[];var C=class extends g{static{a=this}static{const A="function"==typeof Symbol&&Symbol.metadata?Object.create(g[Symbol.metadata]??null):void 0;o=[(e=ar).uint32.bind(e)],c=[(t=ar).uint32.bind(t)],l=[(n=ar).uint32.bind(n)],u=[(r=ar).uint32.bind(r)],h=[(i=ar).uint32.bind(i)],d=[ar.char(8)],jl(this,null,o,{kind:"accessor",name:"xflags",static:!1,private:!1,access:{has:e=>"xflags"in e,get:e=>e.xflags,set:(e,t)=>{e.xflags=t}},metadata:A},m,y),jl(this,null,c,{kind:"accessor",name:"extsize",static:!1,private:!1,access:{has:e=>"extsize"in e,get:e=>e.extsize,set:(e,t)=>{e.extsize=t}},metadata:A},b,w),jl(this,null,l,{kind:"accessor",name:"nextents",static:!1,private:!1,access:{has:e=>"nextents"in e,get:e=>e.nextents,set:(e,t)=>{e.nextents=t}},metadata:A},v,S),jl(this,null,u,{kind:"accessor",name:"projid",static:!1,private:!1,access:{has:e=>"projid"in e,get:e=>e.projid,set:(e,t)=>{e.projid=t}},metadata:A},x,E),jl(this,null,h,{kind:"accessor",name:"cowextsize",static:!1,private:!1,access:{has:e=>"cowextsize"in e,get:e=>e.cowextsize,set:(e,t)=>{e.cowextsize=t}},metadata:A},I,k),jl(this,null,d,{kind:"accessor",name:"pad",static:!1,private:!1,access:{has:e=>"pad"in e,get:e=>e.pad,set:(e,t)=>{e.pad=t}},metadata:A},T,_),jl(null,s={value:a},f,{kind:"class",name:a.name,metadata:A},null,p),C=a=s.value,A&&Object.defineProperty(a,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:A}),zl(a,p)}#U=zl(this,m,void 0);get xflags(){return this.#U}set xflags(e){this.#U=e}#V=(zl(this,y),zl(this,b,void 0));get extsize(){return this.#V}set extsize(e){this.#V=e}#j=(zl(this,w),zl(this,v,void 0));get nextents(){return this.#j}set nextents(e){this.#j=e}#z=(zl(this,S),zl(this,x,void 0));get projid(){return this.#z}set projid(e){this.#z=e}#G=(zl(this,E),zl(this,I,void 0));get cowextsize(){return this.#G}set cowextsize(e){this.#G=e}#H=(zl(this,k),zl(this,T,[]));get pad(){return this.#H}set pad(e){this.#H=e}constructor(e=$e(new nt(Qe.EINVAL,"fsxattr must be initialized with an inode"))){super(new ArrayBuffer(ur(C))),zl(this,_),this.extsize=e.size,this.nextents=1,this.projid=e.uid,this.cowextsize=e.size;for(const t of Object.keys(Kr))e.flags&Kr[t]&&t in Vl&&(this.xflags|=Vl[t])}};return C=a})();var Hl,$l,Wl;async function ql(e,t,...n){e=yr(e);const{fs:r,path:i}=es(e,this);try{const e=new Qr(await r.stat(i));switch(t){case $l.GetFlags:case Wl.GetFlags:return e.flags;case $l.SetFlags:case Wl.SetFlags:return e.flags=n[0],void await r.touch(i,e);case $l.GetVersion:case Wl.GetVersion:return e.version;case $l.SetVersion:case Wl.SetVersion:return e.version=n[0],void await r.touch(i,e);case $l.Fiemap:break;case $l.GetXattr:return new Gl(e);case $l.SetXattr:break;case $l.GetLabel:return r.label;case $l.SetLabel:return void(r.label=n[0]);case $l.GetUUID:return r.uuid;case $l.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(t){throw tt(Object.assign(t,{syscall:"ioctl",path:e}))}throw rt("ENOTSUP","ioctl",e)}function Xl(e,t,...n){e=yr(e);const{fs:r,path:i}=es(e,this);try{const e=new Qr(r.statSync(i));switch(t){case $l.GetFlags:case Wl.GetFlags:return e.flags;case $l.SetFlags:case Wl.SetFlags:return e.flags=n[0],void r.touchSync(i,e);case $l.GetVersion:case Wl.GetVersion:return e.version;case $l.SetVersion:case Wl.SetVersion:return e.version=n[0],void r.touchSync(i,e);case $l.Fiemap:break;case $l.GetXattr:return new Gl(e);case $l.SetXattr:break;case $l.GetLabel:return r.label;case $l.SetLabel:return void(r.label=n[0]);case $l.GetUUID:return r.uuid;case $l.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(t){throw tt(Object.assign(t,{syscall:"ioctl",path:e}))}throw rt("ENOTSUP","ioctl",e)}!function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"}(Hl||(Hl={})),function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"}($l||($l={})),function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"}(Wl||(Wl={}));const Yl=l;globalThis.__zenfs__=Object.assign(Object.create(l),{_version:"2.4.3"});var Kl=__webpack_require__(597),Jl=Uint8Array,Zl=Uint16Array,Ql=Int32Array,eu=new Jl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tu=new Jl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),nu=new Jl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ru=function(e,t){for(var n=new Zl(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new Ql(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return{b:n,r:i}},iu=ru(eu,2),su=iu.b,au=iu.r;su[28]=258,au[258]=28;for(var ou=ru(tu,0),cu=ou.b,lu=ou.r,uu=new Zl(32768),hu=0;hu<32768;++hu){var du=(43690&hu)>>1|(21845&hu)<<1;du=(61680&(du=(52428&du)>>2|(13107&du)<<2))>>4|(3855&du)<<4,uu[hu]=((65280&du)>>8|(255&du)<<8)>>1}var fu=function(e,t,n){for(var r=e.length,i=0,s=new Zl(t);i<r;++i)e[i]&&++s[e[i]-1];var a,o=new Zl(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(n){a=new Zl(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var l=i<<4|e[i],u=t-e[i],h=o[e[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)a[uu[h]>>c]=l}else for(a=new Zl(r),i=0;i<r;++i)e[i]&&(a[i]=uu[o[e[i]-1]++]>>15-e[i]);return a},pu=new Jl(288);for(hu=0;hu<144;++hu)pu[hu]=8;for(hu=144;hu<256;++hu)pu[hu]=9;for(hu=256;hu<280;++hu)pu[hu]=7;for(hu=280;hu<288;++hu)pu[hu]=8;var gu=new Jl(32);for(hu=0;hu<32;++hu)gu[hu]=5;var mu,yu=fu(pu,9,0),bu=fu(pu,9,1),wu=fu(gu,5,0),vu=fu(gu,5,1),Su=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},xu=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},Eu=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Iu=function(e){return(e+7)/8|0},ku=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new Jl(e.subarray(t,n))},Tu=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_u=function(e,t,n){var r=new Error(t||Tu[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,_u),!n)throw r;return r},Cu=function(e,t,n,r){var i=e.length,s=r?r.length:0;if(!i||t.f&&!t.l)return n||new Jl(0);var a=!n,o=a||2!=t.i,c=t.i;a&&(n=new Jl(3*i));var l=function(e){var t=n.length;if(e>t){var r=new Jl(Math.max(2*t,e));r.set(n),n=r}},u=t.f||0,h=t.p||0,d=t.b||0,f=t.l,p=t.d,g=t.m,m=t.n,y=8*i;do{if(!f){u=xu(e,h,1);var b=xu(e,h+1,3);if(h+=3,!b){var w=e[(F=Iu(h)+4)-4]|e[F-3]<<8,v=F+w;if(v>i){c&&_u(0);break}o&&l(d+w),n.set(e.subarray(F,v),d),t.b=d+=w,t.p=h=8*v,t.f=u;continue}if(1==b)f=bu,p=vu,g=9,m=5;else if(2==b){var S=xu(e,h,31)+257,x=xu(e,h+10,15)+4,E=S+xu(e,h+5,31)+1;h+=14;for(var I=new Jl(E),k=new Jl(19),T=0;T<x;++T)k[nu[T]]=xu(e,h+3*T,7);h+=3*x;var _=Su(k),C=(1<<_)-1,A=fu(k,_,1);for(T=0;T<E;){var F,R=A[xu(e,h,C)];if(h+=15&R,(F=R>>4)<16)I[T++]=F;else{var M=0,D=0;for(16==F?(D=3+xu(e,h,3),h+=2,M=I[T-1]):17==F?(D=3+xu(e,h,7),h+=3):18==F&&(D=11+xu(e,h,127),h+=7);D--;)I[T++]=M}}var O=I.subarray(0,S),P=I.subarray(S);g=Su(O),m=Su(P),f=fu(O,g,1),p=fu(P,m,1)}else _u(1);if(h>y){c&&_u(0);break}}o&&l(d+131072);for(var N=(1<<g)-1,L=(1<<m)-1,B=h;;B=h){var U=(M=f[Eu(e,h)&N])>>4;if((h+=15&M)>y){c&&_u(0);break}if(M||_u(2),U<256)n[d++]=U;else{if(256==U){B=h,f=null;break}var V=U-254;if(U>264){var j=eu[T=U-257];V=xu(e,h,(1<<j)-1)+su[T],h+=j}var z=p[Eu(e,h)&L],G=z>>4;if(z||_u(3),h+=15&z,P=cu[G],G>3&&(j=tu[G],P+=Eu(e,h)&(1<<j)-1,h+=j),h>y){c&&_u(0);break}o&&l(d+131072);var H=d+V;if(d<P){var $=s-P,W=Math.min(P,H);for($+d<0&&_u(3);d<W;++d)n[d]=r[$+d]}for(;d<H;++d)n[d]=n[d-P]}}t.l=f,t.p=B,t.b=d,t.f=u,f&&(u=1,t.m=g,t.d=p,t.n=m)}while(!u);return d!=n.length&&a?ku(n,0,d):n.subarray(0,d)},Au=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Fu=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Ru=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,s=n.slice();if(!i)return{t:Bu,l:0};if(1==i){var a=new Jl(n[0].s+1);return a[n[0].s]=1,{t:a,l:1}}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var o=n[0],c=n[1],l=0,u=1,h=2;for(n[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=i-1;)o=n[n[l].f<n[h].f?l++:h++],c=n[l!=u&&n[l].f<n[h].f?l++:h++],n[u++]={s:-1,f:o.f+c.f,l:o,r:c};var d=s[0].s;for(r=1;r<i;++r)s[r].s>d&&(d=s[r].s);var f=new Zl(d+1),p=Mu(n[u-1],f,0);if(p>t){r=0;var g=0,m=p-t,y=1<<m;for(s.sort(function(e,t){return f[t.s]-f[e.s]||e.f-t.f});r<i;++r){var b=s[r].s;if(!(f[b]>t))break;g+=y-(1<<p-f[b]),f[b]=t}for(g>>=m;g>0;){var w=s[r].s;f[w]<t?g-=1<<t-f[w]++-1:++r}for(;r>=0&&g;--r){var v=s[r].s;f[v]==t&&(--f[v],++g)}p=t}return{t:new Jl(f),l:p}},Mu=function(e,t,n){return-1==e.s?Math.max(Mu(e.l,t,n+1),Mu(e.r,t,n+1)):t[e.s]=n},Du=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Zl(++t),r=0,i=e[0],s=1,a=function(e){n[r++]=e},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return{c:n.subarray(0,r),n:t}},Ou=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Pu=function(e,t,n){var r=n.length,i=Iu(t+2);e[i]=255&r,e[i+1]=r>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<r;++s)e[i+s+4]=n[s];return 8*(i+4+r)},Nu=function(e,t,n,r,i,s,a,o,c,l,u){Au(t,u++,n),++i[256];for(var h=Ru(i,15),d=h.t,f=h.l,p=Ru(s,15),g=p.t,m=p.l,y=Du(d),b=y.c,w=y.n,v=Du(g),S=v.c,x=v.n,E=new Zl(19),I=0;I<b.length;++I)++E[31&b[I]];for(I=0;I<S.length;++I)++E[31&S[I]];for(var k=Ru(E,7),T=k.t,_=k.l,C=19;C>4&&!T[nu[C-1]];--C);var A,F,R,M,D=l+5<<3,O=Ou(i,pu)+Ou(s,gu)+a,P=Ou(i,d)+Ou(s,g)+a+14+3*C+Ou(E,T)+2*E[16]+3*E[17]+7*E[18];if(c>=0&&D<=O&&D<=P)return Pu(t,u,e.subarray(c,c+l));if(Au(t,u,1+(P<O)),u+=2,P<O){A=fu(d,f,0),F=d,R=fu(g,m,0),M=g;var N=fu(T,_,0);for(Au(t,u,w-257),Au(t,u+5,x-1),Au(t,u+10,C-4),u+=14,I=0;I<C;++I)Au(t,u+3*I,T[nu[I]]);u+=3*C;for(var L=[b,S],B=0;B<2;++B){var U=L[B];for(I=0;I<U.length;++I){var V=31&U[I];Au(t,u,N[V]),u+=T[V],V>15&&(Au(t,u,U[I]>>5&127),u+=U[I]>>12)}}}else A=yu,F=pu,R=wu,M=gu;for(I=0;I<o;++I){var j=r[I];if(j>255){Fu(t,u,A[257+(V=j>>18&31)]),u+=F[V+257],V>7&&(Au(t,u,j>>23&31),u+=eu[V]);var z=31&j;Fu(t,u,R[z]),u+=M[z],z>3&&(Fu(t,u,j>>5&8191),u+=tu[z])}else Fu(t,u,A[j]),u+=F[j]}return Fu(t,u,A[256]),u+F[256]},Lu=new Ql([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Bu=new Jl(0),Uu=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,s=0|n.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=r+=n[a];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}e=r,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},Vu=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new Jl(s.length+e.length);a.set(s),a.set(e,s.length),e=a,i.w=s.length}return function(e,t,n,r,i,s){var a=s.z||e.length,o=new Jl(r+a+5*(1+Math.ceil(a/7e3))+i),c=o.subarray(r,o.length-i),l=s.l,u=7&(s.r||0);if(t){u&&(c[0]=s.r>>3);for(var h=Lu[t-1],d=h>>13,f=8191&h,p=(1<<n)-1,g=s.p||new Zl(32768),m=s.h||new Zl(p+1),y=Math.ceil(n/3),b=2*y,w=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<b)&p},v=new Ql(25e3),S=new Zl(288),x=new Zl(32),E=0,I=0,k=s.i||0,T=0,_=s.w||0,C=0;k+2<a;++k){var A=w(k),F=32767&k,R=m[A];if(g[F]=R,m[A]=F,_<=k){var M=a-k;if((E>7e3||T>24576)&&(M>423||!l)){u=Nu(e,c,0,v,S,x,I,T,C,k-C,u),T=E=I=0,C=k;for(var D=0;D<286;++D)S[D]=0;for(D=0;D<30;++D)x[D]=0}var O=2,P=0,N=f,L=F-R&32767;if(M>2&&A==w(k-L))for(var B=Math.min(d,M)-1,U=Math.min(32767,k),V=Math.min(258,M);L<=U&&--N&&F!=R;){if(e[k+O]==e[k+O-L]){for(var j=0;j<V&&e[k+j]==e[k+j-L];++j);if(j>O){if(O=j,P=L,j>B)break;var z=Math.min(L,j-2),G=0;for(D=0;D<z;++D){var H=k-L+D&32767,$=H-g[H]&32767;$>G&&(G=$,R=H)}}}L+=(F=R)-(R=g[F])&32767}if(P){v[T++]=268435456|au[O]<<18|lu[P];var W=31&au[O],q=31&lu[P];I+=eu[W]+tu[q],++S[257+W],++x[q],_=k+O,++E}else v[T++]=e[k],++S[e[k]]}}for(k=Math.max(k,_);k<a;++k)v[T++]=e[k],++S[e[k]];u=Nu(e,c,l,v,S,x,I,T,C,k-C,u),l||(s.r=7&u|c[u/8|0]<<3,u-=7,s.h=m,s.p=g,s.i=k,s.w=_)}else{for(k=s.w||0;k<a+l;k+=65535){var X=k+65535;X>=a&&(c[u/8|0]=l,X=a),u=Pu(c,u+1,e.subarray(k,X))}s.i=a}return ku(o,0,r+Iu(u)+i)}(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,i)},ju=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},zu=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=Uu();i.p(t.dictionary),ju(e,2,i.d())}},Gu=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&_u(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&_u(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)},Hu="undefined"!=typeof TextDecoder&&new TextDecoder;try{Hu.decode(Bu,{stream:!0})}catch(e){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout,function(e){e[e.STORED=0]="STORED",e[e.SHRUNK=1]="SHRUNK",e[e.REDUCED_1=2]="REDUCED_1",e[e.REDUCED_2=3]="REDUCED_2",e[e.REDUCED_3=4]="REDUCED_3",e[e.REDUCED_4=5]="REDUCED_4",e[e.IMPLODE=6]="IMPLODE",e[e.DEFLATE=8]="DEFLATE",e[e.DEFLATE64=9]="DEFLATE64",e[e.TERSE_OLD=10]="TERSE_OLD",e[e.BZIP2=12]="BZIP2",e[e.LZMA=14]="LZMA",e[e.TERSE_NEW=18]="TERSE_NEW",e[e.LZ77=19]="LZ77",e[e.WAVPACK=97]="WAVPACK",e[e.PPMD=98]="PPMD"}(mu||(mu={}));const $u={[mu.DEFLATE]:e=>function(e,t){return Cu(e,{i:2},t,t)}(e),[mu.STORED]:(e,t,n)=>e.subarray(0,t)};function Wu(e){return new Date(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,2*(31&e))}const qu=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","_","_","","","","","","","","","+","+","","","+","+","-","-","+","-","+","","","+","+","-","-","","-","+","","","","","","","i","","","","+","+","_","_","","","_","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","_"," "];async function Xu(e,t,n,r){if(0===r)return"";const i=await e.get(n,r);return t?Je(i):[...i].map(e=>e>127?qu[e-128]:String.fromCharCode(e)).join("")}var Yu,Ku=function(e,t,n,r,i,s){function a(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var o,c=r.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!t&&e?r.static?e:e.prototype:null,h=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var p={};for(var g in r)p[g]="access"===g?{}:r[g];for(var g in r.access)p.access[g]=r.access[g];p.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(e||null))};var m=(0,n[f])("accessor"===c?{get:h.get,set:h.set}:h[l],p);if("accessor"===c){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(o=a(m.get))&&(h.get=o),(o=a(m.set))&&(h.set=o),(o=a(m.init))&&i.unshift(o)}else(o=a(m))&&("field"===c?i.unshift(o):h[l]=o)}u&&Object.defineProperty(u,r.name,h),d=!0},Ju=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0};!function(e){e[e.MSDOS=0]="MSDOS",e[e.AMIGA=1]="AMIGA",e[e.OPENVMS=2]="OPENVMS",e[e.UNIX=3]="UNIX",e[e.VM_CMS=4]="VM_CMS",e[e.ATARI_ST=5]="ATARI_ST",e[e.OS2_HPFS=6]="OS2_HPFS",e[e.MAC=7]="MAC",e[e.Z_SYSTEM=8]="Z_SYSTEM",e[e.CP_M=9]="CP_M",e[e.NTFS=10]="NTFS",e[e.MVS=11]="MVS",e[e.VSE=12]="VSE",e[e.ACORN_RISC=13]="ACORN_RISC",e[e.VFAT=14]="VFAT",e[e.ALT_MVS=15]="ALT_MVS",e[e.BEOS=16]="BEOS",e[e.TANDEM=17]="TANDEM",e[e.OS_400=18]="OS_400",e[e.OSX=19]="OSX"}(Yu||(Yu={}));let Zu=(()=>{var e,t,n,r,i,s,a,o,c,l;let u,h,d,f,p,g,m,y,b,w,v,S,x=[rr.packed("LocalFileHeader")],E=[],I=or.typed(Uint8Array),k=[],T=[],_=[],C=[],A=[],F=[],R=[],M=[],D=[],O=[],P=[],N=[],L=[],B=[],U=[],V=[],j=[],z=[],G=[],H=[];var $=class extends I{static{h=this}static{const W="function"==typeof Symbol&&Symbol.metadata?Object.create(I[Symbol.metadata]??null):void 0;d=[(e=ar).uint32.bind(e)],f=[(t=ar).uint16.bind(t)],p=[(n=ar).uint16.bind(n)],g=[(r=ar).uint16.bind(r)],m=[(i=ar).uint32.bind(i)],y=[(s=ar).uint32.bind(s)],b=[(a=ar).uint32.bind(a)],w=[(o=ar).uint32.bind(o)],v=[(c=ar).uint16.bind(c)],S=[(l=ar).uint16.bind(l)],Ku(this,null,d,{kind:"accessor",name:"signature",static:!1,private:!1,access:{has:e=>"signature"in e,get:e=>e.signature,set:(e,t)=>{e.signature=t}},metadata:W},k,T),Ku(this,null,f,{kind:"accessor",name:"versionNeeded",static:!1,private:!1,access:{has:e=>"versionNeeded"in e,get:e=>e.versionNeeded,set:(e,t)=>{e.versionNeeded=t}},metadata:W},_,C),Ku(this,null,p,{kind:"accessor",name:"flags",static:!1,private:!1,access:{has:e=>"flags"in e,get:e=>e.flags,set:(e,t)=>{e.flags=t}},metadata:W},A,F),Ku(this,null,g,{kind:"accessor",name:"compressionMethod",static:!1,private:!1,access:{has:e=>"compressionMethod"in e,get:e=>e.compressionMethod,set:(e,t)=>{e.compressionMethod=t}},metadata:W},R,M),Ku(this,null,m,{kind:"accessor",name:"datetime",static:!1,private:!1,access:{has:e=>"datetime"in e,get:e=>e.datetime,set:(e,t)=>{e.datetime=t}},metadata:W},D,O),Ku(this,null,y,{kind:"accessor",name:"crc32",static:!1,private:!1,access:{has:e=>"crc32"in e,get:e=>e.crc32,set:(e,t)=>{e.crc32=t}},metadata:W},P,N),Ku(this,null,b,{kind:"accessor",name:"compressedSize",static:!1,private:!1,access:{has:e=>"compressedSize"in e,get:e=>e.compressedSize,set:(e,t)=>{e.compressedSize=t}},metadata:W},L,B),Ku(this,null,w,{kind:"accessor",name:"uncompressedSize",static:!1,private:!1,access:{has:e=>"uncompressedSize"in e,get:e=>e.uncompressedSize,set:(e,t)=>{e.uncompressedSize=t}},metadata:W},U,V),Ku(this,null,v,{kind:"accessor",name:"nameLength",static:!1,private:!1,access:{has:e=>"nameLength"in e,get:e=>e.nameLength,set:(e,t)=>{e.nameLength=t}},metadata:W},j,z),Ku(this,null,S,{kind:"accessor",name:"extraLength",static:!1,private:!1,access:{has:e=>"extraLength"in e,get:e=>e.extraLength,set:(e,t)=>{e.extraLength=t}},metadata:W},G,H),Ku(null,u={value:h},x,{kind:"class",name:h.name,metadata:W},null,E),$=h=u.value,W&&Object.defineProperty(h,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:W}),Ju(h,E)}_source;#$=Ju(this,k,void 0);get signature(){return this.#$}set signature(e){this.#$=e}check(){if(67324752!==this.signature)throw it("EINVAL","Invalid Zip file: Local file header has invalid signature: "+this.signature)}#W=(Ju(this,T),Ju(this,_,void 0));get versionNeeded(){return this.#W}set versionNeeded(e){this.#W=e}#g=(Ju(this,C),Ju(this,A,void 0));get flags(){return this.#g}set flags(e){this.#g=e}#q=(Ju(this,F),Ju(this,R,void 0));get compressionMethod(){return this.#q}set compressionMethod(e){this.#q=e}#X=(Ju(this,M),Ju(this,D,void 0));get datetime(){return this.#X}set datetime(e){this.#X=e}get lastModified(){return Wu(this.datetime)}#Y=(Ju(this,O),Ju(this,P,void 0));get crc32(){return this.#Y}set crc32(e){this.#Y=e}#K=(Ju(this,N),Ju(this,L,void 0));get compressedSize(){return this.#K}set compressedSize(e){this.#K=e}#J=(Ju(this,B),Ju(this,U,void 0));get uncompressedSize(){return this.#J}set uncompressedSize(e){this.#J=e}#Z=(Ju(this,V),Ju(this,j,void 0));get nameLength(){return this.#Z}set nameLength(e){this.#Z=e}#Q=(Ju(this,z),Ju(this,G,void 0));get extraLength(){return this.#Q}set extraLength(e){this.#Q=e}name=Ju(this,H);extra;get size(){return $.size+this.nameLength+this.extraLength}get useUTF8(){return!!(2048&this.flags)}static async from(e,t){const n=await e.get(t,$.size),r=new $(n.buffer,n.byteOffset);return r._source=e,t+=$.size,r.name=await Xu(e,r.useUTF8,t,r.nameLength),t+=r.nameLength,r.extra=await e.get(t,r.extraLength),t+=r.extraLength,r}};return $=h})(),Qu=((()=>{var e,t;let n,r,i,s,a=[rr.packed("ExtraDataRecord")],o=[],c=or.typed(Uint8Array),l=[],u=[],h=[],d=[];var f=class extends c{static{r=this}static{const p="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;i=[(e=ar).uint32.bind(e)],s=[(t=ar).uint32.bind(t)],Ku(this,null,i,{kind:"accessor",name:"signature",static:!1,private:!1,access:{has:e=>"signature"in e,get:e=>e.signature,set:(e,t)=>{e.signature=t}},metadata:p},l,u),Ku(this,null,s,{kind:"accessor",name:"length",static:!1,private:!1,access:{has:e=>"length"in e,get:e=>e.length,set:(e,t)=>{e.length=t}},metadata:p},h,d),Ku(null,n={value:r},a,{kind:"class",name:r.name,metadata:p},null,o),f=r=n.value,p&&Object.defineProperty(r,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p}),Ju(r,o)}_source;#$=Ju(this,l,void 0);get signature(){return this.#$}set signature(e){this.#$=e}check(){if(134630224!=this.signature)throw it("EINVAL","Invalid archive extra data record signature: "+this.signature)}#ee=(Ju(this,u),Ju(this,h,void 0));get length(){return this.#ee}set length(e){this.#ee=e}extraField=Ju(this,d);static async from(e,t){const n=await e.get(t,f.size),r=new f(n.buffer,n.byteOffset);return r._source=e,t+=f.size,r.extraField=await e.get(t,r.length),r}};f=r})(),(()=>{var e,t,n,r,i,s,a,o,c,l,u,h,d,f,p,g,m;let y,b,w,v,S,x,E,I,k,T,_,C,A,F,R,M,D,O,P,N=[rr.packed("FileEntry")],L=[],B=or.typed(Uint8Array),U=[],V=[],j=[],z=[],G=[],H=[],$=[],W=[],q=[],X=[],Y=[],K=[],J=[],Z=[],Q=[],ee=[],te=[],ne=[],re=[],ie=[],se=[],ae=[],oe=[],ce=[],le=[],ue=[],he=[],de=[],fe=[],pe=[],ge=[],me=[],ye=[],be=[];var we=class extends B{static{b=this}static{const ve="function"==typeof Symbol&&Symbol.metadata?Object.create(B[Symbol.metadata]??null):void 0;w=[(e=ar).uint32.bind(e)],v=[(t=ar).uint8.bind(t)],S=[(n=ar).uint8.bind(n)],x=[(r=ar).uint16.bind(r)],E=[(i=ar).uint16.bind(i)],I=[(s=ar).uint16.bind(s)],k=[(a=ar).uint32.bind(a)],T=[(o=ar).uint32.bind(o)],_=[(c=ar).uint32.bind(c)],C=[(l=ar).uint32.bind(l)],A=[(u=ar).uint16.bind(u)],F=[(h=ar).uint16.bind(h)],R=[(d=ar).uint16.bind(d)],M=[(f=ar).uint16.bind(f)],D=[(p=ar).uint16.bind(p)],O=[(g=ar).uint32.bind(g)],P=[(m=ar).uint32.bind(m)],Ku(this,null,w,{kind:"accessor",name:"signature",static:!1,private:!1,access:{has:e=>"signature"in e,get:e=>e.signature,set:(e,t)=>{e.signature=t}},metadata:ve},U,V),Ku(this,null,v,{kind:"accessor",name:"zipVersion",static:!1,private:!1,access:{has:e=>"zipVersion"in e,get:e=>e.zipVersion,set:(e,t)=>{e.zipVersion=t}},metadata:ve},j,z),Ku(this,null,S,{kind:"accessor",name:"attributeCompat",static:!1,private:!1,access:{has:e=>"attributeCompat"in e,get:e=>e.attributeCompat,set:(e,t)=>{e.attributeCompat=t}},metadata:ve},G,H),Ku(this,null,x,{kind:"accessor",name:"versionNeeded",static:!1,private:!1,access:{has:e=>"versionNeeded"in e,get:e=>e.versionNeeded,set:(e,t)=>{e.versionNeeded=t}},metadata:ve},$,W),Ku(this,null,E,{kind:"accessor",name:"flag",static:!1,private:!1,access:{has:e=>"flag"in e,get:e=>e.flag,set:(e,t)=>{e.flag=t}},metadata:ve},q,X),Ku(this,null,I,{kind:"accessor",name:"compressionMethod",static:!1,private:!1,access:{has:e=>"compressionMethod"in e,get:e=>e.compressionMethod,set:(e,t)=>{e.compressionMethod=t}},metadata:ve},Y,K),Ku(this,null,k,{kind:"accessor",name:"datetime",static:!1,private:!1,access:{has:e=>"datetime"in e,get:e=>e.datetime,set:(e,t)=>{e.datetime=t}},metadata:ve},J,Z),Ku(this,null,T,{kind:"accessor",name:"crc32",static:!1,private:!1,access:{has:e=>"crc32"in e,get:e=>e.crc32,set:(e,t)=>{e.crc32=t}},metadata:ve},Q,ee),Ku(this,null,_,{kind:"accessor",name:"compressedSize",static:!1,private:!1,access:{has:e=>"compressedSize"in e,get:e=>e.compressedSize,set:(e,t)=>{e.compressedSize=t}},metadata:ve},te,ne),Ku(this,null,C,{kind:"accessor",name:"uncompressedSize",static:!1,private:!1,access:{has:e=>"uncompressedSize"in e,get:e=>e.uncompressedSize,set:(e,t)=>{e.uncompressedSize=t}},metadata:ve},re,ie),Ku(this,null,A,{kind:"accessor",name:"nameLength",static:!1,private:!1,access:{has:e=>"nameLength"in e,get:e=>e.nameLength,set:(e,t)=>{e.nameLength=t}},metadata:ve},se,ae),Ku(this,null,F,{kind:"accessor",name:"extraLength",static:!1,private:!1,access:{has:e=>"extraLength"in e,get:e=>e.extraLength,set:(e,t)=>{e.extraLength=t}},metadata:ve},oe,ce),Ku(this,null,R,{kind:"accessor",name:"commentLength",static:!1,private:!1,access:{has:e=>"commentLength"in e,get:e=>e.commentLength,set:(e,t)=>{e.commentLength=t}},metadata:ve},le,ue),Ku(this,null,M,{kind:"accessor",name:"startDisk",static:!1,private:!1,access:{has:e=>"startDisk"in e,get:e=>e.startDisk,set:(e,t)=>{e.startDisk=t}},metadata:ve},he,de),Ku(this,null,D,{kind:"accessor",name:"internalAttributes",static:!1,private:!1,access:{has:e=>"internalAttributes"in e,get:e=>e.internalAttributes,set:(e,t)=>{e.internalAttributes=t}},metadata:ve},fe,pe),Ku(this,null,O,{kind:"accessor",name:"externalAttributes",static:!1,private:!1,access:{has:e=>"externalAttributes"in e,get:e=>e.externalAttributes,set:(e,t)=>{e.externalAttributes=t}},metadata:ve},ge,me),Ku(this,null,P,{kind:"accessor",name:"headerRelativeOffset",static:!1,private:!1,access:{has:e=>"headerRelativeOffset"in e,get:e=>e.headerRelativeOffset,set:(e,t)=>{e.headerRelativeOffset=t}},metadata:ve},ye,be),Ku(null,y={value:b},N,{kind:"class",name:b.name,metadata:ve},null,L),we=b=y.value,ve&&Object.defineProperty(b,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ve}),Ju(b,L)}_source;#$=Ju(this,U,void 0);get signature(){return this.#$}set signature(e){this.#$=e}check(){if(33639248!=this.signature)throw it("EINVAL","Invalid Zip file: Central directory record has invalid signature: "+this.signature)}#te=(Ju(this,V),Ju(this,j,void 0));get zipVersion(){return this.#te}set zipVersion(e){this.#te=e}#ne=(Ju(this,z),Ju(this,G,void 0));get attributeCompat(){return this.#ne}set attributeCompat(e){this.#ne=e}#W=(Ju(this,H),Ju(this,$,void 0));get versionNeeded(){return this.#W}set versionNeeded(e){this.#W=e}#re=(Ju(this,W),Ju(this,q,void 0));get flag(){return this.#re}set flag(e){this.#re=e}get useUTF8(){return!!(2048&this.flag)}get isEncrypted(){return!!(1&this.flag)}#q=(Ju(this,X),Ju(this,Y,void 0));get compressionMethod(){return this.#q}set compressionMethod(e){this.#q=e}#X=(Ju(this,K),Ju(this,J,void 0));get datetime(){return this.#X}set datetime(e){this.#X=e}get lastModified(){return Wu(this.datetime)}#Y=(Ju(this,Z),Ju(this,Q,void 0));get crc32(){return this.#Y}set crc32(e){this.#Y=e}#K=(Ju(this,ee),Ju(this,te,void 0));get compressedSize(){return this.#K}set compressedSize(e){this.#K=e}#J=(Ju(this,ne),Ju(this,re,void 0));get uncompressedSize(){return this.#J}set uncompressedSize(e){this.#J=e}#Z=(Ju(this,ie),Ju(this,se,void 0));get nameLength(){return this.#Z}set nameLength(e){this.#Z=e}#Q=(Ju(this,ae),Ju(this,oe,void 0));get extraLength(){return this.#Q}set extraLength(e){this.#Q=e}#ie=(Ju(this,ce),Ju(this,le,void 0));get commentLength(){return this.#ie}set commentLength(e){this.#ie=e}#se=(Ju(this,ue),Ju(this,he,void 0));get startDisk(){return this.#se}set startDisk(e){this.#se=e}#ae=(Ju(this,de),Ju(this,fe,void 0));get internalAttributes(){return this.#ae}set internalAttributes(e){this.#ae=e}#oe=(Ju(this,pe),Ju(this,ge,void 0));get externalAttributes(){return this.#oe}set externalAttributes(e){this.#oe=e}#ce=(Ju(this,me),Ju(this,ye,void 0));get headerRelativeOffset(){return this.#ce}set headerRelativeOffset(e){this.#ce=e}name=Ju(this,be);extra;comment;get size(){return ur(we)+this.nameLength+this.extraLength+this.commentLength}get isDirectory(){return!!(16&this.externalAttributes)||"/"==this.name.at(-1)}get isFile(){return!this.isDirectory}async loadContents(){const e=await this._source.get(this.headerRelativeOffset,ur(Zu)),{compressionMethod:t,size:n,name:r}=new Zu(e.buffer,e.byteOffset),i=await this._source.get(this.headerRelativeOffset+n,this.compressedSize),s=$u[t];if("function"!=typeof s)throw it("EINVAL",`Invalid compression method on file "${r}": ${t in mu?mu[t]:t.toString()}`);this.contents=s(i,this.compressedSize,this.uncompressedSize,this.flag)}contents;get data(){return this.contents}static async from(e,t){const n=await e.get(t,we.size),r=new we(n.buffer,n.byteOffset);return r._source=e,t+=we.size,r.name=await Xu(e,r.useUTF8,t,r.nameLength),t+=r.nameLength,r.extra=await e.get(t,r.extraLength),t+=r.extraLength,r.comment=await Xu(e,r.useUTF8,t,r.commentLength),r}};return we=b})()),eh=((()=>{var e,t;let n,r,i,s,a=[rr.packed("DigitalSignature")],o=[],c=or.typed(Uint8Array),l=[],u=[],h=[],d=[];var f=class extends c{static{r=this}static{const p="function"==typeof Symbol&&Symbol.metadata?Object.create(c[Symbol.metadata]??null):void 0;i=[(e=ar).uint32.bind(e)],s=[(t=ar).uint16.bind(t)],Ku(this,null,i,{kind:"accessor",name:"signature",static:!1,private:!1,access:{has:e=>"signature"in e,get:e=>e.signature,set:(e,t)=>{e.signature=t}},metadata:p},l,u),Ku(this,null,s,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:p},h,d),Ku(null,n={value:r},a,{kind:"class",name:r.name,metadata:p},null,o),f=r=n.value,p&&Object.defineProperty(r,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:p}),Ju(r,o)}_source;#$=Ju(this,l,void 0);get signature(){return this.#$}set signature(e){this.#$=e}check(){if(84233040!=this.signature)throw it("EINVAL","Invalid digital signature signature: "+this.signature)}#n=(Ju(this,u),Ju(this,h,void 0));get size(){return this.#n}set size(e){this.#n=e}signatureData=Ju(this,d);static async from(e,t){const n=await e.get(t,f.size),r=new f(n.buffer,n.byteOffset);return r._source=e,t+=f.size,r.signatureData=await e.get(t,r.size),r}};f=r})(),(()=>{var e,t,n,r,i,s,a,o;let c,l,u,h,d,f,p,g,m,y,b=[rr.packed("Header")],w=[],v=or.typed(Uint8Array),S=[],x=[],E=[],I=[],k=[],T=[],_=[],C=[],A=[],F=[],R=[],M=[],D=[],O=[],P=[],N=[];return class extends v{static{l=this}static{const L="function"==typeof Symbol&&Symbol.metadata?Object.create(v[Symbol.metadata]??null):void 0;u=[(e=ar).uint32.bind(e)],h=[(t=ar).uint16.bind(t)],d=[(n=ar).uint16.bind(n)],f=[(r=ar).uint16.bind(r)],p=[(i=ar).uint16.bind(i)],g=[(s=ar).uint32.bind(s)],m=[(a=ar).uint32.bind(a)],y=[(o=ar).uint16.bind(o)],Ku(this,null,u,{kind:"accessor",name:"signature",static:!1,private:!1,access:{has:e=>"signature"in e,get:e=>e.signature,set:(e,t)=>{e.signature=t}},metadata:L},S,x),Ku(this,null,h,{kind:"accessor",name:"disk",static:!1,private:!1,access:{has:e=>"disk"in e,get:e=>e.disk,set:(e,t)=>{e.disk=t}},metadata:L},E,I),Ku(this,null,d,{kind:"accessor",name:"entriesDisk",static:!1,private:!1,access:{has:e=>"entriesDisk"in e,get:e=>e.entriesDisk,set:(e,t)=>{e.entriesDisk=t}},metadata:L},k,T),Ku(this,null,f,{kind:"accessor",name:"diskEntryCount",static:!1,private:!1,access:{has:e=>"diskEntryCount"in e,get:e=>e.diskEntryCount,set:(e,t)=>{e.diskEntryCount=t}},metadata:L},_,C),Ku(this,null,p,{kind:"accessor",name:"totalEntryCount",static:!1,private:!1,access:{has:e=>"totalEntryCount"in e,get:e=>e.totalEntryCount,set:(e,t)=>{e.totalEntryCount=t}},metadata:L},A,F),Ku(this,null,g,{kind:"accessor",name:"size",static:!1,private:!1,access:{has:e=>"size"in e,get:e=>e.size,set:(e,t)=>{e.size=t}},metadata:L},R,M),Ku(this,null,m,{kind:"accessor",name:"offset",static:!1,private:!1,access:{has:e=>"offset"in e,get:e=>e.offset,set:(e,t)=>{e.offset=t}},metadata:L},D,O),Ku(this,null,y,{kind:"accessor",name:"commentLength",static:!1,private:!1,access:{has:e=>"commentLength"in e,get:e=>e.commentLength,set:(e,t)=>{e.commentLength=t}},metadata:L},P,N),Ku(null,c={value:l},b,{kind:"class",name:l.name,metadata:L},null,w),l=c.value,L&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:L}),Ju(l,w)}_source;#$=Ju(this,S,void 0);get signature(){return this.#$}set signature(e){this.#$=e}check(){if(101010256!=this.signature)throw it("EINVAL","Invalid Zip file: End of central directory record has invalid signature: 0x"+this.signature.toString(16))}#le=(Ju(this,x),Ju(this,E,void 0));get disk(){return this.#le}set disk(e){this.#le=e}#ue=(Ju(this,I),Ju(this,k,void 0));get entriesDisk(){return this.#ue}set entriesDisk(e){this.#ue=e}#he=(Ju(this,T),Ju(this,_,void 0));get diskEntryCount(){return this.#he}set diskEntryCount(e){this.#he=e}#de=(Ju(this,C),Ju(this,A,void 0));get totalEntryCount(){return this.#de}set totalEntryCount(e){this.#de=e}#n=(Ju(this,F),Ju(this,R,void 0));get size(){return this.#n}set size(e){this.#n=e}#E=(Ju(this,M),Ju(this,D,void 0));get offset(){return this.#E}set offset(e){this.#E=e}#ie=(Ju(this,O),Ju(this,P,void 0));get commentLength(){return this.#ie}set commentLength(e){this.#ie=e}comment=Ju(this,N)},l})());class th extends(Bl(di)){label;data;lazy;caseFold;files=new Map;directories=new Map;folded=new Map;_time=Date.now();_ready=!1;eocd;async ready(){if(await super.ready(),this._ready)return;if(this._ready=!0,this.eocd=await async function(e){for(let t=e.size-22;t>e.size-65535;t--){const n=await e.get(t,22);if(101010256==(n[0]|n[1]<<8|n[2]<<16|n[3]<<24)>>>0){wt("zipfs: found End of Central Directory signature at 0x"+t.toString(16));const r=new eh(n.buffer,n.byteOffset);return r._source=e,r.comment=await Xu(e,!0,t+eh.size,r.commentLength),r}}throw gt(it("EINVAL","zipfs: could not locate End of Central Directory signature"))}(this.data),this.eocd.disk!=this.eocd.entriesDisk)throw it("EINVAL","ZipFS does not support spanned zip files.");let e=this.eocd.offset;if(4294967295===e)throw it("EINVAL","ZipFS does not support Zip64.");const t=e+this.eocd.size;for(;e<t;){const t=await Qu.from(this.data,e);if(this.lazy||await t.loadContents(),t.name.startsWith("/"))throw it("EPERM","Unexpectedly encountered an absolute path in a zip file.");const n=t.name.endsWith("/")?"/"+t.name.slice(0,-1):"/"+t.name;this.files.set(this._caseFold(n,!0),t),e+=t.size}for(const e of this.files.keys()){const t=this.folded.get(e)??e;let{dir:n,base:r}=Or(t);n=this._caseFold(n,!0),this.directories.has(n)||this.directories.set(n,new Set),this.directories.get(n).add(r)}for(const e of this.directories.keys()){const t=this.folded.get(e)??e;let{dir:n,base:r}=Or(t);n=this._caseFold(n,!0),""!=r&&(this.directories.has(n)||this.directories.set(n,new Set),this.directories.get(n).add(r))}}constructor(e,t,n=!1,r){super(544893296,"zipfs"),this.label=e,this.data=t,this.lazy=n,this.caseFold=r}usage(){return{totalSpace:this.data.size,freeSpace:0}}async stat(e){return this.statSync(e)}statSync(e){const t=this._caseFold(e);if(this.directories.has(t))return new Qr({mode:365|mn,size:4096,mtimeMs:this._time,ctimeMs:this._time,atimeMs:Date.now(),birthtimeMs:this._time});const n=this.files.get(t);if(!n)throw it("ENOENT");return new Qr({mode:365|(n.isDirectory?mn:pn),size:n.uncompressedSize,mtimeMs:n.lastModified.getTime()})}async readdir(e){if(!((await this.stat(e)).mode&mn))throw it("ENOTDIR");const t=this.directories.get(this._caseFold(e));if(!t)throw it("ENODATA");return Array.from(t).map(e=>this.folded.get(e)??e)}readdirSync(e){if(!(this.statSync(e).mode&mn))throw it("ENOTDIR");const t=this.directories.get(this._caseFold(e));if(!t)throw it("ENODATA");return Array.from(t).map(e=>this.folded.get(e)??e)}async read(e,t,n,r){const i=this._caseFold(e);if(this.directories.has(i))throw it("EISDIR");const s=this.files.get(i)??$e(it("ENOENT"));s.contents||await s.loadContents(),t.set(s.contents.subarray(n,r))}readSync(e,t,n,r){const i=this._caseFold(e);if(this.directories.has(i))throw it("EISDIR");const s=this.files.get(i)??$e(it("ENOENT"));if(!s.contents)throw s.loadContents(),it("EAGAIN");t.set(s.contents.subarray(n,r))}_caseFold(e,t=!1){if(this.caseFold){const n="upper"==this.caseFold?e.toUpperCase():e.toLowerCase();return t&&!this.folded.has(n)&&n!==e&&this.folded.set(n,e),n}return e}}const nh={name:"Zip",options:{data:{type:"object",required:!0},name:{type:"string",required:!1},lazy:{type:"boolean",required:!1},caseFold:{type:"string",required:!1}},isAvailable:()=>!0,create:e=>new th(e.name??"",function(e){if(e instanceof ArrayBuffer||"object"==typeof(t=e)&&null!==t&&"SharedArrayBuffer"===t.constructor.name)return{size:e.byteLength,get:(t,n)=>new Uint8Array(e,t,n),set(t,n){new Uint8Array(e,t,n.byteLength).set(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}};var t;if(ArrayBuffer.isView(e))return{size:e.byteLength,get:(t,n)=>new Uint8Array(e.buffer,e.byteOffset+t,n),set(t,n){new Uint8Array(e.buffer,e.byteOffset+t,n.byteLength).set(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}};if("object"==typeof e&&null!==e&&"size"in e&&"number"==typeof e.size&&"function"==typeof e.get)return e;throw gt(it("EINVAL","Invalid zip data source"))}(e.data),e.lazy,e.caseFold)};class rh{paths;mfs;tfs;cfs;pfs;xfs;root;ext;constructor(e,t){this.paths=new Map,e?(this.root=e,this.pfs=Kl):this.pfs=l,t?(this.ext=t,this.xfs=Kl):this.xfs=l,this.mfs=l,this.tfs=l,this.cfs=l}savePath(e){this.paths.set(e.toLowerCase().replace(/\/+/g,"/").trim(),e.replace(/\/+/g,"/").trim())}deletePath(e){return this.paths.delete(e.toLowerCase().replace(/\/+/g,"/").trim())}getOriginalPath(e){return this.paths.get(e.toLowerCase().replace(/\/+/g,"/").trim())}setRoot(e){this.root=e,this.pfs=Kl}setExt(e){this.ext=e,this.xfs=Kl}async resetMemoryFS(e,t){void 0!==l&&(Qi("tmp:"),Zi("tmp:",await oo({backend:xc,buffer:e,caseFold:"lower"})),Qi("cachefs:"),Zi("cachefs:",await oo({backend:xc,buffer:t,caseFold:"lower"})))}getFS(e){return e.trim().toLowerCase().startsWith("tmp:")?this.tfs:e.trim().toLowerCase().startsWith("cachefs:")?this.cfs:e.trim().toLowerCase().startsWith("common:")?this.mfs:e.trim().toLowerCase().startsWith("ext1:")?this.xfs:this.pfs}getPath(e){return this.root&&e.trim().toLowerCase().startsWith("pkg:")?e=this.root+"/"+e.trim().slice(4):this.ext&&e.trim().toLowerCase().startsWith("ext1:")?e=this.ext+"/"+e.trim().slice(5):this.root||(e=e.toLowerCase()),e.replace(/\/+/g,"/").trim()}volumesSync(){const e=[];return(this.root||this.pfs.existsSync("pkg:/"))&&e.push("pkg:"),(this.ext||this.xfs.existsSync("ext1:/"))&&e.push("ext1:"),this.mfs.existsSync("common:/")&&e.push("common:"),e.push("tmp:"),e.push("cachefs:"),e}existsSync(e){return sh(e)&&this.getFS(e).existsSync(this.getPath(e))}readFileSync(e,t){return this.getFS(e).readFileSync(this.getPath(e),t)}readdirSync(e){const t=this.getFS(e).readdirSync(this.getPath(e));if(ah(e)&&t.length>0)for(const[n,r]of t.entries()){const i=Ne.posix.join(e.toLowerCase(),r),s=this.getOriginalPath(i);s&&(t[n]=Ne.posix.basename(s))}return t}mkdirSync(e){this.getFS(e).mkdirSync(this.getPath(e)),this.savePath(e)}rmdirSync(e){if(ah(e)&&this.readdirSync(e).length>0)throw new Error("Directory not empty!");this.getFS(e).rmdirSync(this.getPath(e)),this.deletePath(e)}unlinkSync(e){this.getFS(e).unlinkSync(this.getPath(e)),this.deletePath(e)}renameSync(e,t){const n=this.readFileSync(e);this.writeFileSync(t,n),this.unlinkSync(e)}writeFileSync(e,t,n){this.getFS(e).writeFileSync(this.getPath(e),t,n),this.savePath(e)}statSync(e){return this.getFS(e).statSync(this.getPath(e))}findSync(e,t){let n=[];const r=this.getFS(e);return function e(i){const s=r.readdirSync(i);for(const a of s){const s=Ne.join(i,a);r.statSync(s).isDirectory()?e(s):Ne.extname(a)===`.${t}`&&n.push(s)}}(this.getPath(e)),n}}function ih(e){return e.toLowerCase().substring(0,e.indexOf(":")+1)}function sh(e){return""!==e.trim()&&!e.startsWith("/")&&!e.startsWith("\\")&&e.includes(":/")}function ah(e){return sh(e=e.toLowerCase())&&(e.startsWith("tmp:/")||e.startsWith("cachefs:/"))}async function oh(e,t,n,r,i){const s={mounts:{},caseFold:"lower"};return h?.mounts.get("/common:")&&Qi("common:"),Object.assign(s.mounts,{"common:":{backend:nh,data:e}}),h?.mounts.get("/tmp:")&&Qi("tmp:"),Object.assign(s.mounts,{"tmp:":{backend:xc,buffer:t}}),h?.mounts.get("/cachefs:")&&Qi("cachefs:"),Object.assign(s.mounts,{"cachefs:":{backend:xc,buffer:n}}),h?.mounts.get("/pkg:")&&Qi("pkg:"),r?Object.assign(s.mounts,{"pkg:":{backend:nh,data:r}}):Object.assign(s.mounts,{"pkg:":{backend:ki}}),h?.mounts.get("/ext1:")&&Qi("ext1:"),i&&Object.assign(s.mounts,{"ext1:":{backend:nh,data:i}}),fo(s)}class ch{outputStream;post;currentLineLength=0;constructor(e,t=!0){this.outputStream=e,this.post=t}write(e){let t=e;const n=e.split(",")[0];["print","error","warning"].includes(n)&&(t=e.slice(n.length+1),this.post&&postMessage(e)),!this.post&&t.length&&this.outputStream.write(t),this.position(t)}position(e){if(e){const t=e.split("\n");t.length>1?this.currentLineLength=t[t.length-1].length:this.currentLineLength+=e.length}return this.outputStream?.isTTY&&this.outputStream?.columns?this.currentLineLength%this.outputStream.columns:this.currentLineLength}}var lh=__webpack_require__(9907);class uh{static deviceInfo=de;static registry=new Map;static fileSystem=new rh;static isDevMode=!1;static keysBuffer=[];static terms=new Map;static sfx=Ce.slice();static stdout=new ch(lh.stdout,!1);static stderr=new ch(lh.stderr,!1);static sharedArray=new Int32Array(0);static displayEnabled=!0;static singleKeyEvents=!0;static useCORSProxy=!0;static lastRemote=0;static lastKey=-1;static lastMod=-1;static lastKeyTime=Date.now();static currKeyTime=Date.now();static timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone;static clockFormat="12h";static locale="en-US";static tmpVolume;static cacheFS;static registryVersion=0;static sharedRegistry;static getTmpVolume(){return this.tmpVolume??=new SharedArrayBuffer(this.deviceInfo.tmpVolSize),this.tmpVolume}static getCacheFS(){return this.cacheFS??=new SharedArrayBuffer(this.deviceInfo.cacheFSVolSize),this.cacheFS}static async resetMemoryVolumes(){new Uint8Array(this.getTmpVolume()).fill(0),new Uint8Array(this.getCacheFS()).fill(0),await this.fileSystem.resetMemoryFS(this.tmpVolume,this.cacheFS)}static setRegistry(e){let t;e instanceof SharedArrayBuffer?(this.sharedRegistry=new Pe(32768,65536),this.sharedRegistry.setBuffer(e),this.registryVersion=this.sharedRegistry.getVersion(),t=new Map(Object.entries(this.sharedRegistry.load()))):t=e;for(const[e,n]of t)this.registry.set(e,n)}static flushRegistry(){this.sharedRegistry?.store(Object.fromEntries(this.registry))}static refreshRegistry(){if(this.sharedRegistry&&this.sharedRegistry.getVersion()!==this.registryVersion){this.registryVersion=this.sharedRegistry.getVersion();const e=new Map(Object.entries(this.sharedRegistry.load()));this.registry.clear();for(const[t,n]of e)this.registry.set(t,n)}}static setSharedArray(e){this.sharedArray=e}static setDeviceInfo(e){for(let[t,n]of Object.entries(e))if(!t.startsWith("registry")&&"assets"!==t){let e=n;"developerId"===t?e=e.replace(".",":"):"corsProxy"===t&&(e.length>0&&!e.startsWith("http")?e="":e.length>0&&!e.endsWith("/")&&(e+="/")),this.deviceInfo[t]=e}this.clockFormat=uh.deviceInfo.clockFormat,this.timeZone=uh.deviceInfo.timeZone,this.locale=uh.deviceInfo.locale.replace("_","-")}static loadLocaleTerms(){const e=`common:/locale/${this.locale.replace("-","_")}/terms.json`;if(this.fileSystem.existsSync(e)){const t=this.fileSystem.readFileSync(e,"utf8");if(t)for(const[e,n]of Object.entries(JSON.parse(t)))"string"==typeof n&&this.terms.set(e,n)}}static getDisplayMode(){return this.deviceInfo?.displayMode?.startsWith("1080")?"FHD":this.deviceInfo?.displayMode?.startsWith("480")?"SD":"HD"}static getTerm(e){return this.terms.get(e)??e}static getCORSProxy(e=""){const t=this.deviceInfo.corsProxy??"";return!this.useCORSProxy||e.includes("//localhost")||e.includes("//127.0.0.1")?e:`${t}${e}`}static checkBreakCommand(e){let t=e?Ie.BREAK:-1;return e||(t=Atomics.load(this.sharedArray,ve.DBG),t===Ie.BREAK?Atomics.store(this.sharedArray,ve.DBG,-1):t===Ie.PAUSE&&(postMessage("debug,pause"),Atomics.wait(this.sharedArray,ve.DBG,Ie.PAUSE),Atomics.store(this.sharedArray,ve.DBG,-1),t=-1,postMessage("debug,continue"))),t}static readDataBuffer(){let e="";return this.sharedArray.slice(xe).every(t=>(t>0&&(e+=String.fromCharCode(t)),t)),Atomics.store(this.sharedArray,ve.BUF,-1),e}static updateKeysBuffer(){for(let e=0;e<5;e++){const t=3*e,n=Atomics.load(this.sharedArray,ve.KEY+t);if(-1===n)break;if(0===this.keysBuffer.length||n!==this.keysBuffer.at(-1)?.key){const e=Atomics.load(this.sharedArray,ve.RID+t),r=10*Math.trunc(e/10),i=Ee[r]??Ee[Ee.SIM],s=e-r,a=Atomics.load(this.sharedArray,ve.MOD+t);Atomics.store(this.sharedArray,ve.KEY+t,-1),this.keysBuffer.push({remote:`${i}:${s}`,key:n,mod:a}),this.lastRemote=s}}const e=this.keysBuffer.shift();if(e&&e.key!==this.lastKey){if(this.singleKeyEvents)if(0===e.mod)0===this.lastMod&&(this.keysBuffer.unshift({...e}),e.key=this.lastKey+100,e.mod=100);else if(e.key!==this.lastKey+100)return;return this.lastKeyTime=this.currKeyTime,this.currKeyTime=Date.now(),this.lastKey=e.key,this.lastMod=e.mod,e}}static playSound(e){if(Ce.includes(e)){const t=this.sfx.findIndex(t=>t===e),n=this.getSfxStream(t);n>=0&&postMessage(`sfx,trigger,${e},${this.deviceInfo.audioVolume},${n}`)}}static getSfxStream(e){for(let t=0;t<4;t++){const n=Atomics.load(this.sharedArray,ve.WAV+t);if(n===e||-1===n)return Atomics.store(this.sharedArray,ve.WAV+t,e),t}return-1}static getTime(){const e=new Date;return"12h"===this.clockFormat?new Intl.DateTimeFormat(this.locale,{hour:"numeric",minute:"numeric",hour12:!0,timeZone:this.timeZone}).format(e).toLowerCase():new Intl.DateTimeFormat(this.locale,{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:this.timeZone}).format(e)}}var hh=__webpack_require__(3261);class dh{component;defaultFormat;defaultRegEx;constructor(e,t=""){this.component=e,t instanceof RegExp?this.defaultRegEx=t:this.defaultFormat=t}toStr=new Ch("toStr",{signature:{args:[new kh("format",T.String,O.Instance)],returns:T.String},impl:(e,t)=>{if(t instanceof O){if(!this.defaultFormat?.length){if(this.defaultRegEx)return new M(this.component.toString().replace(this.defaultRegEx,""));if(JS(this.component))return new M(this.component.toString());if(R(this.component)||this.component instanceof bd||this.component instanceof Pv)return new M(this.component.getValue().toString());throw new J(Z.MemberFunctionNotFound,e.location,e.stack.slice(0,-1))}t=new M(this.defaultFormat)}if(!(JS(this.component)||this.component instanceof md))throw new J(Z.MemberFunctionNotFound,e.location,e.stack.slice(0,-1));const n=t.value.split("%").length-1;if(0===n)return new M(t.value);const r=new Array(n).fill(this.component.getValue());try{return new M((0,hh.vsprintf)(t.value,r))}catch(n){uh.isDevMode&&uh.stderr.write(`warning,ifToStr.toStr() Error: ${n.message} - ${t.value}`);const r=n.message?.includes("expecting number")?Z.TypeMismatch:Z.InvalidFormatSpecifier;throw new J(r,e.location,e.stack.slice(0,-1))}}})}class fh extends L{kind=T.Object;intrinsic;getValue(){return this.intrinsic.getValue()}constructor(e){super("roLongInteger"),this.intrinsic=new ph(jS(e)?e.getValue():0),this.registerMethods({ifLongInt:[this.getLongInt,this.setLongInt],ifToStr:[new dh(this).toStr]})}unbox(){return this.intrinsic}copy(){return new fh(this.intrinsic)}equalTo(e){return e instanceof fh?D.from(e.intrinsic.getValue().low===this.intrinsic.getValue().low):D.False}toString(e){return this.intrinsic.toString()}getLongInt=new Ch("getLongInt",{signature:{args:[],returns:T.Int64},impl:e=>this.intrinsic});setLongInt=new Ch("setLongInt",{signature:{args:[new kh("value",T.Int64)],returns:T.Void},impl:(e,t)=>(this.intrinsic=t,O.Instance)})}class ph{inArray;kind=T.Int64;value;getValue(){return this.value}toBoolean(){return 0!==this.value.toNumber()}constructor(e,t=!1){this.inArray=t,e instanceof C()?this.value=e:this.value=C().fromNumber(Math.trunc(e))}static fromString(e){let t=10;return e.toLowerCase().startsWith("&h")&&(t=16,e=e.slice(2).replace("&","")),new ph(C().fromString(e,void 0,t))}add(e){switch(e.kind){case T.Int32:case T.Int64:return new ph(this.getValue().add(e.getValue()));case T.Float:return new bh(this.getValue().toNumber()+e.getValue());case T.Double:return new mh(this.getValue().toNumber()+e.getValue())}}subtract(e){switch(e.kind){case T.Int32:case T.Int64:return new ph(this.getValue().subtract(e.getValue()));case T.Float:return new bh(this.getValue().toNumber()-e.getValue());case T.Double:return new mh(this.getValue().toNumber()-e.getValue())}}multiply(e){switch(e.kind){case T.Int32:case T.Int64:return new ph(this.getValue().multiply(e.getValue()));case T.Float:return new bh(this.getValue().toNumber()*e.getValue());case T.Double:return new mh(this.getValue().toNumber()*e.getValue())}}divide(e){switch(e.kind){case T.Int32:case T.Int64:return new bh(this.getValue().divide(e.getValue()).toNumber());case T.Float:return new bh(this.getValue().toNumber()/e.getValue());case T.Double:return new mh(this.getValue().toNumber()/e.getValue())}}modulo(e){switch(e.kind){case T.Int32:case T.Int64:return new ph(this.getValue().modulo(e.getValue()));case T.Float:case T.Double:return new ph(this.getValue().toNumber()%e.getValue())}}intDivide(e){switch(e.kind){case T.Int32:case T.Int64:return new ph(this.getValue().divide(e.getValue()));case T.Float:case T.Double:return new ph(Math.floor(this.getValue().toNumber()/e.getValue()))}}leftShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new ph(this.getValue().toNumber()<<Math.trunc(e.getValue()));case T.Int64:return new ph(this.getValue().toNumber()<<e.getValue().toNumber())}}rightShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new ph(this.getValue().toNumber()>>Math.trunc(e.getValue()));case T.Int64:return new ph(this.getValue().toNumber()>>e.getValue().toNumber())}}pow(e){switch(e.kind){case T.Int32:return new ph(Math.pow(this.getValue().toNumber(),e.getValue()));case T.Float:return new bh(Math.pow(this.getValue().toNumber(),e.getValue()));case T.Double:return new mh(Math.pow(this.getValue().toNumber(),e.getValue()));case T.Int64:return new ph(Math.pow(this.getValue().toNumber(),e.getValue().toNumber()))}}and(e){return e.kind===T.Boolean?D.from(this.toBoolean()&&e.getValue()):new ph(this.getValue().and(e.getValue()))}or(e){return e.kind===T.Boolean?D.from(this.toBoolean()||e.getValue()):new ph(this.getValue().or(e.getValue()))}not(){return new ph(this.getValue().not())}lessThan(e){switch(e.kind){case T.Int32:case T.Int64:return D.from(this.getValue().lessThan(e.getValue()));case T.Float:return new bh(this.getValue().toNumber()).lessThan(e);case T.Double:return new mh(this.getValue().toNumber()).lessThan(e)}return YS(e)?D.from(this.getValue().lessThan(e.getValue())):D.False}greaterThan(e){switch(e.kind){case T.Int32:case T.Int64:return D.from(this.getValue().greaterThan(e.getValue()));case T.Float:return new bh(this.getValue().toNumber()).greaterThan(e);case T.Double:return new mh(this.getValue().toNumber()).greaterThan(e)}return YS(e)?D.from(this.getValue().greaterThan(e.getValue())):D.False}equalTo(e){switch(e.kind){case T.Int32:case T.Int64:return D.from(this.getValue().equals(e.getValue()));case T.Float:return new bh(this.getValue().toNumber()).equalTo(e);case T.Double:return new mh(this.getValue().toNumber()).equalTo(e);case T.Boolean:return e.equalTo(D.from(this.toBoolean()))}return YS(e)?D.from(this.getValue().equals(e.getValue())):D.False}toString(e){return Number.isNaN(this.value.toNumber())?"nan":this.value.toString()}box(){return new fh(this)}}class gh extends L{kind=T.Object;intrinsic;getValue(){return this.intrinsic.getValue()}constructor(e){super("roDouble"),this.intrinsic=new mh(jS(e)?e.getValue():0),this.registerMethods({ifDouble:[this.getDouble,this.setDouble],ifToStr:[new dh(this,"%g").toStr]})}unbox(){return this.intrinsic}copy(){return new gh(this.intrinsic)}equalTo(e){return e instanceof gh?D.from(e.intrinsic.getValue()===this.intrinsic.getValue()):D.False}toString(e){return this.intrinsic.toString()}getDouble=new Ch("getDouble",{signature:{args:[],returns:T.Double},impl:e=>this.intrinsic});setDouble=new Ch("setDouble",{signature:{args:[new kh("value",T.Double)],returns:T.Void},impl:(e,t)=>(this.intrinsic=t,O.Instance)})}class mh{inArray;kind=T.Double;value;getValue(){return this.value}toBoolean(){return 0!==Math.trunc(this.value)}constructor(e,t=!1){this.inArray=t,this.value=e instanceof C()?e.toNumber():e}static fromString(e){return new mh(Number.parseFloat(e))}add(e){switch(e.kind){case T.Int64:return new mh(this.getValue()+e.getValue().toNumber());case T.Int32:case T.Float:case T.Double:return new mh(this.getValue()+e.getValue())}}subtract(e){switch(e.kind){case T.Int64:return new mh(this.getValue()-e.getValue().toNumber());case T.Int32:case T.Float:case T.Double:return new mh(this.getValue()-e.getValue())}}multiply(e){switch(e.kind){case T.Int64:return new mh(this.getValue()*e.getValue().toNumber());case T.Int32:case T.Float:case T.Double:return new mh(this.getValue()*e.getValue())}}divide(e){switch(e.kind){case T.Int64:return new mh(this.getValue()/e.getValue().toNumber());case T.Int32:case T.Float:case T.Double:return new mh(this.getValue()/e.getValue())}}modulo(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new mh(Math.trunc(this.getValue()%e.getValue()));case T.Int64:return new mh(Math.trunc(this.getValue()%e.getValue().toNumber()))}}intDivide(e){switch(e.kind){case T.Int64:return new ph(Math.trunc(this.getValue()/e.getValue().toNumber()));case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue()/e.getValue()))}}leftShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue())<<Math.trunc(e.getValue()));case T.Int64:return new vh(Math.trunc(this.getValue())<<e.getValue().toNumber())}}rightShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue())>>Math.trunc(e.getValue()));case T.Int64:return new vh(Math.trunc(this.getValue())>>e.getValue().toNumber())}}pow(e){switch(e.kind){case T.Int32:return new bh(Math.pow(this.getValue(),e.getValue()));case T.Int64:return new ph(this.getValue()).pow(e);case T.Float:return new bh(Math.pow(this.getValue(),e.getValue()));case T.Double:return new mh(Math.pow(this.getValue(),e.getValue()))}}and(e){switch(e.kind){case T.Int64:return new ph(this.getValue()).and(e);case T.Int32:case T.Float:case T.Double:return new vh(this.getValue()&e.getValue());case T.Boolean:return D.from(this.toBoolean()&&e.getValue())}}or(e){switch(e.kind){case T.Int64:return new ph(this.getValue()).or(e);case T.Int32:case T.Float:case T.Double:return new vh(this.getValue()|e.getValue());case T.Boolean:return D.from(this.toBoolean()||e.getValue())}}not(){return new vh(~this.getValue())}lessThan(e){return e.kind===T.Int64?D.from(this.getValue()<e.getValue().toNumber()):YS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return e.kind===T.Int64?D.from(this.getValue()>e.getValue().toNumber()):YS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return e.kind===T.Int64?D.from(this.getValue()===e.getValue().toNumber()):e.kind===T.Boolean?e.equalTo(D.from(this.toBoolean())):YS(e)?D.from(this.getValue()===e.getValue()):D.False}toString(e){return Number.isNaN(this.value)?"nan":this.value.toPrecision()}box(){return new gh(this)}}class yh extends L{kind=T.Object;intrinsic;getValue(){return this.intrinsic.getValue()}constructor(e){super("roFloat"),this.intrinsic=new bh(jS(e)?e.getValue():0),this.registerMethods({ifFloat:[this.getFloat,this.setFloat],ifToStr:[new dh(this,"%g").toStr]})}unbox(){return this.intrinsic}copy(){return new yh(this.intrinsic)}equalTo(e){return e instanceof yh?D.from(e.intrinsic.getValue()===this.intrinsic.getValue()):D.False}toString(e){return this.intrinsic.toString()}getFloat=new Ch("getFloat",{signature:{args:[],returns:T.Float},impl:e=>this.intrinsic});setFloat=new Ch("setFloat",{signature:{args:[new kh("value",T.Float)],returns:T.Void},impl:(e,t)=>(this.intrinsic=t,O.Instance)})}class bh{inArray;kind=T.Float;value;getValue(){return this.value}toBoolean(){return 0!==Math.trunc(this.value)}constructor(e,t=!1){this.inArray=t,e instanceof C()&&(e=e.toNumber()),this.value=parseFloat(Math.fround(e).toPrecision(7))}static fromString(e){return new bh(Number.parseFloat(e))}add(e){switch(e.kind){case T.Int64:return new bh(this.getValue()+e.getValue().toNumber());case T.Int32:case T.Float:return new bh(this.getValue()+e.getValue());case T.Double:return new mh(this.getValue()+e.getValue())}}subtract(e){switch(e.kind){case T.Int64:return new bh(this.getValue()-e.getValue().toNumber());case T.Int32:case T.Float:return new bh(this.getValue()-e.getValue());case T.Double:return new mh(this.getValue()-e.getValue())}}multiply(e){switch(e.kind){case T.Int64:return new bh(this.getValue()*e.getValue().toNumber());case T.Int32:case T.Float:return new bh(this.getValue()*e.getValue());case T.Double:return new mh(this.getValue()*e.getValue())}}divide(e){switch(e.kind){case T.Int64:return new bh(this.getValue()/e.getValue().toNumber());case T.Int32:case T.Float:return new bh(this.getValue()/e.getValue());case T.Double:return new mh(this.getValue()/e.getValue())}}modulo(e){switch(e.kind){case T.Int32:case T.Float:return new bh(Math.trunc(this.getValue()%e.getValue()));case T.Double:return new mh(Math.trunc(this.getValue()%e.getValue()));case T.Int64:return new bh(Math.trunc(this.getValue()%e.getValue().toNumber()))}}intDivide(e){switch(e.kind){case T.Int64:return new ph(Math.trunc(this.getValue()/e.getValue().toNumber()));case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue()/e.getValue()))}}leftShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue())<<Math.trunc(e.getValue()));case T.Int64:return new vh(Math.trunc(this.getValue())<<e.getValue().toNumber())}}rightShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue())>>Math.trunc(e.getValue()));case T.Int64:return new vh(Math.trunc(this.getValue())>>e.getValue().toNumber())}}pow(e){switch(e.kind){case T.Int32:return new bh(Math.pow(this.getValue(),e.getValue()));case T.Int64:return new bh(Math.pow(this.getValue(),e.getValue().toNumber()));case T.Float:return new bh(Math.pow(this.getValue(),e.getValue()));case T.Double:return new mh(Math.pow(this.getValue(),e.getValue()))}}and(e){switch(e.kind){case T.Int64:return new ph(this.getValue()).and(e);case T.Int32:case T.Float:case T.Double:return new vh(this.getValue()&e.getValue());case T.Boolean:return D.from(this.toBoolean()&&e.getValue())}}or(e){switch(e.kind){case T.Int64:return new ph(this.getValue()).or(e);case T.Int32:case T.Float:case T.Double:return new vh(this.getValue()|e.getValue());case T.Boolean:return D.from(this.toBoolean()||e.getValue())}}not(){return new vh(~this.getValue())}lessThan(e){return e.kind===T.Int64?D.from(this.getValue()<e.getValue().toNumber()):YS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return e.kind===T.Int64?D.from(this.getValue()>e.getValue().toNumber()):YS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return e.kind===T.Int64?D.from(this.getValue()===e.getValue().toNumber()):e.kind===T.Boolean?e.equalTo(D.from(this.toBoolean())):YS(e)?D.from(this.getValue()===e.getValue()):D.False}toString(e){return Number.isNaN(this.value)?"nan":(0,hh.vsprintf)("%g",[this.value])}box(){return new yh(this)}}class wh extends L{kind=T.Object;intrinsic;getValue(){return this.intrinsic.getValue()}constructor(e){super("roInt"),this.intrinsic=new vh(jS(e)?e.getValue():0);const t=new dh(this).toStr;this.registerMethods({ifInt:[this.getInt,this.setInt],ifIntOps:[t],ifToStr:[t]})}unbox(){return this.intrinsic}copy(){return new wh(this.intrinsic)}equalTo(e){return e instanceof wh?D.from(e.intrinsic.getValue()===this.intrinsic.getValue()):D.False}toString(e){return this.intrinsic.toString()}getInt=new Ch("getInt",{signature:{args:[],returns:T.Double},impl:e=>this.intrinsic});setInt=new Ch("setInt",{signature:{args:[new kh("value",T.Int32)],returns:T.Void},impl:(e,t)=>(this.intrinsic=t,O.Instance)})}class vh{inArray;kind=T.Int32;value;getValue(){return this.value}toBoolean(){return 0!==this.value}constructor(e,t=!1){this.inArray=t;const n=2147483648;e instanceof C()?e=e.low:(e>n-1||e<-n)&&(e=e<-n?-n:n-1),this.value=Math.trunc(e)}static fromString(e){if(e.toLowerCase().startsWith("&h")){e=e.slice(2);const t=0|Number.parseInt(e,16);return new vh(t)}return new vh(Number.parseFloat(e))}add(e){switch(e.kind){case T.Int32:return new vh(this.getValue()+e.getValue()|0);case T.Int64:return new ph(e.getValue().add(this.getValue()));case T.Float:return new bh(this.getValue()+e.getValue());case T.Double:return new mh(this.getValue()+e.getValue())}}subtract(e){switch(e.kind){case T.Int32:return new vh(this.getValue()-e.getValue()|0);case T.Int64:return new ph(this.getValue()).subtract(e);case T.Float:return new bh(this.getValue()-e.getValue());case T.Double:return new mh(this.getValue()-e.getValue())}}multiply(e){switch(e.kind){case T.Int32:return new vh(this.getValue()*e.getValue()|0);case T.Int64:return new ph(e.getValue().multiply(this.getValue()));case T.Float:return new bh(this.getValue()*e.getValue());case T.Double:return new mh(this.getValue()*e.getValue())}}divide(e){switch(e.kind){case T.Int32:return new bh(this.getValue()/e.getValue());case T.Int64:return new bh(this.getValue()/e.getValue().toNumber());case T.Float:return new bh(this.getValue()/e.getValue());case T.Double:return new mh(this.getValue()/e.getValue())}}modulo(e){switch(e.kind){case T.Int32:return new vh(this.getValue()%e.getValue());case T.Float:return new bh(Math.trunc(this.getValue()%e.getValue()));case T.Double:return new mh(Math.trunc(this.getValue()%e.getValue()));case T.Int64:return new ph(this.getValue()).modulo(e)}}intDivide(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(Math.trunc(this.getValue()/e.getValue()));case T.Int64:return new ph(Math.trunc(this.getValue()/e.getValue().toNumber()))}}leftShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(this.getValue()<<Math.trunc(e.getValue()));case T.Int64:return new vh(this.getValue()<<e.getValue().toNumber())}}rightShift(e){switch(e.kind){case T.Int32:case T.Float:case T.Double:return new vh(this.getValue()>>>Math.trunc(e.getValue()));case T.Int64:return new vh(this.getValue()>>>e.getValue().toNumber())}}pow(e){switch(e.kind){case T.Int32:return new bh(Math.pow(this.getValue(),e.getValue()));case T.Int64:return new ph(this.getValue()).pow(e);case T.Float:return new bh(Math.pow(this.getValue(),e.getValue()));case T.Double:return new mh(Math.pow(this.getValue(),e.getValue()))}}and(e){switch(e.kind){case T.Int32:return new vh(this.getValue()&e.getValue());case T.Int64:return new ph(this.getValue()).and(e);case T.Float:case T.Double:return new vh(this.getValue()&e.getValue());case T.Boolean:return D.from(this.toBoolean()&&e.getValue())}}or(e){switch(e.kind){case T.Int32:return new vh(this.getValue()|e.getValue());case T.Int64:return new ph(this.getValue()).or(e);case T.Float:case T.Double:return new vh(this.getValue()|e.getValue());case T.Boolean:return D.from(this.toBoolean()||e.getValue())}}not(){return new vh(~this.getValue())}lessThan(e){return e.kind===T.Int64?D.from(this.getValue()<e.getValue().toNumber()):YS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return e.kind===T.Int64?D.from(this.getValue()>e.getValue().toNumber()):YS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return e.kind===T.Int64?D.from(this.getValue()===e.getValue().toNumber()):e.kind===T.Boolean?e.equalTo(D.from(this.toBoolean())):YS(e)?D.from(this.getValue()===e.getValue()):D.False}toString(e){return Number.isNaN(this.value)?"nan":this.value.toString()}box(){return new wh(this)}}function Sh(e,t){if(e.kind===t||t===T.Dynamic)return e;if(e.kind===T.Uninitialized)return e;if(t===T.Object){if(se(e))return Sh(e.box(),t);if(e instanceof L)return e}if(HS.has(t)&&ae(e))return Sh(e.unbox(),t);if(GS(t)&&jS(e))switch(t){case T.Int32:return new vh(e.getValue());case T.Int64:return new ph(e.getValue());case T.Float:return new bh(e.getValue());case T.Double:return new mh(e.getValue())}else if(t===T.Boolean&&jS(e))return D.from(e.toBoolean())}function xh(e,t){let n=t.signature,r=t.mismatches,i=[],s=0,a=n.args.map(e=>{let t=`${e.name.text} as ${T.toString(e.type.kind)}`;return e.defaultValue?`[${t}]`:(s++,t)}).join(", ");return i.push(`function ${e}(${a}) as ${T.toString(n.returns)}:`),i.push(...r.map(t=>{switch(t.reason){case Th.TooFewArguments:return`* ${e} requires at least ${s} argument(s), but received ${t.received}.`;case Th.TooManyArguments:return`* ${e} accepts at most ${t.expected} argument(s), but received ${t.received}.`;case Th.ArgumentTypeMismatch:return`* Argument '${t.argName}' must be of type ${t.expected}, but received ${t.received}.`}}).map(e=>`    ${e}`)),i.map(e=>`    ${e}`).join("\n")}function Eh(e,t,n){let r,i,s=e.getName(),a=e.getAllSignatureMismatches(t);1===a.length?(r=`Provided arguments don't match ${s}'s signature.`,i=[xh(s,a[0])]):(r=`Provided arguments don't match any of ${s}'s signatures.`,i=a.map(xh.bind(null,s)));const o={message:`${Z.TypeMismatch.message}: ${[r,...i].join("\n")}`,errno:Z.TypeMismatch.errno};return new J(o,n)}let Ih=0;class kh{location;name;type;defaultValue;constructor(e,t,n){this.location=kh.InternalLocation,this.name={text:e,location:kh.InternalLocation},this.type={kind:t,location:kh.InternalLocation},n&&(this.defaultValue=new $(n,kh.InternalLocation))}static InternalLocation={file:"(stdlib)",start:{line:-1,column:-1},end:{line:-1,column:-1}}}var Th,_h;!function(e){e[e.TooFewArguments=0]="TooFewArguments",e[e.TooManyArguments=1]="TooManyArguments",e[e.ArgumentTypeMismatch=2]="ArgumentTypeMismatch"}(Th||(Th={}));class Ch{kind=T.Callable;inArray=!1;name;signatures;context;location;call(e,...t){let n=this.getFirstSatisfiedSignature(t);null==n&&e.addError(Eh(this,t,e.location));let{signature:r,impl:i}=n,s=[...n.coercedArgs];return e.inSubEnv(t=>{for(const[n,i]of r.args.entries())i.defaultValue&&null==s[n]&&(s[n]=t.evaluate(i.defaultValue)),t.environment.define(ne.Function,i.name.text,s[n],e.location);return i(t,...s)})}constructor(e,...t){this.name=e,this.signatures=t,!this.signatures.length||this.name&&"[Function]"!==this.name||(this.name="$anon_"+ ++Ih)}lessThan(e){return D.False}greaterThan(e){return D.False}equalTo(e){return D.from(this===e)}toString(e){return`<Function: ${this.name?.toLowerCase()??"UNDEFINED"}>`}box(){return new Rh(this)}getName(){return this.name??""}getContext(){return this.context}setContext(e){this.context=e}setLocation(e){this.location=e}getLocation(){return this.location}getFirstSatisfiedSignature(e){for(let t of this.signatures){let n=this.trySatisfySignature(t,e);if(0===n.mismatches.length)return n}}getAllSignatureMismatches(e){return this.signatures.map(t=>this.trySatisfySignature(t,e))}trySatisfySignature(e,t){let{signature:n,impl:r}=e,i=[],s=n.args.filter(e=>!e.defaultValue).length;t.length<s?i.push({reason:Th.TooFewArguments,expected:n.args.length.toString(),received:t.length.toString()}):!n.variadic&&t.length>n.args.length&&i.push({reason:Th.TooManyArguments,expected:n.args.length.toString(),received:t.length.toString()});let a=[...t];const o=n.args.slice(0,Math.min(n.args.length,t.length));for(const[e,r]of o.entries()){let r=n.args[e],s=t[e],o=Sh(s,r.type.kind);null!=o?a[e]=o:i.push({reason:Th.ArgumentTypeMismatch,expected:T.toString(r.type.kind),received:T.toString(s.kind),argName:r.name.text})}return{signature:n,impl:r,coercedArgs:a,mismatches:i}}static variadic(e){let{signature:t,impl:n}=e;return[e,...new Array(10).fill(0).map((e,r)=>({signature:{args:[...t.args,...new Array(r).fill(0).map((e,t)=>new kh(`arg${t}`,T.Dynamic))],returns:t.returns},impl:n}))]}}class Ah{component;constructor(e){this.component=e}isEmpty=new Ch("isEmpty",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(0===this.component.getElements().length)});isNext=new Ch("isNext",{signature:{args:[],returns:T.Boolean},impl:e=>this.component.hasNext()});reset=new Ch("reset",{signature:{args:[],returns:T.Void},impl:e=>(this.component.resetNext(),O.Instance)});next=new Ch("next",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.getNext()??O.Instance})}class Fh extends L{kind=T.Object;elements=new Map;enumIndex;keyMap=new Map;modeCaseSensitive;constructor(e,t=!1){super("roAssociativeArray"),this.modeCaseSensitive=t;for(const t of e)this.addChildRef(t.value),this.set(t.name,t.value,!0);this.enumIndex=e.length?0:-1;const n=new Ah(this);this.registerMethods({ifAssociativeArray:[this.clear,this.delete,this.addReplace,this.count,this.doesExist,this.append,this.keys,this.items,this.lookup,this.lookupCI,this.setModeCaseSensitive],ifEnum:[n.isEmpty,n.isNext,n.next,n.reset]})}toString(e){return e?"<Component: roAssociativeArray>":["<Component: roAssociativeArray> =","{",...Array.from(this.elements.entries()).sort().map(([e,t])=>`    ${e}: ${t.toString(this)}`),"}"].join("\n")}equalTo(e){return D.False}getValue(){return this.elements}getElements(){return Array.from(this.elements.keys()).sort().map(e=>new M(e))}getValues(){return Array.from(this.elements.values()).sort().map(e=>e)}clearElements(){let e=0;for(const t of this.elements.values())this.removeChildRef(t)&&e++;return this.elements.clear(),this.keyMap.clear(),this.enumIndex=-1,e}deepCopy(){const e=[];for(const[t,n]of this.elements)XS(n)?(n instanceof Kh||n instanceof Fh||n instanceof Wh)&&e.push({name:new M(t),value:n.deepCopy()}):!se(n)||n instanceof Ch?!ae(n)||n instanceof Rh||e.push({name:new M(t),value:n.copy()}):e.push({name:new M(t),value:n});return new Fh(e,this.modeCaseSensitive)}get(e,t=!1){if(ae(e)&&(e=e.unbox()),e.kind!==T.String)throw new Error("Associative array indexes must be strings");return this.findElement(e.value,t)||this.getMethod(e.value)||O.Instance}set(e,t,n=!1){if(ae(e)&&(e=e.unbox()),e.kind!==T.String)throw new Error("Associative array indexes must be strings");let r=this.findElementKey(e.value);this.addChildRef(t),r&&this.removeChildRef(this.elements.get(r)),!this.modeCaseSensitive&&r&&(this.elements.delete(r),this.keyMap.set(r.toLowerCase(),new Set));let i=n?e.value:e.value.toLowerCase();this.elements.set(i,t);let s=e.value.toLowerCase();return this.keyMap.has(s)||this.keyMap.set(s,new Set),this.keyMap.get(s)?.add(i),O.Instance}hasNext(){return D.from(this.enumIndex>=0)}getNext(){const e=Array.from(this.elements.keys()),t=this.enumIndex;t>=0&&(this.enumIndex++,this.enumIndex>=e.length&&(this.enumIndex=-1));const n=e[t];return n?new M(n):O.Instance}resetNext(){this.enumIndex=this.elements.size>0?0:-1}updateNext(){const e=Array.from(this.elements.keys()),t=e.length>0;-1===this.enumIndex&&t?this.enumIndex=0:(this.enumIndex>=e.length||!t)&&(this.enumIndex=-1)}dispose(){for(const e of this.elements.values())this.removeChildRef(e)}addChildRef(e){e instanceof L?e.addReference():e&&se(e)&&(e.inArray=!0)}removeChildRef(e){return e instanceof L&&e.removeReference()>1}findElementKey(e,t=!1){return this.modeCaseSensitive&&t?e:this.keyMap.get(e.toLowerCase())?.values().next().value}findElement(e,t=!1){let n=this.findElementKey(e,t);return void 0!==n?this.elements.get(n):void 0}clear=new Ch("clear",{signature:{args:[],returns:T.Void},impl:e=>(this.clearElements(),O.Instance)});delete=new Ch("delete",{signature:{args:[new kh("str",T.String)],returns:T.Boolean},impl:(e,t)=>{let n=this.findElementKey(t.value,this.modeCaseSensitive);n&&this.removeChildRef(this.elements.get(n));let r=!!n&&this.elements.delete(n),i=t.value.toLowerCase();if(this.modeCaseSensitive){let e=this.keyMap.get(i);e&&n&&e?.delete(n),0===e?.size&&this.keyMap.delete(i)}else this.keyMap.delete(i);return this.updateNext(),D.from(r)}});addReplace=new Ch("addReplace",{signature:{args:[new kh("key",T.String),new kh("value",T.Dynamic)],returns:T.Void},impl:(e,t,n)=>(this.set(t,n,!0),this.updateNext(),O.Instance)});count=new Ch("count",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.elements.size)});doesExist=new Ch("doesExist",{signature:{args:[new kh("str",T.String)],returns:T.Boolean},impl:(e,t)=>{let n=this.findElementKey(t.value,this.modeCaseSensitive);return n&&this.elements.has(n)?D.True:D.False}});append=new Ch("append",{signature:{args:[new kh("obj",T.Object)],returns:T.Void},impl:(e,t)=>{if(!(t instanceof Fh))return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roAssociativeArray.Append: invalid parameter type ${t.getComponentName()}: ${e.formatLocation()}`),O.Instance;for(const[e,n]of t.elements)this.set(new M(e),n,!0);return this.updateNext(),O.Instance}});keys=new Ch("keys",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.getElements())});items=new Ch("items",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.getElements().map(e=>new Fh([{name:new M("key"),value:e},{name:new M("value"),value:this.get(e)}])))});lookup=new Ch("lookup",{signature:{args:[new kh("key",T.String)],returns:T.Dynamic},impl:(e,t)=>this.get(t,!0)});lookupCI=new Ch("lookupCI",{signature:{args:[new kh("key",T.String)],returns:T.Dynamic},impl:(e,t)=>this.get(t)});setModeCaseSensitive=new Ch("setModeCaseSensitive",{signature:{args:[],returns:T.Void},impl:e=>(this.modeCaseSensitive=!0,O.Instance)})}class Rh extends L{kind=T.Object;intrinsic;getValue(){return this.intrinsic}constructor(e){super("roFunction"),this.intrinsic=e??new Ch(void 0),this.registerMethods({ifFunction:[this.getSub,this.setSub],ifToStr:[new dh(this,/[<>]/g).toStr]})}unbox(){return this.intrinsic}copy(){return new Rh(this.intrinsic)}equalTo(e){return D.False}toString(e){return this.intrinsic.toString()}getSub=new Ch("getSub",{signature:{args:[],returns:T.Callable},impl:e=>this.intrinsic});setSub=new Ch("setSub",{signature:{args:[new kh("value",T.Callable)],returns:T.Void},impl:(e,t)=>(this.intrinsic=t,O.Instance)})}function Mh(e){const t=e.toLowerCase();return Object.values(_h).some(e=>e.toLowerCase()===t)}!function(e){e.Node="Node",e.ContentNode="ContentNode",e.Group="Group",e.LayoutGroup="LayoutGroup",e.MaskGroup="MaskGroup",e.TargetGroup="TargetGroup",e.TargetList="TargetList",e.TargetSet="TargetSet",e.ButtonGroup="ButtonGroup",e.Button="Button",e.Panel="Panel",e.PanelSet="PanelSet",e.ListPanel="ListPanel",e.GridPanel="GridPanel",e.OverhangPanelSetScene="OverhangPanelSetScene",e.Dialog="Dialog",e.KeyboardDialog="KeyboardDialog",e.PinPad="PinPad",e.PinDialog="PinDialog",e.ParentalControlPinPad="ParentalControlPinPad",e.StandardDialog="StandardDialog",e.StandardKeyboardDialog="StandardKeyboardDialog",e.StandardMessageDialog="StandardMessageDialog",e.StandardPinPadDialog="StandardPinPadDialog",e.StandardProgressDialog="StandardProgressDialog",e.ProgressDialog="ProgressDialog",e.StdDlgActionCardItem="StdDlgActionCardItem",e.StdDlgAreaBase="StdDlgAreaBase",e.StdDlgBulletTextItem="StdDlgBulletTextItem",e.StdDlgButton="StdDlgButton",e.StdDlgButtonArea="StdDlgButtonArea",e.StdDlgContentArea="StdDlgContentArea",e.StdDlgCustomItem="StdDlgCustomItem",e.StdDlgDeterminateProgressItem="StdDlgDeterminateProgressItem",e.StdDlgGraphicItem="StdDlgGraphicItem",e.StdDlgItemBase="StdDlgItemBase",e.StdDlgItemGroup="StdDlgItemGroup",e.StdDlgKeyboardItem="StdDlgKeyboardItem",e.StdDlgMultiStyleTextItem="StdDlgMultiStyleTextItem",e.StdDlgProgressItem="StdDlgProgressItem",e.StdDlgSideCardArea="StdDlgSideCardArea",e.StdDlgTextItem="StdDlgTextItem",e.StdDlgTitleArea="StdDlgTitleArea",e.Rectangle="Rectangle",e.Poster="Poster",e.Label="Label",e.LabelBase="LabelBase",e.SimpleLabel="SimpleLabel",e.MultiStyleLabel="MultiStyleLabel",e.MonospaceLabel="MonospaceLabel",e.ScrollingLabel="ScrollingLabel",e.ScrollableText="ScrollableText",e.Font="Font",e.ArrayGrid="ArrayGrid",e.PosterGrid="PosterGrid",e.LabelList="LabelList",e.CheckList="CheckList",e.RowList="RowList",e.RadioButtonList="RadioButtonList",e.MarkupList="MarkupList",e.ZoomRowList="ZoomRowList",e.MarkupGrid="MarkupGrid",e.TimeGrid="TimeGrid",e.Task="Task",e.Timer="Timer",e.Scene="Scene",e.Keyboard="Keyboard",e.MiniKeyboard="MiniKeyboard",e.DynamicKeyboard="DynamicKeyboard",e.DynamicKeyboardBase="DynamicKeyboardBase",e.DynamicMiniKeyboard="DynamicMiniKeyboard",e.DynamicCustomKeyboard="DynamicCustomKeyboard",e.DynamicPinPad="DynamicPinPad",e.DynamicKeyGrid="DynamicKeyGrid",e.TextEditBox="TextEditBox",e.VoiceTextEditBox="VoiceTextEditBox",e.Overhang="Overhang",e.RSGPalette="RSGPalette",e.Video="Video",e.Audio="Audio",e.SoundEffect="SoundEffect",e.TrickPlayBar="TrickPlayBar",e.Animation="Animation",e.AnimationBase="AnimationBase",e.SequentialAnimation="SequentialAnimation",e.ParallelAnimation="ParallelAnimation",e.FloatFieldInterpolator="FloatFieldInterpolator",e.Vector2DFieldInterpolator="Vector2DFieldInterpolator",e.ColorFieldInterpolator="ColorFieldInterpolator",e.BusySpinner="BusySpinner",e.ChannelStore="ChannelStore",e.ComponentLibrary="ComponentLibrary",e.InfoPane="InfoPane"}(_h||(_h={}));class Dh{static additionalNodes=new Map;static addNodeTypes(e){for(const[t,n]of e)this.additionalNodes.set(t.toLowerCase(),n)}static createNode(e,t){let n=t||e;const r=this.additionalNodes.get(e?.toLowerCase());if(r)return r(n);switch(e.toLowerCase()){case _h.Node.toLowerCase():return new Bf([],n);case _h.Group.toLowerCase():case _h.MaskGroup.toLowerCase():case _h.TargetGroup.toLowerCase():case _h.ScrollableText.toLowerCase():return new tS([],n);case _h.LayoutGroup.toLowerCase():return new cS([],n);case _h.Panel.toLowerCase():case _h.ListPanel.toLowerCase():case _h.GridPanel.toLowerCase():return new lS([],n);case _h.Button.toLowerCase():return new RS([],n);case _h.ButtonGroup.toLowerCase():return new MS([],n);case _h.KeyboardDialog.toLowerCase():return new mS([],n);case _h.Dialog.toLowerCase():return new gS([],n);case _h.Rectangle.toLowerCase():return new uS([],n);case _h.Label.toLowerCase():return new hS([],n);case _h.ScrollingLabel.toLowerCase():return new dS([],n);case _h.Font.toLowerCase():return new fS([],n);case _h.Poster.toLowerCase():return new pS([],n);case _h.ArrayGrid.toLowerCase():return new yS([],n);case _h.LabelList.toLowerCase():return new CS([],n);case _h.CheckList.toLowerCase():return new AS([],n);case _h.RadioButtonList.toLowerCase():return new FS([],n);case _h.RowList.toLowerCase():return new bS([],n);case _h.ZoomRowList.toLowerCase():return new wS([],n);case _h.MarkupList.toLowerCase():return new SS([],n);case _h.MarkupGrid.toLowerCase():return new vS([],n);case _h.ContentNode.toLowerCase():return new Zv(n);case _h.Task.toLowerCase():return new Vf([],n);case _h.Timer.toLowerCase():return new ES([],n);case _h.Scene.toLowerCase():return new nS([],n);case _h.Audio.toLowerCase():return new IS([],n);case _h.SoundEffect.toLowerCase():return new kS([],n);case _h.Video.toLowerCase():return new _S([],n);case _h.TrickPlayBar.toLowerCase():return new TS([],n);case _h.Keyboard.toLowerCase():return new sS([],n);case _h.MiniKeyboard.toLowerCase():return new aS([],n);case _h.TextEditBox.toLowerCase():return new oS([],n);case _h.Overhang.toLowerCase():return new xS([],n);case _h.StandardDialog.toLowerCase():return new DS([],n);case _h.StandardProgressDialog.toLowerCase():return new OS([],n);case _h.StdDlgContentArea.toLowerCase():return new PS([],n);case _h.StdDlgTitleArea.toLowerCase():return new NS([],n);case _h.StdDlgProgressItem.toLowerCase():return new LS([],n);case _h.BusySpinner.toLowerCase():return new BS([],n);case _h.RSGPalette.toLowerCase():return new US([],n);case _h.ChannelStore.toLowerCase():return new VS([],n);default:return Mh(e)?(uh.stderr.write(`warning,The roSGNode with type "${e}" is not implemented yet, created as regular "Node".`),new Bf([],n)):void 0}}static canResolveNodeType(e){return this.additionalNodes.has(e?.toLowerCase())||Mh(e)}}function Oh(e,t){let n=Dh.createNode(e.value)??O.Instance;if(n instanceof O){let r=eS.nodeDefMap.get(e.value.toLowerCase());if(r&&t instanceof RE)n=Lh(t,e,r);else{if(!r)return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode: Failed to create roSGNode with type ${e.value}: ${t?.formatLocation()??""}`),O.Instance;r=Uh(r).pop(),n=Dh.createNode(r.extends,e.value)??O.Instance,n instanceof O&&(n=new Bf([],e.value))}}if(n instanceof Vf&&(n.id=eS.tasks.length+1,eS.tasks.push(n),eS.setThread(n.id)),n instanceof Bf&&eS.inTaskThread()){const e=eS.tasks[0];e&&ux(n.getNodeParent())&&n.setNodeParent(e)}return n}function Ph(e,t){let n=eS.nodeDefMap.get(t.value.toLowerCase());return Uh(n),n&&Hh(t.value,_h.Scene)?new nS([],t.value):(uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode: Failed to create a Scene with type ${t.value}: ${e.formatLocation()}`),O.Instance)}function Nh(e){return eS.nodeDefMap.has(e.value.toLowerCase())}function Lh(e,t,n,r){if(n){const i=Uh(n),s=n.environment?.createSubEnvironment();n=i.pop(),r||(r=Dh.createNode(n.extends,t.value)),r??=new Bf([],t.value);const a=new Fh([]);for(s?.setM(new Fh([]));n;){let t;e.inSubEnv(e=>(zh(e,r,n),jh(e,r,n),O.Instance),s),r instanceof nS&&r.renderNode(e,[0,0],0,1),e.inSubEnv(e=>(t=e.getCallableFunction("init"),O.Instance),n.environment),e.inSubEnv(e=>(e.environment.hostNode=r,a.set(new M("top"),r),a.set(new M("global"),eS.mGlobal),e.environment.setM(a),e.environment.setRootM(a),r.m=a,t instanceof Ch&&t.call(e),O.Instance),s),n=i.pop()}return r}return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode: Failed to initialize roSGNode with type ${t.value}: ${e.formatLocation()}`),O.Instance}function Bh(e,t){const n=t.name;let r=eS.nodeDefMap.get(n.toLowerCase());if(r){let i=Uh(r),s=r.environment?.createSubEnvironment();r=i.pop();let a=Dh.createNode(r.extends,n)||new Vf([],n),o=new Fh([]);for(s?.setM(new Fh([]));r;)e.inSubEnv(e=>(zh(e,a,r),jh(e,a,r),O.Instance),s),e.inSubEnv(e=>(e.environment.hostNode=a,o.set(new M("top"),a),o.set(new M("global"),eS.mGlobal),e.environment.setM(o),e.environment.setRootM(o),a.m=o,O.Instance),s),r=i.pop();return function(e,t,n){let r;if(t instanceof Vf&&(t.id=n.id,t.thread=!0,eS.tasks.push(t),eS.setThread(0,!1,n.render),eS.setThread(n.id,!0),e.environment.hostNode=t),n.m)for(let[e,i]of Object.entries(n.m)){if("global"===e||"top"===e)continue;const n=rx(i);!r&&n instanceof pp&&(console.debug("[Task] A port object was found!"),r=n),t.m.set(new M(e),n)}if(n.m?.global&&Vh(e,n.m.global,eS.mGlobal,r),n.m?.top&&Vh(e,n.m.top,t,r),n.scene?._node_){const e=n.scene._node_.split(":"),t=ix(n.scene,e[0],e[1]);t instanceof nS&&eS.setScene(t)}}(e,a,t),a}return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode: Failed to initialize Task with type ${n}: ${e.formatLocation()}`),O.Instance}function Uh(e){let t=[];if(!e)return t;for(t.push(e);e;)Gh.set(e.name.toLowerCase(),e.extends||_h.Node),(e=eS.nodeDefMap.get(e.extends.toLowerCase()))&&t.push(e);return t}function Vh(e,t,n,r){const i=t._observed_;n.owner=t._owner_??eS.taskId;for(let[s,a]of Object.entries(t))s.startsWith("_")&&s.endsWith("_")&&s.length>2||(n.setFieldValue(s,rx(a)),r&&i?.includes(s)&&(n instanceof Vf?console.debug(`[Task] Adding observer port for top.${s}`):console.debug(`[Task] Adding observer port for global.${s}`),n.addObserver(e,"unscoped",new M(s),r)))}function jh(e,t,n){let r=n.fields;for(let[i,s]of Object.entries(r))if(s instanceof Object){if(s.alias?.includes(".")){const e=s.alias.split(".")[0],r=s.alias.split(".")[1],a=t.findNodeById(t,e);if(!(a instanceof Bf)){let r=`warning,Error creating XML component ${t.nodeSubtype}\n`;return r+=`-- Interface field alias failed: No node named ${e}\n`,r+=`-- Error found ${n.xmlPath}`,void uh.stderr.write(r)}{const s=a.getNodeFields().get(r?.toLowerCase());if(!s){let i=`warning,Error creating XML component ${t.nodeSubtype}\n`;return i+=`-- Interface field alias failed: Node "${e}" has no field named "${r}"\n`,i+=`-- Error found ${n.xmlPath}`,void uh.stderr.write(i)}t.addNodeFieldAlias(i,s,e,r)}}else{if(t.getNodeFields().get(i.toLowerCase())){let e=`warning,Error creating XML component ${t.nodeSubtype}\n`;return e+=`-- Attempt to add duplicate field "${i}" to RokuML component "${t.nodeSubtype}"\n`,e+=`---- Extends node type "${n.extends}" already has a field named ${i}\n`,e+=`-- Error found ${n.xmlPath}`,void uh.stderr.write(e)}t.addNodeField(i,s.type,"true"===s.alwaysNotify),s.value&&t.setFieldValue(i,F(s.type,s.value))}if(s.onChange){const n=t.getNodeFields().get(i.toLowerCase()),r=e.getCallableFunction(s.onChange);r instanceof Ch&&n&&n.addObserver("permanent",e,r,t,new M(i))}}}function zh(e,t,n){const r=n.children,i=t.getMethod("appendchild");for(let n of r){const r=Oh(new M(n.name),e);if(r instanceof Bf){const s=r.getNodeFields();for(let[e,t]of Object.entries(n.fields)){const n=s.get(e.toLowerCase());n&&r.set(new M(e),F(n.getType(),t))}if(n.fields?.role){const i=n.fields.role;if(!t.getNodeFields().get(i))throw new Error(`Role/Field ${i} does not exist in ${t.getId()} node`);n.children.length>0&&zh(e,r,n),t.set(new M(i),r,!1)}else i&&(i.call(e,r),n.children.length>0&&zh(e,r,n))}}}const Gh=new Map;function Hh(e,t){if(t=t.toLowerCase(),(e=e.toLowerCase())===t)return!0;let n=Gh.get(e);return null!=n&&Hh(n,t)}function $h(e){if(Mh(e))return e;let t=Gh.get(e.toLowerCase());return null==t?_h.Node:Mh(t)?t:$h(t)}class Wh extends L{nodeSubtype;kind=T.Object;httpAgent;m=new Fh([]);constructor(e,t="Node"){super("roSGNode"),this.nodeSubtype=t,this.registerMethods({ifAssociativeArray:[this.clear,this.delete,this.addReplace,this.count,this.doesExist,this.append,this.keys,this.items,this.lookup,this.lookupCI],ifSGNodeField:[this.addField,this.addFields,this.getField,this.getFields,this.getFieldType,this.getFieldTypes,this.hasField,this.observeField,this.unobserveField,this.observeFieldScoped,this.observeFieldScopedEx,this.unobserveFieldScoped,this.removeField,this.removeFields,this.setField,this.setFields,this.update,this.signalBeacon,this.threadInfo,this.queueFields,this.moveIntoField,this.moveFromField,this.setRef,this.canGetRef,this.getRef],ifSGNodeChildren:[this.appendChild,this.getChildCount,this.getChildren,this.removeChild,this.getParent,this.createChild,this.replaceChild,this.removeChildren,this.appendChildren,this.getChild,this.insertChild,this.removeChildrenIndex,this.removeChildIndex,this.reparent,this.createChildren,this.replaceChildren,this.insertChildren,this.getScene],ifSGNodeFocus:[this.hasFocus,this.setFocus,this.isInFocusChain],ifSGNodeDict:[this.findNode,this.isSameNode,this.subtype,this.callFunc,this.isSubtype,this.parentSubtype,this.clone],ifSGNodeBoundingRect:[this.boundingRect,this.localBoundingRect,this.sceneBoundingRect],ifSGNodeHttpAgentAccess:[this.getHttpAgent,this.setHttpAgent]}),this.httpAgent=new mv,this.registerHttpAgent(this.httpAgent)}registerHttpAgent(e){this.registerMethods({ifHttpAgent:[e.ifHttpAgent.addHeader,e.ifHttpAgent.setHeaders,e.ifHttpAgent.initClientCertificates,e.ifHttpAgent.setCertificatesFile,e.ifHttpAgent.setCertificatesDepth,e.ifHttpAgent.enableCookies,e.ifHttpAgent.getCookies,e.ifHttpAgent.addCookies,e.ifHttpAgent.clearCookies]})}equalTo(e){return D.False}callFunc=new Ch("callFunc",...Ch.variadic({signature:{args:[new kh("functionName",T.String)],returns:T.Dynamic},impl:(e,t,...n)=>this.callFunction(e,t,...n)}));clear=new Ch("clear",{signature:{args:[],returns:T.Void},impl:e=>(this.clearNodeFields(),O.Instance)});delete=new Ch("delete",{signature:{args:[new kh("str",T.String)],returns:T.Boolean},impl:(e,t)=>(this.removeFieldEntry(t.getValue()),D.True)});addReplace=new Ch("addReplace",{signature:{args:[new kh("key",T.String),new kh("value",T.Dynamic)],returns:T.Void},impl:(e,t,n)=>(this.set(t,n),O.Instance)});count=new Ch("count",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.getElements().length)});doesExist=new Ch("doesExist",{signature:{args:[new kh("str",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(this.getElements().some(e=>e.value===t.value.toLowerCase()))});append=new Ch("append",{signature:{args:[new kh("obj",T.Object)],returns:T.Void},impl:(e,t)=>(this.appendNodeFields(t),O.Instance)});keys=new Ch("keys",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.getElements())});items=new Ch("items",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.getElements().map(e=>nx({key:e,value:this.get(e)})))});lookup=new Ch("lookup",{signature:{args:[new kh("key",T.String)],returns:T.Dynamic},impl:(e,t)=>this.get(t)});lookupCI=new Ch("lookupCI",this.lookup.signatures[0]);addField=new Ch("addField",{signature:{args:[new kh("fieldName",T.String),new kh("type",T.String),new kh("alwaysNotify",T.Boolean)],returns:T.Boolean},impl:(e,t,n,r)=>(this.addNodeField(t.value,n.value,r.toBoolean()),D.True)});addFields=new Ch("addFields",{signature:{args:[new kh("fields",T.Object)],returns:T.Boolean},impl:(e,t)=>t instanceof Fh?(this.setNodeFields(t),D.True):D.False});threadInfo=new Ch("threadInfo",{signature:{args:[],returns:T.Object},impl:e=>this.getThreadInfo()});queueFields=new Ch("queueFields",{signature:{args:[new kh("queueNode",T.Boolean)],returns:T.Void},impl:(e,t)=>P.Instance});moveIntoField=new Ch("moveIntoField",{signature:{args:[new kh("fieldName",T.String),new kh("data",T.Object)],returns:T.Int32},impl:(e,t,n)=>{let r;if(r=n instanceof Fh?this.moveObjectIntoField(t.value,n):{code:-1,msg:"Move data must be AA"},r.code<0){const t=e.formatLocation();uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.moveIntoField: ${r.msg}: ${t}`)}return new vh(r.code)}});moveFromField=new Ch("moveFromField",{signature:{args:[new kh("fieldName",T.String)],returns:T.Object},impl:(e,t)=>{const n=this.moveObjectFromField(t.value);if("string"==typeof n){const t=e.formatLocation();return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.moveFromField: ${n}: ${t}`),O.Instance}return n}});setRef=new Ch("setRef",{signature:{args:[new kh("fieldName",T.String),new kh("data",T.Object)],returns:T.Boolean},impl:(e,t,n)=>{if(eS.inTaskThread()||!(n instanceof Fh))return D.False;const r=this.setFieldByRef(t.value,n);if(r<0){const n=e.formatLocation();uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.setRef: Could not find field '"${t.value}"': ${n}`)}return D.from(r>0)}});canGetRef=new Ch("canGetRef",{signature:{args:[new kh("fieldName",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(this.canGetFieldByRef(t.value))});getRef=new Ch("getRef",{signature:{args:[new kh("fieldName",T.String)],returns:T.Dynamic},impl:(e,t)=>{const n=this.getFieldByRef(t.value);if("string"==typeof n&&n.length>0){const t=e.formatLocation();uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.getRef: ${n}: ${t}`)}else if(n instanceof Fh)return n;return O.Instance}});getField=new Ch("getField",{signature:{args:[new kh("fieldName",T.String)],returns:T.Dynamic},impl:(e,t)=>this.get(t)});getFields=new Ch("getFields",{signature:{args:[],returns:T.Object},impl:e=>this.getNodeFieldsAsAA()});getFieldType=new Ch("getFieldType",{signature:{args:[new kh("fieldName",T.String)],returns:T.String},impl:(e,t)=>{const n=this.getNodeFieldTypes().get(t);return n instanceof M?n:new M("<NoSuchField>")}});getFieldTypes=new Ch("getFieldTypes",{signature:{args:[],returns:T.Object},impl:e=>this.getNodeFieldTypes()});hasField=new Ch("hasField",{signature:{args:[new kh("fieldName",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(this.hasNodeField(t.value))});observeField=new Ch("observeField",{signature:{args:[new kh("fieldName",T.String),new kh("functionName",T.String),new kh("infoFields",T.Object,O.Instance)],returns:T.Boolean},impl:(e,t,n,r)=>this.addObserver(e,"unscoped",t,n,r)},{signature:{args:[new kh("fieldName",T.String),new kh("port",T.Object),new kh("infoFields",T.Object,O.Instance)],returns:T.Boolean},impl:(e,t,n,r)=>this.addObserver(e,"unscoped",t,n,r)});unobserveField=new Ch("unobserveField",{signature:{args:[new kh("fieldName",T.String)],returns:T.Boolean},impl:(e,t)=>{if(!e.environment.hostNode){const n=e.formatLocation();return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.unObserveField: "${this.nodeSubtype}.${t.value}" no active host node: ${n}`),D.False}return this.removeObserver(t.value),D.True}});observeFieldScoped=new Ch("observeFieldScoped",{signature:{args:[new kh("fieldName",T.String),new kh("functionName",T.String),new kh("infoFields",T.Object,O.Instance)],returns:T.Boolean},impl:(e,t,n,r)=>this.addObserver(e,"scoped",t,n,r)},{signature:{args:[new kh("fieldName",T.String),new kh("port",T.Object),new kh("infoFields",T.Object,O.Instance)],returns:T.Boolean},impl:(e,t,n,r)=>this.addObserver(e,"scoped",t,n,r)});observeFieldScopedEx=new Ch("observeFieldScopedEx",{signature:{args:[new kh("fieldName",T.String),new kh("functionName",T.String),new kh("infoFields",T.Object,O.Instance)],returns:T.Boolean},impl:(e,t,n,r)=>this.addObserver(e,"scoped",t,n,r)},{signature:{args:[new kh("fieldName",T.String),new kh("port",T.Object),new kh("infoFields",T.Object,O.Instance)],returns:T.Boolean},impl:(e,t,n,r)=>this.addObserver(e,"scoped",t,n,r)});unobserveFieldScoped=new Ch("unobserveFieldScoped",{signature:{args:[new kh("fieldName",T.String)],returns:T.Boolean},impl:(e,t)=>{if(!e.environment.hostNode){let n=e.formatLocation();return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.unObserveFieldScoped: "${this.nodeSubtype}.${t.value}" no active host node: ${n}`),D.False}return this.removeObserver(t.value,e.environment.hostNode),D.True}});removeField=new Ch("removeField",{signature:{args:[new kh("fieldName",T.String)],returns:T.Boolean},impl:(e,t)=>(this.removeFieldEntry(t.getValue()),D.True)});removeFields=new Ch("removeFields",{signature:{args:[new kh("fieldNames",T.Object)],returns:T.Boolean},impl:(e,t)=>{if(!(t instanceof Kh))return D.False;const n=t.getElements();if(0===n.length)return D.False;let r=!1;for(const e of n)$S(e)&&(r||=this.removeFieldEntry(e.getValue()));return D.from(r)}});setField=new Ch("setField",{signature:{args:[new kh("fieldName",T.String),new kh("value",T.Dynamic)],returns:T.Boolean},impl:(e,t,n)=>{if(!this.getElements().some(e=>e.value===t.value.toLowerCase())){const n=e.formatLocation();return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.setField: Tried to set nonexistent field "${t.value}": ${n}`),D.False}if(!this.canAcceptValue(t.value,n)){const t=e.formatLocation();return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.setField: Type mismatch: ${t}`),D.False}return this.set(t,n),D.True}});setFields=new Ch("setFields",{signature:{args:[new kh("fields",T.Object)],returns:T.Boolean},impl:(e,t)=>t instanceof Fh?(this.setNodeFields(t,!0),D.True):D.False});update=new Ch("update",{signature:{args:[new kh("content",T.Object),new kh("createFields",T.Boolean,D.False)],returns:T.Uninitialized},impl:(e,t,n)=>(this.updateFields(e,t,n.toBoolean()),P.Instance)});signalBeacon=new Ch("signalBeacon",{signature:{args:[new kh("beacon",T.String)],returns:T.Int32},impl:(e,t)=>new vh(["AppLaunchComplete","AppDialogInitiate","AppDialogComplete","EPGLaunchInitiate","EPGLaunchComplete"].includes(t.value)?0:2)});getChildCount=new Ch("getChildCount",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.getNodeChildren().length)});appendChild=new Ch("appendChild",{signature:{args:[new kh("child",T.Dynamic)],returns:T.Boolean},impl:(e,t)=>D.from(this.appendChildToParent(t))});getChildren=new Ch("getChildren",{signature:{args:[new kh("num_children",T.Int32),new kh("index",T.Int32)],returns:T.Object},impl:(e,t,n)=>{const r=t.getValue(),i=n.getValue(),s=this.getNodeChildren();let a;return a=r<=-1&&0===i?new Kh(s.slice().map(e=>e instanceof O?e.box():e)):r<=0||i<0||i>=s.length?new Kh([]):new Kh(s.slice(i,i+r).map(e=>e instanceof O?e.box():e)),a}});removeChild=new Ch("removeChild",{signature:{args:[new kh("child",T.Dynamic)],returns:T.Boolean},impl:(e,t)=>D.from(this.removeChildByReference(t))});getParent=new Ch("getParent",{signature:{args:[],returns:T.Dynamic},impl:e=>this.getNodeParent()});createChild=new Ch("createChild",{signature:{args:[new kh("nodeType",T.String)],returns:T.Object},impl:(e,t)=>{const n=Oh(t,e);return n instanceof Wh&&this.appendChildToParent(n),n}});replaceChild=new Ch("replaceChild",{signature:{args:[new kh("newChild",T.Dynamic),new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>t instanceof Wh?D.from(this.replaceChildAtIndex(t,n)):D.False});removeChildren=new Ch("removeChildren",{signature:{args:[new kh("child_nodes",T.Dynamic)],returns:T.Boolean},impl:(e,t)=>{if(t instanceof Kh){const e=t.getElements();if(0!==e.length){for(const t of e)this.removeChildByReference(t);return D.True}}return D.False}});removeChildrenIndex=new Ch("removeChildrenIndex",{signature:{args:[new kh("num_children",T.Int32),new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>{const r=t.getValue(),i=n.getValue();return D.from(this.removeChildrenAtIndex(i,r))}});getChild=new Ch("getChild",{signature:{args:[new kh("index",T.Int32)],returns:T.Dynamic},impl:(e,t)=>{const n=t.getValue(),r=this.getNodeChildren();let i=O.Instance;return n>=0&&n<r.length&&(i=r[n]),i}});appendChildren=new Ch("appendChildren",{signature:{args:[new kh("child_nodes",T.Dynamic)],returns:T.Boolean},impl:(e,t)=>{if(t instanceof Kh){const e=t.getElements();if(0!==e.length){for(const t of e)t instanceof Wh&&(this.removeChildByReference(t),this.appendChildToParent(t));return D.True}}return D.False}});createChildren=new Ch("createChildren",{signature:{args:[new kh("num_children",T.Int32),new kh("subtype",T.String)],returns:T.Dynamic},impl:(e,t,n)=>{const r=t.getValue(),i=[];for(let t=0;t<r;t++){const t=Oh(n,e);t instanceof Wh&&(this.appendChildToParent(t),i.push(t))}return new Kh(i)}});replaceChildren=new Ch("replaceChildren",{signature:{args:[new kh("child_nodes",T.Dynamic),new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>{if(t instanceof Kh){let e=n.getValue();const r=t.getElements();if(0!==r.length){for(const t of r)t instanceof Wh&&!this.replaceChildAtIndex(t,new vh(e))&&this.removeChildByReference(t),e+=1;return D.True}}return D.False}});insertChildren=new Ch("insertChildren",{signature:{args:[new kh("child_nodes",T.Dynamic),new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>{if(t instanceof Kh){let e=n.getValue();const r=t.getElements();if(0!==r.length){for(const t of r)this.insertChildAtIndex(t,new vh(e)),e+=1;return D.True}}return D.False}});insertChild=new Ch("insertChild",{signature:{args:[new kh("child",T.Dynamic),new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>D.from(this.insertChildAtIndex(t,n))});removeChildIndex=new Ch("removeChildIndex",{signature:{args:[new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t)=>D.from(this.removeChildrenAtIndex(t.getValue(),1))});reparent=new Ch("reparent",{signature:{args:[new kh("newParent",T.Dynamic),new kh("adjustTransform",T.Boolean)],returns:T.Boolean},impl:(e,t,n)=>{if(t instanceof Wh&&t!==this){const e=this.getNodeParent();return e instanceof Wh&&e.removeChildByReference(this),t.appendChildToParent(this),D.True}return D.False}});boundingRect=new Ch("boundingRect",{signature:{args:[],returns:T.Dynamic},impl:e=>nx(this.getBoundingRect(e,"toParent"))});localBoundingRect=new Ch("localBoundingRect",{signature:{args:[],returns:T.Dynamic},impl:e=>nx(this.getBoundingRect(e,"local"))});sceneBoundingRect=new Ch("sceneBoundingRect",{signature:{args:[],returns:T.Dynamic},impl:e=>nx(this.getBoundingRect(e,"toScene"))});hasFocus=new Ch("hasFocus",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(eS.focused===this)});setFocus=new Ch("setFocus",{signature:{args:[new kh("on",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.from(this.setNodeFocus(e,t.toBoolean()))});isInFocusChain=new Ch("isInFocusChain",{signature:{args:[],returns:T.Boolean},impl:e=>eS.focused===this?D.True:D.from(this.isChildrenFocused())});findNode=new Ch("findNode",{signature:{args:[new kh("name",T.String)],returns:T.Dynamic},impl:(e,t)=>0===t.value.length?O.Instance:this.findNodeById(this.findRootNode(),t.value)});isSubtype=new Ch("isSubtype",{signature:{args:[new kh("nodeType",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(Hh(this.nodeSubtype,t.value))});parentSubtype=new Ch("parentSubtype",{signature:{args:[new kh("nodeType",T.String)],returns:T.Object},impl:(e,t)=>{const n=Gh.get(t.value.toLowerCase());return n?new M(n):O.Instance}});isSameNode=new Ch("isSameNode",{signature:{args:[new kh("roSGNode",T.Dynamic)],returns:T.Boolean},impl:(e,t)=>D.from(this.compareNodes(t))});subtype=new Ch("subtype",{signature:{args:[],returns:T.String},impl:e=>new M(this.nodeSubtype)});clone=new Ch("clone",{signature:{args:[new kh("isDeepCopy",T.Boolean)],returns:T.Object},impl:(e,t)=>this.cloneNode(t.toBoolean(),e)});getScene=new Ch("getScene",{signature:{args:[],returns:T.Object},impl:e=>eS.scene||O.Instance});getHttpAgent=new Ch("getHttpAgent",{signature:{args:[],returns:T.Object},impl:e=>this.httpAgent});setHttpAgent=new Ch("setHttpAgent",{signature:{args:[new kh("httpAgent",T.Object)],returns:T.Boolean},impl:(e,t)=>t instanceof mv?(this.httpAgent=t,this.registerHttpAgent(t),D.True):D.False})}class qh{component;name;constructor(e){this.component=e,this.name=e.getComponentName()}peek=new Ch("peek",{signature:{args:[],returns:T.Dynamic},impl:e=>{const t=this.component.getElements();return t[t.length-1]||O.Instance}});pop=new Ch("pop",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.remove(this.component.tail())||O.Instance});push=new Ch("push",{signature:{args:[new kh("talue",T.Dynamic)],returns:T.Void},impl:(e,t)=>{const n=this.component.getValue();return this.component.resizable||n.length<this.component.maxSize?this.component.add(t,!0):uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: ${this.name}.Push: set ignored for index out of bounds on non-resizable array: ${e.formatLocation()}`),O.Instance}});shift=new Ch("shift",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.remove(0)||O.Instance});unshift=new Ch("unshift",{signature:{args:[new kh("tvalue",T.Dynamic)],returns:T.Void},impl:(e,t)=>{const n=this.component.getValue();return this.component.resizable||n.length<this.component.maxSize?this.component.add(t,!1):uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: ${this.name}.Unshift: set ignored for index out of bounds on non-resizable array: ${e.formatLocation()}`),O.Instance}});delete=new Ch("delete",{signature:{args:[new kh("index",T.Int32)],returns:T.Boolean},impl:(e,t)=>t.lessThan(new vh(0)).toBoolean()?D.False:this.component.remove(t.getValue())?D.True:D.False});count=new Ch("count",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.getValue().length)});clear=new Ch("clear",{signature:{args:[],returns:T.Void},impl:e=>(this.component.clear(),O.Instance)});append=new Ch("append",{signature:{args:[new kh("array",T.Object)],returns:T.Void},impl:(e,t)=>{if(this.name!==t.getComponentName())return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: ${this.name}.Append: invalid parameter type ${t.getComponentName()}: ${e.formatLocation()}`),O.Instance;const n=this.component,r=n.getValue();if(n.resizable||r.length+t.getValue().length<=n.maxSize){const e=t.getValue().filter(e=>!!e&&(n.addChildRef&&n.addChildRef(e),!0));r.push(...e),this.component.updateNext(!0,0)}return O.Instance}})}class Xh{kind=T.Object;component;constructor(e){this.component=e}getEntry=new Ch("getEntry",{signature:{args:[new kh("index",T.Int32|T.Float)],returns:T.Dynamic},impl:(e,t)=>this.component.get(t)||O.Instance})}class Yh{kind=T.Object;component;constructor(e){this.component=e}setEntry=new Ch("setEntry",{signature:{args:[new kh("index",T.Int32|T.Float),new kh("tvalue",T.Dynamic)],returns:T.Void},impl:(e,t,n)=>this.component.set(t,n)})}class Kh extends L{kind=T.Object;resizable=!0;maxSize=0;elements;enumIndex;constructor(...e){if(super("roArray"),this.elements=[],1===e.length&&Array.isArray(e[0]))for(const t of e[0])this.addChildRef(t),this.elements.push(t);else{if(2!==e.length||!(e[0]instanceof vh||e[0]instanceof bh)||!(e[1]instanceof D||jS(e[1])))throw new Error('BRIGHTSCRIPT: ERROR: Runtime: "roArray": invalid number of parameters:');this.maxSize=e[0].getValue(),this.resizable=e[1].toBoolean()}this.enumIndex=this.elements.length?0:-1;const t=new qh(this),n=new Xh(this),r=new Yh(this),i=new Ah(this);this.registerMethods({ifArray:[t.peek,t.pop,t.push,t.shift,t.unshift,t.delete,t.count,t.clear,t.append],ifArrayGet:[n.getEntry],ifArraySet:[r.setEntry],ifArrayJoin:[this.join],ifArraySort:[this.sort,this.sortBy,this.reverse],ifArraySlice:[this.slice],ifArraySizeInfo:[this.capacity,this.isResizable,this.reserve,this.shrinkToFit],ifEnum:[i.isEmpty,i.isNext,i.next,i.reset]})}toString(e){return e?"<Component: roArray>":["<Component: roArray> =","[",...Array.from(this.elements,e=>void 0===e?"    invalid":`    ${e.toString(this)}`),"]"].join("\n")}equalTo(e){return D.False}getValue(){return this.elements}getElements(){return this.elements.slice()}add(e,t=!0){this.addChildRef(e),t?this.elements.push(e):this.elements.unshift(e),this.updateNext(!0)}remove(e){let t;return t=0===e?this.elements.shift():e===this.tail()?this.elements.pop():this.elements.splice(e,1)[0],this.updateNext(),this.removeChildRef(t),t}clear(){for(const e of this.elements)this.removeChildRef(e);this.elements.length=0,this.enumIndex=-1}tail(){return this.elements.length-1}deepCopy(){const e=[];for(const t of this.elements)XS(t)?(t instanceof Kh||t instanceof Fh||t instanceof Wh)&&e.push(t.deepCopy()):!se(t)||t instanceof Ch?!ae(t)||t instanceof Rh||e.push(t.copy()):e.push(t);return new Kh(e)}get(e){switch(JS(e)&&(e=e.unbox()),e.kind){case T.Float:return this.getElements()[Math.trunc(e.getValue())]??O.Instance;case T.Int32:return this.getElements()[e.getValue()]??O.Instance;case T.String:return this.getMethod(e.value)??O.Instance;default:return O.Instance}}set(e,t){if(JS(e)&&(e=e.unbox()),e.kind===T.Int32||e.kind===T.Float){const n=Math.trunc(e.getValue());this.addChildRef(t),this.removeChildRef(this.elements[n]),this.elements[n]=t}return O.Instance}hasNext(){return D.from(this.enumIndex>=0)}getNext(){const e=this.enumIndex;return e>=0&&(this.enumIndex++,this.enumIndex>=this.elements.length&&(this.enumIndex=-1)),this.elements[e]}resetNext(){this.enumIndex=this.elements.length>0?0:-1}updateNext(e,t){const n=this.elements.length>0;-1===this.enumIndex&&n?this.enumIndex=0:(this.enumIndex>=this.elements.length||!n)&&(this.enumIndex=-1),e&&this.updateCapacity(t??1.25)}updateCapacity(e=0){if(this.resizable&&e>0){if(this.elements.length>0&&this.elements.length>this.maxSize){let t=this.elements.length-1,n=Math.trunc(t*e);n-this.maxSize<10?this.maxSize=Math.trunc(10*(t/10+1)):this.maxSize=n}}else this.maxSize=Math.max(this.elements.length,this.maxSize)}aaCompare(e,t,n,r){let i=0;const s=[...this.elements],a=t.toString().indexOf("i")>-1,o=n.elements.has(e.toString().toLowerCase()),c=r.elements.has(e.toString().toLowerCase());return o&&c?i=Zh(s,n.get(e),r.get(e),a):o?i=-1:c&&(i=1),i}dispose(){for(const e of this.elements)this.removeChildRef(e)}addChildRef(e){e instanceof L?e.addReference():e&&se(e)&&(e.inArray=!0)}removeChildRef(e){e instanceof L&&e.removeReference()}join=new Ch("join",{signature:{args:[new kh("separator",T.String)],returns:T.String},impl:(e,t)=>this.elements.some(function(e){return!(e instanceof M)})?(uh.isDevMode&&uh.stderr.write("warning,roArray.Join: Array contains non-string value(s)."),new M("")):new M(this.elements.join(t.value))});sort=new Ch("sort",{signature:{args:[new kh("flags",T.String,new M(""))],returns:T.Void},impl:(e,t)=>{if(null!=t.toString().match(/([^ir])/g))uh.isDevMode&&uh.stderr.write("warning,roArray.Sort: Flags contains invalid option(s).");else{const e=t.toString().indexOf("i")>-1,n=[...this.elements];this.elements.sort((t,r)=>Zh(n,t,r,e)),t.toString().indexOf("r")>-1&&this.elements.reverse()}return O.Instance}});sortBy=new Ch("sortBy",{signature:{args:[new kh("fieldName",T.String),new kh("flags",T.String,new M(""))],returns:T.Void},impl:(e,t,n)=>{if(null!=n.toString().match(/([^ir])/g))uh.isDevMode&&uh.stderr.write("warning,roArray.SortBy: Flags contains invalid option(s).");else{const e=[...this.elements];this.elements.sort((r,i)=>{let s=0;return r instanceof Fh&&i instanceof Fh?s=this.aaCompare(t,n,r,i):void 0!==r&&void 0!==i&&(s=Zh(e,r,i,!1,!1)),s}),n.toString().indexOf("r")>-1&&this.elements.reverse()}return O.Instance}});reverse=new Ch("reverse",{signature:{args:[],returns:T.Void},impl:(e,t)=>(this.elements.reverse(),O.Instance)});slice=new Ch("slice",{signature:{args:[new kh("start",T.Int32|T.Float,new vh(0)),new kh("end",T.Int32|T.Float,O.Instance)],returns:T.Object},impl:(e,t,n)=>new Kh(n instanceof O?this.elements.slice(t.getValue()):this.elements.slice(t.getValue(),n.getValue()))});capacity=new Ch("capacity",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.maxSize)});isResizable=new Ch("isResizable",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.resizable)});reserve=new Ch("reserve",{signature:{args:[new kh("minSize",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.resizable&&t.getValue()>this.maxSize&&(this.maxSize=t.getValue()),D.from(this.resizable||t.getValue()<=this.maxSize))});shrinkToFit=new Ch("shrinkToFit",{signature:{args:[],returns:T.Boolean},impl:e=>(this.resizable&&(this.maxSize=this.elements.length),D.from(!0))})}function Jh(e){return jS(e)?0:$S(e)?1:e instanceof Fh?2:3}function Zh(e,t,n,r=!1,i=!0){let s=0;if(void 0!==t&&void 0!==n){const a=Jh(t),o=Jh(n);if(a<o)s=-1;else if(o<a)s=1;else if(i&&jS(t))s=t.greaterThan(n).toBoolean()?1:-1;else if(i&&$S(t)){let e=t.toString(),i=n.toString();r&&(e=e.toLowerCase(),i=i.toLowerCase()),s=e>i?1:-1}else{const r=e.indexOf(t),i=e.indexOf(n);r>-1&&i>-1&&(s=r-i)}}return s}class Qh{component;constructor(e){this.component=e}addHead=new Ch("addHead",{signature:{args:[new kh("tvalue",T.Dynamic)],returns:T.Void},impl:(e,t)=>(this.component.add(t,!1),O.Instance)});addTail=new Ch("addTail",{signature:{args:[new kh("tvalue",T.Dynamic)],returns:T.Void},impl:(e,t)=>(this.component.getValue().push(t),O.Instance)});getHead=new Ch("getHead",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.getValue()[0]||O.Instance});getTail=new Ch("getTail",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.getValue()[this.component.tail()]||O.Instance});removeHead=new Ch("removeHead",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.remove(0)||O.Instance});removeTail=new Ch("removeTail",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.remove(this.component.tail())||O.Instance});resetIndex=new Ch("resetIndex",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.component.resetCurrent())});getIndex=new Ch("getIndex",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.getCurrent()??O.Instance});removeIndex=new Ch("removeIndex",{signature:{args:[],returns:T.Dynamic},impl:e=>this.component.remove(this.component.listIndex)||O.Instance})}class ed{kind=T.Object;component;constructor(e){this.component=e}toArray=new Ch("toArray",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.component.getValue())})}class td extends L{kind=T.Object;resizable=!0;maxSize=0;elements;listIndex;enumIndex;constructor(e){if(super("roList"),this.elements=[],e)for(const t of e)this.addChildRef(t),this.elements.push(t);this.listIndex=-1,this.enumIndex=-1;const t=new Qh(this),n=new ed(this),r=new qh(this),i=new Xh(this),s=new Yh(this),a=new Ah(this);this.registerMethods({ifList:[t.addHead,t.addTail,t.getHead,t.getTail,t.removeHead,t.removeTail,t.resetIndex,t.getIndex,t.removeIndex],ifListToArray:[n.toArray],ifArray:[r.peek,r.pop,r.push,r.shift,r.unshift,r.delete,r.count,r.clear,r.append],ifArrayGet:[i.getEntry],ifArraySet:[s.setEntry],ifEnum:[a.isEmpty,a.isNext,a.next,a.reset]})}toString(e){return e?"<Component: roList>":["<Component: roList> =","(",...Array.from(this.elements,e=>void 0===e?"    invalid":`    ${e.toString(this)}`),")"].join("\n")}equalTo(e){return D.False}getValue(){return this.elements}getElements(){return this.elements.slice()}deepCopy(){return new Pv}get(e){switch(JS(e)&&(e=e.unbox()),e.kind){case T.Float:return this.getElements()[Math.trunc(e.getValue())]??O.Instance;case T.Int32:return this.getElements()[e.getValue()]??O.Instance;case T.String:return this.getMethod(e.value)??O.Instance;default:return O.Instance}}set(e,t){if(JS(e)&&(e=e.unbox()),e.kind===T.Int32||e.kind===T.Float){const n=Math.trunc(e.getValue());this.addChildRef(t),this.removeChildRef(this.elements[n]),this.elements[n]=t}return O.Instance}hasNext(){return D.from(this.enumIndex>=0)}getNext(){const e=this.enumIndex;return e>=0&&(this.enumIndex++,this.enumIndex>=this.elements.length&&(this.enumIndex=-1)),this.elements[e]}resetNext(){this.enumIndex=this.elements.length>0?0:-1}updateNext(){const e=this.elements.length>0;-1===this.enumIndex&&e?this.enumIndex=0:(this.enumIndex>=this.elements.length||!e)&&(this.enumIndex=-1)}add(e,t=!0){this.addChildRef(e),t?this.elements.push(e):(this.elements.unshift(e),this.listIndex>=0&&this.listIndex++,this.enumIndex>=0&&this.enumIndex++)}remove(e){let t;return t=0===e?this.elements.shift():e===this.tail()?this.elements.pop():this.elements.splice(e,1)[0],t&&this.listIndex>e&&this.listIndex--,this.listIndex>=this.elements.length&&(this.listIndex=-1),t&&this.enumIndex>e&&this.enumIndex--,this.enumIndex>=this.elements.length&&(this.enumIndex=-1),this.removeChildRef(t),t}clear(){for(const e of this.elements)this.removeChildRef(e);this.elements.length=0,this.listIndex=-1,this.enumIndex=-1}getCurrent(){const e=this.listIndex;return e>=0&&(this.listIndex++,this.listIndex>=this.elements.length&&(this.listIndex=-1)),this.elements[e]}resetCurrent(){return this.listIndex=this.elements.length>0?0:-1,0===this.listIndex}length(){return this.elements.length}tail(){return this.elements.length-1}dispose(){for(const e of this.elements)this.removeChildRef(e)}addChildRef(e){e instanceof L?e.addReference():e&&se(e)&&(e.inArray=!0)}removeChildRef(e){e instanceof L&&e.removeReference()}}const nd=Oi.Buffer.from&&Oi.Buffer.alloc&&Oi.Buffer.allocUnsafe&&Oi.Buffer.allocUnsafeSlow?Oi.Buffer.from:e=>new Oi.Buffer(e);function rd(e,t){const n=(e,n)=>t(e,n)>>>0;return n.signed=t,n.unsigned=n,n.model=e,n}rd("crc1",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=~~t,r=0;for(let t=0;t<e.length;t++)r+=e[t];return n+=r%256,n%256});let id=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];"undefined"!=typeof Int32Array&&(id=new Int32Array(id)),rd("crc-8",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=~~t;for(let t=0;t<e.length;t++){const r=e[t];n=255&id[255&(n^r)]}return n});let sd=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];"undefined"!=typeof Int32Array&&(sd=new Int32Array(sd)),rd("dallas-1-wire",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=~~t;for(let t=0;t<e.length;t++){const r=e[t];n=255&sd[255&(n^r)]}return n});let ad=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(ad=new Int32Array(ad)),rd("crc-16",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=~~t;for(let t=0;t<e.length;t++){const r=e[t];n=65535&(ad[255&(n^r)]^n>>8)}return n});let od=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];"undefined"!=typeof Int32Array&&(od=new Int32Array(od)),rd("ccitt",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=void 0!==t?~~t:65535;for(let t=0;t<e.length;t++){const r=e[t];n=65535&(od[255&(n>>8^r)]^n<<8)}return n});let cd=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(cd=new Int32Array(cd)),rd("crc-16-modbus",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=void 0!==t?~~t:65535;for(let t=0;t<e.length;t++){const r=e[t];n=65535&(cd[255&(n^r)]^n>>8)}return n}),rd("xmodem",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=void 0!==t?~~t:0;for(let t=0;t<e.length;t++){let r=n>>>8&255;r^=255&e[t],r^=r>>>4,n=n<<8&65535,n^=r,r=r<<5&65535,n^=r,r=r<<7&65535,n^=r}return n});let ld=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];"undefined"!=typeof Int32Array&&(ld=new Int32Array(ld)),rd("kermit",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=void 0!==t?~~t:0;for(let t=0;t<e.length;t++){const r=e[t];n=65535&(ld[255&(n^r)]^n>>8)}return n});let ud=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];"undefined"!=typeof Int32Array&&(ud=new Int32Array(ud)),rd("crc-24",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=void 0!==t?~~t:11994318;for(let t=0;t<e.length;t++){const r=e[t];n=16777215&(ud[255&(n>>16^r)]^n<<8)}return n});let hd=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(hd=new Int32Array(hd));const dd=rd("crc-32",function(e,t){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=0===t?0:~t;for(let t=0;t<e.length;t++){const r=e[t];n=hd[255&(n^r)]^n>>>8}return~n});let fd=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(fd=new Int32Array(fd)),rd("jam",function(e,t=-1){Oi.Buffer.isBuffer(e)||(e=nd(e));let n=0===t?0:~~t;for(let t=0;t<e.length;t++){const r=e[t];n=fd[255&(n^r)]^n>>>8}return n});var pd=__webpack_require__(1048).Buffer;class gd extends L{kind=T.Object;maxSize=0;resizable=!0;elements;enumIndex;constructor(e){super("roByteArray"),this.elements=e??new Uint8Array,this.enumIndex=this.elements.length?0:-1;const t=new Ah(this);this.registerMethods({ifByteArray:[this.readFile,this.writeFile,this.appendFile,this.setResize,this.fromHexString,this.toHexString,this.fromBase64String,this.toBase64String,this.fromAsciiString,this.toAsciiString,this.getSignedByte,this.getSignedLong,this.getCRC32,this.isLittleEndianCPU],ifArray:[this.peek,this.pop,this.push,this.shift,this.unshift,this.delete,this.count,this.clear,this.append],ifArrayGet:[this.getEntry],ifArraySet:[this.setEntry],ifArraySizeInfo:[this.capacity,this.isResizable],ifEnum:[t.isEmpty,t.isNext,t.next,t.reset]})}toString(e){return e?"<Component: roByteArray>":["<Component: roByteArray> =","[",...this.getElements().slice(0,100).map(e=>`    ${e.toString(this)}`),this.elements.length>100?"    ...\n]":"]"].join("\n")}equalTo(e){return D.False}getValue(){return this.elements}getElements(){const e=[];for(const t of this.elements.slice())e.push(new vh(t));return e}getByteArray(){return this.elements}deepCopy(){return new Pv}get(e){switch(JS(e)&&(e=e.unbox()),e.kind){case T.Float:return this.getElements()[Math.trunc(e.getValue())]??O.Instance;case T.Int32:return this.getElements()[e.getValue()]??O.Instance;case T.String:return this.getMethod(e.value)??O.Instance;default:return O.Instance}}set(e,t){if(JS(e)&&(e=e.unbox()),jS(e)&&t.kind===T.Int32){e.kind===T.Int64&&(e=new vh(e.getValue()));const n=Math.trunc(e.getValue());if(n>=this.elements.length){const e=new Uint8Array(n+1);e.set(this.elements),this.elements=e}this.elements[n]=t.getValue()}return O.Instance}hasNext(){return D.from(this.enumIndex>=0)}getNext(){return this.enumIndex>=0&&(this.enumIndex++,this.enumIndex>=this.elements.length&&(this.enumIndex=-1)),new vh(this.elements[this.enumIndex])}updateNext(){const e=this.elements.length>0;-1===this.enumIndex&&e?this.enumIndex=0:(this.enumIndex>=this.elements.length||!e)&&(this.enumIndex=-1)}resetNext(){this.enumIndex=this.elements.length>0?0:-1}updateCapacity(e=0){if(this.resizable&&e>0){if(this.elements.length>0&&this.elements.length>this.maxSize){let t=this.elements.length-1,n=Math.trunc(t*e);n-this.maxSize<16?this.maxSize=Math.trunc(16*(t/16+1)):this.maxSize=n}}else this.maxSize=Math.max(this.elements.length,this.maxSize)}isLittleEndian(){const e=new Uint32Array([287454020]);return 68===new Uint8Array(e.buffer)[0]}readFile=new Ch("readFile",{signature:{args:[new kh("path",T.String),new kh("index",T.Int32,new vh(0)),new kh("length",T.Int32,new vh(-1))],returns:T.Boolean},impl:(e,t,n,r)=>{try{const e=uh.fileSystem;if(e&&sh(t.value)){let i=e.readFileSync(t.value);if(n.getValue()>0||r.getValue()>0){let e=n.getValue(),t=r.getValue()<1?void 0:e+r.getValue();i=i.slice(e,t)}if(this.resizable||i.length<=this.maxSize)return this.elements=i,this.updateNext(),this.updateCapacity(),D.True}}catch(e){return D.False}return D.False}});writeFile=new Ch("writeFile",{signature:{args:[new kh("path",T.String),new kh("index",T.Int32,new vh(0)),new kh("length",T.Int32,new vh(-1))],returns:T.Boolean},impl:(e,t,n,r)=>{try{const e=uh.fileSystem;if(e&&ah(t.value)){if(n.getValue()>0||r.getValue()>0){let i=n.getValue(),s=r.getValue()<1?void 0:i+r.getValue();e.writeFileSync(t.value,pd.from(this.elements.slice(i,s)))}else e.writeFileSync(t.value,pd.from(this.elements));return D.True}}catch(e){return D.False}return D.False}});appendFile=new Ch("appendFile",{signature:{args:[new kh("path",T.String),new kh("index",T.Int32,new vh(0)),new kh("length",T.Int32,new vh(-1))],returns:T.Boolean},impl:(e,t,n,r)=>{try{const e=uh.fileSystem;if(e&&ah(t.value)){let i,s=e.readFileSync(t.value);if(n.getValue()>0||r.getValue()>0){let e=n.getValue(),t=r.getValue()<1?void 0:e+r.getValue(),a=this.elements.slice(e,t);i=new Uint8Array(s.length+a.length),i.set(s,0),i.set(a,s.length)}else i=new Uint8Array(s.length+this.elements.length),i.set(s,0),i.set(this.elements,s.length);return e.writeFileSync(t.value,pd.from(i)),D.True}}catch(e){return D.False}return D.False}});fromAsciiString=new Ch("fromAsciiString",{signature:{args:[new kh("asciiStr",T.String)],returns:T.Void},impl:(e,t)=>{const n=new Uint8Array(pd.from(t.value,"utf8"));return(this.resizable||n.length<=this.maxSize)&&(this.elements=n,this.updateNext(),this.updateCapacity()),O.Instance}});toAsciiString=new Ch("toAsciiString",{signature:{args:[],returns:T.String},impl:e=>new M(pd.from(this.elements).toString("utf8"))});fromHexString=new Ch("fromHexString",{signature:{args:[new kh("hexStr",T.String)],returns:T.Void},impl:(e,t)=>{const n=t.value.replace(/[^0-9A-Fa-f]/g,"0");return n.length%2==0&&(this.resizable||n.length/2<=this.maxSize)&&(this.elements=new Uint8Array(pd.from(n,"hex")),this.updateNext(),this.updateCapacity()),O.Instance}});toHexString=new Ch("toHexString",{signature:{args:[],returns:T.String},impl:e=>{const t=pd.from(this.elements).toString("hex");return new M(t.toUpperCase())}});fromBase64String=new Ch("fromBase64String",{signature:{args:[new kh("hexStr",T.String)],returns:T.Void},impl:(e,t)=>{const n=new Uint8Array(pd.from(t.value,"base64"));return(this.resizable||n.length<=this.maxSize)&&(this.elements=n,this.updateNext(),this.updateCapacity()),O.Instance}});toBase64String=new Ch("toBase64String",{signature:{args:[],returns:T.String},impl:e=>new M(pd.from(this.elements).toString("base64"))});getSignedByte=new Ch("getSignedByte",{signature:{args:[new kh("index",T.Int32|T.Float)],returns:T.Int32},impl:(e,t)=>{const n=Math.trunc(t.getValue());if(n<this.elements.length){let e=this.elements[n]<<24>>24;return new vh(e)}return new vh(0)}});getSignedLong=new Ch("getSignedLong",{signature:{args:[new kh("index",T.Int32|T.Float)],returns:T.Int32},impl:(e,t)=>{const n=4*Math.trunc(t.getValue());if(n<this.elements.length-3){const e=new DataView(this.elements.buffer,n,4).getInt32(0,this.isLittleEndian());return new vh(e)}return new vh(0)}});getCRC32=new Ch("getCRC32",{signature:{args:[new kh("index",T.Int32|T.Float,new vh(0)),new kh("length",T.Int32|T.Float,new vh(-1))],returns:T.Int32},impl:(e,t,n)=>{const r=Math.trunc(t.getValue()),i=Math.trunc(n.getValue());if(r>0||i>0){const e=i<1?void 0:r+i;return new vh(dd(pd.from(this.elements.slice(r,e))))}return new vh(dd(pd.from(this.elements)))}});setResize=new Ch("setResize",{signature:{args:[new kh("minSize",T.Int32|T.Float),new kh("autoResize",T.Boolean)],returns:T.Void},impl:(e,t,n)=>(this.maxSize=Math.max(Math.trunc(t.getValue()),this.elements.length),this.resizable=n.toBoolean(),O.Instance)});isLittleEndianCPU=new Ch("isLittleEndianCPU",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.isLittleEndian())});peek=new Ch("peek",{signature:{args:[],returns:T.Dynamic},impl:e=>{const t=this.elements[this.elements.length-1];return t?new vh(t):O.Instance}});pop=new Ch("pop",{signature:{args:[],returns:T.Dynamic},impl:e=>{if(0===this.elements.length)return O.Instance;const t=this.elements.length-1,n=this.elements[t];let r=new Uint8Array(t);return r.set(this.elements.slice(0,t),0),this.elements=r,n?new vh(n):O.Instance}});push=new Ch("push",{signature:{args:[new kh("byte",T.Dynamic)],returns:T.Void},impl:(e,t)=>{if(jS(t))if(this.resizable||this.elements.length<this.maxSize){let e=new Uint8Array(this.elements.length+1);e.set(this.elements,0),e[this.elements.length]=t.getValue(),this.elements=e,this.updateNext(),this.updateCapacity(1.5)}else uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roByteArray.Push: set ignored for index out of bounds on non-resizable array: ${e.formatLocation()}`);else uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roByteArray.Push: set ignored for non-numeric value: ${e.formatLocation()}`);return O.Instance}});shift=new Ch("shift",{signature:{args:[],returns:T.Dynamic},impl:e=>{if(0===this.elements.length)return O.Instance;const t=this.elements[0];let n=new Uint8Array(this.elements.length-1);return n.set(this.elements.slice(1)),this.elements=n,t?new vh(t):O.Instance}});unshift=new Ch("unshift",{signature:{args:[new kh("byte",T.Dynamic)],returns:T.Void},impl:(e,t)=>{if(jS(t))if(this.resizable||this.elements.length<this.maxSize){let e=new Uint8Array(this.elements.length+1);e[0]=t.getValue(),e.set(this.elements,1),this.elements=e,this.updateNext(),this.updateCapacity(1.25)}else uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roByteArray.Unshift: unshift ignored for full non-resizable array: ${e.formatLocation()}`);else uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roByteArray.Unshift: unshift ignored for non-numeric value: ${e.formatLocation()}`);return O.Instance}});delete=new Ch("delete",{signature:{args:[new kh("index",T.Int32|T.Float)],returns:T.Boolean},impl:(e,t)=>{const n=Math.trunc(t.getValue());if(n<0||n>=this.elements.length)return D.False;let r=new Uint8Array(this.elements.length-1);return r.set(this.elements.slice(0,n),0),r.set(this.elements.slice(n+1),n),this.elements=r,D.True}});count=new Ch("count",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.elements.length)});clear=new Ch("clear",{signature:{args:[],returns:T.Void},impl:e=>(this.elements=new Uint8Array,this.enumIndex=-1,O.Instance)});append=new Ch("append",{signature:{args:[new kh("array",T.Object)],returns:T.Void},impl:(e,t)=>t instanceof gd?((this.resizable||this.elements.length+t.elements.length<=this.maxSize)&&(this.elements=new Uint8Array([...this.elements,...t.elements]),this.updateNext(),this.updateCapacity()),O.Instance):(uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roByteArray.Append: invalid parameter type ${t.getComponentName()}: ${e.formatLocation()}`),O.Instance)});getEntry=new Ch("getEntry",{signature:{args:[new kh("index",T.Int32|T.Float)],returns:T.Dynamic},impl:(e,t)=>this.getElements()[Math.trunc(t.getValue())]||O.Instance});setEntry=new Ch("setEntry",{signature:{args:[new kh("index",T.Int32|T.Float),new kh("value",T.Dynamic)],returns:T.Void},impl:(e,t,n)=>(jS(n)||uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roByteArray.SetEntry: set ignored for non-numeric value: ${e.formatLocation()}`),this.set(t,n))});capacity=new Ch("capacity",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.maxSize)});isResizable=new Ch("isResizable",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.resizable)})}class md extends L{kind=T.Object;intrinsic=new M("");constructor(e){super("roString"),e&&(this.intrinsic=e),this.registerMethods({ifString:[this.setString,this.getString],ifStringOps:[this.arg,this.appendString,this.len,this.left,this.right,this.mid,this.instr,this.replace,this.trim,this.toInt,this.toFloat,this.tokenize,this.split,this.getEntityEncode,this.escape,this.unescape,this.encodeUri,this.decodeUri,this.encodeUriComponent,this.decodeUriComponent,this.startsWith,this.endsWith,this.isEmpty,this.format],ifToStr:[new dh(this).toStr]})}getValue(){return this.intrinsic.value}lessThan(e){return KS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return KS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return KS(e)?D.from(this.getValue()===e.getValue()):D.False}concat(e){return KS(e)?new M(this.intrinsic.value+e.getValue()):new M(this.intrinsic.value+e.toString())}unbox(){return this.intrinsic}copy(){return new md(this.intrinsic)}toString(e){return this.intrinsic.toString(e)}setString=new Ch("SetString",{signature:{args:[new kh("s",T.String)],returns:T.Void},impl:(e,t)=>(this.intrinsic=new M(t.value),O.Instance)},{signature:{args:[new kh("s",T.String),new kh("len",T.Int32)],returns:T.Void},impl:(e,t,n)=>{const r=n.getValue();return this.intrinsic=new M(r<=0?"":t.value.slice(0,r)),O.Instance}});getString=new Ch("GetString",{signature:{args:[],returns:T.String},impl:e=>this.intrinsic});arg=new Ch("Arg",{signature:{args:[new kh("arg1",T.String),new kh("arg2",T.String,O.Instance),new kh("arg3",T.String,O.Instance),new kh("arg4",T.String,O.Instance),new kh("arg5",T.String,O.Instance),new kh("arg6",T.String,O.Instance)],returns:T.String},impl:(e,...t)=>{let n=this.intrinsic.value,r=0;const i=Array.from(new Set(n.match(/%([1-9])/g))).sort();if(i)for(let e of i){if(!$S(t[r]))break;n=n.replaceAll(e,t[r].value),r++}return r<t.length&&t[r]instanceof M&&uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roString.Arg: unused parameters."),new M(n)}});appendString=new Ch("AppendString",{signature:{args:[new kh("s",T.String),new kh("len",T.Int32)],returns:T.Void},impl:(e,t,n)=>{const r=n.getValue();return r>0&&(this.intrinsic=this.intrinsic.concat(new M(t.value.slice(0,r)))),O.Instance}});len=new Ch("Len",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.intrinsic.value.length)});left=new Ch("Left",{signature:{args:[new kh("len",T.Int32)],returns:T.String},impl:(e,t)=>new M(this.intrinsic.value.slice(0,t.getValue()))});right=new Ch("Right",{signature:{args:[new kh("len",T.Int32)],returns:T.String},impl:(e,t)=>{const n=this.intrinsic.value,r=t.getValue();return new M(r<=0?"":n.slice(-r))}});mid=new Ch("Mid",{signature:{args:[new kh("start_index",T.Int32)],returns:T.String},impl:(e,t)=>new M(this.intrinsic.value.slice(t.getValue()))},{signature:{args:[new kh("start_index",T.Int32),new kh("num_chars",T.Int32)],returns:T.String},impl:(e,t,n)=>{let r=this.intrinsic.value,i=t.getValue()>0?t.getValue():0,s=n.getValue()>0?n.getValue():0;return new M(r.substring(i,i+s))}});instr=new Ch("Instr",{signature:{args:[new kh("substring",T.String)],returns:T.Int32},impl:(e,t)=>new vh(this.intrinsic.value.indexOf(t.value))},{signature:{args:[new kh("start_index",T.Int32),new kh("substring",T.String)],returns:T.Int32},impl:(e,t,n)=>""===n.value?new vh(t.getValue()<0?0:t.getValue()):new vh(this.intrinsic.value.indexOf(n.value,t.getValue()))});replace=new Ch("Replace",{signature:{args:[new kh("from",T.String),new kh("to",T.String)],returns:T.String},impl:(e,t,n)=>{if(""===t.value)return this.intrinsic;let r=t.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new M(this.intrinsic.value.replace(new RegExp(r,"g"),n.value))}});trim=new Ch("Trim",{signature:{args:[],returns:T.String},impl:e=>new M(this.intrinsic.value.trim())});toInt=new Ch("ToInt",{signature:{args:[],returns:T.Int32},impl:e=>{let t=Math.trunc(Number.parseFloat(this.intrinsic.value));return Number.isNaN(t)?new vh(0):new vh(t)}});toFloat=new Ch("ToFloat",{signature:{args:[],returns:T.Float},impl:e=>{let t=Number.parseFloat(this.intrinsic.value);return Number.isNaN(t)?new bh(0):new bh(t)}});tokenize=new Ch("Tokenize",{signature:{args:[new kh("delim",T.String)],returns:T.Object},impl:(e,t)=>{let n=this.intrinsic.value,r=[],i=[];for(let e of n)t.value.includes(e)?r.length>0&&(i.push(new M(r.join(""))),r=[]):r.push(e);return r.length>0&&i.push(new M(r.join(""))),new td(i)}});split=new Ch("Split",{signature:{args:[new kh("separator",T.String)],returns:T.Object},impl:(e,t)=>{let n;return n=""===t.value?Array.from(this.intrinsic.value):this.intrinsic.value.split(t.value),new Kh(n.map(e=>new M(e)))}});getEntityEncode=new Ch("GetEntityEncode",{signature:{args:[],returns:T.String},impl:e=>new M(this.intrinsic.value.replace(/(['"<>&])/g,"\\$1"))});escape=new Ch("Escape",{signature:{args:[],returns:T.String},impl:e=>new M(encodeURIComponent(this.intrinsic.value).replace(/[!'()*]/g,e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()))});unescape=new Ch("Unescape",{signature:{args:[],returns:T.String},impl:e=>new M(decodeURIComponent(this.intrinsic.value))});isEmpty=new Ch("isEmpty",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(0===this.intrinsic.value.length)});encodeUri=new Ch("EncodeUri",{signature:{args:[],returns:T.String},impl:e=>new M(encodeURI(this.intrinsic.value))});decodeUri=new Ch("DecodeUri",{signature:{args:[],returns:T.String},impl:e=>new M(decodeURI(this.intrinsic.value))});encodeUriComponent=new Ch("EncodeUriComponent",{signature:{args:[],returns:T.String},impl:e=>new M(encodeURIComponent(this.intrinsic.value))});decodeUriComponent=new Ch("DecodeUriCOmponent",{signature:{args:[],returns:T.String},impl:e=>new M(decodeURIComponent(this.intrinsic.value))});startsWith=new Ch("startsWith",{signature:{args:[new kh("matchString",T.String),new kh("position",T.Int32,O.Instance)],returns:T.Boolean},impl:(e,t,n)=>n instanceof O?D.from(this.intrinsic.value.startsWith(t.value)):D.from(this.intrinsic.value.startsWith(t.value,n.getValue()))});endsWith=new Ch("endsWith",{signature:{args:[new kh("matchString",T.String),new kh("position",T.Int32,O.Instance)],returns:T.Boolean},impl:(e,t,n)=>n instanceof O?D.from(this.intrinsic.value.endsWith(t.value)):D.from(this.intrinsic.value.endsWith(t.value,n.getValue()))});format=new Ch("format",{signature:{args:[new kh("arg",T.Dynamic,O.Instance)],variadic:!0,returns:T.String},impl:(e,...t)=>{let n=[];if(t.length>0)for(const e of t)jS(e)?n.push(e.getValue()):e instanceof M&&n.push(e.value);try{return new M((0,hh.sprintf)(this.intrinsic.value,...n))}catch(t){uh.isDevMode&&uh.stderr.write(`warning,roString.format() Error: ${t.message}`);const n=t.message?.includes("expecting number")?Z.TypeMismatch:Z.InvalidFormatSpecifier;throw new J(n,e.location,e.stack.slice(0,-1))}}})}class yd extends L{kind=T.Object;fullPath="";parsedPath;parsedUrl;valid=!1;constructor(e){super("roPath"),this.parsedUrl=this.setPath(e.value),this.registerMethods({ifPath:[this.change,this.isValid,this.split],ifString:[this.setString,this.getString]})}setPath(e){let t;return function(e){try{return new URL(e),!0}catch(e){return!1}}(e=e.replace(/[/\\]+/g,Le().posix.sep))?(t=new URL(e),this.fullPath=e,this.parsedPath=Le().parse(`${t.host}${t.pathname}`),this.valid=!0):(t=new URL("tmp:/blank"),this.fullPath="",this.valid=!1),t}getParentPart(){if("string"!=typeof this.parsedPath?.base)return this.fullPath;const e=this.fullPath.indexOf(this.parsedPath.base);return-1===e?this.fullPath:this.fullPath.slice(0,e)}toString(e){return this.fullPath}getValue(){return this.fullPath}lessThan(e){return KS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return KS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return KS(e)?D.from(this.getValue()===e.getValue()):D.False}concat(e){return KS(e)?new M(this.getValue()+e.getValue()):new M(this.getValue()+e.toString())}change=new Ch("change",{signature:{args:[new kh("newPath",T.String)],returns:T.Boolean},impl:(e,t)=>(this.setPath(t.value),D.from(this.valid))});isValid=new Ch("isValid",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.valid)});split=new Ch("split",{signature:{args:[],returns:T.Object},impl:e=>""===this.fullPath?new Fh([]):nx({basename:this.parsedPath.name,extension:this.parsedPath.ext,filename:this.parsedPath.base,parent:this.getParentPart(),phy:this.parsedUrl.protocol})});setString=new Ch("SetString",{signature:{args:[new kh("path",T.String)],returns:T.Void},impl:(e,t)=>(this.parsedUrl=this.setPath(t.value),O.Instance)});getString=new Ch("GetString",{signature:{args:[],returns:T.String},impl:e=>new M(this.fullPath)})}class bd extends L{kind=T.Object;intrinsic=D.False;getValue(){return this.intrinsic.toBoolean()}constructor(e){super("roBoolean"),e instanceof D&&(this.intrinsic=e),this.registerMethods({ifBoolean:[this.getBoolean,this.setBoolean],ifToStr:[new dh(this).toStr]})}unbox(){return this.intrinsic}copy(){return new bd(this.intrinsic)}equalTo(e){return e instanceof bd?D.from(e.getValue()===this.getValue()):jS(e)||e instanceof D?D.from(e.toBoolean()===this.intrinsic.toBoolean()):D.False}toString(e){return this.intrinsic.toString()}toBoolean(){return this.intrinsic.toBoolean()}fromBoolean(e){this.intrinsic=D.from(e)}getBoolean=new Ch("getBoolean",{signature:{args:[],returns:T.Boolean},impl:e=>this.intrinsic});setBoolean=new Ch("setBoolean",{signature:{args:[new kh("value",T.Boolean)],returns:T.Void},impl:(e,t)=>(this.intrinsic=t,O.Instance)})}function wd(e,t,n,r){try{const i=new XMLHttpRequest;if(i.open("GET",e,!1),i.responseType=t,n)for(const[e,t]of n)i.setRequestHeader(e,t);return void 0!==r&&(i.withCredentials=r),i.send(),200!==i.status?void(uh.isDevMode&&postMessage(`error,HTTP Error downloading ${e}: ${i.statusText} (${i.status})`)):i.response}catch(t){uh.isDevMode&&postMessage(`error,Error downloading ${e}: ${t.message}`)}}function vd(){const e="https://api.ipify.org";try{const t=new XMLHttpRequest;if(t.open("GET",e,!1),t.responseType="text",t.send(),200!==t.status){if(uh.isDevMode)throw new Error(`[getExternalIp] Error getting ${e}: status ${t.status} - ${t.statusText}`);return""}const n=t.responseText;return Ed(n)?n:""}catch(t){if(uh.isDevMode)throw new Error(`[getExternalIp] Error getting ${e}: ${t.message}`);return""}}const Sd=new Map;function xd(e){if(!Id(e))return null;if(Sd.has(e))return Sd.get(e);const t=["https://dns.google/resolve","https://cloudflare-dns.com/dns-query"],n=[];for(const r of t){const i=`${r}?name=${e}&type=A`,s=new XMLHttpRequest;s.open("GET",i,!1),s.setRequestHeader("Accept","application/dns-json");try{if(s.send(),200!==s.status)return null;const t=JSON.parse(s.responseText);if(t.Answer&&t.Answer.length>0){const n=t.Answer.find(e=>1===e.type);if(n&&Ed(n.data))return Sd.set(e,n.data),n.data}}catch(t){n.push(`[resolveHostToIP] Error resolving ${e} from ${r}: ${t.message}`)}}if(n.length>0&&uh.isDevMode)throw new Error(n.join("\n"));return null}function Ed(e){if(!e)return!1;const t=e.split(".");return 4===t.length&&t.every(e=>{const t=Number(e);return!Number.isNaN(t)&&t>=0&&t<=255})}function Id(e){if(e.length>253)return!1;const t=e.split("."),n=/^[a-zA-Z0-9-]{1,63}$/;for(const e of t){if(e.length>63||0===e.length)return!1;if(!n.test(e)||e.startsWith("-")||e.endsWith("-"))return!1}return!0}function kd(e){try{return new URL(e).host}catch(e){return""}}class Td extends L{kind=T.Object;id;responseCode;responseString;failureReason;headers;host;constructor(e,t,n,r,i,s){super("roUrlEvent"),this.id=e,this.responseCode=r,this.failureReason=i,this.responseString=n,this.headers=s,this.host=t,this.registerMethods({ifUrlEvent:[this.getResponseCode,this.getFailureReason,this.getSourceIdentity,this.getResponseHeaders,this.getResponseHeadersArray,this.getTargetIpAddress],ifString:[this.getString],ifInt:[this.getInt]})}getStatus(){return this.responseCode}getValue(){return this.responseString}toString(e){return this.responseString}lessThan(e){return KS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return KS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return KS(e)?D.from(this.getValue()===e.getValue()):D.False}concat(e){return KS(e)?new M(this.getValue()+e.getValue()):new M(this.getValue()+e.toString())}getInt=new Ch("getInt",{signature:{args:[],returns:T.Int32},impl:e=>new vh(1)});getResponseCode=new Ch("getResponseCode",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.responseCode)});getFailureReason=new Ch("getFailureReason",{signature:{args:[],returns:T.String},impl:e=>new M(this.failureReason)});getString=new Ch("getString",{signature:{args:[],returns:T.String},impl:e=>new M(this.responseString)});getSourceIdentity=new Ch("getSourceIdentity",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.id)});getResponseHeaders=new Ch("getResponseHeaders",{signature:{args:[],returns:T.Dynamic},impl:e=>{let t=new Fh([]);return this.headers.split("\n").map(e=>e.trim()).map((e,t)=>{let n=e.indexOf(":");return""===e||-1===n?["",""]:[e.slice(0,n),e.slice(n+1)]}).filter(([e,t])=>e&&t).map(([e,t])=>[e.trim(),t.trim()]).map(([e,n])=>{t.set(new M(e),new M(n))}),t}});getResponseHeadersArray=new Ch("getResponseHeadersArray",{signature:{args:[],returns:T.Object},impl:e=>{let t=new Array;return this.headers.split("\n").map(e=>e.trim()).map((e,t)=>{let n=e.indexOf(":");return""===e||-1===n?["",""]:[e.slice(0,n),e.slice(n+1)]}).filter(([e,t])=>e&&t).map(([e,t])=>[e.trim(),t.trim()]).map(([e,n])=>{let r=new Fh([]);r.set(new M(e),new M(n)),t.push(r)}),new Kh(t)}});getTargetIpAddress=new Ch("getTargetIpAddress",{signature:{args:[],returns:T.String},impl:e=>new M(xd(this.host)??"")})}class _d extends L{kind=T.Object;event;constructor(e){super("roUniversalControlEvent"),this.event=e,this.registerMethods({ifUniversalControlEvent:[this.getKey,this.getRemoteID,this.getID,this.isPress,this.getChar],ifInt:[this.getInt]})}toString(e){return this.event.key.toString()}getValue(){return this.event.key}lessThan(e){return e.kind===T.Int64?D.from(this.getValue()<e.getValue().toNumber()):YS(e)?D.from(this.getValue()<e.getValue()):D.False}greaterThan(e){return e.kind===T.Int64?D.from(this.getValue()>e.getValue().toNumber()):YS(e)?D.from(this.getValue()>e.getValue()):D.False}equalTo(e){return e.kind===T.Int64?D.from(this.getValue()===e.getValue().toNumber()):YS(e)?D.from(this.getValue()===e.getValue()):D.False}getInt=new Ch("getInt",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.event.key)});getKey=new Ch("getKey",{signature:{args:[],returns:T.Int32},impl:e=>{let t=this.event.key-this.event.mod;return t>=32&&(t=0),new vh(t)}});getID=new Ch("getID",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.event.key-this.event.mod)});getRemoteID=new Ch("getRemoteID",{signature:{args:[],returns:T.String},impl:e=>new M(this.event.remote)});getChar=new Ch("getChar",{signature:{args:[],returns:T.Int32},impl:e=>{let t=this.event.key-this.event.mod;return t<32&&(t=0),new vh(t)}});isPress=new Ch("isPress",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.event.mod<100)})}class Cd extends L{kind=T.Object;logType;data;constructor(e,t){super("roSystemLogEvent"),this.data=t,this.logType=e,this.registerMethods({ifroSystemLogEvent:[this.getInfo]})}toString(e){return"<Component: roSystemLogEvent>"}equalTo(e){return D.False}getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>{const t={logType:this.logType,DateTime:new up};return"bandwidth.minute"===this.logType&&"number"==typeof this.data?t.bandwidth=this.data:"http.connect"===this.logType&&(t.HttpCode=this.data.httpCode,t.Status=this.data.status,t.OrigUrl=this.data.url,t.Url=this.data.url,t.Method="GET",t.TargetIp=""),nx(t)}})}class Ad extends L{kind=T.Object;id;input;constructor(e){super("roInputEvent"),this.id=Math.floor(100*Math.random())+1,this.input=e,this.registerMethods({ifroInputEvent:[this.isInput,this.getInfo]})}toString(e){return"<Component: roInputEvent>"}equalTo(e){return D.False}isInput=new Ch("isInput",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(void 0!==this.input)});getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>this.input instanceof Fh?this.input:nx({type:"transport",id:new ph(this.id),command:"",direction:"",duration:""})})}class Fd extends L{kind=T.Object;flags;index;message;constructor(e,t){switch(super("roAudioPlayerEvent"),this.flags=e,this.index=t,this.flags){case ke.SELECTED:this.message="start of play";break;case ke.FULL:this.message="end of playlist";break;default:this.message=""}this.registerMethods({ifroAudioPlayerEvent:[this.getIndex,this.getMessage,this.getInfo,this.getData,this.isListItemSelected,this.isFullResult,this.isPartialResult,this.isRequestSucceeded,this.isRequestFailed,this.isPaused,this.isResumed,this.isStatusMessage,this.isTimedMetadata]})}toString(e){return"<Component: roAudioPlayerEvent>"}equalTo(e){return D.False}getIndex=new Ch("getIndex",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.index)});getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>O.Instance});getData=new Ch("getData",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0)});getMessage=new Ch("getMessage",{signature:{args:[],returns:T.String},impl:e=>new M(this.message)});isListItemSelected=new Ch("isListItemSelected",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.SELECTED)});isFullResult=new Ch("isFullResult",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.FULL)});isRequestSucceeded=new Ch("isRequestSucceeded",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.FINISHED)});isRequestFailed=new Ch("isRequestFailed",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.FAILED)});isPartialResult=new Ch("isPartialResult",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.PARTIAL)});isPaused=new Ch("isPaused",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.PAUSED)});isResumed=new Ch("isResumed",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.RESUMED)});isStatusMessage=new Ch("isStatusMessage",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(""!==this.message)});isTimedMetadata=new Ch("isTimedMetadata",{signature:{args:[],returns:T.Boolean},impl:e=>D.False})}class Rd extends L{kind=T.Object;flags;index;message;selected;constructor(e,t,n){switch(super("roVideoPlayerEvent"),this.flags=e,this.index=t,this.selected=n??0,this.flags){case ke.LOADING:this.message="startup progress";break;case ke.START_PLAY:this.message="start of play";break;case ke.FULL:this.message="end of playlist";break;default:this.message=""}this.registerMethods({ifroVideoPlayerEvent:[this.getIndex,this.getMessage,this.getInfo,this.isListItemSelected,this.isFullResult,this.isPartialResult,this.isRequestSucceeded,this.isRequestFailed,this.isPaused,this.isResumed,this.isStatusMessage,this.isTimedMetadata,this.isPlaybackPosition,this.isFormatDetected,this.isSegmentDownloadStarted,this.isStreamStarted,this.isCaptionModeChanged,this.isStreamSegmentInfo,this.isDownloadSegmentInfo]})}toString(e){return"<Component: roVideoPlayerEvent>"}equalTo(e){return D.False}getIndex=new Ch("getIndex",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.index)});getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>this.flags===ke.START_STREAM?nx({Url:"",StreamBitrate:0,MeasuredBitrate:0,IsUnderrun:!1}):this.flags===ke.POSITION?nx({ClipIdx:this.selected,ClipPos:1e3*this.index}):this.flags===ke.FAILED?nx({ClipIdx:this.selected,ignored:!0}):O.Instance});getMessage=new Ch("getMessage",{signature:{args:[],returns:T.String},impl:e=>new M(this.message)});isListItemSelected=new Ch("isListItemSelected",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.SELECTED)});isFullResult=new Ch("isFullResult",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.FULL)});isRequestSucceeded=new Ch("isRequestSucceeded",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.FINISHED)});isRequestFailed=new Ch("isRequestFailed",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.FAILED)});isPartialResult=new Ch("isPartialResult",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.PARTIAL)});isPaused=new Ch("isPaused",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.PAUSED)});isResumed=new Ch("isResumed",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.RESUMED)});isStatusMessage=new Ch("isStatusMessage",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(""!==this.message)});isTimedMetadata=new Ch("isTimedMetadata",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});isPlaybackPosition=new Ch("isPlaybackPosition",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.POSITION)});isFormatDetected=new Ch("isFormatDetected",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(!1)});isSegmentDownloadStarted=new Ch("isSegmentDownloadStarted",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(!1)});isStreamStarted=new Ch("isStreamStarted",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.flags===ke.START_STREAM)});isCaptionModeChanged=new Ch("isCaptionModeChanged",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});isStreamSegmentInfo=new Ch("isStreamSegmentInfo",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});isDownloadSegmentInfo=new Ch("isDownloadSegmentInfo",{signature:{args:[],returns:T.Boolean},impl:e=>D.False})}class Md extends L{kind=T.Object;id;state;uri;bmp;constructor(e,t){super("roTextureRequestEvent"),this.id=e.identity,this.state=e.state,this.uri=e.uri,this.bmp=t,this.registerMethods({ifTextureRequestEvent:[this.getId,this.getState,this.getURI,this.getBitmap]})}getValue(){return this.uri}toString(e){return"<Component: roTextureRequestEvent>"}equalTo(e){return D.False}getId=new Ch("getId",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.id)});getState=new Ch("getState",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.state)});getURI=new Ch("getURI",{signature:{args:[],returns:T.String},impl:e=>new M(this.uri)});getBitmap=new Ch("getBitmap",{signature:{args:[],returns:T.Object},impl:e=>this.bmp})}class Dd extends L{kind=T.Object;id;response;status;constructor(e,t,n){super("roChannelStoreEvent"),this.id=e,this.response=t,this.status=n,this.registerMethods({ifChannelStoreEvent:[this.isRequestSucceeded,this.isRequestFailed,this.getResponse,this.getStatus,this.getStatusMessage,this.isRequestInterrupted],ifSourceIdentity:[this.getSourceIdentity]})}toString(e){return"<Component: roChannelStoreEvent>"}equalTo(e){return D.False}isRequestSucceeded=new Ch("isRequestSucceeded",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(1===this.status.code)});isRequestFailed=new Ch("isRequestFailed",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.status.code<0)});isRequestInterrupted=new Ch("isRequestInterrupted",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(2===this.status.code)});getSourceIdentity=new Ch("getSourceIdentity",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.id)});getResponse=new Ch("getResponse",{signature:{args:[],returns:T.Object},impl:e=>this.response?new Kh(this.response):O.Instance});getStatus=new Ch("getStatus",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.status.code)});getStatusMessage=new Ch("getStatusMessage",{signature:{args:[],returns:T.String},impl:e=>new M(this.status.message)})}class Od extends L{kind=T.Object;data;isStatusMsg=!1;isCaptionModeMsg=!1;constructor(e){super("roDeviceInfoEvent"),this.data=e,"string"==typeof e.Mode?this.isCaptionModeMsg=!0:this.isStatusMsg=!0,this.registerMethods({ifroDeviceInfoEvent:[this.getInfo,this.isStatusMessage,this.isCaptionModeChanged]})}toString(e){return"<Component: roDeviceInfoEvent>"}equalTo(e){return D.False}isStatusMessage=new Ch("isStatusMessage",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.isStatusMsg)});isCaptionModeChanged=new Ch("isCaptionModeChanged",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.isCaptionModeMsg)});getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>nx(this.data)})}class Pd extends L{kind=T.Object;active;constructor(e){super("roCECStatusEvent"),this.active=e,this.registerMethods({ifroCECStatusEvent:[this.getInfo,this.getIndex,this.getMessage]})}toString(e){return"<Component: roCECStatusEvent>"}equalTo(e){return D.False}getIndex=new Ch("getIndex",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0)});getMessage=new Ch("getMessage",{signature:{args:[],returns:T.String},impl:e=>new M("CECStatus")});getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>{const t=this.active?"ACTIVE":"INACTIVE";return nx({Active:this.active,ActiveSourceState:t})}})}class Nd extends L{kind=T.Object;plugged;constructor(e){super("roHdmiStatusEvent"),this.plugged=e,this.registerMethods({ifroHdmiStatusEvent:[this.getInfo,this.getIndex,this.getMessage]})}toString(e){return"<Component: roHdmiStatusEvent>"}equalTo(e){return D.False}getIndex=new Ch("getIndex",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0)});getMessage=new Ch("getMessage",{signature:{args:[],returns:T.String},impl:e=>new M("HdmiHotPlug")});getInfo=new Ch("getInfo",{signature:{args:[],returns:T.Object},impl:e=>nx({ChannelId:"tvinput.hdmi1",Plugged:this.plugged,PortType:"Tx",PortNumber:1})})}class Ld extends L{node;fieldName;fieldValue;infoFields;kind=T.Object;constructor(e,t,n,r){super("roSGNodeEvent"),this.node=e,this.fieldName=t,this.fieldValue=n,this.infoFields=r,this.appendMethods([this.getData,this.getField,this.getRoSGNode,this.getNode,this.getInfo])}equalTo(e){return D.False}toString(){return"<Component: roSGNodeEvent>"}getData=new Ch("getdata",{signature:{args:[],returns:T.Dynamic},impl:e=>this.fieldValue});getField=new Ch("getfield",{signature:{args:[],returns:T.Dynamic},impl:e=>this.fieldName});getRoSGNode=new Ch("getrosgnode",{signature:{args:[],returns:T.Dynamic},impl:e=>this.node});getNode=new Ch("getnode",{signature:{args:[],returns:T.Dynamic},impl:e=>this.node.getFieldValue("id")});getInfo=new Ch("getinfo",{signature:{args:[],returns:T.Object},impl:e=>this.infoFields??new Fh([])})}class Bd extends L{closed;kind=T.Object;constructor(e){super("roSGScreenEvent"),this.closed=e,this.appendMethods([this.isScreenClosed])}equalTo(e){return D.False}toString(){return"<Component: roSGScreenEvent>"}isScreenClosed=new Ch("isScreenClosed",{signature:{args:[],returns:T.Dynamic},impl:e=>this.closed})}class Ud extends K{}class Vd extends Ud{constructor(e){super("`continue for` encountered",e)}}class jd extends Ud{constructor(e){super("`exit for` encountered",e)}}class zd extends Ud{constructor(e){super("`continue while` encountered",e)}}class Gd extends Ud{constructor(e){super("`exit while` encountered",e)}}class Hd extends Ud{location;label;constructor(e,t){super("`goto` encountered",e),this.location=e,this.label=t}}class $d extends Ud{location;value;constructor(e,t){super("`return` encountered",e),this.location=e,this.value=t}}class Wd{tokens;name;value;constructor(e,t,n){this.tokens=e,this.name=t,this.value=n}accept(e){return e.visitAssignment(this)}get location(){return{file:this.name.location.file,start:this.name.location.start,end:this.value.location.end}}}class qd{tokens;name;dimensions;constructor(e,t,n){this.tokens=e,this.name=t,this.dimensions=n}accept(e){return e.visitDim(this)}get location(){return{file:this.tokens.dim.location.file,start:this.tokens.dim.location.start,end:this.tokens.closingBrace.location.end}}}class Xd{statements;location;constructor(e,t){this.statements=e,this.location=t}accept(e){return e.visitBlock(this)}}class Yd{expression;constructor(e){this.expression=e}accept(e){return e.visitExpression(this)}get location(){return this.expression.location}}class Kd{tokens;constructor(e){this.tokens=e}accept(e){return e.visitContinueFor(this)}get location(){return this.tokens.continueFor.location}}class Jd{tokens;constructor(e){this.tokens=e}accept(e){return e.visitContinueWhile(this)}get location(){return this.tokens.continueWhile.location}}class Zd{tokens;constructor(e){this.tokens=e}accept(e){return e.visitExitFor(this)}get location(){return this.tokens.exitFor.location}}class Qd{tokens;constructor(e){this.tokens=e}accept(e){return e.visitExitWhile(this)}get location(){return this.tokens.exitWhile.location}}class ef{name;func;constructor(e,t){this.name=e,this.func=t}accept(e){return e.visitNamedFunction(this)}get location(){return{file:this.name.location.file,start:this.func.location.start,end:this.func.location.end}}}class tf{tokens;condition;thenBranch;elseIfs;elseBranch;constructor(e,t,n,r,i){this.tokens=e,this.condition=t,this.thenBranch=n,this.elseIfs=r,this.elseBranch=i}accept(e){return e.visitIf(this)}getEndLocation(){return this.tokens.endIf?this.tokens.endIf.location:this.elseBranch?this.elseBranch.location:this.elseIfs.length?this.elseIfs[this.elseIfs.length-1].thenBranch.location:this.thenBranch.location}get location(){return{file:this.tokens.if.location.file,start:this.tokens.if.location.start,end:this.getEndLocation().end}}}class nf{value;token;constructor(e,t){this.value=e,this.token=t}accept(e){return e.visitIncrement(this)}get location(){return{file:this.value.location.file,start:this.value.location.start,end:this.token.location.end}}}class rf{tokens;expressions;constructor(e,t){this.tokens=e,this.expressions=t}accept(e){return e.visitPrint(this)}get location(){let e=this.expressions.length?this.expressions[this.expressions.length-1].location.end:this.tokens.print.location.end;return{file:this.tokens.print.location.file,start:this.tokens.print.location.start,end:e}}}class sf{tokens;constructor(e){this.tokens=e}accept(e){return e.visitGoto(this)}get location(){return{file:this.tokens.goto.location.file,start:this.tokens.goto.location.start,end:this.tokens.label.location.end}}}class af{tokens;constructor(e){this.tokens=e}accept(e){return O.Instance}get location(){return{file:this.tokens.identifier.location.file,start:this.tokens.identifier.location.start,end:this.tokens.colon.location.end}}}class of{tokens;value;constructor(e,t){this.tokens=e,this.value=t}accept(e){return e.visitReturn(this)}get location(){return{file:this.tokens.return.location.file,start:this.tokens.return.location.start,end:this.value?.location.end??this.tokens.return.location.end}}}class cf{tokens;constructor(e){this.tokens=e}accept(e){throw new Ud("end-statement",this.tokens.end.location)}get location(){return{file:this.tokens.end.location.file,start:this.tokens.end.location.start,end:this.tokens.end.location.end}}}class lf{tokens;constructor(e){this.tokens=e}accept(e){return e.visitStop(this)}get location(){return{file:this.tokens.stop.location.file,start:this.tokens.stop.location.start,end:this.tokens.stop.location.end}}}class uf{tokens;counterDeclaration;finalValue;increment;body;constructor(e,t,n,r,i){this.tokens=e,this.counterDeclaration=t,this.finalValue=n,this.increment=r,this.body=i}accept(e){return e.visitFor(this)}get location(){return{file:this.tokens.for.location.file,start:this.tokens.for.location.start,end:this.tokens.endFor.location.end}}}class hf{tokens;item;target;body;constructor(e,t,n,r){this.tokens=e,this.item=t,this.target=n,this.body=r}accept(e){return e.visitForEach(this)}get location(){return{file:this.tokens.forEach.location.file,start:this.tokens.forEach.location.start,end:this.tokens.endFor.location.end}}}class df{tokens;condition;body;constructor(e,t,n){this.tokens=e,this.condition=t,this.body=n}accept(e){return e.visitWhile(this)}get location(){return{file:this.tokens.while.location.file,start:this.tokens.while.location.start,end:this.tokens.endWhile.location.end}}}class ff{obj;name;value;constructor(e,t,n){this.obj=e,this.name=t,this.value=n}accept(e){return e.visitDottedSet(this)}get location(){return{file:this.obj.location.file,start:this.obj.location.start,end:this.value.location.end}}}class pf{obj;indexes;value;closingSquare;constructor(e,t,n,r){this.obj=e,this.indexes=t,this.value=n,this.closingSquare=r}accept(e){return e.visitIndexedSet(this)}get location(){return{file:this.obj.location.file,start:this.obj.location.start,end:this.value.location.end}}}class gf{tokens;constructor(e){this.tokens=e}accept(e){return e.visitLibrary(this)}get location(){return{file:this.tokens.library.location.file,start:this.tokens.library.location.start,end:this.tokens.filePath?this.tokens.filePath.location.end:this.tokens.library.location.end}}}class mf{tryBlock;catchBlock;errorBinding;tokens;constructor(e,t,n,r){this.tryBlock=e,this.catchBlock=t,this.errorBinding=n,this.tokens=r}accept(e){return e.visitTryCatch(this)}get location(){return{file:this.tokens.try.location.file,start:this.tokens.endtry.location.start,end:this.tokens.endtry.location.end}}}class yf{tokens;value;constructor(e,t){this.tokens=e,this.value=t}accept(e){return e.visitThrow(this)}get location(){return{file:this.tokens.throw.location.file,start:this.tokens.throw.location.start,end:this.value?.location.end??this.tokens.throw.location.end}}}var bf,wf;!function(e){e.Interface="interface",e.Array="array",e.AssocArray="assocarray",e.Int32="integer",e.Int64="longinteger",e.Double="double",e.Float="float",e.Font="font",e.Node="node",e.Boolean="boolean",e.String="string",e.Function="function",e.Object="object",e.Color="color",e.Time="time",e.Rect2D="rect2d"}(bf||(bf={})),function(e){function t(t){switch(t.toLowerCase()){case"interface":return e.Interface;case"array":case"roarray":case"floatarray":case"intarray":case"timearray":case"vector2d":return e.Array;case"rect2d":return e.Rect2D;case"roassociativearray":case"assocarray":return e.AssocArray;case"font":return e.Font;case"node":return e.Node;case"bool":case"boolean":return e.Boolean;case"int":case"integer":return e.Int32;case"longint":case"longinteger":return e.Int64;case"float":return e.Float;case"double":return e.Double;case"uri":case"str":case"string":return e.String;case"function":return e.Function;case"object":return e.Object;case"color":return e.Color;case"time":return e.Time;default:return}}e.fromString=t,e.fromBrsType=function n(r){if(ae(r))return n(r.unbox());if(r.kind!==T.Object)return t(T.toString(r.kind));switch(r.getComponentName().toLowerCase()){case"roarray":return e.Array;case"roassociativearray":return e.AssocArray;case"rosgnode":return r instanceof fS?e.Font:e.Node;default:return}}}(bf||(bf={}));class vf{value;type;alwaysNotify;hidden;valueRef;permanentObservers=[];unscopedObservers=[];scopedObservers=new Map;constructor(e,t,n,r=!1,i=!1){this.value=e,this.type=t,this.alwaysNotify=n,this.hidden=r,this.valueRef=i,this.value=this.convertValue(e)}toString(e){return this.value.toString(e)}isHidden(){return this.hidden}setHidden(e){this.hidden=e}isAlwaysNotify(){return this.alwaysNotify}isValueRef(){return this.valueRef}getType(){return this.type}getValue(e=!0){return e&&(this.hidden=!1),this.value}setValue(e,t=!0,n=!1){this.hidden=!1,this.valueRef=n;const r=this.value;return n||(r instanceof Zv&&r.removeParentField(this),e instanceof Zv&&e.addParentField(this),e=this.convertValue(e)),this.value=e,!(!t||!this.alwaysNotify&&this.isEqual(r,e)||(this.notifyObservers(),0))}notifyObservers(){for(const e of this.permanentObservers)this.executeCallbacks(e);for(const e of this.unscopedObservers)this.executeCallbacks(e);for(const[e,t]of this.scopedObservers)for(const e of t)this.executeCallbacks(e)}canAcceptValue(e){if(A(this.type)===T.Object&&ux(e)||ZS(this.value)&&ZS(e)||$S(this.value)&&$S(e)||$S(this.value)&&ZS(e)||$S(this.value)&&WS(e)||WS(this.value)&&$S(e))return!0;if(this.type===bf.Rect2D&&e instanceof Kh)return 4===e.elements.length&&e.elements.every(e=>ZS(e));if(this.type===bf.Rect2D&&e instanceof Fh){const t=sx(e);return t&&"number"==typeof t.x&&"number"==typeof t.y&&"number"==typeof t.width&&"number"==typeof t.height}return this.type===bf.fromBrsType(e)}addObserver(e,t,n,r,i,s){this.hidden=!1;const a=t.environment.hostNode??r;let o={interpreter:t,environment:t.environment,hostNode:a,callable:n,eventParams:{node:r,fieldName:i,infoFields:s}};if("scoped"===e){let e=this.scopedObservers.get(a)||[];this.scopedObservers.set(a,[...e,o])}else"unscoped"===e?this.unscopedObservers.push(o):this.permanentObservers.push(o)}removeUnscopedObservers(){this.unscopedObservers.splice(0)}removeScopedObservers(e){this.scopedObservers.get(e)?.splice(0),this.scopedObservers.delete(e)}clearObservers(){this.permanentObservers.length=0,this.unscopedObservers.length=0,this.scopedObservers.clear()}isObserved(){return this.permanentObservers.length>0||this.unscopedObservers.length>0||this.scopedObservers.size>0}isPortObserved(e){return this.unscopedObservers.some(t=>t.callable instanceof pp&&t.hostNode instanceof Vf&&t.hostNode.id===e.id)||this.scopedObservers.get(e)?.some(e=>e.callable instanceof pp)||!1}convertValue(e){return ZS(e)&&e.kind!==A(this.type)?(JS(e)&&(e=e.unbox()),e=this.convertNumber(e)):WS(e)&&this.type===bf.String?e=new M(e.toBoolean()?"1":"0"):$S(e)&&this.type===bf.Boolean?e=D.from("true"===e.getValue().toLowerCase()):this.type===bf.Rect2D&&(e=this.convertRect2D(e)),se(e)&&(e=e.box()),e}convertNumber(e){let t=e;return this.type===bf.Float?t=new bh(e.getValue()):this.type===bf.Int32?t=new vh(e.getValue()):this.type===bf.Int64?t=new ph(e.getValue()):this.type===bf.Double?t=new mh(e.getValue()):this.type===bf.String&&(t=new M(e.toString())),t}convertRect2D(e){const t={x:0,y:0,width:0,height:0};if(e instanceof Kh){const n=cx(e);Array.isArray(n)&&4===n.length&&n.every(e=>"number"==typeof e)&&(t.x=n[0],t.y=n[1],t.width=n[2],t.height=n[3])}else if(e instanceof Fh){const n=sx(e);"number"==typeof n.x&&"number"==typeof n.y&&"number"==typeof n.width&&"number"==typeof n.height&&(t.x=n.x,t.y=n.y,t.width=n.width,t.height=n.height)}return nx(t)}isEqual(e,t){return ZS(e)&&ZS(t)||$S(e)&&$S(t)?e.getValue()===t.getValue():WS(e)&&WS(t)?e.toBoolean()===t.toBoolean():e instanceof Bf&&t instanceof Bf?e===t&&!t.changed:e.equalTo(t).toBoolean()}executeCallbacks(e){if(e.running)return;const{interpreter:t,callable:n,hostNode:r,environment:i,eventParams:s}=e;let a;if(s.infoFields){const e=new Map;if(s.infoFields.elements?.length)for(const t of s.infoFields.elements)if($S(t)){const n=t.getValue();e.set(n,r.getFieldValue(n))}a=nx(e)}let o=new Ld(s.node,s.fieldName,this.value,a);n instanceof pp?n.pushMessage(o):t.inSubEnv(t=>{e.running=!0,t.environment.hostNode=r,t.environment.setRootM(r.m);try{const e=n.getFirstSatisfiedSignature([o]);if(e){let{signature:n,impl:r}=e;t.environment.define(ne.Function,n.args[0].name.text,o),r(t,o)}else n.getFirstSatisfiedSignature([])?.impl(t)}catch(t){if(!(t instanceof Ud))throw e.running=!1,t}return e.running=!1,O.Instance},i)}}!function(e){e.LeftParen="LeftParen",e.RightParen="RightParen",e.LeftSquare="LeftSquare",e.RightSquare="RightSquare",e.LeftBrace="LeftBrace",e.RightBrace="RightBrace",e.Caret="Caret",e.Minus="Minus",e.Plus="Plus",e.Star="Star",e.Slash="Slash",e.Mod="Mod",e.Backslash="Backslash",e.PlusPlus="PlusPlus",e.MinusMinus="MinusMinus",e.LeftShift="LeftShift",e.RightShift="RightShift",e.MinusEqual="MinusEqual",e.PlusEqual="PlusEqual",e.StarEqual="StarEqual",e.SlashEqual="SlashEqual",e.BackslashEqual="BackslashEqual",e.LeftShiftEqual="LeftShiftEqual",e.RightShiftEqual="RightShiftEqual",e.Less="Less",e.LessEqual="LessEqual",e.Greater="Greater",e.GreaterEqual="GreaterEqual",e.Equal="Equal",e.LessGreater="LessGreater",e.Identifier="Identifier",e.String="String",e.Integer="Integer",e.Float="Float",e.Double="Double",e.LongInteger="LongInteger",e.Dot="Dot",e.Comma="Comma",e.Colon="Colon",e.Semicolon="Semicolon",e.AtSymbol="AtSymbol",e.HashIf="HashIf",e.HashElseIf="HashElseIf",e.HashElse="HashElse",e.HashEndIf="HashEndIf",e.HashConst="HashConst",e.HashError="HashError",e.HashErrorMessage="HashErrorMessage",e.And="And",e.Box="Box",e.Catch="Catch",e.CreateObject="CreateObject",e.ContinueFor="ContinueFor",e.ContinueWhile="ContinueWhile",e.Dim="Dim",e.Else="Else",e.ElseIf="ElseIf",e.End="End",e.EndFunction="EndFunction",e.EndFor="EndFor",e.EndIf="EndIf",e.EndSub="EndSub",e.EndTry="EndTry",e.EndWhile="EndWhile",e.Eval="Eval",e.Exit="Exit",e.ExitFor="ExitFor",e.ExitWhile="ExitWhile",e.False="False",e.For="For",e.ForEach="ForEach",e.Function="Function",e.GetGlobalAA="GetGlobalAA",e.GetLastRunCompileError="GetLastRunCompileError",e.GetLastRunRunTimeError="GetLastRunRunTimeError",e.Goto="Goto",e.If="If",e.Invalid="Invalid",e.Let="Let",e.Next="Next",e.Not="Not",e.ObjFun="ObjFun",e.Or="Or",e.Pos="Pos",e.Print="Print",e.Rem="Rem",e.Return="Return",e.Step="Step",e.Stop="Stop",e.Sub="Sub",e.Tab="Tab",e.Throw="Throw",e.To="To",e.True="True",e.Try="Try",e.Type="Type",e.While="While",e.Newline="Newline",e.Eof="Eof"}(wf||(wf={}));const Sf=new Set(["and","box","catch","continue","createobject","dim","each","else","elseif","endsub","endwhile","eval","exit","exitwhile","false","for","function","getglobalaa","getlastruncompileerror","getlastrunruntimeerror","goto","if","invalid","let","line_num","next","not","objfun","or","pos","print","rem","return","run","step","stop","sub","tab","then","throw","to","try","true","type","while"]),xf={and:wf.And,catch:wf.Catch,"continue for":wf.ContinueFor,"continue while":wf.ContinueWhile,dim:wf.Dim,else:wf.Else,elseif:wf.ElseIf,"else if":wf.ElseIf,end:wf.End,endfor:wf.EndFor,"end for":wf.EndFor,endfunction:wf.EndFunction,"end function":wf.EndFunction,endif:wf.EndIf,"end if":wf.EndIf,endsub:wf.EndSub,"end sub":wf.EndSub,endtry:wf.EndTry,"end try":wf.EndTry,endwhile:wf.EndWhile,"end while":wf.EndWhile,exit:wf.Exit,"exit for":wf.ExitFor,exitwhile:wf.ExitWhile,"exit while":wf.ExitWhile,false:wf.False,for:wf.For,"for each":wf.ForEach,function:wf.Function,goto:wf.Goto,if:wf.If,invalid:wf.Invalid,let:wf.Let,mod:wf.Mod,next:wf.Next,not:wf.Not,or:wf.Or,print:wf.Print,rem:wf.Rem,return:wf.Return,step:wf.Step,stop:wf.Stop,sub:wf.Sub,to:wf.To,try:wf.Try,throw:wf.Throw,true:wf.True,while:wf.While};var Ef;function If(e){return!!(e.kind&&e.text&&e.location)}!function(e){e.equalTo=function(e,t){return e.file===t.file&&e.start.line===t.start.line&&e.start.column===t.start.column&&e.end.line===t.end.line&&e.end.column===t.end.column}}(Ef||(Ef={}));const kf=new Set(["UpTime","Sleep","Wait","Tr","CopyFile","MoveFile","DeleteFile","DeleteDirectory","CreateDirectory","FormatDrive","ListDir","ReadAsciiFile","WriteAsciiFile","MatchFiles","RebootSystem","RunGarbageCollector","GetInterface","FindMemberFunction","FormatJson","ParseJson","Abs","Cdbl","Cint","Csng","Fix","Int","Sgn","Atn","Cos","Sin","Tan","Exp","Log","Sqr","Rnd","Ucase","Lcase","Asc","Chr","Left","Right","Instr","Len","Mid","Str","StrI","String","StringI","Substitute","Val","StrToI"]);function Tf(e){if(e.length>1)throw new Error(`Lexer#isDecimalDigit expects a single character; received '${e}'`);return e>="0"&&e<="9"}function _f(e){if(e.length>1)throw new Error(`Lexer#isHexDigit expects a single character; received '${e}'`);let t=e.toLowerCase();return Tf(t)||t>="a"&&t<="f"}function Cf(e){if(e.length>1)throw new Error(`Lexer#isAlpha expects a single character; received '${e}'`);let t=e.toLowerCase();return t>="a"&&t<="z"||"_"===t}function Af(e){if(e.length>1)throw new Error(`Lexer#isAlphaNumeric expects a single character; received '${e}'`);return Cf(e)||Tf(e)}class Ff{events=new v.EventEmitter;static scan(e,t=""){return(new Ff).scan(e,t)}onError(e){return this.events.on("err",e),{dispose:()=>{this.events.removeListener("err",e)}}}onErrorOnce(e){this.events.once("err",e)}scan(e,t){let n=0,r=0,i=1,s=0,a=e,o=[],c=[],l=[];const u=e=>{l.push(e),this.events.emit("err",e)};for(;!h();)n=r,d();return o.push({kind:wf.Eof,isReserved:!1,text:"\0",location:{start:{line:i,column:s},end:{line:i,column:s+1},file:t}}),{tokens:o,comments:c,errors:l};function h(){return r>=a.length}function d(){let e=f();if(Cf(e))!function(){for(;Af(p());)f();let e=a.slice(n,r),t=e.toLowerCase();if(!("continue"!==t&&"end"!==t&&"else"!==t&&"exit"!==t&&"for"!==t||" "!==p()&&"\t"!==p())){let e={position:r,column:s},t="";for(;" "===p()||"\t"===p();)t+=p(),f();for(;Af(p());)f();let i=a.slice(n,r).replace(t," ").toLowerCase();if(xf.hasOwnProperty(i))return void w(xf[i]);r=e.position,s=e.column}let i=p();["$","%","!","#","&"].includes(i)&&(e+=i,f());let c=e.toLowerCase(),l=xf.hasOwnProperty(c)?xf[c]:wf.Identifier;l===xf.rem?function(e){let t=o[o.length-1];return!(!t||t.kind!==e)}(wf.Dot)?w(wf.Identifier):y(e):w(l)}();else switch(e.toLowerCase()){case" ":case"\r":case"\t":break;case"\n":let t=b();t&&t.kind!==wf.Newline&&w(wf.Newline),i++,s=0;break;case".":Tf(p())?m(!0):w(wf.Dot);break;case"=":w(wf.Equal);break;case'"':!function(){for(;!h();){if('"'===p()){if('"'!==g())break;f()}if("\n"===g())return void u(new K("Unterminated string at end of line",v(a.slice(n,r))));f()}if(h())return void u(new K("Unterminated string at end of file",v(a.slice(n,r))));f();let e=a.slice(n+1,r-1).replace(/""/g,'"');w(wf.String,new M(e))}();break;case"'":y("'");break;case",":w(wf.Comma);break;case"(":w(wf.LeftParen);break;case")":w(wf.RightParen);break;case"{":w(wf.LeftBrace);break;case"}":w(wf.RightBrace);break;case"[":w(wf.LeftSquare);break;case"]":w(wf.RightSquare);break;case"@":w(wf.AtSymbol);break;case"+":switch(p()){case"=":f(),w(wf.PlusEqual);break;case"+":f(),w(wf.PlusPlus);break;default:w(wf.Plus)}break;case"-":switch(p()){case"=":f(),w(wf.MinusEqual);break;case"-":f(),w(wf.MinusMinus);break;default:w(wf.Minus)}break;case"*":"="===p()?(f(),w(wf.StarEqual)):w(wf.Star);break;case"/":"="===p()?(f(),w(wf.SlashEqual)):w(wf.Slash);break;case"^":w(wf.Caret);break;case"\\":"="===p()?(f(),w(wf.BackslashEqual)):w(wf.Backslash);break;case":":w(wf.Colon);break;case";":w(wf.Semicolon);break;case"?":switch(p()){case".":f(),w(wf.Dot);break;case"(":f(),w(wf.LeftParen);break;case"[":f(),w(wf.LeftSquare);break;case"@":f(),w(wf.AtSymbol);break;default:w(wf.Print)}break;case"<":switch(p()){case"=":f(),w(wf.LessEqual);break;case"<":f(),"="===p()?(f(),w(wf.LeftShiftEqual)):w(wf.LeftShift);break;case">":f(),w(wf.LessGreater);break;default:w(wf.Less)}break;case">":switch(p()){case"=":f(),w(wf.GreaterEqual);break;case">":f(),"="===p()?(f(),w(wf.RightShiftEqual)):w(wf.RightShift);break;default:w(wf.Greater)}break;case"#":!function(){for(f();Af(p());)f();let e=a.slice(n,r).toLowerCase();if(("#end"===e||"#else"===e)&&" "===p()){let e=r;for(f();Af(p());)f();switch(a.slice(n,r).toLowerCase().replace(/ {2,}/g," ")){case"#else if":return void w(wf.HashElseIf);case"#end if":return void w(wf.HashEndIf)}r=e}switch(e){case"#if":return void w(wf.HashIf);case"#else":return void w(wf.HashElse);case"#elseif":return void w(wf.HashElseIf);case"#endif":return void w(wf.HashEndIf);case"#const":return void w(wf.HashConst);case"#error":for(w(wf.HashError),n=r;!h()&&"\n"!==p();)f();return w(wf.HashErrorMessage),!h()&&"\n"===a.charAt(r)&&r++,void(n=r);default:u(new K(`Found unexpected conditional-compilation string '${e}'`,v(a.slice(n,r))))}}();break;default:Tf(e)?m(!1):"&"===e&&"h"===p().toLowerCase()?(f(),function(){for(;_f(p());)f();if("."===p()&&_f(g()))return f(),void u(new K("Fractional hex literals are not supported",v(a.slice(n,r))));if("&"===p()){f();let e=a.slice(n,r);w(wf.LongInteger,ph.fromString(e))}else{let e=a.slice(n,r);w(wf.Integer,vh.fromString(e))}}()):u(new K(`Unexpected character '${e}'`,v(e)))}}function f(){return r++,s++,a.charAt(r-1)}function p(){return h()?"\0":a.charAt(r)}function g(){return r+1>a.length?"\0":a.charAt(r+1)}function m(e){let t=e;for(;Tf(p());)f();if(!e&&"."===p()&&(t=!0,!Cf(g())))for(f();Tf(p());)f();let i=a.slice(n,r),s=t?i.length-1:i.length,o=p().toLowerCase();if("#"===o)return f(),void w(wf.Double,mh.fromString(i));if(s>=10&&"&"!==o&&"e"!==o&&"d"!==o)w(wf.Double,mh.fromString(i));else{if("d"===o||"e"===o&&s>=10){for(f(),"+"!==p()&&"-"!==p()||f();Tf(p());)f();return"#"===p()&&f(),i=a.slice(n,r).replace(/[dD]/,"e").replace(/#$/,""),void w(wf.Double,mh.fromString(i))}if("!"===o)return f(),i=a.slice(n,r),void w(wf.Float,bh.fromString(i));if("e"===o){for(f(),"+"!==p()&&"-"!==p()||f();Tf(p());)f();let e=p().toLowerCase();return"#"===e?(f(),i=a.slice(n,r).replace(/#$/,""),void w(wf.Double,mh.fromString(i))):("!"===e&&f(),i=a.slice(n,r).replace(/!$/,""),void w(wf.Float,bh.fromString(i)))}if(!t)return"&"===o?(i=a.slice(n,r),f(),void w(wf.LongInteger,ph.fromString(i))):("%"===o&&f(),void w(wf.Integer,vh.fromString(i)));w(wf.Float,bh.fromString(i))}}function y(e){const t=b()?.location.start.line===i?"Line":"Block";let s="";for(;"\n"!==p()&&!h();)s+=f();const a={type:t,starter:e,value:s,loc:v(e+s),range:[n,r]};let o=c[c.length-1];null!=o&&"Block"===o.type&&"Block"===a.type&&o.starter===a.starter&&o.loc.end.line===a.loc.start.line-1?(o.loc.end=a.loc.end,o.range[1]=a.range[1],o.value+=`\n${a.value}`):c.push(a)}function b(){return o[o.length-1]}function w(e,t){let i=a.slice(n,r),s=i.trimLeft()||i;o.push({kind:e,text:s,isReserved:Sf.has(s.toLowerCase()),literal:t,location:v(s)})}function v(e){return{start:{line:i,column:s-e.length},end:{line:i,column:Math.max(s-e.length+1,s)},file:t}}}}class Rf extends K{constructor(e,t){const n=Z.BadSyntax;let r=`${n.message} (compile error &h${Re(n.errno)}) ${t}`;e.kind===wf.Eof&&(r="(At end of file) "+t),super(r,e.location)}}const Mf=[wf.Equal,wf.MinusEqual,wf.PlusEqual,wf.StarEqual,wf.SlashEqual,wf.BackslashEqual,wf.LeftShiftEqual,wf.RightShiftEqual],Df=[wf.And,wf.Box,wf.Catch,wf.ContinueFor,wf.ContinueWhile,wf.CreateObject,wf.Dim,wf.Else,wf.ElseIf,wf.End,wf.EndFunction,wf.EndFor,wf.EndIf,wf.EndSub,wf.EndWhile,wf.Eval,wf.Exit,wf.ExitFor,wf.ExitWhile,wf.False,wf.For,wf.ForEach,wf.Function,wf.GetGlobalAA,wf.GetLastRunCompileError,wf.GetLastRunRunTimeError,wf.Goto,wf.If,wf.Invalid,wf.Let,wf.Mod,wf.Next,wf.Not,wf.ObjFun,wf.Or,wf.Pos,wf.Print,wf.Rem,wf.Return,wf.Step,wf.Stop,wf.Sub,wf.Tab,wf.To,wf.True,wf.Try,wf.Type,wf.While],Of=[wf.EndFor,wf.ExitFor,wf.ForEach,wf.Try,wf.Catch],Pf=new Set([wf.And,wf.Box,wf.CreateObject,wf.Dim,wf.Else,wf.ElseIf,wf.End,wf.EndFunction,wf.EndIf,wf.EndSub,wf.EndWhile,wf.Eval,wf.Exit,wf.ExitWhile,wf.False,wf.For,wf.Function,wf.GetGlobalAA,wf.GetLastRunCompileError,wf.GetLastRunRunTimeError,wf.Goto,wf.If,wf.Invalid,wf.Let,wf.Next,wf.Not,wf.ObjFun,wf.Or,wf.Pos,wf.Print,wf.Rem,wf.Return,wf.Step,wf.Sub,wf.Tab,wf.To,wf.True,wf.Type,wf.While].map(e=>wf[e].toLowerCase())),Nf=new Map;class Lf{events=new v.EventEmitter;stats=new Map;constructor(){Nf.set("v30/bslCore.brs",!1),Nf.set("v30/bslDefender.brs",!1),Nf.set("Roku_Ads.brs",!1),Nf.set("IMA3.brs",!1),Nf.set("Roku_Event_Dispatcher.brs",!1),Nf.set("RokuBrowser.brs",!1),this.stats.set(wf.Integer,new Set),this.stats.set(wf.String,new Set),this.stats.set(wf.Float,new Set),this.stats.set(wf.Double,new Set),this.stats.set(wf.LongInteger,new Set),this.stats.set(wf.Function,new Set),this.stats.set(wf.Identifier,new Set)}static parse(e){return(new Lf).parse(e)}onError(e){return this.events.on("err",e),{dispose:()=>{this.events.removeListener("err",e)}}}onErrorOnce(e){this.events.once("err",e)}parse(e){const t=this;let n=0,r=e,i=!1,s=0;function a(){return 0===s}let o=[],c=[];const l=(e,t)=>{let n=new Rf(e,t);return c.push(n),this.events.emit("err",n),n},u=(e,t)=>{l({location:e},t)};if(0===e.length)return{statements:[],errors:[],libraries:Nf};try{for(;!Q();){let e=h();e&&o.push(e)}return{statements:o,errors:c,libraries:Nf}}catch(e){return{statements:[],errors:c,libraries:Nf}}function h(...e){try{let t=[wf.Colon];if(e.includes(wf.Newline)){if(K(wf.Newline))return}else t.push(wf.Newline);for(;A(...t););if(e.includes(wf.Newline)&&K(wf.Newline))return;if(Q())return;try{return 0===s&&K(wf.Sub,wf.Function)?d(!1):g()?m():K(wf.Identifier,...Of)&&J(...Mf)?p(...e):function(...e){return g()?m():K(wf.Stop)?function(){let e={stop:P()};for(;A(wf.Newline,wf.Colon););return new lf(e)}():K(wf.Try)?function(){let e=P();i=!0;let t=y(wf.Catch);if(i=!1,!t)throw l(ee(),"Expected 'catch' to terminate try block");if(!K(wf.Identifier))throw l(ee(),"Expected variable name for caught error after 'catch'");let n=new Y(P()),r=y(wf.EndTry);if(!r)throw l(ee(),"Expected 'end try' or 'endtry' to terminate catch block");return new mf(t.body,r.body,n,{try:e,catch:t.closingToken,endtry:r.closingToken})}():K(wf.If)?function(){const e=P(),t=e.location,n=b();let i,s,a,o,u,h=[],d=[];function f(){return K(wf.Identifier)&&"then"===ee().text.toLowerCase()}if(f()&&(a=P()),K(wf.Newline)||K(wf.Colon)){let n=c.length,a=y(wf.EndIf,wf.Else,wf.ElseIf);if(!a)throw c.splice(n,c.length-n),l(e,"Expected 'end if', 'else if', or 'else' to terminate 'then' block");let p=a.closingToken;for(p.kind===wf.EndIf&&(o=p),i=a.body;p.kind===wf.ElseIf;){d.push(p);let e=b();f()&&P();let t=y(wf.EndIf,wf.Else,wf.ElseIf);if(!t)throw l(ee(),"Expected 'end if', 'else if', or 'else' to terminate 'then' block");p=t.closingToken,p.kind===wf.EndIf&&(o=p),h.push({condition:e,thenBranch:t.body})}if(p.kind===wf.Else){u=p;let t=y(wf.EndIf);if(!t)throw l(ee(),"Expected 'end if' to terminate 'else' block");if(s=t.body,o=t.closingToken,e.location.start.line===o.location.start.line){let e=r.indexOf(o);r[e-1].kind!==wf.Colon&&l(o,"Expected ':' to precede 'end if'")}A(wf.Newline)}else{if(!o)throw l(p,`Expected 'end if' to close 'if' statement started on line ${t.start.line}`);if(e.location.start.line===o.location.start.line){let e=r.indexOf(o);r[e-1].kind!==wf.Colon&&l(o,"Expected ':' to precede 'end if'")}A(wf.Newline)}}else{let e=y(wf.Newline,wf.Eof,wf.ElseIf,wf.Else);if(!e)throw l(ee(),"Expected a statement to follow 'if ...condition... then'");i=e.body;let t=e.closingToken;for(;t.kind===wf.ElseIf;){let n=e.closingToken;d.push(n);let r=b();f()&&P();let i=y(wf.Newline,wf.Eof,wf.ElseIf,wf.Else);if(!i)throw l(ee(),`Expected a statement to follow '${n.text} ...condition... then'`);t=i.closingToken,h.push({condition:r,thenBranch:i.body})}if(t.kind!==wf.Newline&&(t.kind===wf.Else||A(wf.Else))){u=t;let e=y(wf.Newline,wf.Eof);if(!e)throw l(ee(),"Expected a statement to follow 'else'");s=e.body}}return new tf({if:e,then:a,elseIfs:d,endIf:o,else:u},n,i,h,s)}():K(wf.Print)?function(...e){let t=P(),n=[];if(Q()||K(wf.Newline,wf.Colon)){let e=new $(new M(""),t.location);n.push(e)}else n.push(b());for(;!K(wf.Newline,wf.Colon,...e)&&!Q();)K(wf.Semicolon)&&n.push(P()),K(wf.Comma)&&n.push(P()),K(wf.Newline,wf.Colon)||Q()||n.push(b());return K(...e)||R("Expected newline or ':' after printed values",wf.Newline,wf.Colon,wf.Eof),new rf({print:t},n)}(...e):K(wf.While)?function(){const e=P(),t=b();N("Expected newline or ':' after 'while ...condition...'",wf.Newline,wf.Colon);const n=y(wf.EndWhile);if(!n)throw l(ee(),"Expected 'end while' to terminate while-loop block");return new df({while:e,endWhile:n.closingToken},t,n.body)}():K(wf.ContinueWhile)?function(){let e=P();return N("Expected newline after 'continue while'",wf.Newline),new Jd({continueWhile:e})}():K(wf.ExitWhile)?function(){let e=P();return N("Expected newline after 'exit while'",wf.Newline),new Qd({exitWhile:e})}():K(wf.For)?function(){const e=P(),t=p(wf.To),n=P(),r=b();let i,s;K(wf.Step)?(s=P(),i=b()):i=new $(new vh(1),ee().location),i instanceof $&&ne(wf.Integer,i.value);let a=y(wf.EndFor,wf.Next);if(!a)throw l(ee(),"Expected 'end for' or 'next' to terminate for-loop block");return new uf({for:e,to:n,step:s,endFor:a.closingToken},t,r,i,a.body)}():K(wf.ForEach)?function(){let e=P(),t=P(),n=ee();if(!K(wf.Identifier)||"in"!==n.text.toLowerCase())throw l(n,"Expected 'in' after 'for each <name>'");P();let r=b();if(!r)throw l(ee(),"Expected target object to iterate over");P();let i=y(wf.EndFor,wf.Next);if(!i)throw l(ee(),"Expected 'end for' or 'next' to terminate for-loop block");return new hf({forEach:e,in:n,endFor:i.closingToken},t,r,i.body)}():K(wf.ContinueFor)?function(){let e=P();return N("Expected newline after 'continue for'",wf.Newline),new Kd({continueFor:e})}():K(wf.ExitFor)?function(){let e=P();return N("Expected newline after 'exit for'",wf.Newline),new Zd({exitFor:e})}():K(wf.End)?function(){let e={end:P()};for(;A(wf.Newline,wf.Colon););return new cf(e)}():A(wf.Return)?function(){let e={return:te()};if(K(wf.Colon,wf.Newline,wf.Eof)){for(;A(wf.Colon,wf.Newline,wf.Eof););return new of(e)}let t=b();for(;A(wf.Newline,wf.Colon););return new of(e,t)}():A(wf.Throw)?function(){let e={throw:te()},t=b();for(;A(wf.Newline,wf.Colon););return new yf(e,t)}():K(wf.Dim)?function(){let e=P(),t=R("Expected variable name after 'dim'",wf.Identifier);A(wf.LeftSquare);let n=[b()];for(;!A(wf.RightSquare);)R("Expected ',' after expression in 'dim' statement",wf.Comma),n.push(b());let r=te();return new qd({dim:e,closingBrace:r},t,n)}():K(wf.Goto)?function(){let e={goto:P(),label:R("Expected valid label after goto keyword",wf.Identifier,wf.Integer)};for(;A(wf.Newline,wf.Colon););return new sf(e)}():(K(wf.Identifier)||K(wf.Integer))&&J(wf.Colon)?function(){let e={identifier:P(),colon:P()};return R("Labels must be declared on their own line",wf.Newline,wf.Eof),new af(e)}():function(...e){function t(){let t=ee();if(K(wf.PlusPlus,wf.MinusMinus)){let e=P();if(K(wf.PlusPlus,wf.MinusMinus))throw l(ee(),"Consecutive increment/decrement operators are not allowed");if(n instanceof U)throw l(t,"Increment/decrement operators are not allowed on the result of a function call");return new nf(n,e)}if(K(...e)||R("Expected newline or ':' after expression statement",wf.Newline,wf.Colon,wf.Eof),n instanceof U)return new Yd(n);throw l(t,"Expected statement or function call, but received an expression")}let n=_();if(!K(...Mf)||n instanceof U)return t();{let e=n,r=P(),i=b();return e instanceof G?(R("Expected newline or ':' after indexed 'set' statement",wf.Newline,wf.Else,wf.ElseIf,wf.Colon,wf.Eof),new pf(e.obj,e.indexes,r.kind===wf.Equal?i:new B(e,r,i),e.closingSquare)):e instanceof z?(R("Expected newline or ':' after dotted 'set' statement",wf.Newline,wf.Else,wf.ElseIf,wf.Colon,wf.Eof),new ff(e.obj,e.name,r.kind===wf.Equal?i:new B(e,r,i))):t()}}(...e)}(...e)}finally{for(;A(...t););}}catch(e){return void function(){for(P();!Q();){if(te().kind===wf.Newline||te().kind===wf.Colon)return;switch(ee().kind){case wf.Function:case wf.Sub:case wf.If:case wf.For:case wf.ForEach:case wf.While:case wf.Print:case wf.Return:return}P()}}()}}function d(e){try{s++;let n,r,i,a,o=ee(),c=K(wf.Sub),u=P();r=c?T.Void:T.Dynamic;let h="(anonymous)";if(e)i=R(`Expected '(' after ${u.text}`,wf.LeftParen);else{n=R(`Expected ${u.text} name after '${u.text}'`,wf.Identifier),i=R(`Expected '(' after ${u.text} name`,wf.LeftParen);let e=n.text[n.text.length-1];["$","%","!","#","&"].includes(e)&&l(n,`Function name '${n.text}' cannot end with type designator '${e}'`),h=n.text}let d=[];if(!K(wf.RightParen))do{if(d.length>=U.MaximumArguments)throw l(ee(),`Cannot have more than ${U.MaximumArguments} arguments`);d.push(f())}while(A(wf.Comma));a=P();let p=ee();if(K(wf.Identifier)&&"as"===p.text.toLowerCase()){P();let e=P(),t=e.text||"",n=T.fromString(t);if(!n)throw l(e,`Function return type '${t}' is invalid`);ne(wf.Integer,new vh(0)),r=n}d.reduce((e,t)=>{if(e&&!t.defaultValue)throw l({kind:wf.Identifier,text:t.name.text,isReserved:Sf.has(t.name.text),location:t.location},`Argument '${t.name.text}' has no default value, but comes after arguments with default values`);return e||!!t.defaultValue},!1),N(`Expected newline or ':' after ${u.text} signature`,wf.Newline,wf.Colon);let g=y(wf.EndSub,wf.EndFunction);if(!g)throw l(ee(),`Expected 'end ${u.text}' to terminate ${u.text} block`);let m=g.closingToken,b=c?wf.EndSub:wf.EndFunction;m.kind!==b&&l(m,`Expected 'end ${u.text}' to terminate ${u.text} block`);let w=new V(d,r,g.body,o,m);if(function(e){const n=t.stats.get(wf.Function);n&&n.add(`${e.toLowerCase()}(${n.size})`)}(h),e)return w;for(;A(wf.Newline););return new ef(n,w)}finally{s--}}function f(){if(!K(wf.Identifier))throw l(ee(),`Expected argument name, but received '${ee().text||""}'`);let e,t,n=P(),r=T.Dynamic;A(wf.Equal)&&(t=b());let i=ee();if(K(wf.Identifier)&&i.text&&"as"===i.text.toLowerCase()){P(),e=P();let t=T.fromString(e.text);if(!t)throw l(e,`Function parameter '${n.text}' is of invalid type '${e.text}'`);r=t}return{name:n,type:{kind:r,location:e?e.location:kh.InternalLocation},defaultValue:t,location:{file:n.location.file,start:n.location.start,end:e?e.location.end:n.location.end}}}function p(...e){let t=P();Pf.has(t.text.toLowerCase())&&l(t,`Cannot use reserved word "${t.text}" as an identifier`);let n=R(`Expected operator ('=', '+=', '-=', '*=', '/=', '\\=', '^=', '<<=', or '>>=') after identifier '${t.text}'`,...Mf),r=b();return K(...e)||R("Expected newline or ':' after assignment",wf.Newline,wf.Colon,wf.Eof,...e),n.kind===wf.Equal?new Wd({equals:n},t,r):new Wd({equals:n},t,new B(new Y(t),n,r))}function g(){let e=K(wf.Identifier)&&"library"===ee().text.toLowerCase();return!(!a()||!e)||!(!e||!J(wf.String))}function m(){let e=new gf({library:P(),filePath:K(wf.String)?P():void 0});!e.tokens.filePath&&K(wf.Newline,wf.Colon)?u(e.tokens.library.location,`Missing string literal after ${e.tokens.library.text} keyword`):e.tokens.filePath||ee().kind!==wf.Newline||u(ee().location,`Expected string literal after ${e.tokens.library.text} keyword`);let t=F(wf.Newline,wf.Eof,wf.Colon);if(t.length>0)for(let e of t)u(e.location,`Found unexpected token '${e.text}' after library statement`);let n=!0;for(let e of o)e instanceof gf||(n=!1);for(a()&&n||u(e.location,"Library statements may only appear at the top of a file");A(wf.Newline,wf.Eof,wf.Colon););let r=e.tokens.filePath;if(r){let t=r.text.slice(1,r.text.length-1);Nf.has(t)?Nf.set(t,!0):u(e.location,`Invalid library "${t}"! Supported: ${Array.from(Nf.keys()).join(", ")}`)}return e}function y(...e){let t,r=ee(),s=[wf.Colon];for(e.includes(wf.Newline)||s.push(wf.Newline);A(...s););const a=[];for(;!K(...e)&&!Q();){let r=n,o=h(...e);if(o?o instanceof af&&i?u(o.location,Z.TryContainsLabel.message):a.push(o):(n=r,F(wf.Colon,wf.Newline,wf.Eof),P()),L(...e)){for(t=te();A(...s););break}for(;A(...s););}if(Q()&&!e.includes(wf.Eof))return;if(K(...e)&&!t){t=P();const e=ee();"Next"===t.kind&&"Identifier"===e.kind&&P()}if(!t)return;const o={file:r.location.file,start:r.location.start,end:t.location.start};return{body:new Xd(a,o),closingToken:t}}function b(){return w()}function w(){return K(wf.Sub,wf.Function)?d(!0):function(){let e=v();for(;A(wf.And,wf.Or);){let t=te(),n=v();e=new B(e,t,n)}return e}()}function v(){let e=S();for(;A(wf.Equal,wf.LessGreater,wf.Greater,wf.GreaterEqual,wf.Less,wf.LessEqual);){let t=te(),n=S();e=new B(e,t,n)}return e}function S(){let e=x();for(;A(wf.LeftShift,wf.RightShift);){let t=te(),n=x();e=new B(e,t,n)}return e}function x(){let e=E();for(;A(wf.Plus,wf.Minus);){let t=te(),n=E();e=new B(e,t,n)}return e}function E(){let e=I();for(;A(wf.Slash,wf.Backslash,wf.Star,wf.Mod);){let t=te(),n=I();e=new B(e,t,n)}return e}function I(){let e=k();for(;A(wf.Caret);){let t=te(),n=k();e=new B(e,t,n)}return e}function k(){if(A(wf.Not)){let e=te(),t=v();return new X(e,t)}if(A(wf.Minus,wf.Plus)){let e=te(),t=k();return new X(e,t)}return _()}function _(){let e=function(){switch(!0){case A(wf.False):return new $(D.False,te().location);case A(wf.True):return new $(D.True,te().location);case A(wf.Invalid):return new $(O.Instance,te().location);case A(wf.Integer,wf.LongInteger,wf.Float,wf.Double,wf.String):return ne(wf[te().kind],te().literal),new $(te().literal,te().location);case A(wf.Identifier):return new Y(te());case A(wf.LeftParen):{let e=te(),t=b(),n=R("Unmatched '(' - expected ')' after expression",wf.RightParen);return new H({left:e,right:n},t)}case A(wf.LeftSquare):{let r=[],i=te();for(;A(wf.Newline););if(!A(wf.RightSquare)){for(r.push(b());A(wf.Comma,wf.Newline);){for(;A(wf.Newline););if(K(wf.RightSquare))break;r.push(b())}R("Unmatched '[' - expected ']' after array literal",wf.RightSquare)}let s=te();return ne(wf.Integer,new vh(10)),ne(wf.String,new M("roArray")),r.length&&re(""),new W(r,i,s)}case A(wf.LeftBrace):{let a=te(),o=[];function c(){let e;if(K(wf.Identifier,...Df))e=new M(P().text);else{if(!K(wf.String))throw l(ee(),`Expected identifier or string as associative array key, but received '${ee().text||""}'`);e=P().literal}return R("Expected ':' between associative array key and value",wf.Colon),e}for(;A(wf.Newline););if(!A(wf.RightBrace)){for(o.push({name:c(),value:b()});A(wf.Comma,wf.Newline,wf.Colon);){for(;A(wf.Newline,wf.Colon););if(K(wf.RightBrace))break;o.push({name:c(),value:b()})}if(R("Unmatched '{' - expected '}' after associative array literal",wf.RightBrace),o.length){re("");for(const h of o)re(h.name.value)}}let u=te();return new q(o,a,u)}case A(wf.Pos,wf.Tab):{let d=Object.assign(te(),{kind:wf.Identifier});return new Y(d)}case K(wf.Function,wf.Sub):return w();default:throw l(ee(),`Found unexpected token '${ee().text}'`)}}();function t(){const t="?["===te().text;let n=[];for(;A(wf.Newline););if(!A(wf.RightSquare))for(n.push(b());A(wf.Comma,wf.Newline);){for(;A(wf.Newline););if(K(wf.RightSquare))break;n.push(b())}if(0===n.length)throw l(ee(),"Expected expression inside brackets []");let r=R("Expected ']' after array or object index",wf.RightSquare);e=new G(e,n,r,t)}for(;;)if(A(wf.LeftParen))e=C(e);else if(A(wf.LeftSquare))t();else if(A(wf.AtSymbol)){const t="?@"===te().text;for(;A(wf.Newline););let n=R("Expected identifier name after '@'",wf.Identifier,...Df);n.kind=wf.Identifier,e=new j(e,n,t)}else{if(!A(wf.Dot))break;if(A(wf.LeftSquare))t();else{const t="?."===te().text;for(;A(wf.Newline););let n=R("Expected property name after '.'",wf.Identifier,...Df);n.kind=wf.Identifier,re(n.text),e=new z(e,n,t)}}return e}function C(e){const n="?("===te().text;let r=[];for(;A(wf.Newline););if(!K(wf.RightParen))do{for(;A(wf.Newline););if(r.length>=U.MaximumArguments)throw l(ee(),`Cannot have more than ${U.MaximumArguments} arguments`);r.push(b())}while(A(wf.Comma));for(;A(wf.Newline););const i=R("Expected ')' after function call arguments",wf.RightParen);if(e instanceof Y&&"createobject"===e.name.text.toLowerCase()&&1===r.length&&r[0]instanceof $){const e=r[0].value.toString(),n=t.stats.get(wf.String);n&&n.has(e)&&Array.from(n).pop()===e&&n.delete(e)}return new U(e,i,r,n)}function A(...e){for(let t of e)if(K(t))return P(),!0;return!1}function F(...e){let t=[];for(;!e.includes(ee().kind);)t.push(P());return t}function R(e,...t){if(t.map(e=>ee().kind===e).reduce((e,t)=>e||t,!1))return P();throw l(ee(),e)}function P(){return Q()||n++,te()}function N(e,...t){if(t.map(e=>ee().kind===e).reduce((e,t)=>e||t,!1))return ee();throw l(ee(),e)}function L(...e){if(0===n)return!1;{n--;const t=K(...e);return n++,t}}function K(...e){return!Q()&&e.some(e=>ee().kind===e)}function J(...e){return!Q()&&e.some(e=>(Q()?ee():r[n+1]).kind===e)}function Q(){return ee().kind===wf.Eof}function ee(){return r[n]}function te(){return r[n-1]}function ne(e,n){const r=t.stats.get(e);r&&n&&!r.has(n.toString())&&r.add(n.toString())}function re(e){const n=t.stats.get(wf.Identifier);n&&!n?.has(e.toLowerCase())&&n.add(e.toLowerCase())}}}class Bf extends Wh{nodeSubtype;fields;aliases;children;triedInitFocus=!1;notified=!1;parent;address;owner;changed=!1;rectLocal={x:0,y:0,width:0,height:0};rectToParent={x:0,y:0,width:0,height:0};rectToScene={x:0,y:0,width:0,height:0};defaultFields=[{name:"id",type:bf.String},{name:"focusedChild",type:bf.Node,alwaysNotify:!0},{name:"focusable",type:bf.Boolean},{name:"change",type:bf.AssocArray}];constructor(e=[],t="Node"){super([],t),this.nodeSubtype=t,this.setExtendsType(),this.address=Se(),this.fields=new Map,this.aliases=new Map,this.children=[],this.parent=O.Instance,this.owner=eS.taskId,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.setFieldValue("change",nx({Index1:0,Index2:0,Operation:"none"}))}toString(e){const t=`${this.getComponentName()}:${this.nodeSubtype}`;return e?`<Component: ${t}>`:[`<Component: ${t}> =`,"{",...Array.from(this.fields.entries()).reverse().map(([e,t])=>`    ${e}: ${t.toString(this)}`),"}"].join("\n")}hasNext(){throw new Error("Method not implemented.")}getNext(){throw new Error("Method not implemented.")}resetNext(){throw new Error("Method not implemented.")}updateNext(){throw new Error("Method not implemented.")}getElements(){return Array.from(this.fields.keys()).sort().map(e=>new M(e))}getValues(){return Array.from(this.fields.values()).sort().map(e=>e.getValue())}getNodeFields(){return this.fields}getNodeFieldsAsAA(){const e=[];for(const[t,n]of this.fields)n.isHidden()||e.push({name:new M(t),value:n.getValue()});return new Fh(e)}getNodeFieldTypes(){const e=[];for(const[t,n]of this.fields)n.isHidden()||e.push({name:new M(t),value:new M(n.getType())});return new Fh(e)}hasNodeField(e){return this.fields.has(e.toLowerCase())}canAcceptValue(e,t){const n=this.fields.get(e.toLowerCase());return!!n?.canAcceptValue(t)}clearNodeFields(){this.fields.clear()}getNodeChildren(){return this.children}get(e){if(!$S(e))throw new Error("Node indexes must be strings");const t=this.fields.get(e.getValue().toLowerCase());if(t){const e=t.getValue();return e instanceof Fh||e instanceof Kh?e.deepCopy():ae(e)?e.copy():e}return this.getMethod(e.getValue())||O.Instance}set(e,t,n,r){if(!$S(e))throw new Error("Node indexes must be strings");const i=e.getValue(),s=i.toLowerCase(),a=r??bf.fromBrsType(t),o=this.aliases.get(s);let c=this.fields.get(s);if(c&&c.getType()!==bf.String&&$S(t)&&(t=F(c.getType(),t.getValue())),c)if(o){const e=this.findNodeById(this,o.nodeId);e instanceof Bf?(e.set(new M(o.fieldName),t,n),this.changed=!0):uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.Set: "${i}": Alias "${o.nodeId}.${o.fieldName}" not found!`)}else c.canAcceptValue(t)?(this.notified=c.setValue(t,!0),this.fields.set(s,c),this.changed=!0):ux(t)||uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.AddReplace: "${i}": Type mismatch!`);else if(a&&void 0!==n)c=new vf(t,a,n),this.fields.set(s,c),this.notified=!0,this.changed=!0;else{let e="warning,Warning occurred while setting a field of an RoSGNode\n";e+=`-- Tried to set nonexistent field "${i}" of a "${this.nodeSubtype}" node`,uh.stderr.write(e)}return O.Instance}getId(){return this.getFieldValueJS("id")??this.nodeSubtype}cloneNode(e,t,n){if(n??=new WeakMap,n.has(this))return n.get(this);const r=Oh(new M(this.nodeSubtype));if(!(r instanceof Wh))return O.Instance;n.set(this,r);for(const[e,n]of this.fields){if(this.aliases.has(e)&&t){const n=Gh.get(this.nodeSubtype)??"Node";return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.Clone: No such field ${n}::${e}: ${t?.formatLocation()??""}`),O.Instance}let i=n.getValue(!1);i instanceof Wh&&(i=i.deepCopy());const s=new vf(i,n.getType(),n.isAlwaysNotify(),n.isHidden());r.fields.set(e,s)}if(e)for(const e of this.children){let i=O.Instance;e instanceof Wh&&(i=e.cloneNode(!0,t,n)),r.appendChildToParent(i)}return r}deepCopy(e){e??=new WeakMap;const t=Oh(new M(this.nodeSubtype));if(!(t instanceof Bf))return new Pv;t.address=this.address,e.set(this,t);for(const[n,r]of this.fields){let i=r,s=r.getValue(!1);s instanceof Bf&&(s=e.has(s)?e.get(s):s.deepCopy(e),i=new vf(s,r.getType(),r.isAlwaysNotify(),r.isHidden())),t.fields.set(n,i)}for(const n of this.children){let r=O.Instance;n instanceof Bf&&(r=e.has(n)?e.get(n):n.deepCopy(e)),t.appendChildToParent(r)}return t}moveObjectIntoField(e,t){const n=this.fields.get(e.toLowerCase());if(void 0===n)return{code:-1,msg:`Could not find field '"${e}"'`};if(n.getType()!==bf.AssocArray)return{code:-1,msg:"Field has wrong field type"};const r=[];for(const[e,n]of t.elements)n instanceof Kh||n instanceof Fh||n instanceof Wh?r.push({name:new M(e),value:n.deepCopy()}):!se(n)||n instanceof Ch?!ae(n)||n instanceof Rh||r.push({name:new M(e),value:n.copy()}):r.push({name:new M(e),value:n});const i=t.clearElements();return n.setValue(new Fh(r),!0),this.changed=!0,{code:i}}moveObjectFromField(e){const t=this.fields.get(e.toLowerCase());if(void 0===t)return`Could not find field '"${e}"'`;if(t.getType()!==bf.AssocArray)return"cannot moveFromField on non-assocarray fields";const n=t.getValue();return t.setValue(O.Instance,!0),this.changed=!0,n}addNodeField(e,t,n){let r=F(t),i=bf.fromString(t);r===P.Instance||this.fields.has(e.toLowerCase())||(this.set(new M(e),r,n,i),this.changed=!0)}addNodeFieldAlias(e,t,n,r){this.fields.set(e.toLowerCase(),t),this.aliases.set(e.toLowerCase(),{nodeId:n,fieldName:r})}appendNodeFields(e){if(e instanceof Fh)for(const[t,n]of e.elements)this.setFieldValue(t,n);else if(e instanceof Bf)for(const[t,n]of e.getNodeFields())this.fields.set(t,n),this.changed=!0}setNodeFields(e,t=!1){for(const[n,r]of e.elements){let e=new M(n);!t&&this.fields.has(n.toLowerCase())||(this.set(e,r,!1),this.changed=!0)}}setFieldValue(e,t,n=!1){const r=e.toLowerCase();let i=this.fields.get(r);if(i)i.setValue(t,!1);else{const e=bf.fromBrsType(t);e&&(i=new vf(t,e,n))}i&&(this.fields.set(r,i),this.changed=!0)}updateFields(e,t,n){t instanceof Fh?this.populateNodeFromAA(e,this,t,n,this.nodeSubtype):t instanceof Kh&&this.updateChildrenFromArray(e,this,t,n,this.nodeSubtype)}setFieldByRef(e,t){const n=this.fields.get(e.toLowerCase());return n?n.getType()===bf.AssocArray?(n.setValue(t,!1,!0),1):0:-1}canGetFieldByRef(e){const t=this.fields.get(e.toLowerCase());return!!t&&t.getType()===bf.AssocArray&&t.isValueRef()}getFieldByRef(e){const t=this.fields.get(e.toLowerCase());if(void 0===t)return`Could not find field '"${e}"'`;if(t.getType()===bf.AssocArray&&t.isValueRef()){const e=t.getValue();if(e instanceof Fh)return e}return""}getFieldValue(e){const t=this.fields.get(e.toLowerCase());return t?t.getValue():O.Instance}getFieldValueJS(e){const t=this.fields.get(e.toLowerCase());return t?cx(t.getValue()):void 0}getNodeParent(){return this.parent}setNodeParent(e){this.parent=e}removeParent(){this.parent=O.Instance}isChildrenFocused(){if(0===this.children.length)return!1;for(const e of this.children)if(e instanceof Bf&&(eS.focused===e||e.isChildrenFocused()))return!0;return!1}isFocusable(){return this.getFieldValueJS("focusable")??!1}renderNode(e,t,n,r,i){this.renderChildren(e,t,n,r,i)}renderChildren(e,t,n,r,i){for(const s of this.children)s instanceof Bf&&s.renderNode(e,t,n,r,i);this.changed=!1}getBoundingRect(e,t){switch(this.createPath(this)[0].renderNode(e,[0,0],0,1),t){case"local":return this.rectLocal;case"toScene":return this.rectToScene;default:return this.rectToParent}}addObserver(e,t,n,r,i){let s=D.False;const a=this.fields.get(n.value.toLowerCase());if(a instanceof vf){let o=O.Instance;if(e.environment.hostNode){if(r instanceof M)o=e.getCallableFunction(r.value);else if(r instanceof pp){const t=e.environment.hostNode;r.registerCallback(t.nodeSubtype,t.getNewEvents.bind(t)),o=r}}else{const t=e.formatLocation();uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGNode.ObserveField: "${this.nodeSubtype}.${n.value}" no active host node: ${t}`)}o instanceof O||(a.addObserver(t,e,o,this,n,i),s=D.True)}return s}removeObserver(e,t){const n=this.fields.get(e.toLowerCase());n instanceof vf&&(t instanceof Wh?n.removeScopedObservers(t):n.removeUnscopedObservers())}setNodeFocus(e,t){const n=new M("focusedchild");if(t){if(this.triedInitFocus){if(!this.isFocusable()&&this.isChildrenFocused())return!1}else{this.triedInitFocus=!0;const t=eS.nodeDefMap.get(this.nodeSubtype.toLowerCase());if(t?.initialFocus){const n=this.findNodeById(this,t.initialFocus);if(n instanceof Bf)return n.setNodeFocus(e,!0),this.isFocusable()}}eS.setFocused(this);let t=this.createPath(this);if(eS.focused instanceof Bf){let e=this.createPath(eS.focused),r=0;for(;r<t.length&&r<e.length&&e[r]===t[r];)r++;for(let t=r;t<e.length;t++)e[t].set(n,O.Instance,!1)}for(let e=0;e<t.length-1;e++)t[e].set(n,t[e+1],!1);this.set(n,this,!1)}else if(eS.focused===this){const e=eS.focused;eS.setFocused();let t=this.createPath(e);for(const e of t)e.set(n,O.Instance,!1)}else this.set(n,O.Instance,!1);return this.isFocusable()}findNodeById(e,t){if(e.getFieldValue("id").toString().toLowerCase()===t.toLowerCase())return e;for(const n of e.children){if(!(n instanceof Bf))continue;let e=this.findNodeById(n,t);if(e instanceof Bf)return e}return O.Instance}getBitmap(e){const t=this.getFieldValueJS(e);return this.loadBitmap(t)}loadBitmap(e){if(e.trim())return eS.scene?.subSearch&&eS.scene?.subReplace&&(e=e.replace(eS.scene.subSearch,eS.scene.subReplace)),xw().loadTexture(e,this.httpAgent.customHeaders)}getIconSize(e){let t=0,n=0;for(const r of e){const e=this.getBitmap(r);e&&(t=Math.max(t,e.width),n=Math.max(n,e.height))}return[t,n]}copyField(e,t,n){const r=this.getFieldValue(n??t);return e.set(new M(t),r),r}linkField(e,t,n){const r=e.fields.get(t.toLowerCase());return r&&this.fields.set((n??t).toLowerCase(),r),r}removeFieldEntry(e){const t=e.toLowerCase(),n=this.fields.get(t);if(!n)return!1;n.clearObservers();const r=this.fields.delete(t),i=this.aliases.delete(t),s=r||i;return this.changed||=s,s}updateChildrenFromArray(e,t,n,r,i){const s=n.getElements();for(const n of s)if(n instanceof Fh){const s=cx(n.get(new M("subtype")))??i,a=Oh(new M(s),e);a instanceof Wh&&(this.populateNodeFromAA(e,a,n,r,s),t.appendChildToParent(a))}else n instanceof Wh?t.appendChildToParent(n):uh.stderr.write(`warning,Warning calling update() on ${this.nodeSubtype} object expected to be convertible to Node is ${T.toString(n.kind)}`)}populateNodeFromAA(e,t,n,r,i){for(const[s,a]of n.getValue()){const n=s.toLowerCase();if("children"===n&&a instanceof Kh)this.updateChildrenFromArray(e,t,a,r,i),this.changed=!0;else{if("subtype"===n)continue;(t.fields.has(n)||r&&!ux(a))&&(t.set(new M(s),a,!1),this.changed=!0)}}}getNewEvents(e,t){return new Array}removeChildByReference(e){if(e instanceof Bf){let t=this.children.indexOf(e);return t>=0&&(e.removeParent(),this.children.splice(t,1)),this.changed=!0,!0}return!1}removeChildrenAtIndex(e,t){if(t>0&&e>=0&&e<this.children.length){const n=this.children.splice(e,t);for(const e of n.filter(e=>e instanceof Wh))e.removeParent();return this.changed=!0,!0}return!1}appendChildToParent(e){return e instanceof Bf&&(this.children.includes(e)||(this.children.push(e),e.setNodeParent(this),this.changed=!0),!0)}replaceChildAtIndex(e,t){let n=this.children.length,r=t.getValue();if(r<n){if(this.removeChildByReference(e),r>=0){if(r<this.children.length){const e=this.children[r];e instanceof Bf&&e.removeParent()}e.setNodeParent(this),this.children.splice(r,1,e)}return!0}return!1}insertChildAtIndex(e,t){if(e instanceof Bf){let n=this.children.length,r=t.getValue()<0?n:t.getValue();return this.removeChildByReference(e),e.setNodeParent(this),this.children.splice(r,0,e),!0}return!1}createPath(e,t=!0){let n=[e];for(;e.parent instanceof Bf;)n.push(e.parent),e=e.parent;return t?n.reverse():n}findRootNode(e){let t=e??this;for(;t.parent instanceof Bf;)t=t.parent;return t}callFunction(e,t,...n){let r=eS.nodeDefMap.get(this.nodeSubtype.toLowerCase());return r&&t.value in r.functions?e.inSubEnv(r=>{let i=r.getCallableFunction(t.value);if(!(i instanceof Ch))return uh.stderr.write(`Ignoring attempt to call non-implemented function ${t}`),O.Instance;r.environment.setM(this.m),r.environment.setRootM(this.m),r.environment.hostNode=this;try{let s=i.getFirstSatisfiedSignature(n);const a=s?n:[];if(s??=i.getFirstSatisfiedSignature([]),s){const n=i.getLocation()??e.location;e.addToStack({functionName:t.value,functionLocation:n,callLocation:n,signature:s.signature});const o=i.call(r,...a);return e.stack.pop(),o}return e.addError(Eh(i,n,e.stack.at(-1)?.functionLocation))}catch(e){if(!(e instanceof $d))throw e;return e.value||O.Instance}},r.environment):(uh.stderr.write(`Warning calling function in ${this.nodeSubtype}: no function interface specified for ${t}`),O.Instance)}setExtendsType(){let e,t,n=this.constructor;for(;n;){e=n.name.toLowerCase();const r=Object.getPrototypeOf(n);if(!r||r===Object||!r.name)break;if(n=r,t=r.name,"BrsComponent"===t)break;"RoSGNode"===t&&(t="Node"),Gh.has(e)||Gh.set(e,t)}}registerDefaultFields(e){for(const t of e){const e=F(t.type,t.value),n=bf.fromString(t.type);n&&this.fields.set(t.name.toLowerCase(),new vf(e,n,!!t.alwaysNotify,t.hidden))}}registerInitializedFields(e){for(const t of e){let e=bf.fromBrsType(t.value);e&&this.fields.set(t.name.value.toLowerCase(),new vf(t.value,e,!1))}}compareNodes(e){return this.nodeSubtype===e.nodeSubtype&&this.address===e.address}sendThreadUpdate(e,t,n,r,i=!1){const s={id:e,type:t,field:n,value:r instanceof Bf?lx(r,i):cx(r)};eS.inTaskThread()&&r instanceof Bf&&(r.changed=!1),postMessage(s)}getThreadInfo(){return nx({currentThread:eS.getCurrentThread(),node:{address:this.address,id:this.getId(),type:this.nodeSubtype,owningThread:eS.getThreadInfo(this.owner),willRendezvousFromCurrentThread:this.owner===eS.taskId?"No":"Yes"},renderThread:eS.getRenderThread()})}}class Uf extends Bf{name;constructor(e=[],t="Node"){super([],t),this.name=t,this.registerInitializedFields(e)}set(e,t,n=!1,r,i=!0){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const s=e.getValue().toLowerCase(),a=super.set(e,t,n,r);return i&&eS.tasks.length>0&&this.changed&&this.fields.has(s)&&(this.sendThreadUpdate(eS.taskId,"global",s,t),eS.inTaskThread()&&(this.changed=!1)),a}}class Vf extends Bf{name;defaultFields=[{name:"control",type:"string"},{name:"state",type:"string",value:"init"},{name:"functionName",type:"string"}];taskBuffer;id;active;started;thread;constructor(e=[],t="Task"){super([],t),this.name=t,this.id=-1,this.active=!1,this.started=!1,this.thread=!1,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}set(e,t,n=!1,r,i=!0){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const s=["init","run","stop","done"],a=e.getValue().toLowerCase(),o=this.fields.get(a);if(o&&"control"===a&&$S(t)){let e=t.getValue().toLowerCase();return s.includes(e)||(e=""),this.setControlField(o,e,i),O.Instance}if(o&&"state"===a&&$S(t))return s.includes(t.getValue().toLowerCase())&&o.setValue(t),O.Instance;const c=super.set(e,t,n,r);return this.id>=0&&o&&i&&this.changed&&(this.sendThreadUpdate(this.id,"task",a,t,!0),this.changed=!1),c}setControlField(e,t,n){const r=this.fields.get("state");if("run"===t)this.active=!0;else if("stop"===t||"done"===t){if(this.started){console.debug("Posting Task Data to STOP: ",this.nodeSubtype);const e={id:this.id,name:this.nodeSubtype,state:be.STOP};postMessage(e),this.started=!1}this.active=!1}e.setValue(new M(t)),r&&""!==t&&"init"!==t&&(r.setValue(new M(t)),this.fields.set("state",r),this.id>=0&&this.thread&&n&&this.sendThreadUpdate(this.id,"task","control",new M(t)))}setTaskBuffer(e){this.taskBuffer=new Pe,this.taskBuffer.setBuffer(e)}getNewEvents(e,t){if(this.taskBuffer&&this.thread){const e=0===t?void 0:t,n=this.taskBuffer.waitVersion(0,e);console.debug(`The thread ${this.id} was awaken with "${n}"`),this.updateTask()}return new Array}checkTask(){const e=this.getFieldValueJS("functionName");if(e&&""!==e.trim()){if(!this.started){this.taskBuffer=new Pe;const t={id:this.id,name:this.nodeSubtype,state:be.RUN,buffer:this.taskBuffer.getBuffer(),tmp:uh.getTmpVolume(),cacheFS:uh.getCacheFS(),m:sx(this.m),scene:eS.scene?lx(eS.scene,!1):void 0,render:eS.getRenderThread()?.id},n=this.m.elements.get("global");if(n instanceof Uf){const e=n.getNodeFields(),r=[];for(const[t,n]of e)!n.isHidden()&&n.isPortObserved(this)&&r.push(t);r.length&&t.m&&(t.m.global._observed_=r)}console.debug("Posting Task Data to RUN: ",this.nodeSubtype,e),postMessage(t),this.started=!0}}else this.set(new M("control"),new M("stop"))}updateTask(){const e=this.processUpdateFromOtherThread(),t=this.getFieldValueJS("state");if(!this.thread||"run"!==t)return e;for(const[e,t]of this.getNodeFields()){const n=t.getValue();!t.isHidden()&&n instanceof Bf&&n.changed&&this.sendThreadUpdate(this.id,"task",e,n)}return e}processUpdateFromOtherThread(){let e=this.taskBuffer?.getVersion()??-1;if(this.taskBuffer&&1===e){const e=this.taskBuffer.load(!0);if((t=e)&&"number"==typeof t.id&&"string"==typeof t.type&&"string"==typeof t.field&&void 0!==t.value){console.debug(`Received Update from ${this.thread?"Main thread":"Task Thread"}: `,e.id,e.type,e.field);const t=this.getNodeToUpdate(e.type);if(t){const n=new M(e.field),r=rx(e.value);return t.set(n,r,!1,void 0,!1),!0}}}var t;return!1}getNodeToUpdate(e){return"global"===e?eS.mGlobal:"scene"===e?eS.scene:this}}var jf=__webpack_require__(3464),zf=__webpack_require__.n(jf),Gf=__webpack_require__(7657),Hf=__webpack_require__.n(Gf),$f=__webpack_require__(1630),Wf=__webpack_require__.n($f);class qf extends L{kind=T.Object;markTime;constructor(e){super("roTimespan"),this.markTime=e||performance.now(),zf().extend(Hf()),zf().extend(Wf()),this.registerMethods({ifTimespan:[this.mark,this.totalMicroseconds,this.totalMilliseconds,this.totalSeconds,this.getSecondsToISO8601Date]})}resetTime(){this.markTime=performance.now()}toString(e){return"<Component: roTimespan>"}equalTo(e){return D.False}mark=new Ch("mark",{signature:{args:[],returns:T.Void},impl:e=>(this.resetTime(),O.Instance)});totalMicroseconds=new Ch("totalMicroseconds",{signature:{args:[],returns:T.Int32},impl:e=>new vh(Math.floor(1e3*(performance.now()-this.markTime)))});totalMilliseconds=new Ch("totalMilliseconds",{signature:{args:[],returns:T.Int32},impl:e=>new vh(Math.floor(performance.now()-this.markTime))});totalSeconds=new Ch("totalSeconds",{signature:{args:[],returns:T.Int32},impl:e=>new vh(Math.floor((performance.now()-this.markTime)/1e3))});getSecondsToISO8601Date=new Ch("getSecondsToISO8601Date",{signature:{args:[new kh("date",T.String)],returns:T.Int32},impl:(e,t)=>{let n=2077252342;const r=Date.now(),i=zf()(t.value,tx,!0).utc(!0);return i.isValid()&&(n=Math.round((i.toDate().valueOf()-r)/1e3)),new vh(n)}})}class Xf extends L{kind=T.Object;constructor(){super("roAppManager"),this.registerMethods({ifAppManager:[this.getUpTime,this.getScreensaverTimeout,this.setUserSignedIn,this.setAutomaticAudioGuideEnabled,this.setNowPlayingContentMetaData,this.showChannelStoreSpringboard,this.isAppInstalled,this.launchApp,this.updateLastKeyPressTime,this.startVoiceActionSelectionRequest,this.setVoiceActionStrings,this.getLastExitInfo,this.setTheme,this.setThemeAttribute,this.clearThemeAttribute,this.getRunParams,this.getAppList,this.setDisplayDisabled]})}toString(e){return"<Component: roAppManager>"}equalTo(e){return D.False}getUpTime=new Ch("getUpTime",{signature:{args:[],returns:T.Object},impl:e=>new qf(e.startTime)});getScreensaverTimeout=new Ch("getScreensaverTimeout",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0)});updateLastKeyPressTime=new Ch("updateLastKeyPressTime",{signature:{args:[],returns:T.Void},impl:e=>(uh.lastKeyTime=Date.now(),O.Instance)});setUserSignedIn=new Ch("setUserSignedIn",{signature:{args:[new kh("signedIn",T.Boolean)],returns:T.Void},impl:(e,t)=>O.Instance});setNowPlayingContentMetaData=new Ch("setNowPlayingContentMetaData",{signature:{args:[new kh("contentMetaData",T.Dynamic)],returns:T.Void},impl:(e,t)=>O.Instance});startVoiceActionSelectionRequest=new Ch("startVoiceActionSelectionRequest",{signature:{args:[],returns:T.Void},impl:e=>O.Instance});setVoiceActionStrings=new Ch("setVoiceActionStrings",{signature:{args:[new kh("actions",T.Object)],returns:T.Void},impl:(e,t)=>O.Instance});getLastExitInfo=new Ch("getLastExitInfo",{signature:{args:[],returns:T.Object},impl:e=>{const t=uh.deviceInfo.appList?.find(e=>e.running);return nx({exit_code:t?.exitReason??we.UNKNOWN,media_player_state:"stopped",mem_limit:null,timestamp:t?.exitTime?new Date(t.exitTime).toISOString():null})}});setTheme=new Ch("setTheme",{signature:{args:[new kh("attributeArray",T.Object)],returns:T.Void},impl:(e,t)=>O.Instance});setThemeAttribute=new Ch("setThemeAttribute",{signature:{args:[new kh("attributeName",T.String),new kh("attributeValue",T.String)],returns:T.Void},impl:(e,t,n)=>O.Instance});clearThemeAttribute=new Ch("clearThemeAttribute",{signature:{args:[new kh("attributeName",T.String)],returns:T.Void},impl:(e,t)=>O.Instance});isAppInstalled=new Ch("isAppInstalled",{signature:{args:[new kh("channelId",T.String),new kh("version",T.String)],returns:T.Boolean},impl:(e,t,n)=>{const r=uh.deviceInfo.appList;if(Array.isArray(r)){const e=r.find(e=>e.id===t.value);return D.from(void 0!==e&&Yf(e.version,n.value)>=0)}return D.False}});launchApp=new Ch("launchApp",{signature:{args:[new kh("channelId",T.String),new kh("version",T.String),new kh("params",T.Dynamic)],returns:T.Boolean},impl:(e,t,n,r)=>{const i=uh.deviceInfo.appList;if(Array.isArray(i)){const e=i.find(e=>e.id===t.value);if((s=e)&&"string"==typeof s.id&&"string"==typeof s.title&&"string"==typeof s.version&&("string"==typeof s.path||void 0===s.path)&&("string"==typeof s.icon||void 0===s.icon)&&("string"==typeof s.password||void 0===s.password)&&("string"==typeof s.exitReason||void 0===s.exitReason)&&("number"==typeof s.exitTime||void 0===s.exitTime)&&(s.params instanceof Map||void 0===s.params)&&("boolean"==typeof s.running||void 0===s.running)&&Yf(e.version,n.value)>=0){const t=new Map;for(const[e,n]of r.elements)t.set(e.toString(),n.toString());return t.set("source","other-channel"),e.params=t,postMessage(e),D.True}}var s;return D.False}});showChannelStoreSpringboard=new Ch("showChannelStoreSpringboard",{signature:{args:[new kh("channelId",T.String)],returns:T.Boolean},impl:(e,t)=>D.False});getRunParams=new Ch("getRunParams",{signature:{args:[],returns:T.Object},impl:e=>e.runParams||new Fh([])});getAppList=new Ch("getAppList",{signature:{args:[new kh("extended",T.Boolean,D.False)],returns:T.Dynamic},impl:(e,t)=>{const n=new Kh([]),r=uh.deviceInfo.appList;if(Array.isArray(r)){if(t.toBoolean())return rx(r);for(const e of r){const t={id:e.id,title:e.title,version:e.version};n.elements.push(nx(t))}}return n}});setAutomaticAudioGuideEnabled=new Ch("setAutomaticAudioGuideEnabled",{signature:{args:[new kh("enabled",T.Boolean)],returns:T.Void},impl:(e,t)=>O.Instance});setDisplayDisabled=new Ch("setDisplayDisabled",{signature:{args:[new kh("disabled",T.Boolean)],returns:T.Void},impl:(e,t)=>(uh.displayEnabled=!t.toBoolean(),postMessage({displayEnabled:!t.toBoolean()}),P.Instance)})}function Yf(e,t){const n=function(e){let t=e.split(".");t=t.slice(0,3);const n=t.map(e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?0:t});for(;n.length<3;)n.push(0);return n.join(".")}(e).split("."),r=""===t.trim()?["0"]:t.split(".");for(let e=0;e<3;e++){const t=Number(n[e]),i=r[e]&&""!==r[e].trim()?Number(r[e]):0;if(t<i||Number.isNaN(i))return-1;if(t>i)return 1}return 0}var Kf=__webpack_require__(328),Jf=__webpack_require__(1048).Buffer;class Zf extends L{kind=T.Object;cipher;cipherEncrypt;cipherFormat;cipherKey;cipherIV;cipherPadding;constructor(){super("roEVPCipher"),this.cipher=null,this.cipherEncrypt=!1,this.cipherFormat="",this.cipherKey="",this.cipherIV="",this.cipherPadding=!1,this.registerMethods({ifEVPCipher:[this.setup,this.update,this.reinit,this.process,this.final]})}toString(e){return"<Component: roEVPCipher>"}equalTo(e){return D.False}setupCipher(e,t,n,r,i,s){try{return this.cipherEncrypt=t,this.cipherFormat=n,this.cipherKey=r,this.cipherIV=i,this.cipherPadding=s,this.cipher=t?Kf.Tt(n,Jf.from(r,"hex"),Jf.from(i,"hex")):Kf._7(n,Jf.from(r,"hex"),Jf.from(i,"hex")),this.cipher&&this.cipher.setAutoPadding(s),0}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,[roEVPCipher] Setup error: ${e.message}`),this.cipher=null,this.cipherFormat="",this.cipherKey="",this.cipherIV="",-1}}updateData(e){if(this.cipher)try{return this.cipher.update(Jf.from(e))}catch(e){return Jf.from("")}return Jf.from("")}finalResult(e){if(this.cipher)try{let e=this.cipher.final();return this.cipher=null,e}catch(e){return uh.isDevMode&&uh.stderr.write(`error,[roEVPCipher] Error: ${e.message}`),this.cipher=null,null}return Jf.from("")}setup=new Ch("setup",{signature:{args:[new kh("encrypt",T.Boolean),new kh("format",T.String),new kh("key",T.String),new kh("iv",T.String),new kh("padding",T.Int32)],returns:T.Int32},impl:(e,t,n,r,i,s)=>new vh(this.setupCipher(e,t.toBoolean(),n.value,r.value,i.value,1===s.getValue()))});reinit=new Ch("reinit",{signature:{args:[],returns:T.Int32},impl:e=>""!==this.cipherFormat&&""!==this.cipherKey&&""!==this.cipherIV?new vh(this.setupCipher(e,this.cipherEncrypt,this.cipherFormat,this.cipherKey,this.cipherIV,this.cipherPadding)):new vh(-1)});process=new Ch("process",{signature:{args:[new kh("data",T.Object)],returns:T.Object},impl:(e,t)=>{if(""!==this.cipherFormat&&""!==this.cipherKey&&""!==this.cipherIV&&0===this.setupCipher(e,this.cipherEncrypt,this.cipherFormat,this.cipherKey,this.cipherIV,this.cipherPadding)){let n=this.updateData(t.getByteArray()),r=this.finalResult(e);return r?new gd(new Uint8Array([...n,...r])):O.Instance}return O.Instance}});update=new Ch("update",{signature:{args:[new kh("data",T.Object)],returns:T.String},impl:(e,t)=>new gd(this.updateData(t.getByteArray()))});final=new Ch("final",{signature:{args:[],returns:T.Object},impl:e=>{const t=this.finalResult(e);return t?new gd(t):O.Instance}})}var Qf=__webpack_require__(1048).Buffer;class ep extends L{kind=T.Object;hash;algorithmName;constructor(){super("roEVPDigest"),this.hash=null,this.algorithmName="",this.registerMethods({ifEVPDigest:[this.setup,this.update,this.reinit,this.process,this.final]})}toString(e){return"<Component: roEVPDigest>"}equalTo(e){return D.False}setupHash(e){try{return this.hash=Kf.n1(e),0}catch(e){return this.hash=null,this.algorithmName="",-1}}updateData(e){if(this.hash)try{return this.hash.update(Qf.from(e)),!0}catch(e){return!1}return!1}finalResult(){if(this.hash)try{let e=this.hash.digest("hex");return this.hash=null,e}catch(e){return""}return""}setup=new Ch("setup",{signature:{args:[new kh("algorithm",T.String)],returns:T.Int32},impl:(e,t)=>(this.algorithmName=t.value,new vh(this.setupHash(t.value)))});reinit=new Ch("reinit",{signature:{args:[],returns:T.Int32},impl:e=>""!==this.algorithmName?new vh(this.setupHash(this.algorithmName)):new vh(-1)});process=new Ch("process",{signature:{args:[new kh("data",T.Object)],returns:T.String},impl:(e,t)=>""!==this.algorithmName&&0===this.setupHash(this.algorithmName)&&this.updateData(t.getByteArray())?new M(this.finalResult()):new M("")});update=new Ch("update",{signature:{args:[new kh("data",T.Object)],returns:T.Void},impl:(e,t)=>(this.updateData(t.getByteArray()),O.Instance)});final=new Ch("final",{signature:{args:[],returns:T.String},impl:e=>new M(this.finalResult())})}var tp=__webpack_require__(1048).Buffer;class np extends L{kind=T.Object;hmac;hmacAlgorithm;hmacKey;constructor(){super("roHMAC"),this.hmac=null,this.hmacAlgorithm="",this.hmacKey=tp.from(""),this.registerMethods({ifHMAC:[this.setup,this.update,this.reinit,this.process,this.final]})}toString(e){return"<Component: roHMAC>"}equalTo(e){return D.False}setupHMAC(e,t){try{return this.hmac=Kf.Gz(e,t),this.hmacAlgorithm=e,this.hmacKey=t,0}catch(e){return this.hmac=null,this.hmacAlgorithm="",this.hmacKey=tp.from(""),-1}}updateData(e){if(this.hmac)try{return this.hmac.update(tp.from(e)),!0}catch(e){return!1}return!1}finalResult(){if(this.hmac)try{let e=this.hmac.digest();return this.hmac=null,e}catch(e){return tp.from("")}return tp.from("")}setup=new Ch("setup",{signature:{args:[new kh("digestType",T.String),new kh("key",T.Object)],returns:T.Int32},impl:(e,t,n)=>new vh(this.setupHMAC(t.value,tp.from(n.getByteArray())))});update=new Ch("update",{signature:{args:[new kh("data",T.Object)],returns:T.Void},impl:(e,t)=>(this.updateData(t.getByteArray()),O.Instance)});reinit=new Ch("reinit",{signature:{args:[],returns:T.Boolean},impl:e=>""!==this.hmacAlgorithm?new vh(this.setupHMAC(this.hmacAlgorithm,this.hmacKey)):new vh(-1)});process=new Ch("process",{signature:{args:[new kh("data",T.Object)],returns:T.Object},impl:(e,t)=>""!==this.hmacAlgorithm&&0===this.setupHMAC(this.hmacAlgorithm,this.hmacKey)&&this.updateData(t.getByteArray())?new gd(this.finalResult()):new gd(tp.from(""))});final=new Ch("final",{signature:{args:[],returns:T.Object},impl:e=>new gd(this.finalResult())})}var rp=__webpack_require__(1048).Buffer;class ip extends L{kind=T.Object;algorithm="aes-256-ctr";keys;constructor(){super("roDeviceCrypto"),this.keys=new Map;let e=uh.deviceInfo.clientId.replaceAll("-","");this.keys.set("device",this.format256BitKey(e));let t=uh.deviceInfo.developerId;this.keys.set("channel",this.format256BitKey(t));let n=uh.deviceInfo.deviceModel;this.keys.set("model",this.format256BitKey(`${n}${t}`)),this.registerMethods({ifDeviceCrypto:[this.encrypt,this.decrypt]})}toString(e){return"<Component: roDeviceCrypto>"}equalTo(e){return D.False}format256BitKey(e){return e.length<32?e=e.padEnd(32,String.fromCharCode(13)):e.length>32&&(e=e.slice(0,32)),rp.from(e)}encrypt=new Ch("encrypt",{signature:{args:[new kh("input",T.Object),new kh("type",T.String)],returns:T.Object},impl:(e,t,n)=>{try{const r=this.keys.get(n.value.toLowerCase());if(!r)return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roDeviceCrypto.Encrypt: invalid encryption type ${n.value}: ${e.formatLocation()}`),O.Instance;const i=Kf.po(16),s=Kf.po(16),a=Kf.Tt(this.algorithm,r,i),o=a.update(rp.from([...t.getByteArray(),...s])),c=a.final();return new gd(new Uint8Array([...o,...c,...i]))}catch(e){return O.Instance}}});decrypt=new Ch("decrypt",{signature:{args:[new kh("encryptedData",T.Object),new kh("type",T.String)],returns:T.String},impl:(e,t,n)=>{const r=this.keys.get(n.value.toLowerCase());if(!r)return uh.stdout.write(`warning;BRIGHTSCRIPT: ERROR: roDeviceCrypto.Decrypt: invalid encryption type ${n.value}: ${e.formatLocation()}`),O.Instance;try{const e=t.getByteArray().slice(-16),n=t.getByteArray().slice(0,-16),i=Kf._7(this.algorithm,r,rp.from(e)),s=i.update(rp.from(n)),a=i.final();return new gd(new Uint8Array([...s,...a].slice(0,-16)))}catch(e){return O.Instance}}})}var sp=__webpack_require__(1603);class ap{component;callback;constructor(e,t){this.component=e,this.callback=t}set(e){if(this.callback){const t=this.component.getComponentName();this.component.port?.unregisterCallback(t),this.component.port=e,this.component.port.registerCallback(t,this.callback)}else e.addReference(),this.component.port?.removeReference(),this.component.port=e;return O.Instance}setMessagePort=new Ch("setMessagePort",{signature:{args:[new kh("port",T.Object)],returns:T.Void},impl:(e,t)=>this.set(t)});setPort=new Ch("setPort",{signature:{args:[new kh("port",T.Object)],returns:T.Void},impl:(e,t)=>this.set(t)})}class op{component;constructor(e){this.component=e}getMessagePort=new Ch("getMessagePort",{signature:{args:[],returns:T.Object},impl:e=>this.component.port??O.Instance});getPort=new Ch("getPort",{signature:{args:[],returns:T.Object},impl:e=>this.component.port??O.Instance})}class cp extends L{kind=T.Object;id;order;orderInfo;credData;fakeServerEnabled;port;constructor(){super("roChannelStore"),this.id=103809e3+Math.floor(100*Math.random())+1,this.order=[],this.orderInfo=O.Instance,this.credData="",this.fakeServerEnabled=!1;const e=new ap(this),t=new op(this);this.registerMethods({ifChannelStore:[this.getIdentity,this.getCatalog,this.getStoreCatalog,this.getPurchases,this.getAllPurchases,this.setOrder,this.clearOrder,this.deltaOrder,this.getOrder,this.doOrder,this.fakeServer,this.getUserData,this.getUserRegionData,this.getPartialUserData,this.storeChannelCredData,this.getChannelCred,this.getDeviceAttestation,this.requestPartnerOrder,this.confirmPartnerOrder,e.setMessagePort,t.getMessagePort]})}setFakeServer(e){this.fakeServerEnabled=e}setNewOrder(e){this.order.length=0,e.length>0&&this.order.push(...e)}setDeltaOrder(e,t){for(let n of this.order){const r=n.get(new M("code")),i=n.get(new M("qty"));if(r instanceof M&&r.value===e&&i instanceof vh)return void n.set(new M("qty"),new vh(i.getValue()+t))}this.order.push(nx({code:e,qty:t}))}getProductData(e,t){let n=[];return this.fakeServerEnabled&&(n=this.getFakeProductData(e),t.code=1,t.message="Items Received"),n}placeOrder(e){let t=[];e.code=1,e.message="Order Succeeded";const n=this.getFakeProductData("GetCatalog");for(let t of this.order)if(!this.isValidProductOrder(n,t)){e.code=-3,e.message="Invalid Product Order";break}if(1===e.code){const n=this.getFakeOrderData("PlaceOrder"),r=this.getFakeOrderData("CheckOrder").id;n.id!==r&&(e.code=-3,e.message="Order Mismatch"),Array.isArray(n.order)&&(t=n.order.filter(e=>e instanceof Fh))}return t}getAttestationToken(){return new M("eyJ4NXUiOiJodHRwczovL2V4YW1wbGUucm9rdS5jb20vc2FtcGxlY2VydCIsInR5cCI6IkpXVCIsImFsZyI6IlJTMjU2In0.eyJuYmYiOjE2NTYzNzQyNzQsIngtcm9rdS1hdHRlc3RhdGlvbi1kYXRhIjp7Im5vbmNlIjoiNUUwNjkyRTBBMzg5RjRGNiIsImNoYW5uZWxJZCI6ImRldiIsImRldmVsb3BlcklkIjoiY2FhNzNmYmI1ZTc1YTQ2YTRiNjExNGRlNTFhNWFkYTdkNjE2ZTJlZCIsInRpbWVzdGFtcE1zIjoxNjU2Mzc3ODczOTkwfSwiaXNzIjoidXJuOnJva3U6Y2xvdWQtc2VydmljZXM6ZGV2aWNlLWF0dGVzdGF0aW9uIiwiZXhwIjoxNjU2NDY0Mjc0fQ.nywDvSUys27oeaQZ3yXwNBfOnXbO-TUDuekOPZYjSssfZhNhWwRXvPLbJKHcNMR5Z0vFOQLVDFeqEVGauIMxMEke5UFLuCRxhr3ayBJJPt_BPfrEFbAvYjFEGdKkxJqYUhuFE38R8lU2k7dhO0iFxDw1Qq7W4w8_7CjmDy4YFf7IfyhV7Vf2kGiOx5C94Niw5N2td3s21F3z77Rq_bofQ51DOKIwo_cDVuvPQnDyxG-CNEydZKCZZwGPYCKEHMPrIOOXJ-S9ZjArgaEpBUpMXWJibFxnkpVUVzbC22GEaqz_SjOJXFMQU7TaCKkDeCYVKylgKwCvbvHRDlgogf7kq")}toString(e){return"<Component: roChannelStore>"}equalTo(e){return D.False}dispose(){this.port?.removeReference()}static parseChannelStoreXml(e){const t=new sp.XmlDocument(e);return{[t.name]:cp.elementToObject(t)}}static elementToObject(e){const t=(e.children??[]).filter(function(e){return"element"===e.type});if(0===t.length)return cp.coerceValue(e.val??"");const n={};for(const e of t){const t=cp.elementToObject(e),r=e.name;void 0===n[r]?n[r]=t:Array.isArray(n[r])?n[r].push(t):n[r]=[n[r],t]}return n}static coerceValue(e){const t=e.trim();if(0===t.length)return"";const n=Number(t);return!Number.isNaN(n)&&Number.isFinite(n)?n:t}getFakeProductData(e){const t=[],n=uh.fileSystem;if(n.existsSync(`pkg:/csfake/${e}.xml`)){const r=n.readFileSync(`pkg:/csfake/${e}.xml`),i="string"==typeof r?r:r.toString();let s="";try{const e=cp.parseChannelStoreXml(i),n=e?.result?.products?.product,r=Array.isArray(n)?n:n?[n]:[];if(r.length>0){for(const e of r)if(e&&"object"==typeof e){const n=e,r={};r.code=n.code,r.cost=n.cost,r.freeTrialQuantity=n.freeTrialQuantity,r.freeTrialType=n.freeTrialType,r.name=n.name,r.productType=n.productType,r.purchaseDate=n.purchaseDate,r.qty=n.qty,r.inDunning=n.inDunning??"false",r.isUpgrade=n.isUpgrade??"false",r.trialCost=n.trialCost??"$0.00",r.trialQuantity=n.trialQuantity??0,n.description&&(r.description=n.description),n.id&&(r.id=n.id),n.expirationDate&&(r.expirationDate=n.expirationDate),n.purchaseId&&(r.purchaseId=n.purchaseId),n.renewalDate&&(r.renewalDate=n.renewalDate),n.trialType&&(r.trialType=n.trialType),n.status&&(r.status=n.status),t.push(nx(r))}}else s="warning,Warning: Empty or invalid result when parsing Product XML."}catch(e){s=`error,Error parsing Product XML: ${e?.message??e}`}""!==s&&uh.isDevMode&&uh.stderr.write(s)}return t}getFakeOrderData(e){const t=uh.fileSystem,n={id:e};if(t.existsSync(`pkg:/csfake/${e}.xml`)){const r=t.readFileSync(`pkg:/csfake/${e}.xml`),i="string"==typeof r?r:r.toString();let s="";try{const e=cp.parseChannelStoreXml(i),t=e?.result?.order;if(t){const e=t;e.id&&(n.id=e.id);const r=(e.items??{}).orderItem,i=[];if(Array.isArray(r))for(const e of r)i.push(nx(e));else r&&i.push(nx(r));n.order=i}else s="warning,Warning: Empty or invalid result when parsing Order XML."}catch(e){s=`error,Error parsing Order XML: ${e?.message??e}`}""!==s&&uh.isDevMode&&uh.stderr.write(s)}return n}isValidProductOrder(e,t){const n=t.get(new M("qty"));return!(n instanceof vh&&n.getValue()<=0)&&void 0!==e.find(e=>{const n=e.get(new M("code")),r=t.get(new M("code"));return n instanceof M&&r instanceof M&&n.value===r.value})}getIdentity=new Ch("getIdentity",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.id)});getCatalog=new Ch("getCatalog",{signature:{args:[],returns:T.Void},impl:e=>{if(this.port){const e={code:-4,message:"Empty List"},t=this.getProductData("GetCatalog",e);this.port.pushMessage(new Dd(this.id,t,e))}return O.Instance}});getStoreCatalog=new Ch("getStoreCatalog",{signature:{args:[],returns:T.Void},impl:e=>{if(this.port){const e={code:-4,message:"Empty List"},t=this.getProductData("GetCatalog",e);this.port.pushMessage(new Dd(this.id,t,e))}return O.Instance}});getPurchases=new Ch("getPurchases",{signature:{args:[],returns:T.Void},impl:e=>{if(this.port){const e={code:-4,message:"Empty List"},t=this.getProductData("GetPurchases",e);this.port.pushMessage(new Dd(this.id,t,e))}return O.Instance}});getAllPurchases=new Ch("getAllPurchases",{signature:{args:[],returns:T.Void},impl:e=>{if(this.port){const e={code:-4,message:"Empty List"},t=this.getProductData("GetPurchases",e);this.port.pushMessage(new Dd(this.id,t,e))}return O.Instance}});setOrder=new Ch("setOrder",{signature:{args:[new kh("order",T.Object),new kh("orderInfo",T.Object,O.Instance)],returns:T.Void},impl:(e,t,n)=>((t instanceof td||t instanceof Kh)&&(this.setNewOrder(t.getElements().filter(e=>e instanceof Fh)),this.order.length>0&&n instanceof Fh?this.orderInfo=n:this.orderInfo=O.Instance),O.Instance)});clearOrder=new Ch("clearOrder",{signature:{args:[],returns:T.Void},impl:e=>(this.order.length=0,this.orderInfo=O.Instance,O.Instance)});deltaOrder=new Ch("deltaOrder",{signature:{args:[new kh("code",T.String),new kh("qty",T.Int32)],returns:T.Int32},impl:(e,t,n)=>(this.setDeltaOrder(t.value,n.getValue()),new vh(this.order.length))});getOrder=new Ch("getOrder",{signature:{args:[],returns:T.Object},impl:e=>new td(this.order)});doOrder=new Ch("doOrder",{signature:{args:[],returns:T.Boolean},impl:e=>{if(!this.port)return D.False;const t={code:-3,message:"Invalid Order"};if(!this.fakeServerEnabled||0===this.order.length)return this.port.pushMessage(new Dd(this.id,[],t)),D.False;const n=this.placeOrder(t);return this.port.pushMessage(new Dd(this.id,n,t)),D.from(1===t.code)}});fakeServer=new Ch("fakeServer",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>(this.fakeServerEnabled=t.toBoolean(),O.Instance)});getUserData=new Ch("getUserData",{signature:{args:[],returns:T.Object},impl:e=>O.Instance});getUserRegionData=new Ch("getUserRegionData",{signature:{args:[],returns:T.Object},impl:e=>nx({state:"",zip:"",country:""})});getPartialUserData=new Ch("getPartialUserData",{signature:{args:[new kh("properties",T.String)],returns:T.Object},impl:(e,t)=>O.Instance});storeChannelCredData=new Ch("storeChannelCredData",{signature:{args:[new kh("data",T.String)],returns:T.Object},impl:(e,t)=>(this.credData=t.value,nx({status:0}))});getChannelCred=new Ch("getChannelCred",{signature:{args:[],returns:T.Object},impl:e=>{let t="",n=400;""!==this.credData&&(t=`{channel_data="${this.credData}"}`,n=0);const r=uh.deviceInfo.appList?.find(e=>e.running);return nx({channelId:r?.id??"dev",json:t,publisherDeviceId:uh.deviceInfo.clientId,status:n})}});getDeviceAttestation=new Ch("getDeviceAttestation",{signature:{args:[new kh("nonce",T.String)],returns:T.String},impl:(e,t)=>this.getAttestationToken()});requestPartnerOrder=new Ch("requestPartnerOrder",{signature:{args:[new kh("orderInfo",T.Object),new kh("productId",T.String)],returns:T.Object},impl:(e,t,n)=>nx({errorCode:-1,errorMessage:"",status:"Failure"})});confirmPartnerOrder=new Ch("confirmPartnerOrder",{signature:{args:[new kh("confirmOrderInfo",T.Object),new kh("productId",T.String)],returns:T.Object},impl:(e,t,n)=>nx({errorCode:-1,errorMessage:"",status:"Failure"})})}class lp extends L{kind=T.Object;port;constructor(){super("roAppMemoryMonitor");const e=new ap(this),t=new op(this);this.registerMethods({ifAppMemoryMonitor:[this.enableMemoryWarningEvent,this.getMemoryLimitPercent,this.getChannelAvailableMemory,this.getChannelMemoryLimit],ifSetMessagePort:[e.setMessagePort],ifGetMessagePort:[t.getMessagePort]})}toString(e){return"<Component: roAppMemoryMonitor>"}equalTo(e){return D.False}dispose(){this.port?.removeReference()}enableMemoryWarningEvent=new Ch("enableMemoryWarningEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>t});getMemoryLimitPercent=new Ch("getMemoryLimitPercent",{signature:{args:[],returns:T.Int32},impl:e=>{const{heapSizeLimit:t,usedHeapSize:n}=e.getMemoryHeapInfo();return new vh(n/t*100)}});getChannelAvailableMemory=new Ch("getChannelAvailableMemory",{signature:{args:[],returns:T.Object},impl:e=>{const{heapSizeLimit:t,usedHeapSize:n}=e.getMemoryHeapInfo();return new vh(t-n)}});getChannelMemoryLimit=new Ch("getChannelMemoryLimit",{signature:{args:[],returns:T.Int32},impl:e=>{const{heapSizeLimit:t}=e.getMemoryHeapInfo();return nx({maxForegroundMemory:0,maxBackgroundMemory:0,maxRokuManagedHeapMemory:t})}})}class up extends L{kind=T.Object;markTime=Date.now();constructor(e){super("roDateTime"),zf().extend(Hf()),zf().extend(Wf()),this.registerMethods({ifDateTime:[this.mark,this.asDateString,this.asDateStringNoParam,this.asDateStringLoc,this.asTimeStringLoc,this.asSeconds,this.asSecondsLong,this.asMillisecondsLong,this.fromISO8601String,this.fromSeconds,this.fromSecondsLong,this.getDayOfMonth,this.getDayOfWeek,this.getHours,this.getLastDayOfMonth,this.getMilliseconds,this.getMinutes,this.getMonth,this.getSeconds,this.getTimeZoneOffset,this.getWeekday,this.getYear,this.toISOString,this.toLocalTime]}),e?this.markTime=1e3*e:this.resetTime()}formatDate(e,t){const n=new Date(this.markTime);let r="";switch(e.toLowerCase()){case"long-date":r=n.toLocaleDateString(t,{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}).replace(",","");break;case"full":r=n.toLocaleDateString(t,{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"});break;case"short-weekday":r=n.toLocaleDateString(t,{weekday:"short",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}).replace(",","");break;case"no-weekday":case"long":r=n.toLocaleDateString(t,{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"});break;case"short-month":r=n.toLocaleDateString(t,{weekday:"long",year:"numeric",month:"short",day:"numeric",timeZone:"UTC"}).replace(",","");break;case"short-month-short-weekday":r=n.toLocaleDateString(t,{weekday:"short",year:"numeric",month:"short",day:"numeric",timeZone:"UTC"}).replace(",","");break;case"medium":case"short-month-no-weekday":r=n.toLocaleDateString(t,{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"});break;case"short":r=n.toLocaleDateString(t,{year:"en-US"!==t?"numeric":"2-digit",month:"numeric",day:"numeric",timeZone:"UTC"});break;case"short-date":{const e=n.toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric",timeZone:"UTC"}).split("/");r=e[0]+"/"+e[1]+"/"+Number.parseInt(e[2]).toString();break}case"short-date-dashes":{const e=n.toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric",timeZone:"UTC"}).split("/");r=e[0]+"-"+e[1]+"-"+Number.parseInt(e[2]).toString();break}}return r}formatTime(e,t){const n=new Date(this.markTime);let r="";switch(e.toLowerCase()){case"short":r=new Intl.DateTimeFormat(t,{timeStyle:"short",timeZone:"UTC"}).format(n).toLowerCase();break;case"short-h12":r=new Intl.DateTimeFormat(t,{hour:"numeric",minute:"numeric",hour12:!0,timeZone:"UTC"}).format(n).toLowerCase();break;case"short-h24":r=new Intl.DateTimeFormat(t,{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"}).format(n)}return r}resetTime(){this.markTime=Date.now()}toString(e){return"<Component: roDateTime>"}equalTo(e){return D.False}mark=new Ch("mark",{signature:{args:[],returns:T.Void},impl:e=>(this.resetTime(),P.Instance)});asDateString=new Ch("asDateString",{signature:{args:[new kh("format",T.String)],returns:T.String},impl:(e,t)=>{let n=this.formatDate(t.value,"en-US");return""===n&&(n=this.formatDate("long-date","en-US")),new M(n)}});asDateStringNoParam=new Ch("asDateStringNoParam",{signature:{args:[],returns:T.String},impl:e=>new M(this.formatDate("long-date","en-US"))});asDateStringLoc=new Ch("asDateStringLoc",{signature:{args:[new kh("format",T.String)],returns:T.String},impl:(e,t)=>{const n=["EEEE","EEE","dd","d","MMMM","MMM","MM","M","yy","y"],r=uh.deviceInfo.locale.replace("_","-"),i=""===t.value.trim()?"short":t.value;let s=this.formatDate(i,r);if(""===s){const e=new Date(this.markTime);s=dp(e,hp(t.value,n),r)}return new M(s)}});asTimeStringLoc=new Ch("asTimeStringLoc",{signature:{args:[new kh("format",T.String)],returns:T.String},impl:(e,t)=>{const n=["HH","H","hh","h","mm","m","a"],r=uh.deviceInfo.locale.replace("_","-"),i=""===t.value.trim()?"short":t.value;let s=this.formatTime(i,r);if(""===s){const e=new Date(this.markTime);s=dp(e,hp(t.value,n),r)}return new M(s)}});asSeconds=new Ch("asSeconds",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.markTime/1e3)});fromISO8601String=new Ch("fromISO8601String",{signature:{args:[new kh("dateString",T.String)],returns:T.Void},impl:(e,t)=>{let n=zf()(t.value,tx,!0).utc(!0);return n.isValid()||(n=zf()(0)),this.markTime=n.toDate().valueOf(),P.Instance}});asSecondsLong=new Ch("asSecondsLong",{signature:{args:[],returns:T.Int64},impl:e=>new ph(this.markTime/1e3)});asMillisecondsLong=new Ch("asMillisecondsLong",{signature:{args:[],returns:T.Int64},impl:e=>new ph(this.markTime)});fromSeconds=new Ch("fromSeconds",{signature:{args:[new kh("numSeconds",T.Int32)],returns:T.Void},impl:(e,t)=>(this.markTime=1e3*t.getValue(),P.Instance)});fromSecondsLong=new Ch("fromSecondsLong",{signature:{args:[new kh("numSeconds",T.Int64)],returns:T.Void},impl:(e,t)=>(this.markTime=1e3*t.getValue().toNumber(),O.Instance)});getDayOfMonth=new Ch("getDayOfMonth",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCDate())}});getDayOfWeek=new Ch("getDayOfWeek",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCDay())}});getHours=new Ch("getHours",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCHours())}});getLastDayOfMonth=new Ch("getLastDayOfMonth",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(new Date(t.getUTCFullYear(),t.getUTCMonth()+1,0).getUTCDate())}});getMilliseconds=new Ch("getMilliseconds",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCMilliseconds())}});getMinutes=new Ch("getMinutes",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCMinutes())}});getMonth=new Ch("getMonth",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCMonth()+1)}});getSeconds=new Ch("getSeconds",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCSeconds())}});getTimeZoneOffset=new Ch("getTimeZoneOffset",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0-((e="UTC",t=new Date)=>{const n=new Date(t.toLocaleString("en-US",{timeZone:"UTC"})),r=new Date(t.toLocaleString("en-US",{timeZone:e}));return Math.round((r.getTime()-n.getTime())/6e4)})(uh.deviceInfo.timeZone))});getWeekday=new Ch("getWeekday",{signature:{args:[],returns:T.String},impl:e=>{const t=new Date(this.markTime);return new M(t.toLocaleDateString("en-US",{weekday:"long",timeZone:"UTC"}))}});getYear=new Ch("getYear",{signature:{args:[],returns:T.Int32},impl:e=>{const t=new Date(this.markTime);return new vh(t.getUTCFullYear())}});toISOString=new Ch("toISOString",{signature:{args:[],returns:T.String},impl:e=>{const t=new Date(this.markTime);return new M(t.toISOString().split(".")[0]+"Z")}});toLocalTime=new Ch("toLocalTime",{signature:{args:[],returns:T.Void},impl:e=>(this.markTime-=60*new Date(this.markTime).getTimezoneOffset()*1e3,P.Instance)})}function hp(e,t){const n=new RegExp(`(${t.join("|")})`,"g");return e.replace(n,(e,t,n,r)=>{const i=r[n-1],s=r[n+t.length];return i&&/[a-zA-Z0-9]/.test(i)&&s&&/[a-zA-Z0-9]/.test(s)?t:`{${t}}`})}const dp=(e,t,n="en-US")=>t.replace(/\\?\{(yy|y|MM|M|dd|d|HH|H|hh|h|mm|m|MMMM|MMM|EEEE|EEE|a)\}/g,t=>{if(t.startsWith("\\"))return t.slice(1);switch(t){case"{yy}":return`${e.getUTCFullYear()}`.slice(-2);case"{y}":return`${e.getUTCFullYear()}`;case"{MM}":return`${e.getUTCMonth()+1}`.padStart(2,"0");case"{M}":return`${e.getUTCMonth()+1}`;case"{dd}":return`${e.getUTCDate()}`.padStart(2,"0");case"{d}":return`${e.getUTCDate()}`;case"{HH}":return`${e.getUTCHours()}`.padStart(2,"0");case"{H}":return`${e.getUTCHours()}`;case"{hh}":return`${e.getUTCHours()%12||12}`.padStart(2,"0");case"{h}":return`${e.getUTCHours()%12||12}`;case"{mm}":return`${e.getUTCMinutes()}`.padStart(2,"0");case"{m}":return`${e.getUTCMinutes()}`;case"{MMMM}":return new Intl.DateTimeFormat(n,{month:"long",timeZone:"UTC"}).format(e);case"{MMM}":return new Intl.DateTimeFormat(n,{month:"short",timeZone:"UTC"}).format(e);case"{EEEE}":return new Intl.DateTimeFormat(n,{weekday:"long",timeZone:"UTC"}).format(e);case"{EEE}":return new Intl.DateTimeFormat(n,{weekday:"short",timeZone:"UTC"}).format(e);case"{a}":{const t=new Intl.DateTimeFormat(n,{hour:"numeric",hour12:!0,timeZone:"UTC"}).formatToParts(e);return t.find(e=>"dayPeriod"===e.type)?.value.toLowerCase()??""}default:return""}});class fp extends L{kind=T.Object;supportedFlags="gims";jsRegex;constructor(e,t=new M("")){super("roRegex"),this.jsRegex=new RegExp(e.value,this.parseFlags(t.value)),this.registerMethods({ifRegex:[this.isMatch,this.match,this.replace,this.replaceAll,this.split,this.matchAll]})}toString(e){return"<Component: roRegex>"}equalTo(e){return D.False}parseFlags(e){let t="";if(0===e.length)return t;for(const n of e)if("x"!==n){if(!this.supportedFlags.includes(n))throw new Error(`${n} is not supported.`);t+=n}return t}parseReplacementPattern(e){return e.replace(/\\/g,"$")}isMatch=new Ch("ismatch",{signature:{args:[new kh("str",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(this.jsRegex.test(t.value))});match=new Ch("match",{signature:{args:[new kh("str",T.String)],returns:T.Object},impl:(e,t)=>{const n=this.jsRegex.exec(t.value);let r=[];return null!==n&&(r=n.map(e=>new M(e||""))),new Kh(r)}});replace=new Ch("replace",{signature:{args:[new kh("str",T.String),new kh("replacement",T.String)],returns:T.String},impl:(e,t,n)=>{let r=this.parseReplacementPattern(n.value);const i=this.jsRegex[Symbol.replace](t.value,r);return new M(i)}});replaceAll=new Ch("replaceall",{signature:{args:[new kh("str",T.String),new kh("replacement",T.String)],returns:T.String},impl:(e,t,n)=>{const r=this.jsRegex.source;let i=this.jsRegex.flags;i.includes("g")||(i+="g"),this.jsRegex=new RegExp(r,i);const s=this.jsRegex[Symbol.replace](t.value,n.value);return new M(s)}});split=new Ch("split",{signature:{args:[new kh("str",T.String)],returns:T.Object},impl:(e,t)=>{let n=this.jsRegex[Symbol.split](t.value).map(e=>new M(e));return new td(n)}});matchAll=new Ch("matchall",{signature:{args:[new kh("str",T.String)],returns:T.Object},impl:(e,t)=>{const n=this.jsRegex.source;let r=this.jsRegex.flags;r.includes("g")||(r+="g"),this.jsRegex=new RegExp(n,r);let i,s=[];for(;null!==(i=this.jsRegex.exec(t.value));)s.push(new Kh(i.filter(e=>void 0!==e).map(e=>new M(e))));return new Kh(s)}})}class pp extends L{kind=T.Object;messageQueue;callbackQueue;callbackMap;constructor(){super("roMessagePort"),this.registerMethods({ifMessagePort:[this.waitMessage,this.getMessage,this.peekMessage]}),this.messageQueue=[],this.callbackQueue=[],this.callbackMap=new Map}pushMessage(e){this.messageQueue.push(e)}pushCallback(e){this.callbackQueue.push(e)}registerCallback(e,t){this.addReference(),this.callbackMap.set(e,t)}unregisterCallback(e){this.removeReference(),this.callbackMap.delete(e)}asyncCancel(){this.callbackQueue.length=0}toString(e){return"<Component: roMessagePort>"}equalTo(e){return D.False}wait(e,t){const n=0===t,r=t+performance.now();for(;n||performance.now()<r;){const n=this.getNextMessage();if(QS(n))return n;this.updateMessageQueue(e,t);const r=uh.checkBreakCommand(e.debugMode);if(r===Ie.BREAK||r===Ie.EXIT)return e.debugMode=r===Ie.BREAK,O.Instance}return O.Instance}updateMessageQueue(e,t){if(this.callbackMap.size>0)for(const[n,r]of this.callbackMap.entries()){const n=r(e,t);this.messageQueue.push(...n.filter(QS))}}getNextMessage(){if(this.messageQueue.length>0)return this.messageQueue.shift();if(this.callbackQueue.length>0){const e=this.callbackQueue.shift();if("function"==typeof e)return e()}return O.Instance}waitMessage=new Ch("waitMessage",{signature:{args:[new kh("timeout",T.Int32)],returns:T.Object},impl:(e,t)=>this.wait(e,t.getValue())});getMessage=new Ch("getMessage",{signature:{args:[],returns:T.Dynamic},impl:e=>(this.updateMessageQueue(),this.getNextMessage())});peekMessage=new Ch("peekMessage",{signature:{args:[],returns:T.Dynamic},impl:e=>{if(this.updateMessageQueue(),this.messageQueue.length>0)return this.messageQueue[0];if(this.callbackQueue.length>0){let e=this.callbackQueue[0];if(e){const t=e();if(!ux(t))return this.messageQueue.push(t),t}}return O.Instance}})}class gp extends L{kind=T.Object;port;constructor(){super("roInput");const e=new ap(this,this.getNewEvents.bind(this)),t=new op(this);this.registerMethods({ifInput:[this.enableTransportEvents,this.eventResponse,e.setMessagePort,t.getMessagePort]})}toString(e){return"<Component: roInput>"}equalTo(e){return D.False}dispose(){this.port?.unregisterCallback(this.getComponentName())}getNewEvents(){const e=[];if(Atomics.load(uh.sharedArray,ve.BUF)===_e.INPUT){const t=uh.readDataBuffer();try{const n=JSON.parse(t);e.push(new Ad(nx(n)))}catch(e){uh.isDevMode&&uh.stdout.write(`warning,[roSystemLog] Error parsing Input buffer: ${e.message}`)}}return e}enableTransportEvents=new Ch("enableTransportEvents",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});eventResponse=new Ch("eventResponse",{signature:{args:[new kh("aa",T.Object)],returns:T.Boolean},impl:(e,t)=>D.False})}class mp extends L{kind=T.Object;validEvents=["bandwidth.minute","http.connect","http.complete","http.error"];enabledEvents=[];port;constructor(){super("roSystemLog");const e=new ap(this,this.getNewEvents.bind(this)),t=new op(this);this.registerMethods({ifSystemLog:[this.enableType,e.setMessagePort,t.getMessagePort]})}toString(e){return"<Component: roSystemLog>"}equalTo(e){return D.False}dispose(){this.port?.unregisterCallback(this.getComponentName())}getNewEvents(){const e=[];if(this.enabledEvents.includes("bandwidth.minute")){const t=Atomics.load(uh.sharedArray,ve.MBWD);t>0&&(Atomics.store(uh.sharedArray,ve.MBWD,-1),e.push(new Cd("bandwidth.minute",t)))}if(Atomics.load(uh.sharedArray,ve.BUF)===_e.SYS_LOG){const t=uh.readDataBuffer();try{const n=JSON.parse(t);"string"==typeof n.type&&this.enabledEvents.includes(n.type)&&e.push(new Cd(n.type,n))}catch(e){uh.isDevMode&&uh.stdout.write(`warning,[roSystemLog] Error parsing System Log buffer: ${e.message}`)}}return e}enableType=new Ch("enableType",{signature:{args:[new kh("logType",T.String)],returns:T.Void},impl:(e,t)=>(this.validEvents.includes(t.value)&&!this.enabledEvents.includes(t.value)&&(this.enabledEvents.push(t.value),postMessage(`syslog,${t.value}`)),O.Instance)})}class yp extends L{kind=T.Object;family;size;bold;italic;metrics;canvas;constructor(e,t,n,r,i){super("roFont"),this.family=e.value,this.size=t.getValue(),this.bold=n.toBoolean(),this.italic=r.toBoolean(),this.metrics=i,this.registerMethods({ifFont:[this.getOneLineHeight,this.getOneLineWidth,this.getAscent,this.getDescent,this.getMaxAdvance]}),this.canvas=mw().canvas}measureTextHeight(){return Math.round(this.metrics.lineHeight*this.size)}measureTextWidth(e,t,n){const r=this.canvas.getContext("2d",{alpha:!1});r.font=this.toFontString(),r.textBaseline="top";let i=r.measureText(e),s=t?Math.min(i.width,t):i.width,a=e,o=!1;if(n&&t&&i.width>t){let i=r.measureText(n).width,c=e;for(;r.measureText(c).width+i>t&&c.length>0;)c=c.slice(0,-1);a=c+n,s=r.measureText(a).width,o=!0}return{width:Math.round(s),text:a,ellipsized:o}}measureText(e,t,n){let{width:r,text:i,ellipsized:s}=this.measureTextWidth(e,t,n);return{width:r,height:this.measureTextHeight(),text:i,ellipsized:s}}getTopAdjust(){return(this.metrics.lineHeight*this.size-Math.max(this.metrics.ascent*this.size,this.size))/2}toFontString(){return`${this.italic?"italic":""} ${this.bold?"bold":""} ${this.size}px '${this.family}'`}toString(e){return"<Component: roFont>"}equalTo(e){return D.False}getOneLineHeight=new Ch("getOneLineHeight",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.measureTextHeight())});getOneLineWidth=new Ch("getOneLineWidth",{signature:{args:[new kh("text",T.String),new kh("maxWidth",T.Int32)],returns:T.Int32},impl:(e,t,n)=>{let{width:r}=this.measureTextWidth(t.value,n.getValue());return new vh(r)}});getAscent=new Ch("getAscent",{signature:{args:[],returns:T.Int32},impl:e=>new vh(Math.round(this.metrics.ascent*this.size))});getDescent=new Ch("getDescent",{signature:{args:[],returns:T.Int32},impl:e=>new vh(Math.round(this.metrics.descent*this.size))});getMaxAdvance=new Ch("getMaxAdvance",{signature:{args:[],returns:T.Int32},impl:e=>new vh(Math.round(this.metrics.maxAdvance*this.size))})}var bp,wp,vp=__webpack_require__(1048).Buffer;function Sp(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function xp(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new Sp,this.dtree=new Sp}String.prototype.codePointAt||(wp=function(e){if(null==this)throw TypeError();var t=String(this),n=t.length,r=e?Number(e):0;if(r!=r&&(r=0),!(r<0||r>=n)){var i,s=t.charCodeAt(r);return s>=55296&&s<=56319&&n>r+1&&(i=t.charCodeAt(r+1))>=56320&&i<=57343?1024*(s-55296)+i-56320+65536:s}},(bp=function(){try{var e={},t=Object.defineProperty,n=t(e,e,e)&&t}catch(e){}return n}())?bp(String.prototype,"codePointAt",{value:wp,configurable:!0,writable:!0}):String.prototype.codePointAt=wp);var Ep=new Sp,Ip=new Sp,kp=new Uint8Array(30),Tp=new Uint16Array(30),_p=new Uint8Array(30),Cp=new Uint16Array(30),Ap=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fp=new Sp,Rp=new Uint8Array(320);function Mp(e,t,n,r){var i,s;for(i=0;i<n;++i)e[i]=0;for(i=0;i<30-n;++i)e[i+n]=i/n|0;for(s=r,i=0;i<30;++i)t[i]=s,s+=1<<e[i]}var Dp=new Uint16Array(16);function Op(e,t,n,r){var i,s;for(i=0;i<16;++i)e.table[i]=0;for(i=0;i<r;++i)e.table[t[n+i]]++;for(e.table[0]=0,s=0,i=0;i<16;++i)Dp[i]=s,s+=e.table[i];for(i=0;i<r;++i)t[n+i]&&(e.trans[Dp[t[n+i]]++]=i)}function Pp(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function Np(e,t,n){if(!t)return n;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,r+n}function Lp(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=0,r=0,i=0,s=e.tag;do{r=2*r+(1&s),s>>>=1,++i,n+=t.table[i],r-=t.table[i]}while(r>=0);return e.tag=s,e.bitcount-=i,t.trans[n+r]}function Bp(e,t,n){var r,i,s,a,o,c;for(r=Np(e,5,257),i=Np(e,5,1),s=Np(e,4,4),a=0;a<19;++a)Rp[a]=0;for(a=0;a<s;++a){var l=Np(e,3,0);Rp[Ap[a]]=l}for(Op(Fp,Rp,0,19),o=0;o<r+i;){var u=Lp(e,Fp);switch(u){case 16:var h=Rp[o-1];for(c=Np(e,2,3);c;--c)Rp[o++]=h;break;case 17:for(c=Np(e,3,3);c;--c)Rp[o++]=0;break;case 18:for(c=Np(e,7,11);c;--c)Rp[o++]=0;break;default:Rp[o++]=u}}Op(t,Rp,0,r),Op(n,Rp,r,i)}function Up(e,t,n){for(;;){var r,i,s,a,o=Lp(e,t);if(256===o)return 0;if(o<256)e.dest[e.destLen++]=o;else for(r=Np(e,kp[o-=257],Tp[o]),i=Lp(e,n),a=s=e.destLen-Np(e,_p[i],Cp[i]);a<s+r;++a)e.dest[e.destLen++]=e.dest[a]}}function Vp(e){for(var t,n;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((t=256*(t=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,n=t;n;--n)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}function jp(e,t,n,r,i){return Math.pow(1-i,3)*e+3*Math.pow(1-i,2)*i*t+3*(1-i)*Math.pow(i,2)*n+Math.pow(i,3)*r}function zp(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function Gp(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function Hp(e){throw new Error(e)}function $p(e,t){e||Hp(t)}!function(e,t){var n;for(n=0;n<7;++n)e.table[n]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,n=0;n<24;++n)e.trans[n]=256+n;for(n=0;n<144;++n)e.trans[24+n]=n;for(n=0;n<8;++n)e.trans[168+n]=280+n;for(n=0;n<112;++n)e.trans[176+n]=144+n;for(n=0;n<5;++n)t.table[n]=0;for(t.table[5]=32,n=0;n<32;++n)t.trans[n]=n}(Ep,Ip),Mp(kp,Tp,4,3),Mp(_p,Cp,2,1),kp[28]=0,Tp[28]=258,zp.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},zp.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},zp.prototype.addX=function(e){this.addPoint(e,null)},zp.prototype.addY=function(e){this.addPoint(null,e)},zp.prototype.addBezier=function(e,t,n,r,i,s,a,o){var c=[e,t],l=[n,r],u=[i,s],h=[a,o];this.addPoint(e,t),this.addPoint(a,o);for(var d=0;d<=1;d++){var f=6*c[d]-12*l[d]+6*u[d],p=-3*c[d]+9*l[d]-9*u[d]+3*h[d],g=3*l[d]-3*c[d];if(0!==p){var m=Math.pow(f,2)-4*g*p;if(!(m<0)){var y=(-f+Math.sqrt(m))/(2*p);0<y&&y<1&&(0===d&&this.addX(jp(c[d],l[d],u[d],h[d],y)),1===d&&this.addY(jp(c[d],l[d],u[d],h[d],y)));var b=(-f-Math.sqrt(m))/(2*p);0<b&&b<1&&(0===d&&this.addX(jp(c[d],l[d],u[d],h[d],b)),1===d&&this.addY(jp(c[d],l[d],u[d],h[d],b)))}}else{if(0===f)continue;var w=-g/f;0<w&&w<1&&(0===d&&this.addX(jp(c[d],l[d],u[d],h[d],w)),1===d&&this.addY(jp(c[d],l[d],u[d],h[d],w)))}}},zp.prototype.addQuad=function(e,t,n,r,i,s){var a=e+2/3*(n-e),o=t+2/3*(r-t),c=a+1/3*(i-e),l=o+1/3*(s-t);this.addBezier(e,t,a,o,c,l,i,s)},Gp.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},Gp.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},Gp.prototype.curveTo=Gp.prototype.bezierCurveTo=function(e,t,n,r,i,s){this.commands.push({type:"C",x1:e,y1:t,x2:n,y2:r,x:i,y:s})},Gp.prototype.quadTo=Gp.prototype.quadraticCurveTo=function(e,t,n,r){this.commands.push({type:"Q",x1:e,y1:t,x:n,y:r})},Gp.prototype.close=Gp.prototype.closePath=function(){this.commands.push({type:"Z"})},Gp.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof zp){var t=e;return this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},Gp.prototype.getBoundingBox=function(){for(var e=new zp,t=0,n=0,r=0,i=0,s=0;s<this.commands.length;s++){var a=this.commands[s];switch(a.type){case"M":e.addPoint(a.x,a.y),t=r=a.x,n=i=a.y;break;case"L":e.addPoint(a.x,a.y),r=a.x,i=a.y;break;case"Q":e.addQuad(r,i,a.x1,a.y1,a.x,a.y),r=a.x,i=a.y;break;case"C":e.addBezier(r,i,a.x1,a.y1,a.x2,a.y2,a.x,a.y),r=a.x,i=a.y;break;case"Z":r=t,i=n;break;default:throw new Error("Unexpected path command "+a.type)}}return e.isEmpty()&&e.addPoint(0,0),e},Gp.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var n=this.commands[t];"M"===n.type?e.moveTo(n.x,n.y):"L"===n.type?e.lineTo(n.x,n.y):"C"===n.type?e.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?e.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},Gp.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function n(){for(var e=arguments,n="",r=0;r<arguments.length;r+=1){var i=e[r];i>=0&&r>0&&(n+=" "),n+=t(i)}return n}e=void 0!==e?e:2;for(var r="",i=0;i<this.commands.length;i+=1){var s=this.commands[i];"M"===s.type?r+="M"+n(s.x,s.y):"L"===s.type?r+="L"+n(s.x,s.y):"C"===s.type?r+="C"+n(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?r+="Q"+n(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(r+="Z")}return r},Gp.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+"/>"},Gp.prototype.toDOMElement=function(e){var t=this.toPathData(e),n=document.createElementNS("http://www.w3.org/2000/svg","path");return n.setAttribute("d",t),n};var Wp={fail:Hp,argument:$p,assert:$p},qp=2147483648,Xp={},Yp={},Kp={};function Jp(e){return function(){return e}}Yp.BYTE=function(e){return Wp.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},Kp.BYTE=Jp(1),Yp.CHAR=function(e){return[e.charCodeAt(0)]},Kp.CHAR=Jp(1),Yp.CHARARRAY=function(e){void 0===e&&(e="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var t=[],n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t},Kp.CHARARRAY=function(e){return void 0===e?0:e.length},Yp.USHORT=function(e){return[e>>8&255,255&e]},Kp.USHORT=Jp(2),Yp.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},Kp.SHORT=Jp(2),Yp.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},Kp.UINT24=Jp(3),Yp.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},Kp.ULONG=Jp(4),Yp.LONG=function(e){return e>=qp&&(e=-(2*qp-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},Kp.LONG=Jp(4),Yp.FIXED=Yp.ULONG,Kp.FIXED=Kp.ULONG,Yp.FWORD=Yp.SHORT,Kp.FWORD=Kp.SHORT,Yp.UFWORD=Yp.USHORT,Kp.UFWORD=Kp.USHORT,Yp.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},Kp.LONGDATETIME=Jp(8),Yp.TAG=function(e){return Wp.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},Kp.TAG=Jp(4),Yp.Card8=Yp.BYTE,Kp.Card8=Kp.BYTE,Yp.Card16=Yp.USHORT,Kp.Card16=Kp.USHORT,Yp.OffSize=Yp.BYTE,Kp.OffSize=Kp.BYTE,Yp.SID=Yp.USHORT,Kp.SID=Kp.USHORT,Yp.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?Yp.NUMBER16(e):Yp.NUMBER32(e)},Kp.NUMBER=function(e){return Yp.NUMBER(e).length},Yp.NUMBER16=function(e){return[28,e>>8&255,255&e]},Kp.NUMBER16=Jp(3),Yp.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},Kp.NUMBER32=Jp(5),Yp.REAL=function(e){var t=e.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(n){var r=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));t=(Math.round(e*r)/r).toString()}for(var i="",s=0,a=t.length;s<a;s+=1){var o=t[s];i+="e"===o?"-"===t[++s]?"c":"b":"."===o?"a":"-"===o?"e":o}for(var c=[30],l=0,u=(i+=1&i.length?"f":"ff").length;l<u;l+=2)c.push(parseInt(i.substr(l,2),16));return c},Kp.REAL=function(e){return Yp.REAL(e).length},Yp.NAME=Yp.CHARARRAY,Kp.NAME=Kp.CHARARRAY,Yp.STRING=Yp.CHARARRAY,Kp.STRING=Kp.CHARARRAY,Xp.UTF8=function(e,t,n){for(var r=[],i=n,s=0;s<i;s++,t+=1)r[s]=e.getUint8(t);return String.fromCharCode.apply(null,r)},Xp.UTF16=function(e,t,n){for(var r=[],i=n/2,s=0;s<i;s++,t+=2)r[s]=e.getUint16(t);return String.fromCharCode.apply(null,r)},Yp.UTF16=function(e){for(var t=[],n=0;n<e.length;n+=1){var r=e.charCodeAt(n);t[t.length]=r>>8&255,t[t.length]=255&r}return t},Kp.UTF16=function(e){return 2*e.length};var Zp={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};Xp.MACSTRING=function(e,t,n,r){var i=Zp[r];if(void 0!==i){for(var s="",a=0;a<n;a++){var o=e.getUint8(t+a);s+=o<=127?String.fromCharCode(o):i[127&o]}return s}};var Qp,eg="function"==typeof WeakMap&&new WeakMap;function tg(e){return e>=-128&&e<=127}function ng(e,t,n){for(var r=0,i=e.length;t<i&&r<64&&0===e[t];)++t,++r;return n.push(128|r-1),t}function rg(e,t,n){for(var r=0,i=e.length,s=t;s<i&&r<64;){var a=e[s];if(!tg(a))break;if(0===a&&s+1<i&&0===e[s+1])break;++s,++r}n.push(r-1);for(var o=t;o<s;++o)n.push(e[o]+256&255);return s}function ig(e,t,n){for(var r=0,i=e.length,s=t;s<i&&r<64;){var a=e[s];if(0===a)break;if(tg(a)&&s+1<i&&tg(e[s+1]))break;++s,++r}n.push(64|r-1);for(var o=t;o<s;++o){var c=e[o];n.push(c+65536>>8&255,c+256&255)}return s}Yp.MACSTRING=function(e,t){var n=function(e){if(!Qp)for(var t in Qp={},Zp)Qp[t]=new String(t);var n=Qp[e];if(void 0!==n){if(eg){var r=eg.get(n);if(void 0!==r)return r}var i=Zp[e];if(void 0!==i){for(var s={},a=0;a<i.length;a++)s[i.charCodeAt(a)]=a+128;return eg&&eg.set(n,s),s}}}(t);if(void 0!==n){for(var r=[],i=0;i<e.length;i++){var s=e.charCodeAt(i);if(s>=128&&void 0===(s=n[s]))return;r[i]=s}return r}},Kp.MACSTRING=function(e,t){var n=Yp.MACSTRING(e,t);return void 0!==n?n.length:0},Yp.VARDELTAS=function(e){for(var t=0,n=[];t<e.length;){var r=e[t];t=0===r?ng(e,t,n):r>=-128&&r<=127?rg(e,t,n):ig(e,t,n)}return n},Yp.INDEX=function(e){for(var t=1,n=[t],r=[],i=0;i<e.length;i+=1){var s=Yp.OBJECT(e[i]);Array.prototype.push.apply(r,s),t+=s.length,n.push(t)}if(0===r.length)return[0,0];for(var a=[],o=1+Math.floor(Math.log(t)/Math.log(2))/8|0,c=[void 0,Yp.BYTE,Yp.USHORT,Yp.UINT24,Yp.ULONG][o],l=0;l<n.length;l+=1){var u=c(n[l]);Array.prototype.push.apply(a,u)}return Array.prototype.concat(Yp.Card16(e.length),Yp.OffSize(o),a,r)},Kp.INDEX=function(e){return Yp.INDEX(e).length},Yp.DICT=function(e){for(var t=[],n=Object.keys(e),r=n.length,i=0;i<r;i+=1){var s=parseInt(n[i],0),a=e[s];t=(t=t.concat(Yp.OPERAND(a.value,a.type))).concat(Yp.OPERATOR(s))}return t},Kp.DICT=function(e){return Yp.DICT(e).length},Yp.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},Yp.OPERAND=function(e,t){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r+=1)Wp.argument(e.length===t.length,"Not enough arguments given for type"+t),n=n.concat(Yp.OPERAND(e[r],t[r]));else if("SID"===t)n=n.concat(Yp.NUMBER(e));else if("offset"===t)n=n.concat(Yp.NUMBER32(e));else if("number"===t)n=n.concat(Yp.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);n=n.concat(Yp.REAL(e))}return n},Yp.OP=Yp.BYTE,Kp.OP=Kp.BYTE;var sg="function"==typeof WeakMap&&new WeakMap;function ag(e,t,n){if(t.length&&("coverageFormat"!==t[0].name||1===t[0].value))for(var r=0;r<t.length;r+=1){var i=t[r];this[i.name]=i.value}if(this.tableName=e,this.fields=t,n)for(var s=Object.keys(n),a=0;a<s.length;a+=1){var o=s[a],c=n[o];void 0!==this[o]&&(this[o]=c)}}function og(e,t,n){void 0===n&&(n=t.length);var r=new Array(t.length+1);r[0]={name:e+"Count",type:"USHORT",value:n};for(var i=0;i<t.length;i++)r[i+1]={name:e+i,type:"USHORT",value:t[i]};return r}function cg(e,t,n){var r=t.length,i=new Array(r+1);i[0]={name:e+"Count",type:"USHORT",value:r};for(var s=0;s<r;s++)i[s+1]={name:e+s,type:"TABLE",value:n(t[s],s)};return i}function lg(e,t,n){var r=t.length,i=[];i[0]={name:e+"Count",type:"USHORT",value:r};for(var s=0;s<r;s++)i=i.concat(n(t[s],s));return i}function ug(e){1===e.format?ag.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(og("glyph",e.glyphs))):2===e.format?ag.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(lg("rangeRecord",e.ranges,function(e){return[{name:"startGlyphID",type:"USHORT",value:e.start},{name:"endGlyphID",type:"USHORT",value:e.end},{name:"startCoverageIndex",type:"USHORT",value:e.index}]}))):Wp.assert(!1,"Coverage format must be 1 or 2.")}function hg(e){ag.call(this,"scriptListTable",lg("scriptRecord",e,function(e,t){var n=e.script,r=n.defaultLangSys;return Wp.assert(!!r,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new ag("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new ag("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(og("featureIndex",r.featureIndexes)))}].concat(lg("langSys",n.langSysRecords,function(e,t){var n=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new ag("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(og("featureIndex",n.featureIndexes)))}]})))}]}))}function dg(e){ag.call(this,"featureListTable",lg("featureRecord",e,function(e,t){var n=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new ag("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(og("lookupListIndex",n.lookupListIndexes)))}]}))}function fg(e,t){ag.call(this,"lookupListTable",cg("lookup",e,function(e){var n=t[e.lookupType];return Wp.assert(!!n,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new ag("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(cg("subtable",e.subtables,n)))}))}Yp.CHARSTRING=function(e){if(sg){var t=sg.get(e);if(void 0!==t)return t}for(var n=[],r=e.length,i=0;i<r;i+=1){var s=e[i];n=n.concat(Yp[s.type](s.value))}return sg&&sg.set(e,n),n},Kp.CHARSTRING=function(e){return Yp.CHARSTRING(e).length},Yp.OBJECT=function(e){var t=Yp[e.type];return Wp.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},Kp.OBJECT=function(e){var t=Kp[e.type];return Wp.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},Yp.TABLE=function(e){for(var t=[],n=e.fields.length,r=[],i=[],s=0;s<n;s+=1){var a=e.fields[s],o=Yp[a.type];Wp.argument(void 0!==o,"No encoding function for field type "+a.type+" ("+a.name+")");var c=e[a.name];void 0===c&&(c=a.value);var l=o(c);"TABLE"===a.type?(i.push(t.length),t=t.concat([0,0]),r.push(l)):t=t.concat(l)}for(var u=0;u<r.length;u+=1){var h=i[u],d=t.length;Wp.argument(d<65536,"Table "+e.tableName+" too big."),t[h]=d>>8,t[h+1]=255&d,t=t.concat(r[u])}return t},Kp.TABLE=function(e){for(var t=0,n=e.fields.length,r=0;r<n;r+=1){var i=e.fields[r],s=Kp[i.type];Wp.argument(void 0!==s,"No sizeOf function for field type "+i.type+" ("+i.name+")");var a=e[i.name];void 0===a&&(a=i.value),t+=s(a),"TABLE"===i.type&&(t+=2)}return t},Yp.RECORD=Yp.TABLE,Kp.RECORD=Kp.TABLE,Yp.LITERAL=function(e){return e},Kp.LITERAL=function(e){return e.length},ag.prototype.encode=function(){return Yp.TABLE(this)},ag.prototype.sizeOf=function(){return Kp.TABLE(this)},ug.prototype=Object.create(ag.prototype),ug.prototype.constructor=ug,hg.prototype=Object.create(ag.prototype),hg.prototype.constructor=hg,dg.prototype=Object.create(ag.prototype),dg.prototype.constructor=dg,fg.prototype=Object.create(ag.prototype),fg.prototype.constructor=fg;var pg={Table:ag,Record:ag,Coverage:ug,ScriptList:hg,FeatureList:dg,LookupList:fg,ushortList:og,tableList:cg,recordList:lg};function gg(e,t){return e.getUint8(t)}function mg(e,t){return e.getUint16(t,!1)}function yg(e,t){return e.getUint32(t,!1)}function bg(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}var wg={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function vg(e,t){this.data=e,this.offset=t,this.relativeOffset=0}vg.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},vg.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},vg.prototype.parseCard8=vg.prototype.parseByte,vg.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},vg.prototype.parseCard16=vg.prototype.parseUShort,vg.prototype.parseSID=vg.prototype.parseUShort,vg.prototype.parseOffset16=vg.prototype.parseUShort,vg.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},vg.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},vg.prototype.parseULong=function(){var e=yg(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},vg.prototype.parseOffset32=vg.prototype.parseULong,vg.prototype.parseFixed=function(){var e=bg(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},vg.prototype.parseString=function(e){var t=this.data,n=this.offset+this.relativeOffset,r="";this.relativeOffset+=e;for(var i=0;i<e;i++)r+=String.fromCharCode(t.getUint8(n+i));return r},vg.prototype.parseTag=function(){return this.parseString(4)},vg.prototype.parseLongDateTime=function(){var e=yg(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},vg.prototype.parseVersion=function(e){var t=mg(this.data,this.offset+this.relativeOffset),n=mg(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+n/e/10},vg.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=wg[e]*t},vg.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),n=this.data,r=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=n.getUint32(r),r+=4;return this.relativeOffset+=4*e,t},vg.prototype.parseOffset16List=vg.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),n=this.data,r=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=n.getUint16(r),r+=2;return this.relativeOffset+=2*e,t},vg.prototype.parseShortList=function(e){for(var t=new Array(e),n=this.data,r=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=n.getInt16(r),r+=2;return this.relativeOffset+=2*e,t},vg.prototype.parseByteList=function(e){for(var t=new Array(e),n=this.data,r=this.offset+this.relativeOffset,i=0;i<e;i++)t[i]=n.getUint8(r++);return this.relativeOffset+=e,t},vg.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var n=new Array(e),r=0;r<e;r++)n[r]=t.call(this);return n},vg.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var n=new Array(e),r=0;r<e;r++)n[r]=t.call(this);return n},vg.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var n=new Array(e),r=Object.keys(t),i=0;i<e;i++){for(var s={},a=0;a<r.length;a++){var o=r[a],c=t[o];s[o]=c.call(this)}n[i]=s}return n},vg.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var n=new Array(e),r=Object.keys(t),i=0;i<e;i++){for(var s={},a=0;a<r.length;a++){var o=r[a],c=t[o];s[o]=c.call(this)}n[i]=s}return n},vg.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r],s=e[i];n[i]=s.call(this)}return n},vg.prototype.parseValueRecord=function(e){if(void 0===e&&(e=this.parseUShort()),0!==e){var t={};return 1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t}},vg.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),n=new Array(t),r=0;r<t;r++)n[r]=this.parseValueRecord(e);return n},vg.prototype.parsePointer=function(e){var t=this.parseOffset16();if(t>0)return new vg(this.data,this.offset+t).parseStruct(e)},vg.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(t>0)return new vg(this.data,this.offset+t).parseStruct(e)},vg.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),n=t.length,r=this.relativeOffset,i=new Array(n),s=0;s<n;s++){var a=t[s];if(0!==a)if(this.relativeOffset=a,e){for(var o=this.parseOffset16List(),c=new Array(o.length),l=0;l<o.length;l++)this.relativeOffset=a+o[l],c[l]=e.call(this);i[s]=c}else i[s]=this.parseUShortList();else i[s]=void 0}return this.relativeOffset=r,i},vg.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),n=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(n)};if(2===t){for(var r=new Array(n),i=0;i<n;i++)r[i]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:r}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},vg.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:vg.uShort,end:vg.uShort,classId:vg.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},vg.list=function(e,t){return function(){return this.parseList(e,t)}},vg.list32=function(e,t){return function(){return this.parseList32(e,t)}},vg.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},vg.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},vg.pointer=function(e){return function(){return this.parsePointer(e)}},vg.pointer32=function(e){return function(){return this.parsePointer32(e)}},vg.tag=vg.prototype.parseTag,vg.byte=vg.prototype.parseByte,vg.uShort=vg.offset16=vg.prototype.parseUShort,vg.uShortList=vg.prototype.parseUShortList,vg.uLong=vg.offset32=vg.prototype.parseULong,vg.uLongList=vg.prototype.parseULongList,vg.struct=vg.prototype.parseStruct,vg.coverage=vg.prototype.parseCoverage,vg.classDef=vg.prototype.parseClassDef;var Sg={reserved:vg.uShort,reqFeatureIndex:vg.uShort,featureIndexes:vg.uShortList};vg.prototype.parseScriptList=function(){return this.parsePointer(vg.recordList({tag:vg.tag,script:vg.pointer({defaultLangSys:vg.pointer(Sg),langSysRecords:vg.recordList({tag:vg.tag,langSys:vg.pointer(Sg)})})}))||[]},vg.prototype.parseFeatureList=function(){return this.parsePointer(vg.recordList({tag:vg.tag,feature:vg.pointer({featureParams:vg.offset16,lookupListIndexes:vg.uShortList})}))||[]},vg.prototype.parseLookupList=function(e){return this.parsePointer(vg.list(vg.pointer(function(){var t=this.parseUShort();Wp.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var n=this.parseUShort(),r=16&n;return{lookupType:t,lookupFlag:n,subtables:this.parseList(vg.pointer(e[t])),markFilteringSet:r?this.parseUShort():void 0}})))||[]},vg.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var e=this.parseUShort(),t=this.parseUShort();return Wp.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:vg.offset32,featureTableSubstitutionOffset:vg.offset32})})||[]};var xg={getByte:gg,getCard8:gg,getUShort:mg,getCard16:mg,getShort:function(e,t){return e.getInt16(t,!1)},getULong:yg,getFixed:bg,getTag:function(e,t){for(var n="",r=t;r<t+4;r+=1)n+=String.fromCharCode(e.getInt8(r));return n},getOffset:function(e,t,n){for(var r=0,i=0;i<n;i+=1)r<<=8,r+=e.getUint8(t+i);return r},getBytes:function(e,t,n){for(var r=[],i=t;i<n;i+=1)r.push(e.getUint8(i));return r},bytesToString:function(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return t},Parser:vg};function Eg(e,t,n){e.segments.push({end:t,start:t,delta:-(t-n),offset:0,glyphIndex:n})}var Ig=function(e,t){var n={};n.version=xg.getUShort(e,t),Wp.argument(0===n.version,"cmap table version should be 0."),n.numTables=xg.getUShort(e,t+2);for(var r=-1,i=n.numTables-1;i>=0;i-=1){var s=xg.getUShort(e,t+4+8*i),a=xg.getUShort(e,t+4+8*i+2);if(3===s&&(0===a||1===a||10===a)||0===s&&(0===a||1===a||2===a||3===a||4===a)){r=xg.getULong(e,t+4+8*i+4);break}}if(-1===r)throw new Error("No valid cmap sub-tables found.");var o=new xg.Parser(e,t+r);if(n.format=o.parseUShort(),12===n.format)!function(e,t){var n;t.parseUShort(),e.length=t.parseULong(),e.language=t.parseULong(),e.groupCount=n=t.parseULong(),e.glyphIndexMap={};for(var r=0;r<n;r+=1)for(var i=t.parseULong(),s=t.parseULong(),a=t.parseULong(),o=i;o<=s;o+=1)e.glyphIndexMap[o]=a,a++}(n,o);else{if(4!==n.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+n.format+").");!function(e,t,n,r,i){var s;e.length=t.parseUShort(),e.language=t.parseUShort(),e.segCount=s=t.parseUShort()>>1,t.skip("uShort",3),e.glyphIndexMap={};for(var a=new xg.Parser(n,r+i+14),o=new xg.Parser(n,r+i+16+2*s),c=new xg.Parser(n,r+i+16+4*s),l=new xg.Parser(n,r+i+16+6*s),u=r+i+16+8*s,h=0;h<s-1;h+=1)for(var d=void 0,f=a.parseUShort(),p=o.parseUShort(),g=c.parseShort(),m=l.parseUShort(),y=p;y<=f;y+=1)0!==m?(u=l.offset+l.relativeOffset-2,u+=m,u+=2*(y-p),0!==(d=xg.getUShort(n,u))&&(d=d+g&65535)):d=y+g&65535,e.glyphIndexMap[y]=d}(n,o,e,t,r)}return n},kg=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],Tg=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],_g=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],Cg=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function Ag(e){this.font=e}function Fg(e){this.cmap=e}function Rg(e,t){this.encoding=e,this.charset=t}function Mg(e){switch(e.version){case 1:this.names=Cg.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<Cg.length?this.names[t]=Cg[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-Cg.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var n=0;n<e.numberOfGlyphs;n++)this.names[n]=Cg[n+e.glyphNameIndex[n]];break;default:this.names=[]}}Ag.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),n=this.font.glyphs;if(n)for(var r=0;r<n.length;r+=1)for(var i=n.get(r),s=0;s<i.unicodes.length;s+=1)if(i.unicodes[s]===t)return r;return null},Fg.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},Rg.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),n=this.encoding[t];return this.charset.indexOf(n)},Mg.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},Mg.prototype.glyphIndexToName=function(e){return this.names[e]};var Dg=function(e,t,n,r,i){e.beginPath(),e.moveTo(t,n),e.lineTo(r,i),e.stroke()};function Og(e){this.bindConstructorValues(e)}function Pg(e,t,n){Object.defineProperty(e,t,{get:function(){return e.path,e[n]},set:function(t){e[n]=t},enumerable:!0,configurable:!0})}function Ng(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];r.path.unitsPerEm=e.unitsPerEm,this.glyphs[n]=r}this.length=t&&t.length||0}Og.prototype.bindConstructorValues=function(e){var t,n;this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],"xMin"in e&&(this.xMin=e.xMin),"yMin"in e&&(this.yMin=e.yMin),"xMax"in e&&(this.xMax=e.xMax),"yMax"in e&&(this.yMax=e.yMax),"advanceWidth"in e&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",(t=e.path,n=t||new Gp,{configurable:!0,get:function(){return"function"==typeof n&&(n=n()),n},set:function(e){n=e}}))},Og.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},Og.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},Og.prototype.getPath=function(e,t,n,r,i){var s,a;e=void 0!==e?e:0,t=void 0!==t?t:0,n=void 0!==n?n:72,r||(r={});var o=r.xScale,c=r.yScale;if(r.hinting&&i&&i.hinting&&(a=this.path&&i.hinting.exec(this,n)),a)s=i.hinting.getCommands(a),e=Math.round(e),t=Math.round(t),o=c=1;else{s=this.path.commands;var l=1/(this.path.unitsPerEm||1e3)*n;void 0===o&&(o=l),void 0===c&&(c=l)}for(var u=new Gp,h=0;h<s.length;h+=1){var d=s[h];"M"===d.type?u.moveTo(e+d.x*o,t+-d.y*c):"L"===d.type?u.lineTo(e+d.x*o,t+-d.y*c):"Q"===d.type?u.quadraticCurveTo(e+d.x1*o,t+-d.y1*c,e+d.x*o,t+-d.y*c):"C"===d.type?u.curveTo(e+d.x1*o,t+-d.y1*c,e+d.x2*o,t+-d.y2*c,e+d.x*o,t+-d.y*c):"Z"===d.type&&u.closePath()}return u},Og.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],n=0;n<this.points.length;n+=1){var r=this.points[n];t.push(r),r.lastPointOfContour&&(e.push(t),t=[])}return Wp.argument(0===t.length,"There are still points left in the current contour."),e},Og.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],n=[],r=0;r<e.length;r+=1){var i=e[r];"Z"!==i.type&&(t.push(i.x),n.push(i.y)),"Q"!==i.type&&"C"!==i.type||(t.push(i.x1),n.push(i.y1)),"C"===i.type&&(t.push(i.x2),n.push(i.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},Og.prototype.draw=function(e,t,n,r,i){this.getPath(t,n,r,i).draw(e)},Og.prototype.drawPoints=function(e,t,n,r){function i(t,n,r,i){e.beginPath();for(var s=0;s<t.length;s+=1)e.moveTo(n+t[s].x*i,r+t[s].y*i),e.arc(n+t[s].x*i,r+t[s].y*i,2,0,2*Math.PI,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,n=void 0!==n?n:0,r=void 0!==r?r:24;for(var s=1/this.path.unitsPerEm*r,a=[],o=[],c=this.path,l=0;l<c.commands.length;l+=1){var u=c.commands[l];void 0!==u.x&&a.push({x:u.x,y:-u.y}),void 0!==u.x1&&o.push({x:u.x1,y:-u.y1}),void 0!==u.x2&&o.push({x:u.x2,y:-u.y2})}e.fillStyle="blue",i(a,t,n,s),e.fillStyle="red",i(o,t,n,s)},Og.prototype.drawMetrics=function(e,t,n,r){var i;t=void 0!==t?t:0,n=void 0!==n?n:0,r=void 0!==r?r:24,i=1/this.path.unitsPerEm*r,e.lineWidth=1,e.strokeStyle="black",Dg(e,t,-1e4,t,1e4),Dg(e,-1e4,n,1e4,n);var s=this.xMin||0,a=this.yMin||0,o=this.xMax||0,c=this.yMax||0,l=this.advanceWidth||0;e.strokeStyle="blue",Dg(e,t+s*i,-1e4,t+s*i,1e4),Dg(e,t+o*i,-1e4,t+o*i,1e4),Dg(e,-1e4,n+-a*i,1e4,n+-a*i),Dg(e,-1e4,n+-c*i,1e4,n+-c*i),e.strokeStyle="green",Dg(e,t+l*i,-1e4,t+l*i,1e4)},Ng.prototype.get=function(e){if(void 0===this.glyphs[e]){this.font._push(e),"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());var t=this.glyphs[e],n=this.font._IndexToUnicodeMap[e];if(n)for(var r=0;r<n.unicodes.length;r++)t.addUnicode(n.unicodes[r]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+e:t.name=this.font.cffEncoding.charset[e]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(e)),this.glyphs[e].advanceWidth=this.font._hmtxTableData[e].advanceWidth,this.glyphs[e].leftSideBearing=this.font._hmtxTableData[e].leftSideBearing}else"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());return this.glyphs[e]},Ng.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var Lg={GlyphSet:Ng,glyphLoader:function(e,t){return new Og({index:t,font:e})},ttfGlyphLoader:function(e,t,n,r,i,s){return function(){var a=new Og({index:t,font:e});return a.path=function(){n(a,r,i);var t=s(e.glyphs,a);return t.unitsPerEm=e.unitsPerEm,t},Pg(a,"xMin","_xMin"),Pg(a,"xMax","_xMax"),Pg(a,"yMin","_yMin"),Pg(a,"yMax","_yMax"),a}},cffGlyphLoader:function(e,t,n,r){return function(){var i=new Og({index:t,font:e});return i.path=function(){var t=n(e,i,r);return t.unitsPerEm=e.unitsPerEm,t},i}}};function Bg(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n+=1)if(!Bg(e[n],t[n]))return!1;return!0}return!1}function Ug(e){return e.length<1240?107:e.length<33900?1131:32768}function Vg(e,t,n){var r,i,s=[],a=[],o=xg.getCard16(e,t);if(0!==o){var c=xg.getByte(e,t+2);r=t+(o+1)*c+2;for(var l=t+3,u=0;u<o+1;u+=1)s.push(xg.getOffset(e,l,c)),l+=c;i=r+s[o]}else i=t+2;for(var h=0;h<s.length-1;h+=1){var d=xg.getBytes(e,r+s[h],r+s[h+1]);n&&(d=n(d)),a.push(d)}return{objects:a,startOffset:t,endOffset:i}}function jg(e,t){if(28===t)return e.parseByte()<<8|e.parseByte();if(29===t)return e.parseByte()<<24|e.parseByte()<<16|e.parseByte()<<8|e.parseByte();if(30===t)return function(e){for(var t="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var r=e.parseByte(),i=r>>4,s=15&r;if(15===i)break;if(t+=n[i],15===s)break;t+=n[s]}return parseFloat(t)}(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return 256*(t-247)+e.parseByte()+108;if(t>=251&&t<=254)return 256*-(t-251)-e.parseByte()-108;throw new Error("Invalid b0 "+t)}function zg(e,t,n){t=void 0!==t?t:0;var r=new xg.Parser(e,t),i=[],s=[];for(n=void 0!==n?n:e.length;r.relativeOffset<n;){var a=r.parseByte();a<=21?(12===a&&(a=1200+r.parseByte()),i.push([a,s]),s=[]):s.push(jg(r,a))}return function(e){for(var t={},n=0;n<e.length;n+=1){var r,i=e[n][0],s=e[n][1];if(r=1===s.length?s[0]:s,t.hasOwnProperty(i)&&!isNaN(t[i]))throw new Error("Object "+t+" already has key "+i);t[i]=r}return t}(i)}function Gg(e,t){return t<=390?kg[t]:e[t-391]}function Hg(e,t,n){for(var r,i={},s=0;s<t.length;s+=1){var a=t[s];if(Array.isArray(a.type)){var o=[];o.length=a.type.length;for(var c=0;c<a.type.length;c++)void 0===(r=void 0!==e[a.op]?e[a.op][c]:void 0)&&(r=void 0!==a.value&&void 0!==a.value[c]?a.value[c]:null),"SID"===a.type[c]&&(r=Gg(n,r)),o[c]=r;i[a.name]=o}else void 0===(r=e[a.op])&&(r=void 0!==a.value?a.value:null),"SID"===a.type&&(r=Gg(n,r)),i[a.name]=r}return i}var $g=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Wg=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function qg(e,t){return Hg(zg(e,0,e.byteLength),$g,t)}function Xg(e,t,n,r){return Hg(zg(e,t,n),Wg,r)}function Yg(e,t,n,r){for(var i=[],s=0;s<n.length;s+=1){var a=qg(new DataView(new Uint8Array(n[s]).buffer),r);a._subrs=[],a._subrsBias=0,a._defaultWidthX=0,a._nominalWidthX=0;var o=a.private[0],c=a.private[1];if(0!==o&&0!==c){var l=Xg(e,c+t,o,r);if(a._defaultWidthX=l.defaultWidthX,a._nominalWidthX=l.nominalWidthX,0!==l.subrs){var u=Vg(e,c+l.subrs+t);a._subrs=u.objects,a._subrsBias=Ug(a._subrs)}a._privateDict=l}i.push(a)}return i}function Kg(e,t,n){var r,i,s,a,o,c,l,u,h=new Gp,d=[],f=0,p=!1,g=!1,m=0,y=0;if(e.isCIDFont){var b=e.tables.cff.topDict._fdSelect[t.index],w=e.tables.cff.topDict._fdArray[b];o=w._subrs,c=w._subrsBias,l=w._defaultWidthX,u=w._nominalWidthX}else o=e.tables.cff.topDict._subrs,c=e.tables.cff.topDict._subrsBias,l=e.tables.cff.topDict._defaultWidthX,u=e.tables.cff.topDict._nominalWidthX;var v=l;function S(e,t){g&&h.closePath(),h.moveTo(e,t),g=!0}function x(){d.length%2!=0&&!p&&(v=d.shift()+u),f+=d.length>>1,d.length=0,p=!0}return function n(l){for(var b,w,E,I,k,T,_,C,A,F,R,M,D=0;D<l.length;){var O=l[D];switch(D+=1,O){case 1:case 3:case 18:case 23:x();break;case 4:d.length>1&&!p&&(v=d.shift()+u,p=!0),y+=d.pop(),S(m,y);break;case 5:for(;d.length>0;)m+=d.shift(),y+=d.shift(),h.lineTo(m,y);break;case 6:for(;d.length>0&&(m+=d.shift(),h.lineTo(m,y),0!==d.length);)y+=d.shift(),h.lineTo(m,y);break;case 7:for(;d.length>0&&(y+=d.shift(),h.lineTo(m,y),0!==d.length);)m+=d.shift(),h.lineTo(m,y);break;case 8:for(;d.length>0;)r=m+d.shift(),i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),m=s+d.shift(),y=a+d.shift(),h.curveTo(r,i,s,a,m,y);break;case 10:k=d.pop()+c,(T=o[k])&&n(T);break;case 11:return;case 12:switch(O=l[D],D+=1,O){case 35:r=m+d.shift(),i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),_=s+d.shift(),C=a+d.shift(),A=_+d.shift(),F=C+d.shift(),R=A+d.shift(),M=F+d.shift(),m=R+d.shift(),y=M+d.shift(),d.shift(),h.curveTo(r,i,s,a,_,C),h.curveTo(A,F,R,M,m,y);break;case 34:r=m+d.shift(),i=y,s=r+d.shift(),a=i+d.shift(),_=s+d.shift(),C=a,A=_+d.shift(),F=a,R=A+d.shift(),M=y,m=R+d.shift(),h.curveTo(r,i,s,a,_,C),h.curveTo(A,F,R,M,m,y);break;case 36:r=m+d.shift(),i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),_=s+d.shift(),C=a,A=_+d.shift(),F=a,R=A+d.shift(),M=F+d.shift(),m=R+d.shift(),h.curveTo(r,i,s,a,_,C),h.curveTo(A,F,R,M,m,y);break;case 37:r=m+d.shift(),i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),_=s+d.shift(),C=a+d.shift(),A=_+d.shift(),F=C+d.shift(),R=A+d.shift(),M=F+d.shift(),Math.abs(R-m)>Math.abs(M-y)?m=R+d.shift():y=M+d.shift(),h.curveTo(r,i,s,a,_,C),h.curveTo(A,F,R,M,m,y);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+O),d.length=0}break;case 14:d.length>0&&!p&&(v=d.shift()+u,p=!0),g&&(h.closePath(),g=!1);break;case 19:case 20:x(),D+=f+7>>3;break;case 21:d.length>2&&!p&&(v=d.shift()+u,p=!0),y+=d.pop(),S(m+=d.pop(),y);break;case 22:d.length>1&&!p&&(v=d.shift()+u,p=!0),S(m+=d.pop(),y);break;case 24:for(;d.length>2;)r=m+d.shift(),i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),m=s+d.shift(),y=a+d.shift(),h.curveTo(r,i,s,a,m,y);m+=d.shift(),y+=d.shift(),h.lineTo(m,y);break;case 25:for(;d.length>6;)m+=d.shift(),y+=d.shift(),h.lineTo(m,y);r=m+d.shift(),i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),m=s+d.shift(),y=a+d.shift(),h.curveTo(r,i,s,a,m,y);break;case 26:for(d.length%2&&(m+=d.shift());d.length>0;)r=m,i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),m=s,y=a+d.shift(),h.curveTo(r,i,s,a,m,y);break;case 27:for(d.length%2&&(y+=d.shift());d.length>0;)r=m+d.shift(),i=y,s=r+d.shift(),a=i+d.shift(),m=s+d.shift(),y=a,h.curveTo(r,i,s,a,m,y);break;case 28:b=l[D],w=l[D+1],d.push((b<<24|w<<16)>>16),D+=2;break;case 29:k=d.pop()+e.gsubrsBias,(T=e.gsubrs[k])&&n(T);break;case 30:for(;d.length>0&&(r=m,i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),m=s+d.shift(),y=a+(1===d.length?d.shift():0),h.curveTo(r,i,s,a,m,y),0!==d.length);)r=m+d.shift(),i=y,s=r+d.shift(),a=i+d.shift(),y=a+d.shift(),m=s+(1===d.length?d.shift():0),h.curveTo(r,i,s,a,m,y);break;case 31:for(;d.length>0&&(r=m+d.shift(),i=y,s=r+d.shift(),a=i+d.shift(),y=a+d.shift(),m=s+(1===d.length?d.shift():0),h.curveTo(r,i,s,a,m,y),0!==d.length);)r=m,i=y+d.shift(),s=r+d.shift(),a=i+d.shift(),m=s+d.shift(),y=a+(1===d.length?d.shift():0),h.curveTo(r,i,s,a,m,y);break;default:O<32?console.log("Glyph "+t.index+": unknown operator "+O):O<247?d.push(O-139):O<251?(b=l[D],D+=1,d.push(256*(O-247)+b+108)):O<255?(b=l[D],D+=1,d.push(256*-(O-251)-b-108)):(b=l[D],w=l[D+1],E=l[D+2],I=l[D+3],D+=4,d.push((b<<24|w<<16|E<<8|I)/65536))}}}(n),t.advanceWidth=v,h}function Jg(e,t){var n,r=kg.indexOf(e);return r>=0&&(n=r),(r=t.indexOf(e))>=0?n=r+kg.length:(n=kg.length+t.length,t.push(e)),n}function Zg(e,t,n){for(var r={},i=0;i<e.length;i+=1){var s=e[i],a=t[s.name];void 0===a||Bg(a,s.value)||("SID"===s.type&&(a=Jg(a,n)),r[s.op]={name:s.name,type:s.type,value:a})}return r}function Qg(e,t){var n=new pg.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Zg($g,e,t),n}function em(e){var t=new pg.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function tm(e){var t=[],n=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var r=0,i=0,s=0;s<n.commands.length;s+=1){var a=void 0,o=void 0,c=n.commands[s];if("Q"===c.type){var l=1/3,u=2/3;c={type:"C",x:c.x,y:c.y,x1:Math.round(l*r+u*c.x1),y1:Math.round(l*i+u*c.y1),x2:Math.round(l*c.x+u*c.x1),y2:Math.round(l*c.y+u*c.y1)}}if("M"===c.type)a=Math.round(c.x-r),o=Math.round(c.y-i),t.push({name:"dx",type:"NUMBER",value:a}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rmoveto",type:"OP",value:21}),r=Math.round(c.x),i=Math.round(c.y);else if("L"===c.type)a=Math.round(c.x-r),o=Math.round(c.y-i),t.push({name:"dx",type:"NUMBER",value:a}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rlineto",type:"OP",value:5}),r=Math.round(c.x),i=Math.round(c.y);else if("C"===c.type){var h=Math.round(c.x1-r),d=Math.round(c.y1-i),f=Math.round(c.x2-c.x1),p=Math.round(c.y2-c.y1);a=Math.round(c.x-c.x2),o=Math.round(c.y-c.y2),t.push({name:"dx1",type:"NUMBER",value:h}),t.push({name:"dy1",type:"NUMBER",value:d}),t.push({name:"dx2",type:"NUMBER",value:f}),t.push({name:"dy2",type:"NUMBER",value:p}),t.push({name:"dx",type:"NUMBER",value:a}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rrcurveto",type:"OP",value:8}),r=Math.round(c.x),i=Math.round(c.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}var nm=function(e,t){var n={},r=new xg.Parser(e,t);return n.version=r.parseVersion(),n.fontRevision=Math.round(1e3*r.parseFixed())/1e3,n.checkSumAdjustment=r.parseULong(),n.magicNumber=r.parseULong(),Wp.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=r.parseUShort(),n.unitsPerEm=r.parseUShort(),n.created=r.parseLongDateTime(),n.modified=r.parseLongDateTime(),n.xMin=r.parseShort(),n.yMin=r.parseShort(),n.xMax=r.parseShort(),n.yMax=r.parseShort(),n.macStyle=r.parseUShort(),n.lowestRecPPEM=r.parseUShort(),n.fontDirectionHint=r.parseShort(),n.indexToLocFormat=r.parseShort(),n.glyphDataFormat=r.parseShort(),n},rm=function(e,t){var n={},r=new xg.Parser(e,t);return n.version=r.parseVersion(),n.ascender=r.parseShort(),n.descender=r.parseShort(),n.lineGap=r.parseShort(),n.advanceWidthMax=r.parseUShort(),n.minLeftSideBearing=r.parseShort(),n.minRightSideBearing=r.parseShort(),n.xMaxExtent=r.parseShort(),n.caretSlopeRise=r.parseShort(),n.caretSlopeRun=r.parseShort(),n.caretOffset=r.parseShort(),r.relativeOffset+=8,n.metricDataFormat=r.parseShort(),n.numberOfHMetrics=r.parseUShort(),n},im=function(e,t){var n=new xg.Parser(e,t),r=n.parseULong();Wp.argument(1===r,"Unsupported ltag table version."),n.skip("uLong",1);for(var i=n.parseULong(),s=[],a=0;a<i;a++){for(var o="",c=t+n.parseUShort(),l=n.parseUShort(),u=c;u<c+l;++u)o+=String.fromCharCode(e.getInt8(u));s.push(o)}return s},sm=function(e,t){var n={},r=new xg.Parser(e,t);return n.version=r.parseVersion(),n.numGlyphs=r.parseUShort(),1===n.version&&(n.maxPoints=r.parseUShort(),n.maxContours=r.parseUShort(),n.maxCompositePoints=r.parseUShort(),n.maxCompositeContours=r.parseUShort(),n.maxZones=r.parseUShort(),n.maxTwilightPoints=r.parseUShort(),n.maxStorage=r.parseUShort(),n.maxFunctionDefs=r.parseUShort(),n.maxInstructionDefs=r.parseUShort(),n.maxStackElements=r.parseUShort(),n.maxSizeOfInstructions=r.parseUShort(),n.maxComponentElements=r.parseUShort(),n.maxComponentDepth=r.parseUShort()),n},am=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],om={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},cm={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},lm={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function um(e,t,n){switch(e){case 0:if(65535===t)return"und";if(n)return n[t];break;case 1:return om[t];case 3:return lm[t]}}var hm="utf-16",dm={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},fm={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function pm(e,t,n){switch(e){case 0:return hm;case 1:return fm[n]||dm[t];case 3:if(1===t||10===t)return hm}}function gm(e){var t={};for(var n in e)t[e[n]]=parseInt(n);return t}function mm(e,t,n,r,i,s){return new pg.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:r},{name:"length",type:"USHORT",value:i},{name:"offset",type:"USHORT",value:s}])}function ym(e,t){var n=function(e,t){var n=e.length,r=t.length-n+1;e:for(var i=0;i<r;i++)for(;i<r;i++){for(var s=0;s<n;s++)if(t[i+s]!==e[s])continue e;return i}return-1}(e,t);if(n<0){n=t.length;for(var r=0,i=e.length;r<i;++r)t.push(e[r])}return n}var bm=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],wm=function(e,t){var n={},r=new xg.Parser(e,t);n.version=r.parseUShort(),n.xAvgCharWidth=r.parseShort(),n.usWeightClass=r.parseUShort(),n.usWidthClass=r.parseUShort(),n.fsType=r.parseUShort(),n.ySubscriptXSize=r.parseShort(),n.ySubscriptYSize=r.parseShort(),n.ySubscriptXOffset=r.parseShort(),n.ySubscriptYOffset=r.parseShort(),n.ySuperscriptXSize=r.parseShort(),n.ySuperscriptYSize=r.parseShort(),n.ySuperscriptXOffset=r.parseShort(),n.ySuperscriptYOffset=r.parseShort(),n.yStrikeoutSize=r.parseShort(),n.yStrikeoutPosition=r.parseShort(),n.sFamilyClass=r.parseShort(),n.panose=[];for(var i=0;i<10;i++)n.panose[i]=r.parseByte();return n.ulUnicodeRange1=r.parseULong(),n.ulUnicodeRange2=r.parseULong(),n.ulUnicodeRange3=r.parseULong(),n.ulUnicodeRange4=r.parseULong(),n.achVendID=String.fromCharCode(r.parseByte(),r.parseByte(),r.parseByte(),r.parseByte()),n.fsSelection=r.parseUShort(),n.usFirstCharIndex=r.parseUShort(),n.usLastCharIndex=r.parseUShort(),n.sTypoAscender=r.parseShort(),n.sTypoDescender=r.parseShort(),n.sTypoLineGap=r.parseShort(),n.usWinAscent=r.parseUShort(),n.usWinDescent=r.parseUShort(),n.version>=1&&(n.ulCodePageRange1=r.parseULong(),n.ulCodePageRange2=r.parseULong()),n.version>=2&&(n.sxHeight=r.parseShort(),n.sCapHeight=r.parseShort(),n.usDefaultChar=r.parseUShort(),n.usBreakChar=r.parseUShort(),n.usMaxContent=r.parseUShort()),n},vm=function(e){for(var t=0;t<bm.length;t+=1){var n=bm[t];if(e>=n.begin&&e<n.end)return t}return-1},Sm=function(e,t){var n={},r=new xg.Parser(e,t);switch(n.version=r.parseVersion(),n.italicAngle=r.parseFixed(),n.underlinePosition=r.parseShort(),n.underlineThickness=r.parseShort(),n.isFixedPitch=r.parseULong(),n.minMemType42=r.parseULong(),n.maxMemType42=r.parseULong(),n.minMemType1=r.parseULong(),n.maxMemType1=r.parseULong(),n.version){case 1:n.names=Cg.slice();break;case 2:n.numberOfGlyphs=r.parseUShort(),n.glyphNameIndex=new Array(n.numberOfGlyphs);for(var i=0;i<n.numberOfGlyphs;i++)n.glyphNameIndex[i]=r.parseUShort();n.names=[];for(var s=0;s<n.numberOfGlyphs;s++)if(n.glyphNameIndex[s]>=Cg.length){var a=r.parseChar();n.names.push(r.parseString(a))}break;case 2.5:n.numberOfGlyphs=r.parseUShort(),n.offset=new Array(n.numberOfGlyphs);for(var o=0;o<n.numberOfGlyphs;o++)n.offset[o]=r.parseChar()}return n},xm=new Array(9);xm[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(vg.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(vg.coverage),substitute:this.parseOffset16List()}:void Wp.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},xm[2]=function(){var e=this.parseUShort();return Wp.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(vg.coverage),sequences:this.parseListOfLists()}},xm[3]=function(){var e=this.parseUShort();return Wp.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(vg.coverage),alternateSets:this.parseListOfLists()}},xm[4]=function(){var e=this.parseUShort();return Wp.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(vg.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var Em={sequenceIndex:vg.uShort,lookupListIndex:vg.uShort};xm[5]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{substFormat:t,coverage:this.parsePointer(vg.coverage),ruleSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,Em)}})};if(2===t)return{substFormat:t,coverage:this.parsePointer(vg.coverage),classDef:this.parsePointer(vg.classDef),classSets:this.parseListOfLists(function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,Em)}})};if(3===t){var n=this.parseUShort(),r=this.parseUShort();return{substFormat:t,coverages:this.parseList(n,vg.pointer(vg.coverage)),lookupRecords:this.parseRecordList(r,Em)}}Wp.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},xm[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(vg.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Em)}})}:2===t?{substFormat:2,coverage:this.parsePointer(vg.coverage),backtrackClassDef:this.parsePointer(vg.classDef),inputClassDef:this.parsePointer(vg.classDef),lookaheadClassDef:this.parsePointer(vg.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(Em)}})}:3===t?{substFormat:3,backtrackCoverage:this.parseList(vg.pointer(vg.coverage)),inputCoverage:this.parseList(vg.pointer(vg.coverage)),lookaheadCoverage:this.parseList(vg.pointer(vg.coverage)),lookupRecords:this.parseRecordList(Em)}:void Wp.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},xm[7]=function(){var e=this.parseUShort();Wp.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1");var t=this.parseUShort(),n=new vg(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:t,extension:xm[t].call(n)}},xm[8]=function(){var e=this.parseUShort();return Wp.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(vg.coverage),backtrackCoverage:this.parseList(vg.pointer(vg.coverage)),lookaheadCoverage:this.parseList(vg.pointer(vg.coverage)),substitutes:this.parseUShortList()}};var Im=new Array(9);function km(e){return Math.log(e)/Math.log(2)|0}function Tm(e){for(;e.length%4!=0;)e.push(0);for(var t=0,n=0;n<e.length;n+=4)t+=(e[n]<<24)+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];return t%Math.pow(2,32)}function _m(e,t,n,r){return new pg.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==r?r:0}])}function Cm(e,t,n){for(var r=0;r<t.length;r+=1){var i=e.charToGlyphIndex(t[r]);if(i>0)return e.glyphs.get(i).getMetrics()}return n}function Am(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length}Im[1]=function(e){return 1===e.substFormat?new pg.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new pg.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new pg.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new pg.Coverage(e.coverage)}].concat(pg.ushortList("substitute",e.substitute)))},Im[2]=function(e){return Wp.assert(1===e.substFormat,"Lookup type 2 substFormat must be 1."),new pg.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new pg.Coverage(e.coverage)}].concat(pg.tableList("seqSet",e.sequences,function(e){return new pg.Table("sequenceSetTable",pg.ushortList("sequence",e))})))},Im[3]=function(e){return Wp.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new pg.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new pg.Coverage(e.coverage)}].concat(pg.tableList("altSet",e.alternateSets,function(e){return new pg.Table("alternateSetTable",pg.ushortList("alternate",e))})))},Im[4]=function(e){return Wp.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new pg.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new pg.Coverage(e.coverage)}].concat(pg.tableList("ligSet",e.ligatureSets,function(e){return new pg.Table("ligatureSetTable",pg.tableList("ligature",e,function(e){return new pg.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(pg.ushortList("component",e.components,e.components.length+1)))}))})))},Im[6]=function(e){if(1===e.substFormat){var t=new pg.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:e.substFormat},{name:"coverage",type:"TABLE",value:new pg.Coverage(e.coverage)}].concat(pg.tableList("chainRuleSet",e.chainRuleSets,function(e){return new pg.Table("chainRuleSetTable",pg.tableList("chainRule",e,function(e){var t=pg.ushortList("backtrackGlyph",e.backtrack,e.backtrack.length).concat(pg.ushortList("inputGlyph",e.input,e.input.length+1)).concat(pg.ushortList("lookaheadGlyph",e.lookahead,e.lookahead.length)).concat(pg.ushortList("substitution",[],e.lookupRecords.length));return e.lookupRecords.forEach(function(e,n){t=t.concat({name:"sequenceIndex"+n,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+n,type:"USHORT",value:e.lookupListIndex})}),new pg.Table("chainRuleTable",t)}))})));return t}if(2===e.substFormat)Wp.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(3===e.substFormat){var n=[{name:"substFormat",type:"USHORT",value:e.substFormat}];return n.push({name:"backtrackGlyphCount",type:"USHORT",value:e.backtrackCoverage.length}),e.backtrackCoverage.forEach(function(e,t){n.push({name:"backtrackCoverage"+t,type:"TABLE",value:new pg.Coverage(e)})}),n.push({name:"inputGlyphCount",type:"USHORT",value:e.inputCoverage.length}),e.inputCoverage.forEach(function(e,t){n.push({name:"inputCoverage"+t,type:"TABLE",value:new pg.Coverage(e)})}),n.push({name:"lookaheadGlyphCount",type:"USHORT",value:e.lookaheadCoverage.length}),e.lookaheadCoverage.forEach(function(e,t){n.push({name:"lookaheadCoverage"+t,type:"TABLE",value:new pg.Coverage(e)})}),n.push({name:"substitutionCount",type:"USHORT",value:e.lookupRecords.length}),e.lookupRecords.forEach(function(e,t){n=n.concat({name:"sequenceIndex"+t,type:"USHORT",value:e.sequenceIndex}).concat({name:"lookupListIndex"+t,type:"USHORT",value:e.lookupListIndex})}),new pg.Table("chainContextTable",n)}Wp.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function Fm(e,t){for(var n=0,r=e.length-1;n<=r;){var i=n+r>>>1,s=e[i].tag;if(s===t)return i;s<t?n=i+1:r=i-1}return-n-1}function Rm(e,t){for(var n=0,r=e.length-1;n<=r;){var i=n+r>>>1,s=e[i];if(s===t)return i;s<t?n=i+1:r=i-1}return-n-1}function Mm(e,t){for(var n,r=0,i=e.length-1;r<=i;){var s=r+i>>>1,a=(n=e[s]).start;if(a===t)return n;a<t?r=s+1:i=s-1}if(r>0)return t>(n=e[r-1]).end?0:n}function Dm(e,t){this.font=e,this.tableName=t}function Om(e){Dm.call(this,e,"gpos")}function Pm(e){Dm.call(this,e,"gsub")}function Nm(e,t){var n=e.length;if(n!==t.length)return!1;for(var r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Lm(e,t,n){for(var r=e.subtables,i=0;i<r.length;i++){var s=r[i];if(s.substFormat===t)return s}if(n)return r.push(n),n}function Bm(e,t){if(!e)throw t}function Um(e,t,n,r,i){var s;return(t&r)>0?(s=e.parseByte(),t&i||(s=-s),s=n+s):s=(t&i)>0?n:n+e.parseShort(),s}function Vm(e,t,n){var r,i,s=new xg.Parser(t,n);if(e.numberOfContours=s.parseShort(),e._xMin=s.parseShort(),e._yMin=s.parseShort(),e._xMax=s.parseShort(),e._yMax=s.parseShort(),e.numberOfContours>0){for(var a=e.endPointIndices=[],o=0;o<e.numberOfContours;o+=1)a.push(s.parseUShort());e.instructionLength=s.parseUShort(),e.instructions=[];for(var c=0;c<e.instructionLength;c+=1)e.instructions.push(s.parseByte());var l=a[a.length-1]+1;r=[];for(var u=0;u<l;u+=1)if(i=s.parseByte(),r.push(i),(8&i)>0)for(var h=s.parseByte(),d=0;d<h;d+=1)r.push(i),u+=1;if(Wp.argument(r.length===l,"Bad flags."),a.length>0){var f,p=[];if(l>0){for(var g=0;g<l;g+=1)i=r[g],(f={}).onCurve=!!(1&i),f.lastPointOfContour=a.indexOf(g)>=0,p.push(f);for(var m=0,y=0;y<l;y+=1)i=r[y],(f=p[y]).x=Um(s,i,m,2,16),m=f.x;for(var b=0,w=0;w<l;w+=1)i=r[w],(f=p[w]).y=Um(s,i,b,4,32),b=f.y}e.points=p}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var v=!0;v;){r=s.parseUShort();var S={glyphIndex:s.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&r)>0?(2&r)>0?(S.dx=s.parseShort(),S.dy=s.parseShort()):S.matchedPoints=[s.parseUShort(),s.parseUShort()]:(2&r)>0?(S.dx=s.parseChar(),S.dy=s.parseChar()):S.matchedPoints=[s.parseByte(),s.parseByte()],(8&r)>0?S.xScale=S.yScale=s.parseF2Dot14():(64&r)>0?(S.xScale=s.parseF2Dot14(),S.yScale=s.parseF2Dot14()):(128&r)>0&&(S.xScale=s.parseF2Dot14(),S.scale01=s.parseF2Dot14(),S.scale10=s.parseF2Dot14(),S.yScale=s.parseF2Dot14()),e.components.push(S),v=!!(32&r)}if(256&r){e.instructionLength=s.parseUShort(),e.instructions=[];for(var x=0;x<e.instructionLength;x+=1)e.instructions.push(s.parseByte())}}}function jm(e,t){for(var n=[],r=0;r<e.length;r+=1){var i=e[r],s={x:t.xScale*i.x+t.scale01*i.y+t.dx,y:t.scale10*i.x+t.yScale*i.y+t.dy,onCurve:i.onCurve,lastPointOfContour:i.lastPointOfContour};n.push(s)}return n}function zm(e){var t=new Gp;if(!e)return t;for(var n=function(e){for(var t=[],n=[],r=0;r<e.length;r+=1){var i=e[r];n.push(i),i.lastPointOfContour&&(t.push(n),n=[])}return Wp.argument(0===n.length,"There are still points left in the current contour."),t}(e),r=0;r<n.length;++r){var i=n[r],s=null,a=i[i.length-1],o=i[0];if(a.onCurve)t.moveTo(a.x,a.y);else if(o.onCurve)t.moveTo(o.x,o.y);else{var c={x:.5*(a.x+o.x),y:.5*(a.y+o.y)};t.moveTo(c.x,c.y)}for(var l=0;l<i.length;++l)if(s=a,a=o,o=i[(l+1)%i.length],a.onCurve)t.lineTo(a.x,a.y);else{var u=o;s.onCurve||(a.x,s.x,a.y,s.y),o.onCurve||(u={x:.5*(a.x+o.x),y:.5*(a.y+o.y)}),t.quadraticCurveTo(a.x,a.y,u.x,u.y)}t.closePath()}return t}function Gm(e,t){if(t.isComposite)for(var n=0;n<t.components.length;n+=1){var r=t.components[n],i=e.get(r.glyphIndex);if(i.getPath(),i.points){var s=void 0;if(void 0===r.matchedPoints)s=jm(i.points,r);else{if(r.matchedPoints[0]>t.points.length-1||r.matchedPoints[1]>i.points.length-1)throw Error("Matched points out of range in "+t.name);var a=t.points[r.matchedPoints[0]],o=i.points[r.matchedPoints[1]],c={xScale:r.xScale,scale01:r.scale01,scale10:r.scale10,yScale:r.yScale,dx:0,dy:0};o=jm([o],c)[0],c.dx=a.x-o.x,c.dy=a.y-o.y,s=jm(i.points,c)}t.points=t.points.concat(s)}}return zm(t.points)}Dm.prototype={searchTag:Fm,binSearch:Rm,getTable:function(e){var t=this.font.tables[this.tableName];return!t&&e&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map(function(e){return e.tag}):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,n=0;n<e.scripts.length;n++){var r=e.scripts[n].tag;if("DFLT"===r)return r;"latn"===r&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var n=this.getTable(t);if(n){e=e||"DFLT";var r=n.scripts,i=Fm(n.scripts,e);if(i>=0)return r[i].script;if(t){var s={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return r.splice(-1-i,0,s),s.script}}},getLangSysTable:function(e,t,n){var r=this.getScriptTable(e,n);if(r){if(!t||"dflt"===t||"DFLT"===t)return r.defaultLangSys;var i=Fm(r.langSysRecords,t);if(i>=0)return r.langSysRecords[i].langSys;if(n){var s={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return r.langSysRecords.splice(-1-i,0,s),s.langSys}}},getFeatureTable:function(e,t,n,r){var i=this.getLangSysTable(e,t,r);if(i){for(var s,a=i.featureIndexes,o=this.font.tables[this.tableName].features,c=0;c<a.length;c++)if((s=o[a[c]]).tag===n)return s.feature;if(r){var l=o.length;return Wp.assert(0===l||n>=o[l-1].tag,"Features must be added in alphabetical order."),s={tag:n,feature:{params:0,lookupListIndexes:[]}},o.push(s),a.push(l),s.feature}}},getLookupTables:function(e,t,n,r,i){var s=this.getFeatureTable(e,t,n,i),a=[];if(s){for(var o,c=s.lookupListIndexes,l=this.font.tables[this.tableName].lookups,u=0;u<c.length;u++)(o=l[c[u]]).lookupType===r&&a.push(o);if(0===a.length&&i){o={lookupType:r,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=l.length;return l.push(o),c.push(h),[o]}}return a},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var n=Mm(e.ranges,t);return n?n.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var n=Rm(e.glyphs,t);return n>=0?n:-1;case 2:var r=Mm(e.ranges,t);return r?r.index+t-r.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],n=e.ranges,r=0;r<n.length;r++)for(var i=n[r],s=i.start,a=i.end,o=s;o<=a;o++)t.push(o);return t}},Om.prototype=Dm.prototype,Om.prototype.init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},Om.prototype.getKerningValue=function(e,t,n){for(var r=0;r<e.length;r++)for(var i=e[r].subtables,s=0;s<i.length;s++){var a=i[s],o=this.getCoverageIndex(a.coverage,t);if(!(o<0))switch(a.posFormat){case 1:for(var c=a.pairSets[o],l=0;l<c.length;l++){var u=c[l];if(u.secondGlyph===n)return u.value1&&u.value1.xAdvance||0}break;case 2:var h=this.getGlyphClass(a.classDef1,t),d=this.getGlyphClass(a.classDef2,n),f=a.classRecords[h][d];return f.value1&&f.value1.xAdvance||0}}return 0},Om.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},Pm.prototype=Dm.prototype,Pm.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Pm.prototype.getSingle=function(e,t,n){for(var r=[],i=this.getLookupTables(t,n,e,1),s=0;s<i.length;s++)for(var a=i[s].subtables,o=0;o<a.length;o++){var c=a[o],l=this.expandCoverage(c.coverage),u=void 0;if(1===c.substFormat){var h=c.deltaGlyphId;for(u=0;u<l.length;u++){var d=l[u];r.push({sub:d,by:d+h})}}else{var f=c.substitute;for(u=0;u<l.length;u++)r.push({sub:l[u],by:f[u]})}}return r},Pm.prototype.getMultiple=function(e,t,n){for(var r=[],i=this.getLookupTables(t,n,e,2),s=0;s<i.length;s++)for(var a=i[s].subtables,o=0;o<a.length;o++){var c=a[o],l=this.expandCoverage(c.coverage),u=void 0;for(u=0;u<l.length;u++){var h=l[u],d=c.sequences[u];r.push({sub:h,by:d})}}return r},Pm.prototype.getAlternates=function(e,t,n){for(var r=[],i=this.getLookupTables(t,n,e,3),s=0;s<i.length;s++)for(var a=i[s].subtables,o=0;o<a.length;o++)for(var c=a[o],l=this.expandCoverage(c.coverage),u=c.alternateSets,h=0;h<l.length;h++)r.push({sub:l[h],by:u[h]});return r},Pm.prototype.getLigatures=function(e,t,n){for(var r=[],i=this.getLookupTables(t,n,e,4),s=0;s<i.length;s++)for(var a=i[s].subtables,o=0;o<a.length;o++)for(var c=a[o],l=this.expandCoverage(c.coverage),u=c.ligatureSets,h=0;h<l.length;h++)for(var d=l[h],f=u[h],p=0;p<f.length;p++){var g=f[p];r.push({sub:[d].concat(g.components),by:g.ligGlyph})}return r},Pm.prototype.addSingle=function(e,t,n,r){var i=Lm(this.getLookupTables(n,r,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Wp.assert(1===i.coverage.format,"Single: unable to modify coverage table format "+i.coverage.format);var s=t.sub,a=this.binSearch(i.coverage.glyphs,s);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,s),i.substitute.splice(a,0,0)),i.substitute[a]=t.by},Pm.prototype.addMultiple=function(e,t,n,r){Wp.assert(t.by instanceof Array&&t.by.length>1,'Multiple: "by" must be an array of two or more ids');var i=Lm(this.getLookupTables(n,r,e,2,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});Wp.assert(1===i.coverage.format,"Multiple: unable to modify coverage table format "+i.coverage.format);var s=t.sub,a=this.binSearch(i.coverage.glyphs,s);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,s),i.sequences.splice(a,0,0)),i.sequences[a]=t.by},Pm.prototype.addAlternate=function(e,t,n,r){var i=Lm(this.getLookupTables(n,r,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Wp.assert(1===i.coverage.format,"Alternate: unable to modify coverage table format "+i.coverage.format);var s=t.sub,a=this.binSearch(i.coverage.glyphs,s);a<0&&(a=-1-a,i.coverage.glyphs.splice(a,0,s),i.alternateSets.splice(a,0,0)),i.alternateSets[a]=t.by},Pm.prototype.addLigature=function(e,t,n,r){var i=this.getLookupTables(n,r,e,4,!0)[0],s=i.subtables[0];s||(s={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},i.subtables[0]=s),Wp.assert(1===s.coverage.format,"Ligature: unable to modify coverage table format "+s.coverage.format);var a=t.sub[0],o=t.sub.slice(1),c={ligGlyph:t.by,components:o},l=this.binSearch(s.coverage.glyphs,a);if(l>=0){for(var u=s.ligatureSets[l],h=0;h<u.length;h++)if(Nm(u[h].components,o))return;u.push(c)}else l=-1-l,s.coverage.glyphs.splice(l,0,a),s.ligatureSets.splice(l,0,[c])},Pm.prototype.getFeature=function(e,t,n){if(/ss\d\d/.test(e))return this.getSingle(e,t,n);switch(e){case"aalt":case"salt":return this.getSingle(e,t,n).concat(this.getAlternates(e,t,n));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,n);case"ccmp":return this.getMultiple(e,t,n).concat(this.getLigatures(e,t,n));case"stch":return this.getMultiple(e,t,n)}},Pm.prototype.add=function(e,t,n,r){if(/ss\d\d/.test(e))return this.addSingle(e,t,n,r);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,n,r):this.addAlternate(e,t,n,r);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,n,r);case"ccmp":return t.by instanceof Array?this.addMultiple(e,t,n,r):this.addLigature(e,t,n,r)}};var Hm,$m,Wm,qm,Xm={getPath:zm,parse:function(e,t,n,r,i){return i.lowMemory?function(e,t,n,r){var i=new Lg.GlyphSet(r);return r._push=function(s){var a=n[s];a!==n[s+1]?i.push(s,Lg.ttfGlyphLoader(r,s,Vm,e,t+a,Gm)):i.push(s,Lg.glyphLoader(r,s))},i}(e,t,n,r):function(e,t,n,r){for(var i=new Lg.GlyphSet(r),s=0;s<n.length-1;s+=1){var a=n[s];a!==n[s+1]?i.push(s,Lg.ttfGlyphLoader(r,s,Vm,e,t+a,Gm)):i.push(s,Lg.glyphLoader(r,s))}return i}(e,t,n,r)}};function Ym(e){this.font=e,this.getCommands=function(e){return Xm.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Km(e){return e}function Jm(e){return Math.sign(e)*Math.round(Math.abs(e))}function Zm(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Qm(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function ey(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function ty(e){return Math.sign(e)*Math.floor(Math.abs(e))}var ny=function(e){var t=this.srPeriod,n=this.srPhase,r=1;return e<0&&(e=-e,r=-1),e+=this.srThreshold-n,e=Math.trunc(e/t)*t,(e+=n)<0?n*r:e*r},ry={x:1,y:0,axis:"x",distance:function(e,t,n,r){return(n?e.xo:e.x)-(r?t.xo:t.x)},interpolate:function(e,t,n,r){var i,s,a,o,c,l,u;if(!r||r===this)return i=e.xo-t.xo,s=e.xo-n.xo,c=t.x-t.xo,l=n.x-n.xo,0===(u=(a=Math.abs(i))+(o=Math.abs(s)))?void(e.x=e.xo+(c+l)/2):void(e.x=e.xo+(c*o+l*a)/u);i=r.distance(e,t,!0,!0),s=r.distance(e,n,!0,!0),c=r.distance(t,t,!1,!0),l=r.distance(n,n,!1,!0),0!==(u=(a=Math.abs(i))+(o=Math.abs(s)))?ry.setRelative(e,e,(c*o+l*a)/u,r,!0):ry.setRelative(e,e,(c+l)/2,r,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,n,r,i){if(r&&r!==this){var s=i?t.xo:t.x,a=i?t.yo:t.y,o=s+n*r.x,c=a+n*r.y;e.x=o+(e.y-c)/r.normalSlope}else e.x=(i?t.xo:t.x)+n},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},iy={x:0,y:1,axis:"y",distance:function(e,t,n,r){return(n?e.yo:e.y)-(r?t.yo:t.y)},interpolate:function(e,t,n,r){var i,s,a,o,c,l,u;if(!r||r===this)return i=e.yo-t.yo,s=e.yo-n.yo,c=t.y-t.yo,l=n.y-n.yo,0===(u=(a=Math.abs(i))+(o=Math.abs(s)))?void(e.y=e.yo+(c+l)/2):void(e.y=e.yo+(c*o+l*a)/u);i=r.distance(e,t,!0,!0),s=r.distance(e,n,!0,!0),c=r.distance(t,t,!1,!0),l=r.distance(n,n,!1,!0),0!==(u=(a=Math.abs(i))+(o=Math.abs(s)))?iy.setRelative(e,e,(c*o+l*a)/u,r,!0):iy.setRelative(e,e,(c+l)/2,r,!0)},normalSlope:0,setRelative:function(e,t,n,r,i){if(r&&r!==this){var s=i?t.xo:t.x,a=i?t.yo:t.y,o=s+n*r.x,c=a+n*r.y;e.y=c+r.normalSlope*(e.x-o)}else e.y=(i?t.yo:t.y)+n},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function sy(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function ay(e,t){var n=Math.sqrt(e*e+t*t);return t/=n,1==(e/=n)&&0===t?ry:0===e&&1===t?iy:new sy(e,t)}function oy(e,t,n,r){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=n,this.onCurve=r,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(ry),Object.freeze(iy),sy.prototype.distance=function(e,t,n,r){return this.x*ry.distance(e,t,n,r)+this.y*iy.distance(e,t,n,r)},sy.prototype.interpolate=function(e,t,n,r){var i,s,a,o,c,l,u;a=r.distance(e,t,!0,!0),o=r.distance(e,n,!0,!0),i=r.distance(t,t,!1,!0),s=r.distance(n,n,!1,!0),0!==(u=(c=Math.abs(a))+(l=Math.abs(o)))?this.setRelative(e,e,(i*l+s*c)/u,r,!0):this.setRelative(e,e,(i+s)/2,r,!0)},sy.prototype.setRelative=function(e,t,n,r,i){r=r||this;var s=i?t.xo:t.x,a=i?t.yo:t.y,o=s+n*r.x,c=a+n*r.y,l=r.normalSlope,u=this.slope,h=e.x,d=e.y;e.x=(u*h-l*o+c-d)/(u-l),e.y=u*(e.x-h)+d},sy.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},oy.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},oy.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var cy=Object.freeze(new oy(0,0)),ly={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function uy(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=ry,this.round=Jm}}function hy(e){for(var t=e.tZone=new Array(e.gZone.length),n=0;n<t.length;n++)t[n]=new oy(0,0)}function dy(e,t){var n,r=e.prog,i=e.ip,s=1;do{if(88===(n=r[++i]))s++;else if(89===n)s--;else if(64===n)i+=r[i+1]+1;else if(65===n)i+=2*r[i+1]+1;else if(n>=176&&n<=183)i+=n-176+1;else if(n>=184&&n<=191)i+=2*(n-184+1);else if(t&&1===s&&27===n)break}while(s>0);e.ip=i}function fy(e,t){exports.DEBUG&&console.log(t.step,"SVTCA["+e.axis+"]"),t.fv=t.pv=t.dpv=e}function py(e,t){exports.DEBUG&&console.log(t.step,"SPVTCA["+e.axis+"]"),t.pv=t.dpv=e}function gy(e,t){exports.DEBUG&&console.log(t.step,"SFVTCA["+e.axis+"]"),t.fv=e}function my(e,t){var n,r,i=t.stack,s=i.pop(),a=i.pop(),o=t.z2[s],c=t.z1[a];exports.DEBUG&&console.log("SPVTL["+e+"]",s,a),e?(n=o.y-c.y,r=c.x-o.x):(n=c.x-o.x,r=c.y-o.y),t.pv=t.dpv=ay(n,r)}function yy(e,t){var n,r,i=t.stack,s=i.pop(),a=i.pop(),o=t.z2[s],c=t.z1[a];exports.DEBUG&&console.log("SFVTL["+e+"]",s,a),e?(n=o.y-c.y,r=c.x-o.x):(n=c.x-o.x,r=c.y-o.y),t.fv=ay(n,r)}function by(e){exports.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function wy(e,t){var n=t.stack.pop(),r=t.z0[n],i=t.fv,s=t.pv;exports.DEBUG&&console.log(t.step,"MDAP["+e+"]",n);var a=s.distance(r,cy);e&&(a=t.round(a)),i.setRelative(r,cy,a,s),i.touch(r),t.rp0=t.rp1=n}function vy(e,t){var n,r,i,s=t.z2,a=s.length-2;exports.DEBUG&&console.log(t.step,"IUP["+e.axis+"]");for(var o=0;o<a;o++)n=s[o],e.touched(n)||(r=n.prevTouched(e))!==n&&(r===(i=n.nextTouched(e))&&e.setRelative(n,n,e.distance(r,r,!1,!0),e,!0),e.interpolate(n,r,i,e))}function Sy(e,t){for(var n=t.stack,r=e?t.rp1:t.rp2,i=(e?t.z0:t.z1)[r],s=t.fv,a=t.pv,o=t.loop,c=t.z2;o--;){var l=n.pop(),u=c[l],h=a.distance(i,i,!1,!0);s.setRelative(u,u,h,a),s.touch(u),exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-o)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",l)}t.loop=1}function xy(e,t){var n=t.stack,r=e?t.rp1:t.rp2,i=(e?t.z0:t.z1)[r],s=t.fv,a=t.pv,o=n.pop(),c=t.z2[t.contours[o]],l=c;exports.DEBUG&&console.log(t.step,"SHC["+e+"]",o);var u=a.distance(i,i,!1,!0);do{l!==i&&s.setRelative(l,l,u,a),l=l.nextPointOnContour}while(l!==c)}function Ey(e,t){var n,r,i=t.stack,s=e?t.rp1:t.rp2,a=(e?t.z0:t.z1)[s],o=t.fv,c=t.pv,l=i.pop();switch(exports.DEBUG&&console.log(t.step,"SHZ["+e+"]",l),l){case 0:n=t.tZone;break;case 1:n=t.gZone;break;default:throw new Error("Invalid zone")}for(var u=c.distance(a,a,!1,!0),h=n.length-2,d=0;d<h;d++)r=n[d],o.setRelative(r,r,u,c)}function Iy(e,t){var n=t.stack,r=n.pop()/64,i=n.pop(),s=t.z1[i],a=t.z0[t.rp0],o=t.fv,c=t.pv;o.setRelative(s,a,r,c),o.touch(s),exports.DEBUG&&console.log(t.step,"MSIRP["+e+"]",r,i),t.rp1=t.rp0,t.rp2=i,e&&(t.rp0=i)}function ky(e,t){var n=t.stack,r=n.pop(),i=n.pop(),s=t.z0[i],a=t.fv,o=t.pv,c=t.cvt[r];exports.DEBUG&&console.log(t.step,"MIAP["+e+"]",r,"(",c,")",i);var l=o.distance(s,cy);e&&(Math.abs(l-c)<t.cvCutIn&&(l=c),l=t.round(l)),a.setRelative(s,cy,l,o),0===t.zp0&&(s.xo=s.x,s.yo=s.y),a.touch(s),t.rp0=t.rp1=i}function Ty(e,t){var n=t.stack,r=n.pop(),i=t.z2[r];exports.DEBUG&&console.log(t.step,"GC["+e+"]",r),n.push(64*t.dpv.distance(i,cy,e,!1))}function _y(e,t){var n=t.stack,r=n.pop(),i=n.pop(),s=t.z1[r],a=t.z0[i],o=t.dpv.distance(a,s,e,e);exports.DEBUG&&console.log(t.step,"MD["+e+"]",r,i,"->",o),t.stack.push(Math.round(64*o))}function Cy(e,t){var n=t.stack,r=n.pop(),i=t.fv,s=t.pv,a=t.ppem,o=t.deltaBase+16*(e-1),c=t.deltaShift,l=t.z0;exports.DEBUG&&console.log(t.step,"DELTAP["+e+"]",r,n);for(var u=0;u<r;u++){var h=n.pop(),d=n.pop();if(o+((240&d)>>4)===a){var f=(15&d)-8;f>=0&&f++,exports.DEBUG&&console.log(t.step,"DELTAPFIX",h,"by",f*c);var p=l[h];i.setRelative(p,p,f*c,s)}}}function Ay(e,t){var n=t.stack,r=n.pop();exports.DEBUG&&console.log(t.step,"ROUND[]"),n.push(64*t.round(r/64))}function Fy(e,t){var n=t.stack,r=n.pop(),i=t.ppem,s=t.deltaBase+16*(e-1),a=t.deltaShift;exports.DEBUG&&console.log(t.step,"DELTAC["+e+"]",r,n);for(var o=0;o<r;o++){var c=n.pop(),l=n.pop();if(s+((240&l)>>4)===i){var u=(15&l)-8;u>=0&&u++;var h=u*a;exports.DEBUG&&console.log(t.step,"DELTACFIX",c,"by",h),t.cvt[c]+=h}}}function Ry(e,t){var n,r,i=t.stack,s=i.pop(),a=i.pop(),o=t.z2[s],c=t.z1[a];exports.DEBUG&&console.log(t.step,"SDPVTL["+e+"]",s,a),e?(n=o.y-c.y,r=c.x-o.x):(n=c.x-o.x,r=c.y-o.y),t.dpv=ay(n,r)}function My(e,t){var n=t.stack,r=t.prog,i=t.ip;exports.DEBUG&&console.log(t.step,"PUSHB["+e+"]");for(var s=0;s<e;s++)n.push(r[++i]);t.ip=i}function Dy(e,t){var n=t.ip,r=t.prog,i=t.stack;exports.DEBUG&&console.log(t.ip,"PUSHW["+e+"]");for(var s=0;s<e;s++){var a=r[++n]<<8|r[++n];32768&a&&(a=-(1+(65535^a))),i.push(a)}t.ip=n}function Oy(e,t,n,r,i,s){var a,o,c,l,u=s.stack,h=e&&u.pop(),d=u.pop(),f=s.rp0,p=s.z0[f],g=s.z1[d],m=s.minDis,y=s.fv,b=s.dpv;c=(o=a=b.distance(g,p,!0,!0))>=0?1:-1,o=Math.abs(o),e&&(l=s.cvt[h],r&&Math.abs(o-l)<s.cvCutIn&&(o=l)),n&&o<m&&(o=m),r&&(o=s.round(o)),y.setRelative(g,p,c*o,b),y.touch(g),exports.DEBUG&&console.log(s.step,(e?"MIRP[":"MDRP[")+(t?"M":"m")+(n?">":"_")+(r?"R":"_")+(0===i?"Gr":1===i?"Bl":2===i?"Wh":"")+"]",e?h+"("+s.cvt[h]+","+l+")":"",d,"(d =",a,"->",c*o,")"),s.rp1=s.rp0,s.rp2=d,t&&(s.rp0=d)}function Py(e){this.char=e,this.state={},this.activeState=null}function Ny(e,t,n){this.contextName=n,this.startIndex=e,this.endOffset=t}function Ly(e,t,n){this.contextName=e,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=n}function By(e,t){this.context=e,this.index=t,this.length=e.length,this.current=e[t],this.backtrack=e.slice(0,t),this.lookahead=e.slice(t+1)}function Uy(e){this.eventId=e,this.subscribers=[]}function Vy(e){var t=this,n=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];n.forEach(function(e){Object.defineProperty(t.events,e,{value:new Uy(e)})}),e&&n.forEach(function(n){var r=e[n];"function"==typeof r&&t.events[n].subscribe(r)}),["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach(function(e){t.events[e].subscribe(t.updateContextsRanges)})}function jy(e){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Vy.call(this,e)}function zy(e){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(e)}function Gy(e){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(e)}function Hy(e){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(e)}function $y(e){return/[A-z]/.test(e)}function Wy(e){this.font=e,this.features={}}function qy(e){this.id=e.id,this.tag=e.tag,this.substitution=e.substitution}function Xy(e,t){if(!e)return-1;switch(t.format){case 1:return t.glyphs.indexOf(e);case 2:for(var n=t.ranges,r=0;r<n.length;r++){var i=n[r];if(e>=i.start&&e<=i.end){var s=e-i.start;return i.index+s}}break;default:return-1}return-1}function Yy(e,t){return-1===Xy(e,t.coverage)?null:e+t.deltaGlyphId}function Ky(e,t){var n=Xy(e,t.coverage);return-1===n?null:t.substitute[n]}function Jy(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],s=t.current,a=Xy(s=Array.isArray(s)?s[0]:s,i);-1!==a&&n.push(a)}return n.length!==e.length?-1:n}function Zy(e,t){var n=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(e.context.length<n)return[];var r=Jy(t.inputCoverage,e);if(-1===r)return[];var i=t.inputCoverage.length-1;if(e.lookahead.length<t.lookaheadCoverage.length)return[];for(var s=e.lookahead.slice(i);s.length&&Hy(s[0].char);)s.shift();var a=new By(s,0),o=Jy(t.lookaheadCoverage,a),c=[].concat(e.backtrack);for(c.reverse();c.length&&Hy(c[0].char);)c.shift();if(c.length<t.backtrackCoverage.length)return[];var l=new By(c,0),u=Jy(t.backtrackCoverage,l),h=[];if(r.length===t.inputCoverage.length&&o.length===t.lookaheadCoverage.length&&u.length===t.backtrackCoverage.length)for(var d=0;d<t.lookupRecords.length;d++)for(var f=t.lookupRecords[d].lookupListIndex,p=this.getLookupByIndex(f),g=0;g<p.subtables.length;g++){var m=p.subtables[g],y=this.getLookupMethod(p,m);if("12"===this.getSubstitutionType(p,m))for(var b=0;b<r.length;b++){var w=y(e.get(b));w&&h.push(w)}}return h}function Qy(e,t){var n,r=Xy(e.current,t.coverage);if(-1===r)return null;for(var i=t.ligatureSets[r],s=0;s<i.length;s++){n=i[s];for(var a=0;a<n.components.length&&e.lookahead[a]===n.components[a];a++)if(a===n.components.length-1)return n}return null}function eb(e,t){var n=Xy(e,t.coverage);return-1===n?null:t.sequences[n]}Ym.prototype.exec=function(e,t){if("number"!=typeof t)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var n=this.font,r=this._prepState;if(!r||r.ppem!==t){var i=this._fpgmState;if(!i){uy.prototype=ly,(i=this._fpgmState=new uy("fpgm",n.tables.fpgm)).funcs=[],i.font=n,exports.DEBUG&&(console.log("---EXEC FPGM---"),i.step=-1);try{$m(i)}catch(e){return console.log("Hinting error in FPGM:"+e),void(this._errorState=3)}}uy.prototype=i,(r=this._prepState=new uy("prep",n.tables.prep)).ppem=t;var s=n.tables.cvt;if(s)for(var a=r.cvt=new Array(s.length),o=t/n.unitsPerEm,c=0;c<s.length;c++)a[c]=s[c]*o;else r.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),r.step=-1);try{$m(r)}catch(e){this._errorState<2&&console.log("Hinting error in PREP:"+e),this._errorState=2}}if(!(this._errorState>1))try{return Wm(e,r)}catch(e){return this._errorState<1&&(console.log("Hinting error:"+e),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},Wm=function(e,t){var n,r,i,s=t.ppem/t.font.unitsPerEm,a=s,o=e.components;if(uy.prototype=t,o){var c=t.font;r=[],n=[];for(var l=0;l<o.length;l++){var u=o[l],h=c.glyphs.get(u.glyphIndex);i=new uy("glyf",h.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+l+"---"),i.step=-1),qm(h,i,s,a);for(var d=Math.round(u.dx*s),f=Math.round(u.dy*a),p=i.gZone,g=i.contours,m=0;m<p.length;m++){var y=p[m];y.xTouched=y.yTouched=!1,y.xo=y.x=y.x+d,y.yo=y.y=y.y+f}var b=r.length;r.push.apply(r,p);for(var w=0;w<g.length;w++)n.push(g[w]+b)}e.instructions&&!i.inhibitGridFit&&((i=new uy("glyf",e.instructions)).gZone=i.z0=i.z1=i.z2=r,i.contours=n,r.push(new oy(0,0),new oy(Math.round(e.advanceWidth*s),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),i.step=-1),$m(i),r.length-=2)}else i=new uy("glyf",e.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),i.step=-1),qm(e,i,s,a),r=i.gZone;return r},qm=function(e,t,n,r){for(var i,s,a,o=e.points||[],c=o.length,l=t.gZone=t.z0=t.z1=t.z2=[],u=t.contours=[],h=0;h<c;h++)i=o[h],l[h]=new oy(i.x*n,i.y*r,i.lastPointOfContour,i.onCurve);for(var d=0;d<c;d++)i=l[d],s||(s=i,u.push(d)),i.lastPointOfContour?(i.nextPointOnContour=s,s.prevPointOnContour=i,s=void 0):(a=l[d+1],i.nextPointOnContour=a,a.prevPointOnContour=i);if(!t.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(var f=0;f<c;f++)console.log(f,l[f].x,l[f].y)}if(l.push(new oy(0,0),new oy(Math.round(e.advanceWidth*n),0)),$m(t),l.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",t.stack);for(var p=0;p<c;p++)console.log(p,l[p].x,l[p].y)}}},$m=function(e){var t=e.prog;if(t){var n,r=t.length;for(e.ip=0;e.ip<r;e.ip++){if(exports.DEBUG&&e.step++,!(n=Hm[t[e.ip]]))throw new Error("unknown instruction: 0x"+Number(t[e.ip]).toString(16));n(e)}}},Hm=[fy.bind(void 0,iy),fy.bind(void 0,ry),py.bind(void 0,iy),py.bind(void 0,ry),gy.bind(void 0,iy),gy.bind(void 0,ry),my.bind(void 0,0),my.bind(void 0,1),yy.bind(void 0,0),yy.bind(void 0,1),function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",n,r),e.pv=e.dpv=ay(r,n)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",n,r),e.fv=ay(r,n)},function(e){var t=e.stack,n=e.pv;exports.DEBUG&&console.log(e.step,"GPV[]"),t.push(16384*n.x),t.push(16384*n.y)},function(e){var t=e.stack,n=e.fv;exports.DEBUG&&console.log(e.step,"GFV[]"),t.push(16384*n.x),t.push(16384*n.y)},function(e){e.fv=e.pv,exports.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){var t=e.stack,n=t.pop(),r=t.pop(),i=t.pop(),s=t.pop(),a=t.pop(),o=e.z0,c=e.z1,l=o[n],u=o[r],h=c[i],d=c[s],f=e.z2[a];exports.DEBUG&&console.log("ISECT[], ",n,r,i,s,a);var p=l.x,g=l.y,m=u.x,y=u.y,b=h.x,w=h.y,v=d.x,S=d.y,x=(p-m)*(w-S)-(g-y)*(b-v),E=p*y-g*m,I=b*S-w*v;f.x=(E*(b-v)-I*(p-m))/x,f.y=(E*(w-S)-I*(g-y))/x},function(e){e.rp0=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP0[]",t),e.zp0=t,t){case 0:e.tZone||hy(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP1[]",t),e.zp1=t,t){case 0:e.tZone||hy(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP2[]",t),e.zp2=t,t){case 0:e.tZone||hy(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZPS[]",t),e.zp0=e.zp1=e.zp2=t,t){case 0:e.tZone||hy(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){exports.DEBUG&&console.log(e.step,"RTG[]"),e.round=Jm},function(e){exports.DEBUG&&console.log(e.step,"RTHG[]"),e.round=Qm},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SMD[]",t),e.minDis=t/64},function(e){exports.DEBUG&&console.log(e.step,"ELSE[]"),dy(e,!1)},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"JMPR[]",t),e.ip+=t-1},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCVTCI[]",t),e.cvCutIn=t/64},void 0,void 0,function(e){var t=e.stack;exports.DEBUG&&console.log(e.step,"DUP[]"),t.push(t[t.length-1])},by,function(e){exports.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"SWAP[]"),t.push(n),t.push(r)},function(e){var t=e.stack;exports.DEBUG&&console.log(e.step,"DEPTH[]"),t.push(t.length)},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"CINDEX[]",n),t.push(t[t.length-n])},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"MINDEX[]",n),t.push(t.splice(t.length-n,1)[0])},void 0,void 0,void 0,function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"LOOPCALL[]",n,r);var i=e.ip,s=e.prog;e.prog=e.funcs[n];for(var a=0;a<r;a++)$m(e),exports.DEBUG&&console.log(++e.step,a+1<r?"next loopcall":"done loopcall",a);e.ip=i,e.prog=s},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"CALL[]",t);var n=e.ip,r=e.prog;e.prog=e.funcs[t],$m(e),e.ip=n,e.prog=r,exports.DEBUG&&console.log(++e.step,"returning from",t)},function(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var t=e.stack,n=e.prog,r=e.ip,i=t.pop(),s=r;for(exports.DEBUG&&console.log(e.step,"FDEF[]",i);45!==n[++r];);e.ip=r,e.funcs[i]=n.slice(s+1,r)},void 0,wy.bind(void 0,0),wy.bind(void 0,1),vy.bind(void 0,iy),vy.bind(void 0,ry),Sy.bind(void 0,0),Sy.bind(void 0,1),xy.bind(void 0,0),xy.bind(void 0,1),Ey.bind(void 0,0),Ey.bind(void 0,1),function(e){for(var t=e.stack,n=e.loop,r=e.fv,i=t.pop()/64,s=e.z2;n--;){var a=t.pop(),o=s[a];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"SHPIX[]",a,i),r.setRelative(o,o,i),r.touch(o)}e.loop=1},function(e){for(var t=e.stack,n=e.rp1,r=e.rp2,i=e.loop,s=e.z0[n],a=e.z1[r],o=e.fv,c=e.dpv,l=e.z2;i--;){var u=t.pop(),h=l[u];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-i)+": ":"")+"IP[]",u,n,"<->",r),o.interpolate(h,s,a,c),o.touch(h)}e.loop=1},Iy.bind(void 0,0),Iy.bind(void 0,1),function(e){for(var t=e.stack,n=e.rp0,r=e.z0[n],i=e.loop,s=e.fv,a=e.pv,o=e.z1;i--;){var c=t.pop(),l=o[c];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-i)+": ":"")+"ALIGNRP[]",c),s.setRelative(l,r,0,a),s.touch(l)}e.loop=1},function(e){exports.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Zm},ky.bind(void 0,0),ky.bind(void 0,1),function(e){var t=e.prog,n=e.ip,r=e.stack,i=t[++n];exports.DEBUG&&console.log(e.step,"NPUSHB[]",i);for(var s=0;s<i;s++)r.push(t[++n]);e.ip=n},function(e){var t=e.ip,n=e.prog,r=e.stack,i=n[++t];exports.DEBUG&&console.log(e.step,"NPUSHW[]",i);for(var s=0;s<i;s++){var a=n[++t]<<8|n[++t];32768&a&&(a=-(1+(65535^a))),r.push(a)}e.ip=t},function(e){var t=e.stack,n=e.store;n||(n=e.store=[]);var r=t.pop(),i=t.pop();exports.DEBUG&&console.log(e.step,"WS",r,i),n[i]=r},function(e){var t=e.stack,n=e.store,r=t.pop();exports.DEBUG&&console.log(e.step,"RS",r);var i=n&&n[r]||0;t.push(i)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"WCVTP",n,r),e.cvt[r]=n/64},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"RCVT",n),t.push(64*e.cvt[n])},Ty.bind(void 0,0),Ty.bind(void 0,1),void 0,_y.bind(void 0,0),_y.bind(void 0,1),function(e){exports.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){exports.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"LT[]",n,r),t.push(r<n?1:0)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"LTEQ[]",n,r),t.push(r<=n?1:0)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"GT[]",n,r),t.push(r>n?1:0)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"GTEQ[]",n,r),t.push(r>=n?1:0)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"EQ[]",n,r),t.push(n===r?1:0)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"NEQ[]",n,r),t.push(n!==r?1:0)},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"ODD[]",n),t.push(Math.trunc(n)%2?1:0)},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"EVEN[]",n),t.push(Math.trunc(n)%2?0:1)},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"IF[]",t),t||(dy(e,!0),exports.DEBUG&&console.log(e.step,"EIF[]"))},function(e){exports.DEBUG&&console.log(e.step,"EIF[]")},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"AND[]",n,r),t.push(n&&r?1:0)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"OR[]",n,r),t.push(n||r?1:0)},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"NOT[]",n),t.push(n?0:1)},Cy.bind(void 0,1),function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SDB[]",t),e.deltaBase=t},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SDS[]",t),e.deltaShift=Math.pow(.5,t)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"ADD[]",n,r),t.push(r+n)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"SUB[]",n,r),t.push(r-n)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"DIV[]",n,r),t.push(64*r/n)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"MUL[]",n,r),t.push(r*n/64)},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"ABS[]",n),t.push(Math.abs(n))},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"NEG[]",n),t.push(-n)},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"FLOOR[]",n),t.push(64*Math.floor(n/64))},function(e){var t=e.stack,n=t.pop();exports.DEBUG&&console.log(e.step,"CEILING[]",n),t.push(64*Math.ceil(n/64))},Ay.bind(void 0,0),Ay.bind(void 0,1),Ay.bind(void 0,2),Ay.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"WCVTF[]",n,r),e.cvt[r]=n*e.ppem/e.font.unitsPerEm},Cy.bind(void 0,2),Cy.bind(void 0,3),Fy.bind(void 0,1),Fy.bind(void 0,2),Fy.bind(void 0,3),function(e){var t,n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=ny,192&n){case 0:t=.5;break;case 64:t=1;break;case 128:t=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=t,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid SROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*t},function(e){var t,n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=ny,192&n){case 0:t=Math.sqrt(2)/2;break;case 64:t=Math.sqrt(2);break;case 128:t=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=t,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid S45ROUND value")}n&=15,e.srThreshold=0===n?0:(n/8-.5)*t},void 0,void 0,function(e){exports.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Km},void 0,function(e){exports.DEBUG&&console.log(e.step,"RUTG[]"),e.round=ey},function(e){exports.DEBUG&&console.log(e.step,"RDTG[]"),e.round=ty},by,by,void 0,void 0,void 0,void 0,void 0,function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANCTRL[]",t)},Ry.bind(void 0,0),Ry.bind(void 0,1),function(e){var t=e.stack,n=t.pop(),r=0;exports.DEBUG&&console.log(e.step,"GETINFO[]",n),1&n&&(r=35),32&n&&(r|=4096),t.push(r)},void 0,function(e){var t=e.stack,n=t.pop(),r=t.pop(),i=t.pop();exports.DEBUG&&console.log(e.step,"ROLL[]"),t.push(r),t.push(n),t.push(i)},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"MAX[]",n,r),t.push(Math.max(r,n))},function(e){var t=e.stack,n=t.pop(),r=t.pop();exports.DEBUG&&console.log(e.step,"MIN[]",n,r),t.push(Math.min(r,n))},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANTYPE[]",t)},function(e){var t=e.stack.pop(),n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"INSTCTRL[]",t,n),t){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,My.bind(void 0,1),My.bind(void 0,2),My.bind(void 0,3),My.bind(void 0,4),My.bind(void 0,5),My.bind(void 0,6),My.bind(void 0,7),My.bind(void 0,8),Dy.bind(void 0,1),Dy.bind(void 0,2),Dy.bind(void 0,3),Dy.bind(void 0,4),Dy.bind(void 0,5),Dy.bind(void 0,6),Dy.bind(void 0,7),Dy.bind(void 0,8),Oy.bind(void 0,0,0,0,0,0),Oy.bind(void 0,0,0,0,0,1),Oy.bind(void 0,0,0,0,0,2),Oy.bind(void 0,0,0,0,0,3),Oy.bind(void 0,0,0,0,1,0),Oy.bind(void 0,0,0,0,1,1),Oy.bind(void 0,0,0,0,1,2),Oy.bind(void 0,0,0,0,1,3),Oy.bind(void 0,0,0,1,0,0),Oy.bind(void 0,0,0,1,0,1),Oy.bind(void 0,0,0,1,0,2),Oy.bind(void 0,0,0,1,0,3),Oy.bind(void 0,0,0,1,1,0),Oy.bind(void 0,0,0,1,1,1),Oy.bind(void 0,0,0,1,1,2),Oy.bind(void 0,0,0,1,1,3),Oy.bind(void 0,0,1,0,0,0),Oy.bind(void 0,0,1,0,0,1),Oy.bind(void 0,0,1,0,0,2),Oy.bind(void 0,0,1,0,0,3),Oy.bind(void 0,0,1,0,1,0),Oy.bind(void 0,0,1,0,1,1),Oy.bind(void 0,0,1,0,1,2),Oy.bind(void 0,0,1,0,1,3),Oy.bind(void 0,0,1,1,0,0),Oy.bind(void 0,0,1,1,0,1),Oy.bind(void 0,0,1,1,0,2),Oy.bind(void 0,0,1,1,0,3),Oy.bind(void 0,0,1,1,1,0),Oy.bind(void 0,0,1,1,1,1),Oy.bind(void 0,0,1,1,1,2),Oy.bind(void 0,0,1,1,1,3),Oy.bind(void 0,1,0,0,0,0),Oy.bind(void 0,1,0,0,0,1),Oy.bind(void 0,1,0,0,0,2),Oy.bind(void 0,1,0,0,0,3),Oy.bind(void 0,1,0,0,1,0),Oy.bind(void 0,1,0,0,1,1),Oy.bind(void 0,1,0,0,1,2),Oy.bind(void 0,1,0,0,1,3),Oy.bind(void 0,1,0,1,0,0),Oy.bind(void 0,1,0,1,0,1),Oy.bind(void 0,1,0,1,0,2),Oy.bind(void 0,1,0,1,0,3),Oy.bind(void 0,1,0,1,1,0),Oy.bind(void 0,1,0,1,1,1),Oy.bind(void 0,1,0,1,1,2),Oy.bind(void 0,1,0,1,1,3),Oy.bind(void 0,1,1,0,0,0),Oy.bind(void 0,1,1,0,0,1),Oy.bind(void 0,1,1,0,0,2),Oy.bind(void 0,1,1,0,0,3),Oy.bind(void 0,1,1,0,1,0),Oy.bind(void 0,1,1,0,1,1),Oy.bind(void 0,1,1,0,1,2),Oy.bind(void 0,1,1,0,1,3),Oy.bind(void 0,1,1,1,0,0),Oy.bind(void 0,1,1,1,0,1),Oy.bind(void 0,1,1,1,0,2),Oy.bind(void 0,1,1,1,0,3),Oy.bind(void 0,1,1,1,1,0),Oy.bind(void 0,1,1,1,1,1),Oy.bind(void 0,1,1,1,1,2),Oy.bind(void 0,1,1,1,1,3)],Py.prototype.setState=function(e,t){return this.state[e]=t,this.activeState={key:e,value:this.state[e]},this.activeState},Py.prototype.getState=function(e){return this.state[e]||null},jy.prototype.inboundIndex=function(e){return e>=0&&e<this.tokens.length},jy.prototype.composeRUD=function(e){var t=this,n=e.map(function(e){return t[e[0]].apply(t,e.slice(1).concat(!0))}),r=function(e){return"object"==typeof e&&e.hasOwnProperty("FAIL")};if(n.every(r))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:n.filter(r)};this.dispatch("composeRUD",[n.filter(function(e){return!r(e)})])},jy.prototype.replaceRange=function(e,t,n,r){t=null!==t?t:this.tokens.length;var i=n.every(function(e){return e instanceof Py});if(!isNaN(e)&&this.inboundIndex(e)&&i){var s=this.tokens.splice.apply(this.tokens,[e,t].concat(n));return r||this.dispatch("replaceToken",[e,t,n]),[s,n]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},jy.prototype.replaceToken=function(e,t,n){if(!isNaN(e)&&this.inboundIndex(e)&&t instanceof Py){var r=this.tokens.splice(e,1,t);return n||this.dispatch("replaceToken",[e,t]),[r[0],t]}return{FAIL:"replaceToken: invalid token or index."}},jy.prototype.removeRange=function(e,t,n){t=isNaN(t)?this.tokens.length:t;var r=this.tokens.splice(e,t);return n||this.dispatch("removeRange",[r,e,t]),r},jy.prototype.removeToken=function(e,t){if(!isNaN(e)&&this.inboundIndex(e)){var n=this.tokens.splice(e,1);return t||this.dispatch("removeToken",[n,e]),n}return{FAIL:"removeToken: invalid token index."}},jy.prototype.insertToken=function(e,t,n){return e.every(function(e){return e instanceof Py})?(this.tokens.splice.apply(this.tokens,[t,0].concat(e)),n||this.dispatch("insertToken",[e,t]),e):{FAIL:"insertToken: invalid token(s)."}},jy.prototype.registerModifier=function(e,t,n){this.events.newToken.subscribe(function(r,i){var s=[r,i],a=[r,i];if(null===t||!0===t.apply(this,s)){var o=n.apply(this,a);r.setState(e,o)}}),this.registeredModifiers.push(e)},Uy.prototype.subscribe=function(e){return"function"==typeof e?this.subscribers.push(e)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Uy.prototype.unsubscribe=function(e){this.subscribers.splice(e,1)},By.prototype.setCurrentIndex=function(e){this.index=e,this.current=this.context[e],this.backtrack=this.context.slice(0,e),this.lookahead=this.context.slice(e+1)},By.prototype.get=function(e){switch(!0){case 0===e:return this.current;case e<0&&Math.abs(e)<=this.backtrack.length:return this.backtrack.slice(e)[0];case e>0&&e<=this.lookahead.length:return this.lookahead[e-1];default:return null}},jy.prototype.rangeToText=function(e){if(e instanceof Ny)return this.getRangeTokens(e).map(function(e){return e.char}).join("")},jy.prototype.getText=function(){return this.tokens.map(function(e){return e.char}).join("")},jy.prototype.getContext=function(e){return this.registeredContexts[e]||null},jy.prototype.on=function(e,t){var n=this.events[e];return n?n.subscribe(t):null},jy.prototype.dispatch=function(e,t){var n=this,r=this.events[e];r instanceof Uy&&r.subscribers.forEach(function(e){e.apply(n,t||[])})},jy.prototype.registerContextChecker=function(e,t,n){if(this.getContext(e))return{FAIL:"context name '"+e+"' is already registered."};if("function"!=typeof t)return{FAIL:"missing context start check."};if("function"!=typeof n)return{FAIL:"missing context end check."};var r=new Ly(e,t,n);return this.registeredContexts[e]=r,this.contextCheckers.push(r),r},jy.prototype.getRangeTokens=function(e){var t=e.startIndex+e.endOffset;return[].concat(this.tokens.slice(e.startIndex,t))},jy.prototype.getContextRanges=function(e){var t=this.getContext(e);return t?t.ranges:{FAIL:"context checker '"+e+"' is not registered."}},jy.prototype.resetContextsRanges=function(){var e=this.registeredContexts;for(var t in e)e.hasOwnProperty(t)&&(e[t].ranges=[])},jy.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var e=this.tokens.map(function(e){return e.char}),t=0;t<e.length;t++){var n=new By(e,t);this.runContextCheck(n)}this.dispatch("updateContextsRanges",[this.registeredContexts])},jy.prototype.setEndOffset=function(e,t){var n=new Ny(this.getContext(t).openRange.startIndex,e,t),r=this.getContext(t).ranges;return n.rangeId=t+"."+r.length,r.push(n),this.getContext(t).openRange=null,n},jy.prototype.runContextCheck=function(e){var t=this,n=e.index;this.contextCheckers.forEach(function(r){var i=r.contextName,s=t.getContext(i).openRange;if(!s&&r.checkStart(e)&&(s=new Ny(n,null,i),t.getContext(i).openRange=s,t.dispatch("contextStart",[i,n])),s&&r.checkEnd(e)){var a=n-s.startIndex+1,o=t.setEndOffset(a,i);t.dispatch("contextEnd",[i,o])}})},jy.prototype.tokenize=function(e){this.tokens=[],this.resetContextsRanges();var t=Array.from(e);this.dispatch("start");for(var n=0;n<t.length;n++){var r=t[n],i=new By(t,n);this.dispatch("next",[i]),this.runContextCheck(i);var s=new Py(r);this.tokens.push(s),this.dispatch("newToken",[s,i])}return this.dispatch("end",[this.tokens]),this.tokens},Wy.prototype.getDefaultScriptFeaturesIndexes=function(){for(var e=this.font.tables.gsub.scripts,t=0;t<e.length;t++){var n=e[t];if("DFLT"===n.tag)return n.script.defaultLangSys.featureIndexes}return[]},Wy.prototype.getScriptFeaturesIndexes=function(e){if(!this.font.tables.gsub)return[];if(!e)return this.getDefaultScriptFeaturesIndexes();for(var t=this.font.tables.gsub.scripts,n=0;n<t.length;n++){var r=t[n];if(r.tag===e&&r.script.defaultLangSys)return r.script.defaultLangSys.featureIndexes;var i=r.langSysRecords;if(i)for(var s=0;s<i.length;s++){var a=i[s];if(a.tag===e)return a.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},Wy.prototype.mapTagsToFeatures=function(e,t){for(var n={},r=0;r<e.length;r++){var i=e[r].tag,s=e[r].feature;n[i]=s}this.features[t].tags=n},Wy.prototype.getScriptFeatures=function(e){var t=this.features[e];if(this.features.hasOwnProperty(e))return t;var n=this.getScriptFeaturesIndexes(e);if(!n)return null;var r=this.font.tables.gsub;return t=n.map(function(e){return r.features[e]}),this.features[e]=t,this.mapTagsToFeatures(t,e),t},Wy.prototype.getSubstitutionType=function(e,t){return e.lookupType.toString()+t.substFormat.toString()},Wy.prototype.getLookupMethod=function(e,t){var n=this;switch(this.getSubstitutionType(e,t)){case"11":return function(e){return Yy.apply(n,[e,t])};case"12":return function(e){return Ky.apply(n,[e,t])};case"63":return function(e){return Zy.apply(n,[e,t])};case"41":return function(e){return Qy.apply(n,[e,t])};case"21":return function(e){return eb.apply(n,[e,t])};default:throw new Error("lookupType: "+e.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}},Wy.prototype.lookupFeature=function(e){var t=e.contextParams,n=t.index,r=this.getFeature({tag:e.tag,script:e.script});if(!r)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+e.tag+"' for script '"+e.script+"'.");for(var i=this.getFeatureLookups(r),s=[].concat(t.context),a=0;a<i.length;a++)for(var o=i[a],c=this.getLookupSubtables(o),l=0;l<c.length;l++){var u=c[l],h=this.getSubstitutionType(o,u),d=this.getLookupMethod(o,u),f=void 0;switch(h){case"11":(f=d(t.current))&&s.splice(n,1,new qy({id:11,tag:e.tag,substitution:f}));break;case"12":(f=d(t.current))&&s.splice(n,1,new qy({id:12,tag:e.tag,substitution:f}));break;case"63":f=d(t),Array.isArray(f)&&f.length&&s.splice(n,1,new qy({id:63,tag:e.tag,substitution:f}));break;case"41":(f=d(t))&&s.splice(n,1,new qy({id:41,tag:e.tag,substitution:f}));break;case"21":(f=d(t.current))&&s.splice(n,1,new qy({id:21,tag:e.tag,substitution:f}))}t=new By(s,n),Array.isArray(f)&&!f.length||(f=null)}return s.length?s:null},Wy.prototype.supports=function(e){if(!e.script)return!1;this.getScriptFeatures(e.script);var t=this.features.hasOwnProperty(e.script);if(!e.tag)return t;var n=this.features[e.script].some(function(t){return t.tag===e.tag});return t&&n},Wy.prototype.getLookupSubtables=function(e){return e.subtables||null},Wy.prototype.getLookupByIndex=function(e){return this.font.tables.gsub.lookups[e]||null},Wy.prototype.getFeatureLookups=function(e){return e.lookupListIndexes.map(this.getLookupByIndex.bind(this))},Wy.prototype.getFeature=function(e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(e.script)||this.getScriptFeatures(e.script);var t=this.features[e.script];return t?t.tags[e.tag]?this.features[e.script].tags[e.tag]:null:{FAIL:"No feature for script "+e.script}};var tb={startCheck:function(e){var t=e.current,n=e.get(-1);return null===n&&zy(t)||!zy(n)&&zy(t)},endCheck:function(e){var t=e.get(1);return null===t||!zy(t)}},nb={startCheck:function(e){var t=e.current,n=e.get(-1);return(zy(t)||Hy(t))&&!zy(n)},endCheck:function(e){var t=e.get(1);switch(!0){case null===t:return!0;case!zy(t)&&!Hy(t):var n=/\s/.test(t);if(!n)return!0;if(n&&!e.lookahead.some(function(e){return zy(e)||Hy(e)}))return!0;break;default:return!1}}},rb={11:function(e,t,n){t[n].setState(e.tag,e.substitution)},12:function(e,t,n){t[n].setState(e.tag,e.substitution)},63:function(e,t,n){e.substitution.forEach(function(r,i){t[n+i].setState(e.tag,r)})},41:function(e,t,n){var r=t[n];r.setState(e.tag,e.substitution.ligGlyph);for(var i=e.substitution.components.length,s=0;s<i;s++)(r=t[n+s+1]).setState("deleted",!0)}};function ib(e,t,n){e instanceof qy&&rb[e.id]&&rb[e.id](e,t,n)}function sb(e){var t=this,n="arab",r=this.featuresTags[n],i=this.tokenizer.getRangeTokens(e);if(1!==i.length){var s=new By(i.map(function(e){return e.getState("glyphIndex")}),0),a=new By(i.map(function(e){return e.char}),0);i.forEach(function(e,o){if(!Hy(e.char)){s.setCurrentIndex(o),a.setCurrentIndex(o);var c,l=0;switch(function(e){for(var t=[].concat(e.backtrack),n=t.length-1;n>=0;n--){var r=t[n],i=Gy(r),s=Hy(r);if(!i&&!s)return!0;if(i)return!1}return!1}(a)&&(l|=1),function(e){if(Gy(e.current))return!1;for(var t=0;t<e.lookahead.length;t++)if(!Hy(e.lookahead[t]))return!0;return!1}(a)&&(l|=2),l){case 1:c="fina";break;case 2:c="init";break;case 3:c="medi"}if(-1!==r.indexOf(c)){var u=t.query.lookupFeature({tag:c,script:n,contextParams:s});if(u instanceof Error)return console.info(u.message);u.forEach(function(e,t){e instanceof qy&&(ib(e,i,t),s.context[t]=e.substitution)})}}})}}function ab(e,t){return new By(e.map(function(e){return e.activeState.value}),t||0)}function ob(e){var t=this,n=this.tokenizer.getRangeTokens(e),r=ab(n);r.context.forEach(function(e,i){r.setCurrentIndex(i);var s=t.query.lookupFeature({tag:"rlig",script:"arab",contextParams:r});s.length&&(s.forEach(function(e){return ib(e,n,i)}),r=ab(n))})}var cb={startCheck:function(e){var t=e.current,n=e.get(-1);return null===n&&$y(t)||!$y(n)&&$y(t)},endCheck:function(e){var t=e.get(1);return null===t||!$y(t)}};function lb(e,t){return new By(e.map(function(e){return e.activeState.value}),t||0)}function ub(e){var t=this,n=this.tokenizer.getRangeTokens(e),r=lb(n);r.context.forEach(function(e,i){r.setCurrentIndex(i);var s=t.query.lookupFeature({tag:"liga",script:"latn",contextParams:r});s.length&&(s.forEach(function(e){return ib(e,n,i)}),r=lb(n))})}function hb(e){this.baseDir=e||"ltr",this.tokenizer=new jy,this.featuresTags={}}function db(e){var t=this.contextChecks[e+"Check"];return this.tokenizer.registerContextChecker(e,t.startCheck,t.endCheck)}function fb(){return db.call(this,"latinWord"),db.call(this,"arabicWord"),db.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function pb(){var e=this;this.tokenizer.getContextRanges("arabicSentence").forEach(function(t){var n=e.tokenizer.getRangeTokens(t);e.tokenizer.replaceRange(t.startIndex,t.endOffset,n.reverse())})}function gb(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function mb(){var e=this;this.featuresTags.hasOwnProperty("arab")&&(gb.call(this),this.tokenizer.getContextRanges("arabicWord").forEach(function(t){sb.call(e,t)}))}function yb(){var e=this,t="arab";this.featuresTags.hasOwnProperty(t)&&-1!==this.featuresTags[t].indexOf("rlig")&&(gb.call(this),this.tokenizer.getContextRanges("arabicWord").forEach(function(t){ob.call(e,t)}))}function bb(){var e=this,t="latn";this.featuresTags.hasOwnProperty(t)&&-1!==this.featuresTags[t].indexOf("liga")&&(gb.call(this),this.tokenizer.getContextRanges("latinWord").forEach(function(t){ub.call(e,t)}))}function wb(e){(e=e||{}).tables=e.tables||{},e.empty||(Bm(e.familyName,"When creating a new Font object, familyName is required."),Bm(e.styleName,"When creating a new Font object, styleName is required."),Bm(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Bm(e.ascender,"When creating a new Font object, ascender is required."),Bm(e.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables=Object.assign(e.tables,{os2:Object.assign({usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR},e.tables.os2)})),this.supported=!0,this.glyphs=new Lg.GlyphSet(this,e.glyphs||[]),this.encoding=new Ag(this),this.position=new Om(this),this.substitution=new Pm(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new Ym(this):void 0}})}function vb(e,t,n){var r={},i=new xg.Parser(e,t);return r.tag=i.parseTag(),r.minValue=i.parseFixed(),r.defaultValue=i.parseFixed(),r.maxValue=i.parseFixed(),i.skip("uShort",1),r.name=n[i.parseUShort()]||{},r}function Sb(e,t,n,r){var i={},s=new xg.Parser(e,t);i.name=r[s.parseUShort()]||{},s.skip("uShort",1),i.coordinates={};for(var a=0;a<n.length;++a)i.coordinates[n[a].tag]=s.parseFixed();return i}hb.prototype.setText=function(e){this.text=e},hb.prototype.contextChecks={latinWordCheck:cb,arabicWordCheck:tb,arabicSentenceCheck:nb},hb.prototype.registerFeatures=function(e,t){var n=this,r=t.filter(function(t){return n.query.supports({script:e,tag:t})});this.featuresTags.hasOwnProperty(e)?this.featuresTags[e]=this.featuresTags[e].concat(r):this.featuresTags[e]=r},hb.prototype.applyFeatures=function(e,t){if(!e)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Wy(e));for(var n=0;n<t.length;n++){var r=t[n];this.query.supports({script:r.script})&&this.registerFeatures(r.script,r.tags)}},hb.prototype.registerModifier=function(e,t,n){this.tokenizer.registerModifier(e,t,n)},hb.prototype.checkContextReady=function(e){return!!this.tokenizer.getContext(e)},hb.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(mb.call(this),yb.call(this)),this.checkContextReady("latinWord")&&bb.call(this),this.checkContextReady("arabicSentence")&&pb.call(this)},hb.prototype.processText=function(e){this.text&&this.text===e||(this.setText(e),fb.call(this),this.applyFeaturesToContexts())},hb.prototype.getBidiText=function(e){return this.processText(e),this.tokenizer.getText()},hb.prototype.getTextGlyphs=function(e){this.processText(e);for(var t=[],n=0;n<this.tokenizer.tokens.length;n++){var r=this.tokenizer.tokens[n];if(!r.state.deleted){var i=r.activeState.value;t.push(Array.isArray(i)?i[0]:i)}}return t},wb.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},wb.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},wb.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},wb.prototype.updateFeatures=function(e){return this.defaultRenderOptions.features.map(function(t){return"latn"===t.script?{script:"latn",tags:t.tags.filter(function(t){return e[t]})}:t})},wb.prototype.stringToGlyphs=function(e,t){var n=this,r=new hb;r.registerModifier("glyphIndex",null,function(e){return n.charToGlyphIndex(e.char)});var i=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;r.applyFeatures(this,i);for(var s=r.getTextGlyphs(e),a=s.length,o=new Array(a),c=this.glyphs.get(0),l=0;l<a;l+=1)o[l]=this.glyphs.get(s[l])||c;return o},wb.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},wb.prototype.nameToGlyph=function(e){var t=this.nameToGlyphIndex(e),n=this.glyphs.get(t);return n||(n=this.glyphs.get(0)),n},wb.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},wb.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var n=this.position.defaultKerningTables;return n?this.position.getKerningValue(n,e,t):this.kerningPairs[e+","+t]||0},wb.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},wb.prototype.forEachGlyph=function(e,t,n,r,i,s){t=void 0!==t?t:0,n=void 0!==n?n:0,r=void 0!==r?r:72,i=Object.assign({},this.defaultRenderOptions,i);var a,o=1/this.unitsPerEm*r,c=this.stringToGlyphs(e,i);if(i.kerning){var l=i.script||this.position.getDefaultScriptName();a=this.position.getKerningTables(l,i.language)}for(var u=0;u<c.length;u+=1){var h=c[u];s.call(this,h,t,n,r,i),h.advanceWidth&&(t+=h.advanceWidth*o),i.kerning&&u<c.length-1&&(t+=(a?this.position.getKerningValue(a,h.index,c[u+1].index):this.getKerningValue(h,c[u+1]))*o),i.letterSpacing?t+=i.letterSpacing*r:i.tracking&&(t+=i.tracking/1e3*r)}return t},wb.prototype.getPath=function(e,t,n,r,i){var s=new Gp;return this.forEachGlyph(e,t,n,r,i,function(e,t,n,r){var a=e.getPath(t,n,r,i,this);s.extend(a)}),s},wb.prototype.getPaths=function(e,t,n,r,i){var s=[];return this.forEachGlyph(e,t,n,r,i,function(e,t,n,r){var a=e.getPath(t,n,r,i,this);s.push(a)}),s},wb.prototype.getAdvanceWidth=function(e,t,n){return this.forEachGlyph(e,0,0,t,n,function(){})},wb.prototype.draw=function(e,t,n,r,i,s){this.getPath(t,n,r,i,s).draw(e)},wb.prototype.drawPoints=function(e,t,n,r,i,s){this.forEachGlyph(t,n,r,i,s,function(t,n,r,i){t.drawPoints(e,n,r,i)})},wb.prototype.drawMetrics=function(e,t,n,r,i,s){this.forEachGlyph(t,n,r,i,s,function(t,n,r,i){t.drawMetrics(e,n,r,i)})},wb.prototype.getEnglishName=function(e){var t=this.names[e];if(t)return t.en},wb.prototype.validate=function(){var e=this;function t(t){var n=e.getEnglishName(t);n&&n.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},wb.prototype.toTables=function(){return function(e){for(var t,n=[],r=[],i=[],s=[],a=[],o=[],c=[],l=0,u=0,h=0,d=0,f=0,p=0;p<e.glyphs.length;p+=1){var g=e.glyphs.get(p),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+p+"): advanceWidth is not a number.");(t>m||void 0===t)&&m>0&&(t=m),l<m&&(l=m);var y=vm(m);if(y<32)u|=1<<y;else if(y<64)h|=1<<y-32;else if(y<96)d|=1<<y-64;else{if(!(y<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");f|=1<<y-96}if(".notdef"!==g.name){var b=g.getMetrics();n.push(b.xMin),r.push(b.yMin),i.push(b.xMax),s.push(b.yMax),o.push(b.leftSideBearing),c.push(b.rightSideBearing),a.push(g.advanceWidth)}}var w={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,s),advanceWidthMax:Math.max.apply(null,a),advanceWidthAvg:Am(a),minLeftSideBearing:Math.min.apply(null,o),maxLeftSideBearing:Math.max.apply(null,o),minRightSideBearing:Math.min.apply(null,c)};w.ascender=e.ascender,w.descender=e.descender;var v=function(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,n=t;return e.createdTimestamp&&(n=e.createdTimestamp+2082844800),new pg.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}({flags:3,unitsPerEm:e.unitsPerEm,xMin:w.xMin,yMin:w.yMin,xMax:w.xMax,yMax:w.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),S=function(e){return new pg.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}({ascender:w.ascender,descender:w.descender,advanceWidthMax:w.advanceWidthMax,minLeftSideBearing:w.minLeftSideBearing,minRightSideBearing:w.minRightSideBearing,xMaxExtent:w.maxLeftSideBearing+(w.xMax-w.xMin),numberOfHMetrics:e.glyphs.length}),x=function(e){return new pg.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}(e.glyphs.length),E=function(e){return new pg.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}(Object.assign({xAvgCharWidth:Math.round(w.advanceWidthAvg),usFirstCharIndex:t,usLastCharIndex:l,ulUnicodeRange1:u,ulUnicodeRange2:h,ulUnicodeRange3:d,ulUnicodeRange4:f,sTypoAscender:w.ascender,sTypoDescender:w.descender,sTypoLineGap:0,usWinAscent:w.yMax,usWinDescent:Math.abs(w.yMin),ulCodePageRange1:1,sxHeight:Cm(e,"xyvw",{yMax:Math.round(w.ascender/2)}).yMax,sCapHeight:Cm(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",w).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0},e.tables.os2)),I=function(e){for(var t=new pg.Table("hmtx",[]),n=0;n<e.length;n+=1){var r=e.get(n),i=r.advanceWidth||0,s=r.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:i}),t.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:s})}return t}(e.glyphs),k=function(e){var t,n=!0;for(t=e.length-1;t>0;t-=1)if(e.get(t).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}var r=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(r=r.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),r=r.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var i=new pg.Table("cmap",r);for(i.segments=[],t=0;t<e.length;t+=1){for(var s=e.get(t),a=0;a<s.unicodes.length;a+=1)Eg(i,s.unicodes[a],t);i.segments=i.segments.sort(function(e,t){return e.start-t.start})}!function(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}(i);var o=i.segments.length,c=0,l=[],u=[],h=[],d=[],f=[],p=[];for(t=0;t<o;t+=1){var g=i.segments[t];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+t,type:"USHORT",value:g.end}),u=u.concat({name:"start_"+t,type:"USHORT",value:g.start}),h=h.concat({name:"idDelta_"+t,type:"SHORT",value:g.delta}),d=d.concat({name:"idRangeOffset_"+t,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(f=f.concat({name:"glyph_"+t,type:"USHORT",value:g.glyphId}))):c+=1,n||void 0===g.glyphIndex||(p=(p=(p=p.concat({name:"cmap12Start_"+t,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+t,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+t,type:"ULONG",value:g.glyphIndex}))}if(i.segCountX2=2*(o-c),i.searchRange=2*Math.pow(2,Math.floor(Math.log(o-c)/Math.log(2))),i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange,i.fields=i.fields.concat(l),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(u),i.fields=i.fields.concat(h),i.fields=i.fields.concat(d),i.fields=i.fields.concat(f),i.cmap4Length=14+2*l.length+2+2*u.length+2*h.length+2*d.length+2*f.length,!n){var m=16+4*p.length;i.cmap12Offset=20+i.cmap4Length,i.fields=i.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:m},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:p.length/3}]),i.fields=i.fields.concat(p)}return i}(e.glyphs),T=e.getEnglishName("fontFamily"),_=e.getEnglishName("fontSubfamily"),C=T+" "+_,A=e.getEnglishName("postScriptName");A||(A=T.replace(/\s/g,"")+"-"+_);var F={};for(var R in e.names)F[R]=e.names[R];F.uniqueID||(F.uniqueID={en:e.getEnglishName("manufacturer")+":"+C}),F.postScriptName||(F.postScriptName={en:A}),F.preferredFamily||(F.preferredFamily=e.names.fontFamily),F.preferredSubfamily||(F.preferredSubfamily=e.names.fontSubfamily);var M=[],D=function(e,t){var n,r=[],i={},s=gm(am);for(var a in e){var o=s[a];if(void 0===o&&(o=a),n=parseInt(o),isNaN(n))throw new Error('Name table entry "'+a+'" does not exist, see nameTableNames for complete list.');i[n]=e[a],r.push(n)}for(var c=gm(om),l=gm(lm),u=[],h=[],d=0;d<r.length;d++){var f=i[n=r[d]];for(var p in f){var g=f[p],m=1,y=c[p],b=cm[y],w=pm(m,b,y),v=Yp.MACSTRING(g,w);void 0===v&&(m=0,(y=t.indexOf(p))<0&&(y=t.length,t.push(p)),b=4,v=Yp.UTF16(g));var S=ym(v,h);u.push(mm(m,b,y,n,v.length,S));var x=l[p];if(void 0!==x){var E=Yp.UTF16(g),I=ym(E,h);u.push(mm(3,1,x,n,E.length,I))}}}u.sort(function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID});for(var k=new pg.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:u.length},{name:"stringOffset",type:"USHORT",value:6+12*u.length}]),T=0;T<u.length;T++)k.fields.push({name:"record_"+T,type:"RECORD",value:u[T]});return k.fields.push({name:"strings",type:"LITERAL",value:h}),k}(F,M),O=M.length>0?function(e){for(var t=new pg.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),n="",r=12+4*e.length,i=0;i<e.length;++i){var s=n.indexOf(e[i]);s<0&&(s=n.length,n+=e[i]),t.fields.push({name:"offset "+i,type:"USHORT",value:r+s}),t.fields.push({name:"length "+i,type:"USHORT",value:e[i].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),t}(M):void 0,P=new pg.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}]),N=function(e,t){for(var n,r=new pg.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/t.unitsPerEm,s={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},a=[],o=1;o<e.length;o+=1)n=e.get(o),a.push(n.name);var c=[];r.header=new pg.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),r.nameIndex=function(e){var t=new pg.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var n=0;n<e.length;n+=1)t.names.push({name:"name_"+n,type:"NAME",value:e[n]});return t}([t.postScriptName]);var l=Qg(s,c);r.topDictIndex=em(l),r.globalSubrIndex=new pg.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),r.charsets=function(e,t){for(var n=new pg.Record("Charsets",[{name:"format",type:"Card8",value:0}]),r=0;r<e.length;r+=1){var i=Jg(e[r],t);n.fields.push({name:"glyph_"+r,type:"SID",value:i})}return n}(a,c),r.charStringsIndex=function(e){for(var t=new pg.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<e.length;n+=1){var r=e.get(n),i=tm(r);t.charStrings.push({name:r.name,type:"CHARSTRING",value:i})}return t}(e),r.privateDict=function(e,t){var n=new pg.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=Zg(Wg,{},t),n}(0,c),r.stringIndex=function(e){var t=new pg.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var n=0;n<e.length;n+=1)t.strings.push({name:"string_"+n,type:"STRING",value:e[n]});return t}(c);var u=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return s.charset=u,s.encoding=0,s.charStrings=s.charset+r.charsets.sizeOf(),s.private[1]=s.charStrings+r.charStringsIndex.sizeOf(),l=Qg(s,c),r.topDictIndex=em(l),r}(e.glyphs,{version:e.getEnglishName("version"),fullName:C,familyName:T,weightName:_,postScriptName:A,unitsPerEm:e.unitsPerEm,fontBBox:[0,w.yMin,w.ascender,w.advanceWidthMax]}),L=e.metas&&Object.keys(e.metas).length>0?function(e){var t=Object.keys(e).length,n="",r=16+12*t,i=new pg.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:r},{name:"numTags",type:"ULONG",value:t}]);for(var s in e){var a=n.length;n+=e[s],i.fields.push({name:"tag "+s,type:"TAG",value:s}),i.fields.push({name:"offset "+s,type:"ULONG",value:r+a}),i.fields.push({name:"length "+s,type:"ULONG",value:e[s].length})}return i.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),i}(e.metas):void 0,B=[v,S,x,E,D,k,P,N,I];O&&B.push(O),e.tables.gsub&&B.push(function(e){return new pg.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new pg.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new pg.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new pg.LookupList(e.lookups,Im)}])}(e.tables.gsub)),L&&B.push(L);for(var U=function(e){var t=new pg.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var n=Math.pow(2,km(t.numTables));t.searchRange=16*n,t.entrySelector=km(n),t.rangeShift=16*t.numTables-t.searchRange;for(var r=[],i=[],s=t.sizeOf()+_m().sizeOf()*t.numTables;s%4!=0;)s+=1,i.push({name:"padding",type:"BYTE",value:0});for(var a=0;a<e.length;a+=1){var o=e[a];Wp.argument(4===o.tableName.length,"Table name"+o.tableName+" is invalid.");var c=o.sizeOf(),l=_m(o.tableName,Tm(o.encode()),s,c);for(r.push({name:l.tag+" Table Record",type:"RECORD",value:l}),i.push({name:o.tableName+" table",type:"RECORD",value:o}),s+=c,Wp.argument(!isNaN(s),"Something went wrong calculating the offset.");s%4!=0;)s+=1,i.push({name:"padding",type:"BYTE",value:0})}return r.sort(function(e,t){return e.value.tag>t.value.tag?1:-1}),t.fields=t.fields.concat(r),t.fields=t.fields.concat(i),t}(B),V=Tm(U.encode()),j=U.fields,z=!1,G=0;G<j.length;G+=1)if("head table"===j[G].name){j[G].value.checkSumAdjustment=2981146554-V,z=!0;break}if(!z)throw new Error("Could not find head table with checkSum to adjust.");return U}(this)},wb.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},wb.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e[r];return t},wb.prototype.download=function(e){var t=this.getEnglishName("fontFamily"),n=this.getEnglishName("fontSubfamily");e=e||t.replace(/\s/g,"")+"-"+n+".otf";var r=this.toArrayBuffer();if("undefined"!=typeof window)if(window.URL=window.URL||window.webkitURL,window.URL){var i=new DataView(r),s=new Blob([i],{type:"font/opentype"}),a=document.createElement("a");a.href=window.URL.createObjectURL(s),a.download=e;var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!1),a.dispatchEvent(o)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var c=__webpack_require__(583),l=function(e){for(var t=new vp(e.byteLength),n=new Uint8Array(e),r=0;r<t.length;++r)t[r]=n[r];return t}(r);c.writeFileSync(e,l)}},wb.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},wb.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},wb.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var xb=function(){return{coverage:this.parsePointer(vg.coverage),attachPoints:this.parseList(vg.pointer(vg.uShortList))}},Eb=function(){var e=this.parseUShort();return Wp.argument(1===e||2===e||3===e,"Unsupported CaretValue table version."),1===e?{coordinate:this.parseShort()}:2===e?{pointindex:this.parseShort()}:3===e?{coordinate:this.parseShort()}:void 0},Ib=function(){return this.parseList(vg.pointer(Eb))},kb=function(){return{coverage:this.parsePointer(vg.coverage),ligGlyphs:this.parseList(vg.pointer(Ib))}},Tb=function(){return this.parseUShort(),this.parseList(vg.pointer(vg.coverage))},_b=new Array(10);function Cb(e,t){for(var n=[],r=12,i=0;i<t;i+=1){var s=xg.getTag(e,r),a=xg.getULong(e,r+4),o=xg.getULong(e,r+8),c=xg.getULong(e,r+12);n.push({tag:s,checksum:a,offset:o,length:c,compression:!1}),r+=16}return n}function Ab(e,t){if("WOFF"===t.compression){var n=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),r=new Uint8Array(t.length);if(function(e,t){var n,r,i=new xp(e,t);do{switch(n=Pp(i),Np(i,2,0)){case 0:r=Vp(i);break;case 1:r=Up(i,Ep,Ip);break;case 2:Bp(i,i.ltree,i.dtree),r=Up(i,i.ltree,i.dtree);break;default:r=-3}if(0!==r)throw new Error("Data error")}while(!n);i.destLen<i.dest.length?"function"==typeof i.dest.slice?i.dest.slice(0,i.destLen):i.dest.subarray(0,i.destLen):i.dest}(n,r),r.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}return{data:e,offset:t.offset}}_b[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(vg.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(vg.coverage),values:this.parseValueRecordList()}:void Wp.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},_b[2]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();Wp.assert(1===t||2===t,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var n=this.parsePointer(vg.coverage),r=this.parseUShort(),i=this.parseUShort();if(1===t)return{posFormat:t,coverage:n,valueFormat1:r,valueFormat2:i,pairSets:this.parseList(vg.pointer(vg.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(r),value2:this.parseValueRecord(i)}})))};if(2===t){var s=this.parsePointer(vg.classDef),a=this.parsePointer(vg.classDef),o=this.parseUShort(),c=this.parseUShort();return{posFormat:t,coverage:n,valueFormat1:r,valueFormat2:i,classDef1:s,classDef2:a,class1Count:o,class2Count:c,classRecords:this.parseList(o,vg.list(c,function(){return{value1:this.parseValueRecord(r),value2:this.parseValueRecord(i)}}))}}},_b[3]=function(){return{error:"GPOS Lookup 3 not supported"}},_b[4]=function(){return{error:"GPOS Lookup 4 not supported"}},_b[5]=function(){return{error:"GPOS Lookup 5 not supported"}},_b[6]=function(){return{error:"GPOS Lookup 6 not supported"}},_b[7]=function(){return{error:"GPOS Lookup 7 not supported"}},_b[8]=function(){return{error:"GPOS Lookup 8 not supported"}},_b[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);var Fb=__webpack_require__(6560),Rb=__webpack_require__(5867),Mb=__webpack_require__.n(Rb),Db=__webpack_require__(7692),Ob=__webpack_require__.n(Db),Pb=__webpack_require__(6968),Nb=__webpack_require__(1078),Lb=__webpack_require__.n(Nb),Bb=__webpack_require__(5045),Ub=__webpack_require__(1048).Buffer;class Vb extends L{kind=T.Object;x=0;y=0;width;height;ninePatch=!1;canvas;context;name;valid;alphaEnable;rgbaCanvas;rgbaLast;patchSizes;rgbaRedraw;scaleMode;constructor(e,t){let n;if(super("roBitmap"),this.alphaEnable=!1,this.rgbaLast=0,this.rgbaRedraw=!0,this.valid=!0,this.width=1,this.height=1,this.name=t??"",this.scaleMode=0,e instanceof ArrayBuffer||e instanceof Ub)n=e;else if(e instanceof M)try{n=uh.fileSystem?.readFileSync(e.value),this.alphaEnable=!1,this.name=e.value}catch(t){uh.isDevMode&&uh.stderr.write(`error,Error loading bitmap:${e.value} - ${t.message}`),this.valid=!1}else if(e instanceof Fh){let t=e.get(new M("width"));(t instanceof vh||t instanceof bh||t instanceof mh)&&(this.width=Math.trunc(t.getValue()));let n=e.get(new M("height"));(n instanceof vh||n instanceof bh||n instanceof mh)&&(this.height=Math.trunc(n.getValue()));let r=e.get(new M("name"));r instanceof M&&(this.name=r.value);let i=e.get(new M("alphaEnable"));i instanceof D&&(this.alphaEnable=i.toBoolean())}else uh.isDevMode&&uh.stderr.write("warning,Invalid roBitmap param:"+typeof e),this.valid=!1;if(this.canvas=iw(this.width,this.height),this.context=this.canvas.getContext("2d"),n)try{let e;const t=Mb()(n);if(t&&"image/png"===t.mime){const t=Ob().decode(n),r=Ob().toRGBA8(t);r.length&&(e=r[0],this.width=t.width,this.height=t.height)}else if(t&&"image/jpeg"===t.mime){let t=Pb.decode(n);e=t.data,this.width=t.width,this.height=t.height}else if(t&&"image/webp"===t.mime){const t=new Bb.WebPDecoder,r=Ub.from(n),i=(0,Bb.WebPRiffParser)(r,0);if(i?.frames?.length){let n=[0],s=[0],a=i.frames[0];e=t.WebPDecodeRGBA(r,a.src_off,a.src_size,s,n),e&&(this.height=n[0],this.width=s[0])}}else if(t&&"image/gif"===t.mime){const t=(0,Fb.O5)(n),r=(0,Fb.Ud)(t,!0);r.length&&(e=r[0].patch,this.width=r[0].dims.width,this.height=r[0].dims.height)}else if(t&&"image/bmp"===t.mime){let t=Lb()(n);e=t.data,this.width=t.width,this.height=t.height}if(e){let t=this.context.createImageData(this.width,this.height);this.canvas.width=this.width,this.canvas.height=this.height,t.data.set(new Uint8Array(e)),ow(t,this.context,0,0)}else uh.isDevMode&&uh.stderr.write(`warning,Invalid image format: ${t?.mime}`),this.valid=!1}catch(e){uh.isDevMode&&uh.stderr.write(`error,Error drawing image on canvas: ${e.message}`),this.valid=!1}const r=new qb(this);if(this.registerMethods({ifDraw2D:[r.clear,r.drawObject,r.drawRotatedObject,r.drawScaledObject,r.drawTransformedObject,r.drawLine,r.drawPoint,r.drawRect,r.drawText,r.finish,r.getAlphaEnable,r.setAlphaEnable,r.getByteArray,r.getPng,r.getWidth,r.getHeight],ifBitmap:[this.getName]}),this.valid&&this.name.toLowerCase().endsWith(".9.png")){const e=this.getPatchSizes();e.horizontal>=0&&e.vertical>=0&&(this.ninePatch=!0,this.patchSizes=e)}}clearCanvas(e){const t=this.context;return t.clearRect(0,0,this.canvas.width,this.canvas.height),(255&e)>0&&(t.fillStyle=cw(e),t.fillRect(0,0,this.canvas.width,this.canvas.height)),this.rgbaRedraw=!0,O.Instance}drawImage(e,t,n,r=1,i=1,s){return this.rgbaRedraw=!0,tw(this,e,t,n,r,i,s)}drawImageToContext(e,t,n){return rw(this.context,e,this.alphaEnable,t,n)}getImageName(){return this.name}getCanvas(){return this.canvas}getContext(){return this.context}getRgbaCanvas(e){if(this.rgbaCanvas){if(!this.rgbaRedraw&&e===this.rgbaLast)return this.rgbaCanvas;this.rgbaCanvas.width=this.canvas.width,this.rgbaCanvas.height=this.canvas.height}else this.rgbaCanvas=iw(this.canvas.width,this.canvas.height);const t=this.rgbaCanvas.getContext("2d",{alpha:!0});return aw(this.canvas,t,0,0),t.globalCompositeOperation="multiply",t.fillStyle=cw(e),t.fillRect(0,0,this.canvas.width,this.canvas.height),t.globalCompositeOperation="destination-in",aw(this.canvas,t,0,0),t.globalCompositeOperation="source-over",this.rgbaLast=e,this.rgbaRedraw=!1,this.rgbaCanvas}setCanvasAlpha(e){this.alphaEnable=e,this.rgbaRedraw=!0}getCanvasAlpha(){return this.alphaEnable}makeDirty(){this.rgbaRedraw=!0}finishDraw(){}toString(e){return"<Component: roBitmap>"}equalTo(e){return D.False}isValid(){return this.valid}dispose(){sw(this.canvas),this.rgbaCanvas&&sw(this.rgbaCanvas)}getPatchSizes(){if(this.patchSizes)return this.patchSizes;const e=this.getCanvas(),t=this.getContext().getImageData(0,0,e.width,e.height).data;let n=-1,r=-1;for(let r=0;r<e.width;r++){const i=4*(r+0*e.width),s=t[i],a=t[i+1],o=t[i+2],c=t[i+3];if(0===s&&0===a&&0===o&&255===c){n=r;break}}for(let n=0;n<e.height;n++){const i=4*(0+n*e.width),s=t[i],a=t[i+1],o=t[i+2],c=t[i+3];if(0===s&&0===a&&0===o&&255===c){r=n;break}}return{horizontal:n,vertical:r}}getName=new Ch("getName",{signature:{args:[],returns:T.String},impl:e=>new M(this.name)})}function jb(e){const t=new Vb(e);return t.isValid()?t:O.Instance}class zb extends L{kind=T.Object;valid;alphaEnable;bitmap;collisionType;translationX;translationY;time;wrap;collisionCircle;collisionRect;x;y;width;height;scaleMode;constructor(e,t,n,r,i){super("roRegion"),this.valid=!1,e.addReference(),this.bitmap=e,this.collisionType=0,this.x=0,(t instanceof bh||t instanceof mh||t instanceof vh)&&(this.x=Math.trunc(t.getValue())),this.y=0,(n instanceof bh||n instanceof mh||n instanceof vh)&&(this.y=Math.trunc(n.getValue())),this.width=e.width,(r instanceof bh||r instanceof mh||r instanceof vh)&&(this.width=Math.trunc(r.getValue())),this.height=e.height,(i instanceof bh||i instanceof mh||i instanceof vh)&&(this.height=Math.trunc(i.getValue())),this.translationX=0,this.translationY=0,this.scaleMode=0,this.time=0,this.wrap=!1,this.collisionCircle={x:0,y:0,r:r.getValue()},this.collisionRect={x:0,y:0,width:r.getValue(),height:i.getValue()},this.alphaEnable=!0,this.x+this.width<=e.width&&this.y+this.height<=e.height&&(this.valid=!0);const s=new qb(this);this.registerMethods({ifRegion:[this.copy,this.getBitmap,this.getCollisionType,this.getHeight,this.getPretranslationX,this.getPretranslationY,this.getScaleMode,this.getTime,this.getWidth,this.getWrap,this.getX,this.getY,this.offset,this.set,this.setCollisionCircle,this.setCollisionRectangle,this.setCollisionType,this.setPretranslation,this.setScaleMode,this.setTime,this.setWrap],ifDraw2D:[s.clear,s.drawObject,s.drawRotatedObject,s.drawScaledObject,s.drawTransformedObject,s.drawLine,s.drawPoint,s.drawRect,s.drawText,s.finish,s.getAlphaEnable,s.setAlphaEnable,s.getByteArray,s.getPng]})}isValid(){return this.valid}applyOffset(e,t,n,r){const i=this.bitmap.getCanvas();let s=this.x+e,a=this.y+t;this.width+=n,this.height+=r,this.wrap?(this.x=s>0&&0!==e?s%i.width:s<0?s+i.width:s,this.y=a>0&&0!==t?a%i.height:a<0?a+i.height:a):(s>=0&&s+this.width<=i.width&&(this.x=s),a>=0&&a+this.height<=i.height&&(this.y=a)),this.bitmap.makeDirty()}clearCanvas(e){const t=this.bitmap.getContext();t.fillStyle=cw(e),t.fillRect(this.x,this.y,this.width,this.height),this.bitmap.makeDirty()}drawImage(e,t,n,r=1,i=1,s){const a=tw(this,e,t,n,r,i,s);return a&&this.bitmap.makeDirty(),a}drawImageToContext(e,t,n){const r=rw(this.bitmap.getContext(),e,this.alphaEnable,t+this.getPosX(),n+this.getPosY());return r&&this.bitmap.makeDirty(),r}getCanvas(){return this.bitmap.getCanvas()}getContext(){return this.bitmap.getContext()}getRgbaCanvas(e){return this.bitmap instanceof Vb?this.bitmap.getRgbaCanvas(e):this.bitmap.getCanvas()}setCanvasAlpha(e){this.alphaEnable=e,this.bitmap.setCanvasAlpha(e)}getCanvasAlpha(){return this.alphaEnable}getPosX(){return this.x}getPosY(){return this.y}getTransX(){return this.translationX}getTransY(){return this.translationY}getImageWidth(){return this.width}getImageHeight(){return this.height}getCollCircle(){return this.collisionCircle}getCollRect(){return 1===this.collisionType?this.collisionRect:{x:0,y:0,width:this.width,height:this.height}}getCollType(){return this.collisionType}getImageData(){return this.bitmap.getContext().getImageData(this.x,this.y,this.width,this.height)}getWrapValue(){return this.wrap}getAnimaTime(){return this.time}getSourceBitmap(){return this.bitmap}makeDirty(){this.bitmap.makeDirty()}finishDraw(){this.bitmap.finishDraw()}toString(e){return"<Component: roRegion>"}equalTo(e){return D.False}dispose(){this.bitmap.removeReference()}copy=new Ch("copy",{signature:{args:[],returns:T.Object},impl:e=>new zb(this.bitmap,new vh(this.x),new vh(this.y),new vh(this.width),new vh(this.height))});getBitmap=new Ch("getBitmap",{signature:{args:[],returns:T.Object},impl:e=>this.bitmap});getCollisionType=new Ch("getCollisionType",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.collisionType)});getHeight=new Ch("getHeight",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.height)});getPretranslationX=new Ch("getPretranslationX",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.translationX)});getPretranslationY=new Ch("getPretranslationY",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.translationY)});getScaleMode=new Ch("getScaleMode",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.scaleMode)});getTime=new Ch("getTime",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.time)});getWidth=new Ch("getWidth",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.width)});getWrap=new Ch("getWrap",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.wrap)});getX=new Ch("getX",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.x)});getY=new Ch("getY",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.y)});offset=new Ch("offset",{signature:{args:[new kh("x",T.Dynamic),new kh("y",T.Dynamic),new kh("w",T.Dynamic),new kh("h",T.Dynamic)],returns:T.Void},impl:(e,t,n,r,i)=>(this.applyOffset(t.getValue(),n.getValue(),r.getValue(),i.getValue()),O.Instance)});set=new Ch("set",{signature:{args:[new kh("srcRegion",T.Object)],returns:T.Void},impl:(e,t)=>(this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,t.bitmap?.addReference(),this.bitmap?.removeReference(),this.bitmap=t.bitmap,this.collisionType=t.collisionType,this.translationX=t.translationX,this.translationY=t.translationY,this.scaleMode=t.scaleMode,this.time=t.time,this.wrap=t.wrap,this.collisionCircle=t.collisionCircle,this.collisionRect=t.collisionRect,this.bitmap.makeDirty(),O.Instance)});setCollisionType=new Ch("setCollisionType",{signature:{args:[new kh("collisionType",T.Int32)],returns:T.Void},impl:(e,t)=>(this.collisionType=t.getValue(),O.Instance)});setCollisionCircle=new Ch("setCollisionCircle",{signature:{args:[new kh("xOffset",T.Int32),new kh("yOffset",T.Int32),new kh("radius",T.Int32)],returns:T.Void},impl:(e,t,n,r)=>(this.collisionCircle={x:t.getValue(),y:n.getValue(),r:r.getValue()},O.Instance)});setCollisionRectangle=new Ch("setCollisionRectangle",{signature:{args:[new kh("xOffset",T.Int32),new kh("yOffset",T.Int32),new kh("width",T.Int32),new kh("height",T.Int32)],returns:T.Void},impl:(e,t,n,r,i)=>(this.collisionRect={x:t.getValue(),y:n.getValue(),width:r.getValue(),height:i.getValue()},O.Instance)});setPretranslation=new Ch("setPretranslation",{signature:{args:[new kh("translationX",T.Int32),new kh("translationX",T.Int32)],returns:T.Void},impl:(e,t,n)=>(this.translationX=t.getValue(),this.translationY=n.getValue(),this.bitmap.makeDirty(),O.Instance)});setScaleMode=new Ch("setScaleMode",{signature:{args:[new kh("scaleMode",T.Int32)],returns:T.Void},impl:(e,t)=>(this.scaleMode=t.getValue(),this.bitmap.makeDirty(),O.Instance)});setTime=new Ch("setTime",{signature:{args:[new kh("time",T.Int32)],returns:T.Void},impl:(e,t)=>(this.time=t.getValue(),O.Instance)});setWrap=new Ch("setWrap",{signature:{args:[new kh("wrap",T.Boolean)],returns:T.Void},impl:(e,t)=>(this.wrap=t.toBoolean(),this.bitmap.makeDirty(),O.Instance)})}function Gb(e,t,n,r,i){const s=new zb(e,t,n,r,i);return s.isValid()?s:O.Instance}class Hb extends L{kind=T.Object;id;regions;region;x;y;z;frame;drawable;memberFlags;collidableFlags;data;compositor;tickSum;constructor(e,t,n,r,i,s){super("roSprite"),this.id=i,this.x=e.getValue(),this.y=t.getValue(),this.z=r.getValue(),this.frame=0,this.collidableFlags=1,this.drawable=!0,this.memberFlags=1,this.data=O.Instance,this.compositor=s,this.tickSum=0,n.addReference(),n instanceof Kh?(this.regions=n,this.region=n.getElements()[this.frame],this.region.addReference()):this.region=n,this.registerMethods({ifSprite:[this.checkCollision,this.checkMultipleCollisions,this.getRegion,this.getCollidableFlags,this.getDrawableFlag,this.getMemberFlags,this.getData,this.getX,this.getY,this.getZ,this.moveTo,this.moveOffset,this.offsetRegion,this.setRegion,this.setCollidableFlags,this.setDrawableFlag,this.setMemberFlags,this.setData,this.setZ,this.remove]})}getImageData(){return this.region.getImageData()}getRegionObject(){return this.region}getId(){return this.id}getPosX(){return this.x}getPosY(){return this.y}getCircle(){const e=this.region.getCollCircle();return{x:this.x+e.x,y:this.y+e.y,r:e.r}}getRect(){const e=this.region.getCollRect();return{x:this.x+e.x,y:this.y+e.y,width:e.width,height:e.height}}getFlags(){return{collidableFlags:this.collidableFlags,memberFlags:this.memberFlags}}getType(){return this.region.getCollType()}visible(){return this.drawable}nextFrame(e){if(this.regions){this.tickSum+=e;const t=this.regions.getElements();let n=t[this.frame];this.tickSum>=n.getAnimaTime()&&(this.frame++,this.tickSum=0,this.frame>=t.length&&(this.frame=0),n=t[this.frame],n.addReference(),this.region.removeReference(),this.region=n)}}toString(e){return"<Component: roSprite>"}equalTo(e){return D.False}dispose(){this.region?.removeReference(),this.regions?.removeReference(),this.data instanceof L&&this.data.removeReference()}getRegion=new Ch("getRegion",{signature:{args:[],returns:T.Object},impl:e=>this.region});checkCollision=new Ch("checkCollision",{signature:{args:[],returns:T.Dynamic},impl:e=>this.compositor?.checkCollision(this,!1)??O.Instance});checkMultipleCollisions=new Ch("checkMultipleCollisions",{signature:{args:[],returns:T.Dynamic},impl:e=>this.compositor?.checkCollision(this,!0)??O.Instance});getCollidableFlags=new Ch("getCollidableFlags",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.collidableFlags)});getDrawableFlag=new Ch("getDrawableFlag",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.drawable)});getMemberFlags=new Ch("getMemberFlags",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.memberFlags)});getData=new Ch("getData",{signature:{args:[],returns:T.Dynamic},impl:e=>this.data});getX=new Ch("getX",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.x)});getY=new Ch("getY",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.y)});getZ=new Ch("getZ",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.z)});moveTo=new Ch("moveTo",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32)],returns:T.Void},impl:(e,t,n)=>(this.x=t.getValue(),this.y=n.getValue(),O.Instance)});moveOffset=new Ch("moveOffset",{signature:{args:[new kh("xOffset",T.Int32),new kh("yOffSet",T.Int32)],returns:T.Void},impl:(e,t,n)=>(this.x+=t.getValue(),this.y+=n.getValue(),O.Instance)});offsetRegion=new Ch("offsetRegion",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("width",T.Int32),new kh("height",T.Int32)],returns:T.Void},impl:(e,t,n,r,i)=>{if(this.regions)for(const e of this.regions.getElements())e instanceof zb&&e.applyOffset(t.getValue(),n.getValue(),r.getValue(),i.getValue());else this.region&&this.region.applyOffset(t.getValue(),n.getValue(),r.getValue(),i.getValue());return O.Instance}});setCollidableFlags=new Ch("setCollidableFlags",{signature:{args:[new kh("collidableFlags",T.Int32)],returns:T.Void},impl:(e,t)=>(this.collidableFlags=t.getValue(),O.Instance)});setData=new Ch("setData",{signature:{args:[new kh("data",T.Dynamic)],returns:T.Void},impl:(e,t)=>(t instanceof L&&t.addReference(),this.data instanceof L&&this.data.removeReference(),this.data=t,O.Instance)});setDrawableFlag=new Ch("setDrawableFlag",{signature:{args:[new kh("drawable",T.Boolean)],returns:T.Void},impl:(e,t)=>(this.drawable=t.toBoolean(),O.Instance)});setMemberFlags=new Ch("setMemberFlags",{signature:{args:[new kh("memberFlags",T.Int32)],returns:T.Void},impl:(e,t)=>(this.memberFlags=t.getValue(),O.Instance)});setRegion=new Ch("setRegion",{signature:{args:[new kh("region",T.Object)],returns:T.Void},impl:(e,t)=>(t.addReference(),this.region.removeReference(),this.region=t,O.Instance)});setZ=new Ch("setZ",{signature:{args:[new kh("z",T.Int32)],returns:T.Void},impl:(e,t)=>(this.compositor&&this.z!==t.getValue()&&(this.compositor.setSpriteZ(this.id,this.z,t.getValue()),this.z=t.getValue()),O.Instance)});remove=new Ch("remove",{signature:{args:[],returns:T.Void},impl:(e,t)=>(this.compositor?.removeSprite(this.id,null!==this.regions),this.compositor=void 0,O.Instance)})}class $b extends L{kind=T.Object;sprites=new Map;animations=new Array;canvas;context;destBitmap;rgbaBackground;spriteId;previousSpriteDraws=[];constructor(){super("roCompositor"),this.canvas=iw(10,10),this.context=this.canvas.getContext("2d"),this.spriteId=0,this.registerMethods({ifCompositor:[this.setDrawTo,this.draw,this.drawAll,this.newSprite,this.newAnimatedSprite,this.animationTick]})}setSpriteZ(e,t,n){let r=this.sprites.get(t);r&&r.some((t,r,i)=>t.getId()===e&&(i.splice(r,1),this.setSpriteLayer(t,n),!0))}setSpriteLayer(e,t){let n=this.sprites.get(t);n?n.push(e):n=[e],this.sprites.set(t,n)}removeSprite(e,t){for(const t of this.sprites.values())t.some((t,n,r)=>{if(t.getId()===e){for(const e of r.splice(n,1))e.removeReference();return!0}return!1});t&&this.animations.some((t,n,r)=>{if(t.getId()===e){for(const e of r.splice(n,1))e.removeReference();return!0}return!1})}getCanvasAlpha(){return!!this.destBitmap?.getCanvasAlpha()}getContext(){return this.context}checkCollision(e,t){const n=e.getFlags(),r=e.getCircle(),i=e.getRect(),s=e.getType(),a=[];let o;o=O.Instance;for(let[,c]of this.sprites)if(c.some((c,l,u)=>{if(e.getId()!==c.getId()){const e=c.getFlags(),l=c.getType();if(n.memberFlags===e.memberFlags&&Wb(s,i,r,l,c)){if(!t)return o=c,!0;a.push(c)}}return!1}),o instanceof Hb)break;return t&&a.length>0?new Kh(a):o}clearPreviousSpriteDraws(){let e=this.context,t=this.rgbaBackground?this.rgbaBackground:0;if(e.clearRect(0,0,this.canvas.width,this.canvas.height),0!==t){e.fillStyle=cw(t);for(const t of this.previousSpriteDraws)e.fillRect(t.x,t.y,t.width,t.height)}this.previousSpriteDraws=[]}drawSprites(){if(this.clearPreviousSpriteDraws(),this.destBitmap){this.destBitmap.drawImageToContext(this.canvas,0,0);let e=[...this.sprites.keys()].sort((e,t)=>e-t);for(const t of e){const e=this.sprites.get(t);if(e){for(const t of e)t.visible()&&(tw(this,t.getRegionObject(),t.getPosX(),t.getPosY()),this.previousSpriteDraws.push(t.getRect()));this.destBitmap?.drawImageToContext(this.canvas,0,0)}}}}toString(e){return"<Component: roCompositor>"}equalTo(e){return D.False}dispose(){this.destBitmap?.removeReference();for(const e of this.sprites.values())for(const t of e)t.removeReference();for(const e of this.animations)e.removeReference();sw(this.canvas)}setDrawTo=new Ch("setDrawTo",{signature:{args:[new kh("destBitmap",T.Object),new kh("rgbaBackground",T.Int32)],returns:T.Void},impl:(e,t,n)=>{t.addReference(),this.destBitmap?.removeReference(),this.destBitmap=t;const r=ew(t);return this.canvas.width=r.width,this.canvas.height=r.height,this.rgbaBackground=n.getValue(),O.Instance}});newSprite=new Ch("newSprite",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("region",T.Object),new kh("z",T.Int32,new vh(0))],returns:T.Object},impl:(e,t,n,r,i)=>{if(r instanceof zb){let e=new Hb(t,n,r,i,this.spriteId++,this);return e.addReference(),this.setSpriteLayer(e,i.getValue()),e}return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roCompositor.newSprite: invalid region parameter type roInvalid: ${e.formatLocation()}`),O.Instance}});newAnimatedSprite=new Ch("newAnimatedSprite",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("regionArray",T.Object),new kh("z",T.Int32,new vh(0))],returns:T.Object},impl:(e,t,n,r,i)=>{let s="";if(r instanceof Kh){const e=r.getElements();if(e&&e.length>0){if(e[0]instanceof zb){let e=new Hb(t,n,r,i,this.spriteId++,this);return e.addReference(),this.setSpriteLayer(e,i.getValue()),e.addReference(),this.animations.push(e),e}s="invalid regionArray item type is roInvalid"}else s="invalid regionArray is empty"}else s="invalid regionArray parameter type roInvalid";return s.length&&uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roCompositor.newAnimatedSprite: ${s}: ${e.formatLocation()}`),O.Instance}});animationTick=new Ch("animationTick",{signature:{args:[new kh("duration",T.Int32)],returns:T.Void},impl:(e,t)=>{for(const e of this.animations)e.nextFrame(t.getValue());return O.Instance}});draw=new Ch("draw",{signature:{args:[],returns:T.Void},impl:e=>(this.drawSprites(),O.Instance)});drawAll=new Ch("drawAll",{signature:{args:[],returns:T.Void},impl:e=>(this.drawSprites(),O.Instance)})}function Wb(e,t,n,r,i){return e<2&&r<2?lw(t,i.getRect()):2===e&&2===r?function(e,t){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)<=e.r+t.r}(n,i.getCircle()):2===e?uw(i.getRect(),n):uw(t,i.getCircle())}class qb{component;constructor(e){this.component=e}doClearCanvas(e){this.component.clearCanvas(e)}doDrawScaledObject(e,t,n,r,i,s,a){const o=this.component.getContext();s=dw(s,a);const c=this.component.drawImage(i,e,t,n,r,s);return o.globalAlpha=1,c}doDrawCroppedBitmap(e,t,n,r,i){const s=this.component.getContext(),a=Kb(e,r=dw(r,i));s.save(),Yb(s,r);const o=1===e.scaleMode;return s.imageSmoothingEnabled=o,o&&"imageSmoothingQuality"in s&&(s.imageSmoothingQuality="high"),hw(s,a,{sx:t.x,sy:t.y,sw:t.width,sh:t.height,dx:n.x,dy:n.y,dw:n.width,dh:n.height}),s.restore(),this.component.makeDirty(),!0}doDrawRotatedBitmap(e,t,n,r,i,s,a,o,c,l){const u=this.component.x,h=this.component.y,d=this.component.getContext();c=dw(c,l),d.save();const f=void 0!==a?a:0,p=void 0!==o?o:0;d.translate(u+e+f,h+t+p),0!==i&&d.rotate(-i),d.scale(n,r),d.translate(-f/n,-p/r),this.component.drawImage(s,0,0,1,1,c),d.restore(),this.component.makeDirty()}doDrawRotatedRect(e,t,n,r,i=1){const s=this.component.x,a=this.component.y,o=this.component.getContext();o.save();const c=void 0!==r?r[0]:0,l=void 0!==r?r[1]:0;0!==n?(o.translate(s+e.x+c,a+e.y+l),o.rotate(-n),o.translate(-c,-l)):o.translate(s+e.x,a+e.y),o.globalAlpha=i,o.fillStyle=cw(t,this.component.getCanvasAlpha()),o.fillRect(0,0,e.width,e.height),o.restore(),this.component.makeDirty()}doDrawClearedRect(e){const t=this.component.x+e.x,n=this.component.y+e.y,r=this.component.getContext();r.save(),r.clearRect(t,n,e.width,e.height),r.restore()}doDrawText(e,t,n,r,i,s){const a=this.component.x,o=this.component.y,c=this.component.getContext();c.save(),c.globalAlpha=i,c.fillStyle=cw(r,this.component.getCanvasAlpha()),c.font=s.toFontString(),c.textBaseline="top",c.fillText(e,a+t,o+n+s.getTopAdjust()),c.restore(),this.component.makeDirty()}doDrawRotatedText(e,t,n,r,i,s,a){const o=this.component.x,c=this.component.y,l=this.component.getContext();l.save(),l.globalAlpha=i,l.translate(o+t,c+n),0!==a&&l.rotate(-a),l.fillStyle=cw(r,this.component.getCanvasAlpha()),l.font=s.toFontString(),l.textBaseline="top",l.fillText(e,0,s.getTopAdjust()),l.restore(),this.component.makeDirty()}pushClip(e){const t=this.component.getContext();t.save(),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.clip()}popClip(){this.component.getContext().restore()}drawNinePatch(e,t,n,r){const i=this.component.getContext(),s=Kb(e,n=dw(n,r)),a=e.getPatchSizes(),o=t.x,c=t.y,l=t.width,u=t.height,h=s.width,d=s.height,f=a.horizontal,p=a.horizontal,g=a.vertical,m=a.vertical,y=Math.max(0,h-2-f-p),b=Math.max(0,d-2-g-m),w=Math.max(0,l-f-p),v=Math.max(0,u-g-m),S=(e,t,n,r,a,o,c,l)=>{const u=Math.round(a),h=Math.round(o),d=Math.round(c),f=Math.round(l);n>0&&r>0&&d>0&&f>0&&hw(i,s,{sx:e,sy:t,sw:n,sh:r,dx:u,dy:h,dw:d,dh:f})};i.save(),Yb(i,n);const x=1===e.scaleMode;i.imageSmoothingEnabled=x,x&&"imageSmoothingQuality"in i&&(i.imageSmoothingQuality="high"),S(1,1,f,g,o,c,f,g),S(1+f,1,y,g,o+f,c,w,g),S(h-1-p,1,p,g,o+l-p,c,p,g),S(1,1+g,f,b,o,c+g,f,v),S(1+f,1+g,y,b,o+f,c+g,w,v),S(h-1-p,1+g,p,b,o+l-p,c+g,p,v),S(1,d-1-m,f,m,o,c+u-m,f,m),S(1+f,d-1-m,y,m,o+f,c+u-m,w,m),S(h-1-p,d-1-m,p,m,o+l-p,c+u-m,p,m),i.restore(),this.component.makeDirty()}clear=new Ch("clear",{signature:{args:[new kh("rgba",T.Int32)],returns:T.Void},impl:(e,t)=>(this.doClearCanvas(t.getValue()),O.Instance)});drawObject=new Ch("drawObject",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("object",T.Object),new kh("rgba",T.Int32,O.Instance)],returns:T.Boolean},impl:(e,t,n,r,i)=>{const s=this.component.getContext(),a=this.component.drawImage(r,t.getValue(),n.getValue(),1,1,i instanceof vh?i.getValue():void 0);return s.globalAlpha=1,D.from(a)}});drawRotatedObject=new Ch("drawRotatedObject",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("theta",T.Float),new kh("object",T.Object),new kh("rgba",T.Int32,O.Instance)],returns:T.Boolean},impl:(e,t,n,r,i,s)=>{const a=function(e,t,n,r,i,s){const a=e.getContext(),o=-i*Math.PI/180;a.save(),a.translate(n,r),0!==o&&a.rotate(o);const c=e.drawImage(t,0,0,1,1,s);return a.restore(),c}(this.component,i,t.getValue(),n.getValue(),r.getValue(),s instanceof vh?s.getValue():void 0);return this.component.makeDirty(),D.from(a)}});drawScaledObject=new Ch("drawScaledObject",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("scaleX",T.Float),new kh("scaleY",T.Float),new kh("object",T.Object),new kh("rgba",T.Int32,O.Instance)],returns:T.Boolean},impl:(e,t,n,r,i,s,a)=>{this.component.getContext();const o=this.component.drawImage(s,t.getValue(),n.getValue(),r.getValue(),i.getValue(),a instanceof vh?a.getValue():void 0);return D.from(o)}});drawTransformedObject=new Ch("drawTransformedObject",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("theta",T.Float),new kh("scaleX",T.Float),new kh("scaleY",T.Float),new kh("object",T.Object),new kh("rgba",T.Int32,O.Instance)],returns:T.Boolean},impl:(e,t,n,r,i,s,a,o)=>{const c=this.component.getContext(),l=t.getValue(),u=n.getValue(),h=-r.getValue()*Math.PI/180;c.save(),c.translate(l,u),c.rotate(h);const d=this.component.drawImage(a,0,0,i.getValue(),s.getValue(),o instanceof vh?o.getValue():void 0);return c.globalAlpha=1,c.restore(),D.from(d)}});drawLine=new Ch("drawLine",{signature:{args:[new kh("xStart",T.Int32),new kh("yStart",T.Int32),new kh("xEnd",T.Int32),new kh("yEnd",T.Int32),new kh("rgba",T.Int32)],returns:T.Boolean},impl:(e,t,n,r,i,s)=>{const a=this.component.x,o=this.component.y,c=this.component.getContext();return c.beginPath(),c.strokeStyle=cw(s.getValue(),this.component.getCanvasAlpha()),c.moveTo(a+t.getValue(),o+n.getValue()),c.lineTo(a+r.getValue(),o+i.getValue()),c.stroke(),this.component.makeDirty(),D.True}});drawPoint=new Ch("drawPoint",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("size",T.Float),new kh("rgba",T.Int32)],returns:T.Boolean},impl:(e,t,n,r,i)=>{const s=this.component.x,a=this.component.y,o=this.component.getContext();return o.fillStyle=cw(i.getValue(),this.component.getCanvasAlpha()),o.fillRect(s+t.getValue(),a+n.getValue(),r.getValue(),r.getValue()),this.component.makeDirty(),D.True}});drawRect=new Ch("drawRect",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("width",T.Int32),new kh("height",T.Int32),new kh("rgba",T.Int32)],returns:T.Boolean},impl:(e,t,n,r,i,s)=>{const a=this.component.x+t.getValue(),o=this.component.y+n.getValue(),c=this.component.getContext();return this.component instanceof yw&&!this.component.getCanvasAlpha()?(c.clearRect(a,o,r.getValue(),i.getValue()),c.fillStyle=cw(s.getValue(),!0)):c.fillStyle=cw(s.getValue(),this.component.getCanvasAlpha()),c.fillRect(a,o,r.getValue(),i.getValue()),this.component.makeDirty(),D.True}});drawText=new Ch("drawText",{signature:{args:[new kh("text",T.String),new kh("x",T.Int32),new kh("y",T.Int32),new kh("rgba",T.Int32),new kh("font",T.Object)],returns:T.Boolean},impl:(e,t,n,r,i,s)=>(this.doDrawText(t.value,n.getValue(),r.getValue(),i.getValue(),1,s),D.True)});finish=new Ch("finish",{signature:{args:[],returns:T.Void},impl:e=>(this.component.finishDraw(),O.Instance)});getAlphaEnable=new Ch("getAlphaEnable",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.component.getCanvasAlpha())});setAlphaEnable=new Ch("setAlphaEnable",{signature:{args:[new kh("alphaEnable",T.Boolean)],returns:T.Void},impl:(e,t)=>(this.component.setCanvasAlpha(t.toBoolean()),O.Instance)});getWidth=new Ch("getWidth",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.width)});getHeight=new Ch("getHeight",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.height)});getByteArray=new Ch("getByteArray",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("width",T.Int32),new kh("height",T.Int32)],returns:T.Int32},impl:(e,t,n,r,i)=>{const s=this.component.x,a=this.component.y,o=this.component.getCanvas().getContext("2d").getImageData(s+t.getValue(),a+n.getValue(),r.getValue(),i.getValue()),c=new Uint8Array(o.data.buffer);return new gd(c)}});getPng=new Ch("getPng",{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("width",T.Int32),new kh("height",T.Int32)],returns:T.Int32},impl:(e,t,n,r,i)=>{const s=this.component.x,a=this.component.y,o=this.component.getCanvas().getContext("2d").getImageData(s+t.getValue(),a+n.getValue(),r.getValue(),i.getValue());return new gd(new Uint8Array(Ob().encode([o.data.buffer],o.width,o.height,0)))}})}const Xb=!0;function Yb(e,t){if(t){const n=255&t;n<255&&(e.globalAlpha=n/255)}}function Kb(e,t){let n;return n=void 0===t||Number.isNaN(t)||e instanceof yw?e.getCanvas():e.getRgbaCanvas(t),n}function Jb(e){return!!e&&!!(e.height&&e.height>=1&&e.width&&e.width>=1)}function Zb(e){let t=0,n=0;return e instanceof zb&&(t=e.getPosX(),n=e.getPosY()),{x:t,y:n}}class Qb{width;height;constructor(e,t){this.width=e,this.height=t}}function ew(e){return e instanceof zb||e instanceof Vb?new Qb(e.width,e.height):e instanceof yw?new Qb(e.getCanvas().width,e.getCanvas().height):e instanceof $b?new Qb(e.getContext().canvas.width,e.getContext().canvas.height):new Qb(e.width,e.height)}function tw(e,t,n,r,i=1,s=1,a,o){const c=e.getContext(),l=e.getCanvasAlpha();let u;if(!(t instanceof Vb||t instanceof zb||t instanceof yw))return!1;if(u=Kb(t,a),Yb(c,a),!Jb(u))return!1;const h=1===(o??t.scaleMode);c.imageSmoothingEnabled=h,h&&"imageSmoothingQuality"in c&&(c.imageSmoothingQuality="high");const d=function(e,t,n,r,i,s=1,a=1){const o=[],c=Zb(n),l=function(e){let t=0,n=0;return e instanceof zb&&(t=e.getTransX(),n=e.getTransY()),{x:t,y:n}}(n),u=l.x*s,h=l.y*a,d=c.x,f=c.y,p=n.width,g=n.height,m=r+u+e.x,y=i+h+e.y,b=p*s,w=g*a;if(0===b||0===w)return[];if(o.push({sx:d,sy:f,sw:p,sh:g,dx:m,dy:y,dw:b,dh:w}),!t||n instanceof Vb||n instanceof yw||n instanceof zb&&!n.getWrapValue())return o;if(!(n instanceof zb))return o;const v=ew(n.getSourceBitmap()),S=Math.min(v.width-c.x,p),x=Math.min(v.height-c.y,g),E=p-S,I=g-x;return E<=0&&I<=0||(E>0&&o.push({sx:0,sy:c.y,sw:E,sh:x,dx:S+m,dy:y,dw:E,dh:x}),I>0&&o.push({sx:c.x,sy:0,sw:S,sh:I,dx:m,dy:x+y,dw:S,dh:I}),E>0&&I>0&&o.push({sx:0,sy:0,sw:E,sh:I,dx:S+m,dy:x+y,dw:E,dh:I})),o}(Zb(e),e instanceof $b||t instanceof zb,t,n,r,i,s);for(const e of d){const{sx:t,sy:n,sw:r,sh:a,dx:o,dy:h,dw:d,dh:f}=e;l||c.clearRect(o,h,r*i,a*s),hw(c,u,e)}return!0}function nw(e,t,n){const r=e.getCanvas(),i=t.getContext();i.save();const s=1===(n??t.scaleMode);i.imageSmoothingEnabled=s,s&&"imageSmoothingQuality"in i&&(i.imageSmoothingQuality="high"),hw(i,r,{sx:0,sy:0,sw:e.width,sh:e.height,dx:0,dy:0,dw:t.width,dh:t.height}),i.restore()}function rw(e,t,n,r,i){if(!Jb(t))return!1;if(Xb)if(n)aw(t,e,r,i);else{let n=t.getContext("2d").getImageData(0,0,t.width,t.height),s=n.data;for(let e=3,n=t.width*t.height*4;e<n;e+=4)s[e]=255;ow(n,e,r,i)}else n||e.clearRect(r,i,t.width,t.height),aw(t,e,r,i);return!0}function iw(e,t){return new OffscreenCanvas(e,t)}function sw(e){e.width=0,e.height=0}function aw(e,t,n,r){t instanceof OffscreenCanvasRenderingContext2D&&e instanceof OffscreenCanvas&&t.drawImage(e,n,r)}function ow(e,t,n,r){t instanceof OffscreenCanvasRenderingContext2D&&e instanceof ImageData&&t.putImageData(e,n,r)}function cw(e,t=!0){return t||(e=function(e){return e-(255&e)+255}(e)),"#"+Re(e,"0")}function lw(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function uw(e,t){const n=Math.abs(t.x-e.x-e.width/2),r=Math.abs(t.y-e.y-e.height/2);if(n>e.width/2+t.r)return!1;if(r>e.height/2+t.r)return!1;if(n<=e.width/2)return!0;if(r<=e.height/2)return!0;const i=n-e.width/2,s=r-e.height/2;return i*i+s*s<=t.r*t.r}function hw(e,t,n){const{sx:r,sy:i,sw:s,sh:a,dx:o,dy:c,dw:l,dh:u}=n;e instanceof OffscreenCanvasRenderingContext2D&&t instanceof OffscreenCanvas&&e.drawImage(t,r,i,s,a,o,c,l,u)}function dw(e,t){if(void 0===e&&void 0===t)return;if(void 0===t||t<0||t>=1)return e;const n=e??4294967295;let r=255&n;return r=Math.round(r*t),r=Math.max(0,Math.min(255,r)),4294967040&n|r}let fw,pw;class gw extends L{kind=T.Object;canvas;defaultFontSize=40;fallbackFontFamily="Arial, Helvetica, sans-serif";defaultFontFamilies;fontRegistry;fontPaths;systemFonts;constructor(){super("roFontRegistry"),this.registerMethods({ifFontRegistry:[this.register,this.getFamilies,this.getFont,this.getDefaultFont,this.getDefaultFontSize]}),this.fontRegistry=new Map,this.fontPaths=new Map,this.systemFonts=new Map;const e=uh.fileSystem.readFileSync("common:/fonts/system-fonts.json","utf-8"),t=JSON.parse(e);this.defaultFontFamilies={regular:this.registerFont(`common:/Fonts/${t.default.regular}`,!0),bold:this.registerFont(`common:/Fonts/${t.default.bold}`,!0),italic:this.registerFont(`common:/Fonts/${t.default.italic}`,!0),boldItalic:this.registerFont(`common:/Fonts/${t.default.boldItalic}`,!0)};const n=this.registerFont(`common:/Fonts/${t.sceneGraph.regular}`,!0),r=this.registerFont(`common:/Fonts/${t.sceneGraph.bold}`,!0);for(const e of t.systemFonts)this.systemFonts.set(e.name.toLowerCase(),{family:e.bold?r:n,fhd:e.fhd,hd:e.hd});this.canvas=iw(10,10)}toString(e){return"<Component: roFontRegistry>"}equalTo(e){return D.False}count(){return this.fontRegistry.size}dispose(){sw(this.canvas)}createFont(e,t,n,r){const i=this.fontRegistry.get(e.value);if(i){const s=n.toBoolean()?"bold":"normal",a=r.toBoolean()?["italic","oblique"]:["normal"];let o;return i.some(e=>!(e.weight!==s||!a.includes(e.style)||(o=e,0))),o?new yp(e,t,n,r,o):(o=i[0],new yp(e,t,D.from("bold"===o.weight),D.from(["italic","oblique"].includes(o.style)),o))}if(e.value===this.getDefaultFontFamily(n.toBoolean(),r.toBoolean())){e=new M(this.fallbackFontFamily);let i={ascent:1.06884765625,descent:.29296875,maxAdvance:1.208984375,lineHeight:1.36181640625,style:n.toBoolean()?"bold":"normal",weight:r.toBoolean()?"italic":"normal"};return new yp(e,t,n,r,i)}return O.Instance}getDefaultFontFamily(e,t){return e&&t?this.defaultFontFamilies.boldItalic:e?this.defaultFontFamilies.bold:t?this.defaultFontFamilies.italic:this.defaultFontFamilies.regular}getFontFamily(e){return this.fontPaths.get(e)??this.registerFont(e,!0)}getSystemFont(e){return this.systemFonts.get(e.toLowerCase())}registerFont(e,t=!1){try{const n=uh.fileSystem;if(!sh(e)||!n.existsSync(e))return uh.isDevMode&&uh.stderr.write(`warning,Font file not found: ${e}`),"";if(this.fontPaths.has(e))return this.fontPaths.get(e)??"";const r=uh.fileSystem.readFileSync(e),i=function(e,t){var n,r;t=null==t?{}:t;var i,s,a,o,c,l,u,h,d,f,p,g,m,y=new wb({empty:!0}),b=new DataView(e,0),w=[],v=xg.getTag(b,0);if(v===String.fromCharCode(0,1,0,0)||"true"===v||"typ1"===v)y.outlinesFormat="truetype",w=Cb(b,i=xg.getUShort(b,4));else if("OTTO"===v)y.outlinesFormat="cff",w=Cb(b,i=xg.getUShort(b,4));else{if("wOFF"!==v)throw new Error("Unsupported OpenType signature "+v);var S=xg.getTag(b,4);if(S===String.fromCharCode(0,1,0,0))y.outlinesFormat="truetype";else{if("OTTO"!==S)throw new Error("Unsupported OpenType flavor "+v);y.outlinesFormat="cff"}w=function(e,t){for(var n=[],r=44,i=0;i<t;i+=1){var s,a=xg.getTag(e,r),o=xg.getULong(e,r+4),c=xg.getULong(e,r+8),l=xg.getULong(e,r+12);s=c<l&&"WOFF",n.push({tag:a,offset:o,compression:s,compressedLength:c,length:l}),r+=20}return n}(b,i=xg.getUShort(b,12))}for(var x=0;x<i;x+=1){var E=w[x],I=void 0;switch(E.tag){case"cmap":I=Ab(b,E),y.tables.cmap=Ig(I.data,I.offset),y.encoding=new Fg(y.tables.cmap);break;case"cvt ":I=Ab(b,E),m=new xg.Parser(I.data,I.offset),y.tables.cvt=m.parseShortList(E.length/2);break;case"fvar":a=E;break;case"fpgm":I=Ab(b,E),m=new xg.Parser(I.data,I.offset),y.tables.fpgm=m.parseByteList(E.length);break;case"head":I=Ab(b,E),y.tables.head=nm(I.data,I.offset),y.unitsPerEm=y.tables.head.unitsPerEm,n=y.tables.head.indexToLocFormat;break;case"hhea":I=Ab(b,E),y.tables.hhea=rm(I.data,I.offset),y.ascender=y.tables.hhea.ascender,y.descender=y.tables.hhea.descender,y.numberOfHMetrics=y.tables.hhea.numberOfHMetrics;break;case"hmtx":h=E;break;case"ltag":I=Ab(b,E),r=im(I.data,I.offset);break;case"maxp":I=Ab(b,E),y.tables.maxp=sm(I.data,I.offset),y.numGlyphs=y.tables.maxp.numGlyphs;break;case"name":p=E;break;case"OS/2":I=Ab(b,E),y.tables.os2=wm(I.data,I.offset);break;case"post":I=Ab(b,E),y.tables.post=Sm(I.data,I.offset),y.glyphNames=new Mg(y.tables.post);break;case"prep":I=Ab(b,E),m=new xg.Parser(I.data,I.offset),y.tables.prep=m.parseByteList(E.length);break;case"glyf":o=E;break;case"loca":f=E;break;case"CFF ":s=E;break;case"kern":d=E;break;case"GDEF":c=E;break;case"GPOS":l=E;break;case"GSUB":u=E;break;case"meta":g=E}}var k=Ab(b,p);if(y.tables.name=function(e,t,n){for(var r={},i=new xg.Parser(e,t),s=i.parseUShort(),a=i.parseUShort(),o=i.offset+i.parseUShort(),c=0;c<a;c++){var l,u=i.parseUShort(),h=i.parseUShort(),d=i.parseUShort(),f=i.parseUShort(),p=am[f]||f,g=i.parseUShort(),m=i.parseUShort(),y=um(u,d,n),b=pm(u,h,d);if(void 0!==b&&void 0!==y&&(l=b===hm?Xp.UTF16(e,o+m,g):Xp.MACSTRING(e,o+m,g,b))){var w=r[p];void 0===w&&(w=r[p]={}),w[y]=l}}return 1===s&&i.parseUShort(),r}(k.data,k.offset,r),y.names=y.tables.name,o&&f){var T=0===n,_=Ab(b,f),C=function(e,t,n,r){for(var i=new xg.Parser(e,t),s=r?i.parseUShort:i.parseULong,a=[],o=0;o<n+1;o+=1){var c=s.call(i);r&&(c*=2),a.push(c)}return a}(_.data,_.offset,y.numGlyphs,T),A=Ab(b,o);y.glyphs=Xm.parse(A.data,A.offset,C,y,t)}else{if(!s)throw new Error("Font doesn't contain TrueType or CFF outlines.");var F=Ab(b,s);!function(e,t,n,r){n.tables.cff={};var i=function(e,t){var n={};return n.formatMajor=xg.getCard8(e,t),n.formatMinor=xg.getCard8(e,t+1),n.size=xg.getCard8(e,t+2),n.offsetSize=xg.getCard8(e,t+3),n.startOffset=t,n.endOffset=t+4,n}(e,t),s=Vg(e,i.endOffset,xg.bytesToString),a=Vg(e,s.endOffset),o=Vg(e,a.endOffset,xg.bytesToString),c=Vg(e,o.endOffset);n.gsubrs=c.objects,n.gsubrsBias=Ug(n.gsubrs);var l=Yg(e,t,a.objects,o.objects);if(1!==l.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+l.length);var u=l[0];if(n.tables.cff.topDict=u,u._privateDict&&(n.defaultWidthX=u._privateDict.defaultWidthX,n.nominalWidthX=u._privateDict.nominalWidthX),void 0!==u.ros[0]&&void 0!==u.ros[1]&&(n.isCIDFont=!0),n.isCIDFont){var h=u.fdArray,d=u.fdSelect;if(0===h||0===d)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var f=Vg(e,h+=t),p=Yg(e,t,f.objects,o.objects);u._fdArray=p,d+=t,u._fdSelect=function(e,t,n,r){var i,s=[],a=new xg.Parser(e,t),o=a.parseCard8();if(0===o)for(var c=0;c<n;c++){if((i=a.parseCard8())>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+r+")");s.push(i)}else{if(3!==o)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+o);var l,u=a.parseCard16(),h=a.parseCard16();if(0!==h)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+h);for(var d=0;d<u;d++){if(i=a.parseCard8(),l=a.parseCard16(),i>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+i+" (FD count "+r+")");if(l>n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+l);for(;h<l;h++)s.push(i);h=l}if(l!==n)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+l)}return s}(e,d,n.numGlyphs,p.length)}var g,m=t+u.private[1],y=Xg(e,m,u.private[0],o.objects);if(n.defaultWidthX=y.defaultWidthX,n.nominalWidthX=y.nominalWidthX,0!==y.subrs){var b=m+y.subrs,w=Vg(e,b);n.subrs=w.objects,n.subrsBias=Ug(n.subrs)}else n.subrs=[],n.subrsBias=0;r.lowMemory?(g=function(e,t){var n,r,i=[],s=xg.getCard16(e,t);if(0!==s){var a=xg.getByte(e,t+2);n=t+(s+1)*a+2;for(var o=t+3,c=0;c<s+1;c+=1)i.push(xg.getOffset(e,o,a)),o+=a;r=n+i[s]}else r=t+2;return{offsets:i,startOffset:t,endOffset:r}}(e,t+u.charStrings),n.nGlyphs=g.offsets.length):(g=Vg(e,t+u.charStrings),n.nGlyphs=g.objects.length);var v=function(e,t,n,r){var i,s,a=new xg.Parser(e,t);n-=1;var o=[".notdef"],c=a.parseCard8();if(0===c)for(var l=0;l<n;l+=1)i=a.parseSID(),o.push(Gg(r,i));else if(1===c)for(;o.length<=n;){i=a.parseSID(),s=a.parseCard8();for(var u=0;u<=s;u+=1)o.push(Gg(r,i)),i+=1}else{if(2!==c)throw new Error("Unknown charset format "+c);for(;o.length<=n;){i=a.parseSID(),s=a.parseCard16();for(var h=0;h<=s;h+=1)o.push(Gg(r,i)),i+=1}}return o}(e,t+u.charset,n.nGlyphs,o.objects);if(0===u.encoding?n.cffEncoding=new Rg(Tg,v):1===u.encoding?n.cffEncoding=new Rg(_g,v):n.cffEncoding=function(e,t,n){var r,i={},s=new xg.Parser(e,t),a=s.parseCard8();if(0===a)for(var o=s.parseCard8(),c=0;c<o;c+=1)i[r=s.parseCard8()]=c;else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=s.parseCard8();r=1;for(var u=0;u<l;u+=1)for(var h=s.parseCard8(),d=s.parseCard8(),f=h;f<=h+d;f+=1)i[f]=r,r+=1}return new Rg(i,n)}(e,t+u.encoding,v),n.encoding=n.encoding||n.cffEncoding,n.glyphs=new Lg.GlyphSet(n),r.lowMemory)n._push=function(r){var i=function(e,t,n,r){var i=xg.getCard16(n,r),s=0;return 0!==i&&(s=r+(i+1)*xg.getByte(n,r+2)+2),xg.getBytes(n,s+t[e],s+t[e+1])}(r,g.offsets,e,t+u.charStrings);n.glyphs.push(r,Lg.cffGlyphLoader(n,r,Kg,i))};else for(var S=0;S<n.nGlyphs;S+=1){var x=g.objects[S];n.glyphs.push(S,Lg.cffGlyphLoader(n,S,Kg,x))}}(F.data,F.offset,y,t)}var R=Ab(b,h);if(function(e,t,n,r,i,s,a){a.lowMemory?function(e,t,n,r,i){var s,a;e._hmtxTableData={};for(var o=new xg.Parser(t,n),c=0;c<i;c+=1)c<r&&(s=o.parseUShort(),a=o.parseShort()),e._hmtxTableData[c]={advanceWidth:s,leftSideBearing:a}}(e,t,n,r,i):function(e,t,n,r,i){for(var s,a,o=new xg.Parser(e,t),c=0;c<r;c+=1){c<n&&(s=o.parseUShort(),a=o.parseShort());var l=i.get(c);l.advanceWidth=s,l.leftSideBearing=a}}(t,n,r,i,s)}(y,R.data,R.offset,y.numberOfHMetrics,y.numGlyphs,y.glyphs,t),function(e,t){t.lowMemory?function(e){e._IndexToUnicodeMap={};for(var t=e.tables.cmap.glyphIndexMap,n=Object.keys(t),r=0;r<n.length;r+=1){var i=n[r],s=t[i];void 0===e._IndexToUnicodeMap[s]?e._IndexToUnicodeMap[s]={unicodes:[parseInt(i)]}:e._IndexToUnicodeMap[s].unicodes.push(parseInt(i))}}(e):function(e){for(var t,n=e.tables.cmap.glyphIndexMap,r=Object.keys(n),i=0;i<r.length;i+=1){var s=r[i],a=n[s];(t=e.glyphs.get(a)).addUnicode(parseInt(s))}for(var o=0;o<e.glyphs.length;o+=1)t=e.glyphs.get(o),e.cffEncoding?e.isCIDFont?t.name="gid"+o:t.name=e.cffEncoding.charset[o]:e.glyphNames.names&&(t.name=e.glyphNames.glyphIndexToName(o))}(e)}(y,t),d){var M=Ab(b,d);y.kerningPairs=function(e,t){var n=new xg.Parser(e,t),r=n.parseUShort();if(0===r)return function(e){var t={};e.skip("uShort");var n=e.parseUShort();Wp.argument(0===n,"Unsupported kern sub-table version."),e.skip("uShort",2);var r=e.parseUShort();e.skip("uShort",3);for(var i=0;i<r;i+=1){var s=e.parseUShort(),a=e.parseUShort(),o=e.parseShort();t[s+","+a]=o}return t}(n);if(1===r)return function(e){var t={};e.skip("uShort"),e.parseULong()>1&&console.warn("Only the first kern subtable is supported."),e.skip("uLong");var n=255&e.parseUShort();if(e.skip("uShort"),0===n){var r=e.parseUShort();e.skip("uShort",3);for(var i=0;i<r;i+=1){var s=e.parseUShort(),a=e.parseUShort(),o=e.parseShort();t[s+","+a]=o}}return t}(n);throw new Error("Unsupported kern table version ("+r+").")}(M.data,M.offset)}else y.kerningPairs={};if(c){var D=Ab(b,c);y.tables.gdef=function(e,t){var n=new vg(e,t=t||0),r=n.parseVersion(1);Wp.argument(1===r||1.2===r||1.3===r,"Unsupported GDEF table version.");var i={version:r,classDef:n.parsePointer(vg.classDef),attachList:n.parsePointer(xb),ligCaretList:n.parsePointer(kb),markAttachClassDef:n.parsePointer(vg.classDef)};return r>=1.2&&(i.markGlyphSets=n.parsePointer(Tb)),i}(D.data,D.offset)}if(l){var O=Ab(b,l);y.tables.gpos=function(e,t){var n=new vg(e,t=t||0),r=n.parseVersion(1);return Wp.argument(1===r||1.1===r,"Unsupported GPOS table version "+r),1===r?{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(_b)}:{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(_b),variations:n.parseFeatureVariationsList()}}(O.data,O.offset),y.position.init()}if(u){var P=Ab(b,u);y.tables.gsub=function(e,t){var n=new vg(e,t=t||0),r=n.parseVersion(1);return Wp.argument(1===r||1.1===r,"Unsupported GSUB table version."),1===r?{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(xm)}:{version:r,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(xm),variations:n.parseFeatureVariationsList()}}(P.data,P.offset)}if(a){var N=Ab(b,a);y.tables.fvar=function(e,t,n){var r=new xg.Parser(e,t),i=r.parseULong();Wp.argument(65536===i,"Unsupported fvar table version.");var s=r.parseOffset16();r.skip("uShort",1);for(var a=r.parseUShort(),o=r.parseUShort(),c=r.parseUShort(),l=r.parseUShort(),u=[],h=0;h<a;h++)u.push(vb(e,t+s+h*o,n));for(var d=[],f=t+s+a*o,p=0;p<c;p++)d.push(Sb(e,f+p*l,u,n));return{axes:u,instances:d}}(N.data,N.offset,y.names)}if(g){var L=Ab(b,g);y.tables.meta=function(e,t){var n=new xg.Parser(e,t),r=n.parseULong();Wp.argument(1===r,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var i=n.parseULong(),s={},a=0;a<i;a++){var o=n.parseTag(),c=n.parseULong(),l=n.parseULong(),u=Xp.UTF8(e,t+c,l);s[o]=u}return s}(L.data,L.offset),y.metas=y.tables.meta}return y}(r.buffer),s={ascent:i.ascender/i.unitsPerEm,descent:Math.abs(i.descender/i.unitsPerEm),maxAdvance:i.tables.hhea.advanceWidthMax/i.unitsPerEm,lineHeight:(i.ascender-i.descender+i.tables.hhea.lineGap)/i.unitsPerEm,style:2&i.tables.head.macStyle?"italic":"normal",weight:1&i.tables.head.macStyle?"bold":"normal"},a=t?i.names.fullName.en:i.names.fontFamily.en;if("undefined"!=typeof FontFace){const e=new FontFace(a,r,{weight:s.weight,style:s.style});self.fonts.add(e)}const o=this.fontRegistry.get(a);return o?o.push(s):this.fontRegistry.set(a,[s]),this.fontPaths.set(e,a),a}catch(t){return uh.isDevMode&&uh.stderr.write(`warning,Error loading font:${e} - ${t.message}`),""}}register=new Ch("register",{signature:{args:[new kh("fontPath",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(""!==this.registerFont(t.value))});getFamilies=new Ch("getFamilies",{signature:{args:[],returns:T.Object},impl:e=>{const t=[];for(const e of this.fontRegistry.keys())t.push(new M(e));return new Kh(t)}});getFont=new Ch("getFont",{signature:{args:[new kh("family",T.String),new kh("size",T.Int32),new kh("bold",T.Boolean),new kh("italic",T.Boolean)],returns:T.Object},impl:(e,t,n,r,i)=>this.createFont(t,n,r,i)});getDefaultFont=new Ch("getDefaultFont",{signature:{args:[new kh("size",T.Int32,new vh(this.defaultFontSize)),new kh("bold",T.Boolean,D.False),new kh("italic",T.Boolean,D.False)],returns:T.Object},impl:(e,t,n,r)=>{const i=new M(this.getDefaultFontFamily(n.toBoolean(),r.toBoolean()));return this.createFont(i,t,n,r)}});getDefaultFontSize=new Ch("getDefaultFontSize",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.defaultFontSize)})}function mw(){return fw||(fw=new gw),fw}class yw extends L{kind=T.Object;x=0;y=0;width;height;doubleBuffer;maxMs;valid;alphaEnable;currentBuffer;lastBuffer;canvas;context;port;isDirty;lastMessage;scaleMode;constructor(e,t,n){super("roScreen");let r=854,i=480;"1080p"===uh.deviceInfo.displayMode?(r=1920,i=1080):"720p"===uh.deviceInfo.displayMode&&(r=1280,i=720),this.lastMessage=performance.now(),this.scaleMode=0,this.isDirty=!0,this.width=r,this.height=i,this.valid=!0,t instanceof bh||t instanceof mh||t instanceof vh?(this.width=Math.trunc(t.getValue()),this.width<=0&&(this.width=r)):void 0!==t&&(this.valid=!1),n instanceof bh||n instanceof mh||n instanceof vh?(this.height=Math.trunc(n.getValue()),this.height<=0&&(this.height=i)):void 0!==n&&(this.valid=!1),this.doubleBuffer=!1,e instanceof D?this.doubleBuffer=e.toBoolean():void 0!==e&&(this.valid=!1),this.currentBuffer=0,this.lastBuffer=0,this.canvas=new Array(this.doubleBuffer?2:1),this.context=new Array(this.doubleBuffer?2:1),this.createDisplayBuffer(),this.alphaEnable=!1;const s=uh.deviceInfo.maxFps;this.maxMs=Math.trunc(1/s*1e3);const a=new qb(this),o=new ap(this,this.getNewEvents.bind(this)),c=new op(this);this.registerMethods({ifScreen:[this.swapBuffers],ifDraw2D:[a.clear,a.drawObject,a.drawRotatedObject,a.drawScaledObject,a.drawTransformedObject,a.drawLine,a.drawPoint,a.drawRect,a.drawText,a.finish,a.getAlphaEnable,a.setAlphaEnable,a.getByteArray,a.getPng,a.getWidth,a.getHeight],ifSetMessagePort:[o.setMessagePort,o.setPort],ifGetMessagePort:[c.getMessagePort,c.getPort]})}createDisplayBuffer(){for(let e=0;e<this.canvas.length;e++)this.canvas[e]=iw(this.width,this.height),this.canvas[e]&&(this.context[e]=this.canvas[e].getContext("2d"),this.canvas[e].width=this.width,this.canvas[e].height=this.height)}getCanvas(){return this.canvas[this.lastBuffer]}getRgbaCanvas(e){return this.canvas[this.lastBuffer]}getContext(){return this.context[this.currentBuffer]}clearCanvas(e){let t=this.context[this.currentBuffer];t.fillStyle=cw(e,!1),t.fillRect(0,0,this.width,this.height),this.isDirty=!0}drawImage(e,t,n,r=1,i=1,s){return this.isDirty=tw(this,e,t,n,r,i,s),this.isDirty}drawImageToContext(e,t,n){const r=this.context[this.currentBuffer];return this.isDirty=rw(r,e,this.alphaEnable,t,n),this.isDirty}setCanvasAlpha(e){return this.alphaEnable=e,O.Instance}getCanvasAlpha(){return this.alphaEnable}toString(e){return"<Component: roScreen>"}equalTo(e){return D.False}makeDirty(){this.isDirty=!0}finishDraw(){!this.doubleBuffer&&this.isDirty&&(postMessage(this.context[0].getImageData(0,0,this.width,this.height)),this.isDirty=!1)}dispose(){this.port?.unregisterCallback(this.getComponentName());for(const e of this.canvas)sw(e)}isValid(){return this.valid}getNewEvents(){const e=[],t=uh.updateKeysBuffer();return t&&e.push(new _d(t)),e}swapBuffers=new Ch("swapBuffers",{signature:{args:[],returns:T.Void},impl:e=>{if(this.isDirty){let e=performance.now();for(;e-this.lastMessage<this.maxMs;)e=performance.now();postMessage(this.context[this.currentBuffer].getImageData(0,0,this.width,this.height)),this.doubleBuffer&&(this.lastBuffer=this.currentBuffer,this.currentBuffer++,this.currentBuffer===this.canvas.length&&(this.currentBuffer=0)),this.clearCanvas(255),this.isDirty=!1,this.lastMessage=e}return O.Instance}})}function bw(e,t,n){if(void 0!==t&&void 0===n||void 0===t&&void 0!==n)return O.Instance;const r=new yw(e,t,n);return r.isValid()?r:O.Instance}class ww{component;constructor(e){this.component=e}addHeader=new Ch("addHeader",{signature:{args:[new kh("name",T.String),new kh("value",T.String)],returns:T.Boolean},impl:(e,t,n)=>("x-roku-reserved-dev-id"===t.value.toLowerCase()?this.component.customHeaders.set(t.value,uh.deviceInfo.developerId):this.component.customHeaders.set(t.value,n.value),D.True)});setHeaders=new Ch("setHeaders",{signature:{args:[new kh("headers",T.Dynamic)],returns:T.Boolean},impl:(e,t)=>{this.component.customHeaders.clear();for(const[e,n]of t.elements)"x-roku-reserved-dev-id"===e.toLowerCase()?this.component.customHeaders.set(e,uh.deviceInfo.developerId):this.component.customHeaders.set(e,n.value);return D.True}});initClientCertificates=new Ch("initClientCertificates",{signature:{args:[],returns:T.Boolean},impl:e=>D.True});setCertificatesFile=new Ch("setCertificatesFile",{signature:{args:[new kh("certificate",T.String)],returns:T.Boolean},impl:(e,t)=>(this.component.certificatesFile=t.value,D.True)});setCertificatesDepth=new Ch("setCertificatesDepth",{signature:{args:[new kh("depth",T.Int32)],returns:T.Void},impl:(e,t)=>O.Instance});enableCookies=new Ch("enableCookies",{signature:{args:[],returns:T.Void},impl:e=>(this.component.cookiesEnabled=!0,O.Instance)});getCookies=new Ch("getCookies",{signature:{args:[new kh("domain",T.String),new kh("path",T.String)],returns:T.Object},impl:(e,t,n)=>new Kh([])});addCookies=new Ch("addCookies",{signature:{args:[new kh("cookies",T.Object)],returns:T.Boolean},impl:(e,t)=>D.False});clearCookies=new Ch("clearCookies",{signature:{args:[],returns:T.Void},impl:e=>O.Instance})}class vw extends Error{status;constructor(e,t){super(t),this.status=e}}class Sw extends L{kind=T.Object;textures;requests;port;customHeaders;cookiesEnabled;certificatesFile;constructor(){super("roTextureManager"),this.cookiesEnabled=!1,this.certificatesFile=ue,this.requests=new Map,this.textures=new Map,this.customHeaders=new Map;const e=new ww(this),t=new ap(this,this.getNewEvents.bind(this)),n=new op(this);this.registerMethods({ifTextureManager:[this.requestTexture,this.cancelRequest,this.unloadBitmap,this.cleanup],ifHttpAgent:[e.addHeader,e.setHeaders,e.initClientCertificates,e.setCertificatesFile,e.setCertificatesDepth,e.enableCookies,e.getCookies,e.addCookies,e.clearCookies],ifSetMessagePort:[t.setMessagePort,t.setPort],ifGetMessagePort:[n.getMessagePort,n.getPort]})}toString(e){return"<Component: roTextureManager>"}equalTo(e){return D.False}count(){return this.textures.size}dispose(){this.textures.clear(),this.port?.removeReference()}getNewEvents(){const e=[];for(let t of this.requests.values())e.push(this.createEvent(t)),this.requests.delete(t.identity);return e}createEvent(e){let t=this.loadTexture(e.uri);if(t?.isValid()&&e.size&&e.size.width>0&&e.size.height>0&&(e.size.width!==t.width||e.size.height!==t.height)){const n=nx(e.size),r=new Vb(n);nw(t,r,e.scaleMode),t=r}return e.state=t?.isValid()?Ew.Ready:Ew.Failed,new Md(e,t??O.Instance)}loadTexture(e,t){const n=this.textures.get(e);if(n)return n;let r;if(r=e.startsWith("http")?wd(uh.getCORSProxy(e),"arraybuffer",t??this.customHeaders,this.cookiesEnabled):this.loadLocalFile(e),r){const t=new Vb(r,e);if(t instanceof Vb&&t.isValid())return this.textures.set(e,t),t}}resizeTexture(e,t,n){if(e.isValid()&&t>0&&n>0&&(t!==e.width||n!==e.height)){const r=nx({width:t,height:n}),i=new Vb(r);return nw(e,i,1),i}return e}loadLocalFile(e){try{const t=uh.fileSystem;let n=e;if(e.startsWith("pkg:/locale/images/")&&!t.existsSync(e)){const r=uh.deviceInfo.locale,i=e.substring(19);t.existsSync(`pkg:/locale/${r}/images/${i}`)?n=`pkg:/locale/${r}/images/${i}`:t.existsSync(`pkg:/locale/default/images/${i}`)?n=`pkg:/locale/default/images/${i}`:t.existsSync(`pkg:/locale/en_US/images/${i}`)&&(n=`pkg:/locale/en_US/images/${i}`)}return t.readFileSync(n)}catch(t){uh.isDevMode&&uh.stderr.write(`warning,[roTextureManager] Error requesting texture ${e}: ${t.message}`)}}requestTexture=new Ch("requestTexture",{signature:{args:[new kh("req",T.Object)],returns:T.Void},impl:(e,t)=>t instanceof kw?(sh(t.uri)?t.async?this.requests.set(t.identity,t):this.port&&this.port.pushMessage(this.createEvent(t)):(uh.stderr.write(`warning,*** ERROR: Missing or invalid PHY: '${t.uri}'`),t.state=Ew.Failed,this.port?.pushMessage(new Md(t,O.Instance))),P.Instance):P.Instance});cancelRequest=new Ch("cancelRequest",{signature:{args:[new kh("req",T.Object)],returns:T.Void},impl:(e,t)=>(t instanceof kw&&this.requests.has(t.identity)&&(t.state=Ew.Cancelled,this.requests.delete(t.identity)),P.Instance)});unloadBitmap=new Ch("unloadBitmap",{signature:{args:[new kh("url",T.String)],returns:T.Void},impl:(e,t)=>(this.textures.delete(t.value),P.Instance)});cleanup=new Ch("cleanup",{signature:{args:[],returns:T.Void},impl:e=>(this.textures.clear(),P.Instance)})}function xw(){return pw||(pw=new Sw),pw}var Ew;!function(e){e[e.Requested=0]="Requested",e[e.Downloading=1]="Downloading",e[e.Downloaded=2]="Downloaded",e[e.Ready=3]="Ready",e[e.Failed=4]="Failed",e[e.Cancelled=5]="Cancelled"}(Ew||(Ew={}));let Iw=1;class kw extends L{kind=T.Object;identity;uri;async;state;scaleMode;size;customHeaders;cookiesEnabled;certificatesFile;constructor(e){super("roTextureRequest"),this.identity=Iw++,this.uri=e.value,this.async=!0,this.state=Ew.Requested,this.scaleMode=0,this.cookiesEnabled=!1,this.certificatesFile=ue,this.customHeaders=new Map;const t=new ww(this);this.registerMethods({ifTextureRequest:[this.getId,this.getState,this.setAsync,this.setSize,this.setScaleMode],ifHttpAgent:[t.addHeader,t.setHeaders,t.initClientCertificates,t.setCertificatesFile,t.setCertificatesDepth,t.enableCookies,t.getCookies,t.addCookies,t.clearCookies]})}toString(e){return"<Component: roTextureRequest>"}equalTo(e){return D.False}getId=new Ch("getId",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.identity)});getState=new Ch("getState",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.state)});setAsync=new Ch("setAsync",{signature:{args:[new kh("async",T.Boolean)],returns:T.Void},impl:(e,t)=>(this.async=t.toBoolean(),P.Instance)});setSize=new Ch("setSize",{signature:{args:[new kh("width",T.Int32),new kh("height",T.Int32)],returns:T.Void},impl:(e,t,n)=>(this.size={width:t.getValue(),height:n.getValue()},P.Instance)});setScaleMode=new Ch("setScaleMode",{signature:{args:[new kh("mode",T.Int32)],returns:T.Void},impl:(e,t)=>(this.scaleMode=t.getValue()?1:0,P.Instance)})}const Tw={exif:new Map([[1,"InteroperabilityIndex"],[2,"InteroperabilityVersion"],[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[290,"GrayResponseUnit"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[296,"ResolutionUnit"],[297,"PageNumber"],[300,"ColorResponseUnit"],[301,"TransferFunction"],[305,"Software"],[306,"DateTime"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[320,"ColorMap"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[332,"InkSet"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[337,"TargetPrinter"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[559,"StripRowCounts"],[700,"ApplicationNotes"],[999,"USPTOMiscellaneous"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"],[18246,"Rating"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[18249,"RatingPercent"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33432,"Copyright"],[33434,"ExposureTime"],[33437,"FNumber"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33550,"PixelScale"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33723,"IPTC-NAA"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33920,"IntergraphMatrix"],[33921,"INGRReserved"],[33922,"ModelTiePoint"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34118,"SEMInfo"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34264,"ModelTransform"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34377,"PhotoshopSettings"],[34665,"ExifOffset"],[34675,"ICC_Profile"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34853,"GPSInfo"],[34855,"ISOSpeedRatings"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34954,"LeafSubIFD"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureBiasValue"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"PixelXDimension"],[40963,"PixelYDimension"],[40964,"RelatedSoundFile"],[40965,"InteropOffset"],[41483,"FlashEnergy"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41494,"TIFF-EPStandardID"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41995,"DeviceSettingDescription"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42038,"Title"],[42039,"Photographer"],[42040,"ImageEditor"],[42041,"CameraFirmware"],[42042,"RAWDevelopingSoftware"],[42043,"ImageEditingSoftware"],[42044,"MetadataEditingSoftware"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[42240,"Gamma"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50341,"PrintIM"],[50560,"USPTOOriginalContentType"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50733,"BayerGreenSplit"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50736,"DNGLensInfo"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[50741,"MakerNoteSafety"],[50752,"RawImageSegmentation"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50780,"BestQualityScale"],[50781,"RawDataUniqueID"],[50784,"AliasLayerMetadata"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50935,"NoiseReductionApplied"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"],[51125,"DefaultUserCrop"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65024,"KDC_IFD"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"]]),gps:new Map([[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]])};var _w,Cw,Aw,Fw,Rw,Mw,Dw,Ow,Pw,Nw,Lw,Bw,Uw,Vw,jw,zw,Gw,Hw,$w,Ww,qw,Xw,Yw,Kw,Jw;!function(e){e[e.Image=1]="Image",e[e.Thumbnail=2]="Thumbnail",e[e.GPS=3]="GPS",e[e.Interop=4]="Interop",e[e.EXIF=5]="EXIF"}(_w||(_w={})),function(e){e[e.None=1]="None",e[e.Inch=2]="Inch",e[e.Centimeter=3]="Centimeter"}(Cw||(Cw={})),function(e){e[e.Normal=0]="Normal",e[e.Soft=1]="Soft",e[e.Hard=2]="Hard"}(Aw||(Aw={})),function(e){e[e.Unknown=0]="Unknown",e[e.Daylight=1]="Daylight",e[e.Fluorescent=2]="Fluorescent",e[e["Tungsten incandescent light"]=3]="Tungsten incandescent light",e[e.Flash=4]="Flash",e[e["Fine weather"]=9]="Fine weather",e[e["Cloudy weather"]=10]="Cloudy weather",e[e.Shade=11]="Shade",e[e["Daylight fluorescent"]=12]="Daylight fluorescent",e[e["Day white fluorescent"]=13]="Day white fluorescent",e[e["Cool white fluorescent"]=14]="Cool white fluorescent",e[e["White fluorescent"]=15]="White fluorescent",e[e["Standard light A"]=17]="Standard light A",e[e["Standard light B"]=18]="Standard light B",e[e["Standard light C"]=19]="Standard light C",e[e.D55=20]="D55",e[e.D65=21]="D65",e[e.D75=22]="D75",e[e["ISO studio tungsten"]=24]="ISO studio tungsten",e[e.Other=255]="Other"}(Fw||(Fw={})),function(e){e[e["Not defined"]=1]="Not defined",e[e["One-chip color area sensor"]=2]="One-chip color area sensor",e[e["Two-chip color area sensor"]=3]="Two-chip color area sensor",e[e["Three-chip color area sensor"]=4]="Three-chip color area sensor",e[e["Color sequential area sensor"]=5]="Color sequential area sensor",e[e["Trilinear sensor"]=7]="Trilinear sensor",e[e["Color sequential linear sensor"]=8]="Color sequential linear sensor"}(Rw||(Rw={})),function(e){e[e.Unknown=0]="Unknown",e[e.Average=1]="Average",e[e["Center-weighted average"]=2]="Center-weighted average",e[e.Spot=3]="Spot",e[e["Multi spot"]=4]="Multi spot",e[e.Pattern=5]="Pattern",e[e.Partial=6]="Partial",e[e.Other=255]="Other"}(Mw||(Mw={})),function(e){e[e.sRGB=1]="sRGB",e[e["Adobe RGB"]=2]="Adobe RGB",e[e.Uncalibrated=65535]="Uncalibrated"}(Dw||(Dw={})),function(e){e[e.Unknown=0]="Unknown",e[e["No a composite image"]=1]="No a composite image",e[e["General composite image"]=2]="General composite image",e[e["Composite image captured while shooting"]=3]="Composite image captured while shooting"}(Ow||(Ow={})),function(e){e[e["Top-left"]=1]="Top-left",e[e["Top-right"]=2]="Top-right",e[e["Bottom-right"]=3]="Bottom-right",e[e["Bottom-left"]=4]="Bottom-left",e[e["Left-top"]=5]="Left-top",e[e["Right-top"]=6]="Right-top",e[e["Right-bottom"]=7]="Right-bottom",e[e["Left-bottom"]=8]="Left-bottom"}(Pw||(Pw={})),function(e){e[e["Auto exposure"]=0]="Auto exposure",e[e["Manual exposure"]=1]="Manual exposure",e[e["Auto bracket"]=2]="Auto bracket"}(Nw||(Nw={})),function(e){e[e["Not defined"]=0]="Not defined",e[e.Manual=1]="Manual",e[e["Normal program"]=2]="Normal program",e[e["Aperture priority"]=3]="Aperture priority",e[e["Shutter priority"]=4]="Shutter priority",e[e["Creative program (biased toward depth of field)"]=5]="Creative program (biased toward depth of field)",e[e["Creative program (biased toward fast shutter speed)"]=6]="Creative program (biased toward fast shutter speed)",e[e["Portrait mode (for closeup photos with the background out of focus)"]=7]="Portrait mode (for closeup photos with the background out of focus)",e[e["Landscape mode (for landscape photos with the background in focus)"]=8]="Landscape mode (for landscape photos with the background in focus)"}(Lw||(Lw={})),function(e){e[e.Unknown=0]="Unknown",e[e["Standard output sensitivity (SOS)"]=1]="Standard output sensitivity (SOS)",e[e["Recommended exposure index (REI)"]=2]="Recommended exposure index (REI)",e[e["ISO speed"]=3]="ISO speed",e[e["Standard output sensitivity (SOS) and recommended exposure index (REI)"]=4]="Standard output sensitivity (SOS) and recommended exposure index (REI)",e[e["Standard output sensitivity (SOS) and ISO speed"]=5]="Standard output sensitivity (SOS) and ISO speed",e[e["Recommended exposure index (REI) and ISO speed"]=6]="Recommended exposure index (REI) and ISO speed",e[e["Standard output sensitivity (SOS) and recommended exposure index (REI) and ISO speed"]=7]="Standard output sensitivity (SOS) and recommended exposure index (REI) and ISO speed"}(Bw||(Bw={})),function(e){e[e["Auto white balance"]=0]="Auto white balance",e[e["Manual white balance"]=1]="Manual white balance"}(Uw||(Uw={})),function(e){e[e.Normal=0]="Normal",e[e["Low gain up"]=1]="Low gain up",e[e["High gain Up"]=2]="High gain Up",e[e["Low gain down"]=3]="Low gain down",e[e["High gain down"]=4]="High gain down"}(Vw||(Vw={})),function(e){e[e["Normal process"]=0]="Normal process",e[e["Custom process"]=1]="Custom process"}(jw||(jw={})),function(e){e[e.Uncompressed=1]="Uncompressed",e[e["CCITT 1D"]=2]="CCITT 1D",e[e["T4/Group 3 Fax"]=3]="T4/Group 3 Fax",e[e["T6/Group 4 Fax"]=4]="T6/Group 4 Fax",e[e["LZW compression"]=5]="LZW compression",e[e["JPEG compression"]=6]="JPEG compression",e[e["JPEG compression (new)"]=7]="JPEG compression (new)",e[e["Deflate/ZIP compression"]=8]="Deflate/ZIP compression",e[e["JBIG B&W"]=9]="JBIG B&W",e[e["JBIG Color"]=10]="JBIG Color",e[e.JPEG=99]="JPEG",e[e.Next=32766]="Next",e[e["Sony ARW Compressed"]=32767]="Sony ARW Compressed",e[e["Packed RAW"]=32769]="Packed RAW",e[e["Samsung SRW Compressed"]=32770]="Samsung SRW Compressed",e[e.CCIRLEW=32771]="CCIRLEW",e[e["Samsung SRW Compressed 2"]=32772]="Samsung SRW Compressed 2",e[e["PackBits compression"]=32773]="PackBits compression",e[e.Thunderscan=32809]="Thunderscan",e[e["Kodak KDC Compressed"]=32867]="Kodak KDC Compressed",e[e.IT8CTPAD=32895]="IT8CTPAD",e[e.IT8LW=32896]="IT8LW",e[e.IT8MP=32897]="IT8MP",e[e.IT8BL=32898]="IT8BL",e[e.PixarFilm=32908]="PixarFilm",e[e.PixarLog=32909]="PixarLog",e[e.Deflate=32946]="Deflate",e[e.DCS=32947]="DCS",e[e["Aperio JPEG 2000 YCbCr"]=33003]="Aperio JPEG 2000 YCbCr",e[e["Aperio JPEG 2000 RGB"]=33005]="Aperio JPEG 2000 RGB",e[e.JBIG=34661]="JBIG",e[e.SGILog=34676]="SGILog",e[e.SGILog24=34677]="SGILog24",e[e["JPEG 2000"]=34712]="JPEG 2000",e[e["Nikon NEF Compressed"]=34713]="Nikon NEF Compressed",e[e["JBIG2 TIFF FX"]=34715]="JBIG2 TIFF FX",e[e["Microsoft Document Imaging (MDI) Binary Level Codec"]=34718]="Microsoft Document Imaging (MDI) Binary Level Codec",e[e["Microsoft Document Imaging (MDI) Progressive Transform Codec"]=34719]="Microsoft Document Imaging (MDI) Progressive Transform Codec",e[e["Microsoft Document Imaging (MDI) Vector"]=34720]="Microsoft Document Imaging (MDI) Vector",e[e["ESRI Lerc"]=34887]="ESRI Lerc",e[e["Lossy JPEG"]=34892]="Lossy JPEG",e[e.LZMA2=34925]="LZMA2",e[e.Zstd=34926]="Zstd",e[e.WebP=34927]="WebP",e[e.PNG=34933]="PNG",e[e["JPEG XR"]=34934]="JPEG XR",e[e["JPEG XL"]=52546]="JPEG XL",e[e["Kodak DCR Compressed"]=65e3]="Kodak DCR Compressed",e[e["Pentax PEF Compressed"]=65535]="Pentax PEF Compressed"}(zw||(zw={})),function(e){e[e["Flash did not fire"]=0]="Flash did not fire",e[e["Flash fired"]=1]="Flash fired",e[e["Strobe return light not detected"]=5]="Strobe return light not detected",e[e["Strobe return light detected"]=7]="Strobe return light detected",e[e["Flash fired, compulsory flash mode"]=9]="Flash fired, compulsory flash mode",e[e["Flash fired, compulsory flash mode, return light not detected"]=13]="Flash fired, compulsory flash mode, return light not detected",e[e["Flash fired, compulsory flash mode, return light detected"]=15]="Flash fired, compulsory flash mode, return light detected",e[e["Flash did not fire, compulsory flash mode"]=16]="Flash did not fire, compulsory flash mode",e[e["Flash did not fire, auto mode"]=24]="Flash did not fire, auto mode",e[e["Flash fired, auto mode"]=25]="Flash fired, auto mode",e[e["Flash fired, auto mode, return light not detected"]=29]="Flash fired, auto mode, return light not detected",e[e["Flash fired, auto mode, return light detected"]=31]="Flash fired, auto mode, return light detected",e[e["No flash function"]=32]="No flash function",e[e["Flash fired, red-eye reduction mode"]=65]="Flash fired, red-eye reduction mode",e[e["Flash fired, red-eye reduction mode, return light not detected"]=69]="Flash fired, red-eye reduction mode, return light not detected",e[e["Flash fired, red-eye reduction mode, return light detected"]=71]="Flash fired, red-eye reduction mode, return light detected",e[e["Flash fired, compulsory flash mode, red-eye reduction mode"]=73]="Flash fired, compulsory flash mode, red-eye reduction mode",e[e["Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected"]=77]="Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",e[e["Flash fired, compulsory flash mode, red-eye reduction mode, return light detected"]=79]="Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",e[e["Flash fired, auto mode, red-eye reduction mode"]=89]="Flash fired, auto mode, red-eye reduction mode",e[e["Flash fired, auto mode, return light not detected, red-eye reduction mode"]=93]="Flash fired, auto mode, return light not detected, red-eye reduction mode",e[e["Flash fired, auto mode, return light detected, red-eye reduction mode"]=95]="Flash fired, auto mode, return light detected, red-eye reduction mode"}(Gw||(Gw={})),function(e){e[e.Unknown=0]="Unknown",e[e.Macro=1]="Macro",e[e["Close view"]=2]="Close view",e[e["Distant view"]=3]="Distant view"}(Hw||(Hw={})),function(e){e[e.Centered=1]="Centered",e[e["Co-sited"]=2]="Co-sited"}($w||($w={})),function(e){e[e["Reversed mono"]=0]="Reversed mono",e[e["Normal mono"]=1]="Normal mono",e[e.RGB=2]="RGB",e[e.Palette=3]="Palette",e[e.CMYK=5]="CMYK",e[e.YCbCr=6]="YCbCr",e[e.CieLAB=8]="CieLAB"}(Ww||(Ww={})),function(e){e[e.Standard=0]="Standard",e[e.Landscape=1]="Landscape",e[e.Portrait=2]="Portrait",e[e["Night scene"]=3]="Night scene"}(qw||(qw={})),function(e){e[e["Sea level"]=0]="Sea level",e[e["Sea level reference"]=1]="Sea level reference"}(Xw||(Xw={})),function(e){e[e["2-dimensional measurement"]=2]="2-dimensional measurement",e[e["3-dimensional measurement"]=3]="3-dimensional measurement"}(Yw||(Yw={})),function(e){e[e["No differential correction"]=0]="No differential correction",e[e["Differential corrected"]=1]="Differential corrected"}(Kw||(Kw={})),function(e){e["Measurement active"]="A",e["Measurement void"]="V"}(Jw||(Jw={}));const Zw={ColorSpace:Dw,Compression:zw,Flash:Gw,LightSource:Fw,Contrast:Aw,Saturation:Aw,Sharpness:Aw,GainControl:Vw,ExposureMode:Nw,ExposureProgram:Lw,SensitivityType:Bw,PhotometricInterpretation:Ww,CompositeImage:Ow,WhiteBalance:Uw,SceneCaptureType:qw,SubjectDistanceRange:Hw,SensingMethod:Rw,MeteringMode:Mw,Orientation:Pw,ResolutionUnit:Cw,FocalPlaneResolutionUnit:Cw,CustomRendered:jw,YCbCrPositioning:$w,GPSAltitudeRef:Xw,GPSMeasureMode:Yw,GPSDifferential:Kw,GPSStatus:Jw};var Qw=__webpack_require__(3760),ev=__webpack_require__(1048).Buffer;class tv extends L{kind=T.Object;fileData;constructor(){super("roImageMetadata"),this.registerMethods({ifImageMetadata:[this.setUrl,this.getMetadata,this.getThumbnail,this.getRawExif,this.getRawExifTag]})}toString(e){return"<Component: roImageMetadata>"}equalTo(e){return D.False}loadFile(e,t){let n;try{n=uh.fileSystem?.readFileSync(t)}catch(e){uh.isDevMode&&uh.stderr.write(`warning,[roImageMetadata] Error loading bitmap:${t} - ${e.message}`)}return n}findValue(e,t,n){return e.find(e=>e.section===t&&e.type===n)??null}getTagData(e,t=Tw.exif){let n;const r=t.get(e.type)??"",i=Zw[r];switch(typeof e.value){case"string":n=e.value;break;case"number":n=void 0!==i?i[e.value]??e.value.toString():e.value.toString();break;default:n=e.value instanceof ev?this.processBufferTag(r,e.value):e.value instanceof ArrayBuffer?this.processBufferTag(r,ev.from(e.value)):Array.isArray(e.value)?"GPSTimeStamp"===r?e.value.join(":"):"SubjectArea"===r?this.decodeExifSubjectArea(e.value):e.value.join(", "):e.value.toString()}return nx({tag:e.type,tagValue:n})}processBufferTag(e,t){let n;switch(e){case"UserComment":n=this.decodeUserComment(t);break;case"ComponentsConfiguration":n=this.decodeComponentsConfiguration(t);break;case"FileSource":n=""===t.toString("ascii")?"DSC":t.toString();break;case"SceneType":n=""===t.toString("ascii")?"Directly photographed":t.toString();break;case"ExifVersion":n=`Exif Version ${this.decodeVersion(t)}`;break;case"FlashpixVersion":n=`Flashpix Version ${this.decodeVersion(t)}`;break;case"InteroperabilityVersion":n=t.toString("ascii");break;default:n=`${t.length} bytes undefined data`}return n}decodeComponentsConfiguration(e){const t=["-","Y","Cb","Cr","R","G","B"];let n="";for(let r=0;r<Math.max(e.length,4);r++)n+=t[e[r]]+" ";return n.trim()}decodeUserComment(e){if(e instanceof ev){const t=e.toString("ascii",0,8),n=e.subarray(8);try{switch(t){case"ASCII\0\0\0":default:return new TextDecoder("ascii").decode(n);case"UNICODE\0":return new TextDecoder("utf-16").decode(n);case"JIS\0\0\0\0\0":return new TextDecoder("iso-2022-jp").decode(n)}}catch(e){return""}}return""}decodeExifSubjectArea(e){switch(e.length){case 2:return`(x,y) = (${e[0]}, ${e[1]})`;case 3:return`Within distance ${e[2]} of (x, y) = (${e[0]}, ${e[1]})`;case 4:return`Within rectangle (width ${e[0]}, height ${e[1]}) around (x,y) = (${e[2]}, ${e[3]})`;default:return`Unexpected number of components (${e.length}, expected 2, 3, or 4). ${e.join(", ")}`}}decodeVersion(e){let t=new TextDecoder("ascii").decode(e),n=parseFloat(`${t.slice(0,2)}.${t.slice(2)}`);return Number.isInteger(n)?n+".0":n.toString()}setUrl=new Ch("setUrl",{signature:{args:[new kh("url",T.String)],returns:T.Void},impl:(e,t)=>(this.fileData=this.loadFile(e,t.value),O.Instance)});getMetadata=new Ch("getMetadata",{signature:{args:[],returns:T.Object},impl:e=>{if(!this.fileData)return O.Instance;const t=new Map;try{const e=Qw.create(this.fileData);e.enableBinaryFields(!0);const n=e.parse();let r=n.getImageSize();if(n.tags){t.set("comment",this.decodeUserComment(n.tags.UserComment)),"number"==typeof n.tags.CreateDate&&t.set("datetime",new up(n.tags.CreateDate));const e=Zw.Orientation;t.set("width",r?.width??0),t.set("height",r?.height??0),t.set("orientation",e[n.tags.Orientation??0]??"")}}catch(e){uh.isDevMode&&uh.stderr.write(`warning,[roImageMetadata] Error reading metadata:${e.message}`),t.set("width",0),t.set("height",0),t.set("comment",""),t.set("orientation","")}return nx(t)}});getThumbnail=new Ch("getThumbnail",{signature:{args:[],returns:T.Object},impl:e=>{if(!this.fileData)return O.Instance;try{const e=Qw.create(this.fileData);e.enableReturnTags(!1);const t=e.parse();if(t.hasThumbnail("image/jpeg")){const e=t.getThumbnailBuffer();if(e)return nx({bytes:new gd(new Uint8Array(e)),type:"image/jpeg"})}}catch(e){uh.isDevMode&&uh.stderr.write(`warning,[roImageMetadata] Error getting thumbnail:${e.message}`)}return O.Instance}});getRawExif=new Ch("getRawExif",{signature:{args:[],returns:T.Object},impl:e=>{if(!this.fileData)return O.Instance;try{const e=new Map,t=new Map,n=new Map,r=new Map,i=new Map,s=Qw.create(this.fileData);s.enablePointers(!0),s.enableBinaryFields(!0),s.enableTagNames(!1),s.enableImageSize(!1);const a=s.parse();for(const s of a.tags){const a=s.section===_w.GPS?Tw.gps:Tw.exif,o=a.get(s.type)??"";""!==o&&(s.section===_w.EXIF||s.section===_w.Interop?o.startsWith("Interop")?r.set(o,this.getTagData(s)):e.set(o,this.getTagData(s)):s.section===_w.GPS?t.set(o,this.getTagData(s,a)):s.section===_w.Image?n.set(o,this.getTagData(s)):s.section===_w.Thumbnail&&i.set(o,this.getTagData(s)))}return nx({exif:e,gps:t,image:n,interoperability:r,thumbnail:i})}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,[roImageMetadata] Error getting raw exif:${e.message}`),new Fh([])}}});getRawExifTag=new Ch("getRawExifTag",{signature:{args:[new kh("ifd",T.Int32|T.Float),new kh("tagnum",T.Int32|T.Float)],returns:T.Dynamic},impl:(e,t,n)=>{if(!this.fileData)return O.Instance;try{const e=Qw.create(this.fileData);e.enablePointers(!0),e.enableBinaryFields(!0),e.enableTagNames(!1),e.enableImageSize(!1);const r=e.parse(),i=t.getValue()===_w.GPS?Tw.gps:Tw.exif,s={0:_w.Image,1:_w.Thumbnail,2:_w.EXIF,3:_w.GPS,4:_w.EXIF}[t.getValue()]??_w.EXIF,a=this.findValue(r.tags,s,n.getValue());return a?this.getTagData(a,i):new Fh([])}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,[roImageMetadata] Error getting raw exif tag:${e.message}`),new Fh([])}}})}var nv=__webpack_require__(5007),rv=__webpack_require__.n(nv),iv=__webpack_require__(1048).Buffer;class sv extends L{kind=T.Object;fileData;constructor(){super("roAudioMetadata"),this.registerMethods({ifAudioMetadata:[this.setUrl,this.getTags,this.getAudioProperties,this.getCoverArt]})}toString(e){return"<Component: roAudioMetadata>"}equalTo(e){return D.False}loadFile(e){let t;try{t=uh.fileSystem?.readFileSync(e)}catch(t){uh.isDevMode&&uh.stderr.write(`warning,[roAudioMetadata] Error loading audio:${e} - ${t.message}`)}return t instanceof iv?new DataView(t.buffer):t?new DataView(t):void 0}updateTagsFromSection(e,t){const n=new Map([["TCON","genre"],["TIT2","title"],["TPE1","artist"],["TALB","album"],["TCOM","composer"],["COMM","comment"],["TYER","year"],["TRCK","track"]]);for(let r of t){const t=n.get(r?.header?.id),i=r?.content?.value;"string"==typeof t&&"string"==typeof i&&(["year","track"].includes(t)?e.set(new M(t),new vh(this.parseIntSafe(i))):e.set(new M(t),new M(i)))}}getCoverArtFromSection(e){for(let t of e)if("APIC"===t?.header?.id)return nx({bytes:new gd(new Uint8Array(t.content.pictureData.buffer,t.content.pictureData.byteOffset,t.content.pictureData.byteLength)),type:t.content.mimeType});return null}parseIntSafe(e){const t=Number.parseInt(e,10);return Number.isNaN(t)?0:t}setUrl=new Ch("setUrl",{signature:{args:[new kh("url",T.String)],returns:T.Boolean},impl:(e,t)=>(this.fileData=this.loadFile(t.value),D.from(void 0!==this.fileData))});getTags=new Ch("getTags",{signature:{args:[],returns:T.Object},impl:e=>{if(!this.fileData)return O.Instance;try{const e=rv().readTags(this.fileData),t=nx({genre:"",title:"",artist:"",album:"",composer:"",comment:"",year:0,track:0});if(Array.isArray(e)&&e.length>0){for(let n of e)if("ID3v2"===n?._section?.type){this.updateTagsFromSection(t,n.frames);break}return t}}catch(e){uh.isDevMode&&uh.stderr.write(`warning,[roAudioMetadata] Error getting audio tags:${e.message}`)}return O.Instance}});getAudioProperties=new Ch("getAudioProperties",{signature:{args:[],returns:T.Object},impl:e=>{if(!this.fileData)return O.Instance;try{const e=rv().readTags(this.fileData);if(Array.isArray(e)&&e.length>0){const t={};for(let n of e){if("frame"!==n?._section?.type)continue;const r=this.fileData.byteLength,i=n._section?.offset??0,s=n.header?.bitrate??48,a=Math.round(8*(r-i)/(1e3*s)),o=e[1]?.header?.samplingRate??0,c="11"===e[1]?.header?.channelModeBits?1:2;t.length=a,t.bitrate=s,t.samplerate=o,t.channels=c;break}return nx(t)}}catch(e){uh.isDevMode&&uh.stderr.write(`warning,[roAudioMetadata] Error reading audio properties:${e.message}`)}return O.Instance}});getCoverArt=new Ch("getCoverArt",{signature:{args:[],returns:T.Object},impl:e=>{if(!this.fileData)return O.Instance;try{const e=rv().readTags(this.fileData);if(Array.isArray(e)&&e.length>0)for(let t of e)if("ID3v2"===t?._section?.type)return this.getCoverArtFromSection(t.frames)??O.Instance}catch(e){uh.isDevMode&&uh.stderr.write(`warning,[roAudioMetadata] Error getting cover art:${e.message}`)}return O.Instance}})}class av extends L{kind=T.Object;port;contentList;eventType;customHeaders;cookiesEnabled;certificatesFile;constructor(){super("roAudioPlayer"),this.contentList=new Array,this.eventType=-1,this.cookiesEnabled=!1,this.customHeaders=new Map,this.certificatesFile=ue,postMessage({audioPlaylist:new Array}),postMessage("audio,loop,false"),postMessage("audio,next,-1"),postMessage("audio,mute,false");const e=new ww(this),t=new ap(this,this.getNewEvents.bind(this)),n=new op(this);this.registerMethods({ifAudioPlayer:[this.setContentList,this.addContent,this.clearContent,this.play,this.stop,this.pause,this.resume,this.setLoop,this.setNext,this.seek,this.setTimedMetadataForKeys],ifHttpAgent:[e.addHeader,e.setHeaders,e.initClientCertificates,e.setCertificatesFile,e.setCertificatesDepth,e.enableCookies,e.getCookies,e.addCookies,e.clearCookies],ifSetMessagePort:[t.setMessagePort,t.setPort],ifGetMessagePort:[n.getMessagePort,n.getPort]})}toString(e){return"<Component: roAudioPlayer>"}equalTo(e){return D.False}dispose(){for(const e of this.contentList)e.removeReference();this.port?.removeReference()}getContent(){const e=new Array;for(const t of this.contentList){let n=t.get(new M("url"));n instanceof M&&(n.value.startsWith("http")?e.push(uh.getCORSProxy(n.value)):e.push(n.value))}return e}getNewEvents(){const e=[],t=Atomics.load(uh.sharedArray,ve.SND);return t!==this.eventType&&(this.eventType=t,this.eventType>=0&&e.push(new Fd(this.eventType,Atomics.load(uh.sharedArray,ve.SDX)))),e}setContentList=new Ch("setContentList",{signature:{args:[new kh("contentList",T.Object)],returns:T.Void},impl:(e,t)=>(this.contentList=t.getElements(),postMessage({audioPlaylist:this.getContent()}),O.Instance)});addContent=new Ch("addContent",{signature:{args:[new kh("contentItem",T.Object)],returns:T.Void},impl:(e,t)=>(t.addReference(),this.contentList.push(t),postMessage({audioPlaylist:this.getContent()}),O.Instance)});clearContent=new Ch("clearContent",{signature:{args:[],returns:T.Void},impl:e=>(this.contentList=new Array,postMessage({audioPlaylist:new Array}),O.Instance)});play=new Ch("play",{signature:{args:[],returns:T.Boolean},impl:e=>(postMessage("audio,play"),D.True)});stop=new Ch("stop",{signature:{args:[],returns:T.Boolean},impl:e=>(postMessage("audio,stop"),D.True)});pause=new Ch("pause",{signature:{args:[],returns:T.Boolean},impl:e=>(postMessage("audio,pause"),D.True)});resume=new Ch("resume",{signature:{args:[],returns:T.Boolean},impl:e=>(postMessage("audio,resume"),D.True)});setLoop=new Ch("setLoop",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>(postMessage(`audio,loop,${t.toString()}`),O.Instance)});setNext=new Ch("setNext",{signature:{args:[new kh("item",T.Int32)],returns:T.Void},impl:(e,t)=>(postMessage(`audio,next,${t.toString()}`),O.Instance)});seek=new Ch("seek",{signature:{args:[new kh("offsetMs",T.Int32)],returns:T.Void},impl:(e,t)=>(postMessage(`audio,seek,${t.toString()}`),O.Instance)});setTimedMetadataForKeys=new Ch("setTimedMetadataForKeys",{signature:{args:[new kh("keys",T.Dynamic)],returns:T.Void},impl:(e,t)=>O.Instance})}class ov extends L{kind=T.Object;port;contentList;notificationPeriod;eventType;eventIndex;position;progress;selected;audioTracks;customHeaders;cookiesEnabled;certificatesFile;constructor(){super("roVideoPlayer"),this.contentList=new Array,this.notificationPeriod=0,this.eventType=-1,this.eventIndex=-1,this.position=0,this.progress=-1,this.selected=0,this.audioTracks=[],this.cookiesEnabled=!1,this.certificatesFile=ue,this.customHeaders=new Map,postMessage({videoPlaylist:new Array}),postMessage({supportCaptions:!1}),postMessage("video,loop,false"),postMessage("video,next,-1"),postMessage("video,mute,false");const e=new ww(this),t=new ap(this,this.getNewEvents.bind(this)),n=new op(this);this.registerMethods({ifVideoPlayer:[this.setContentList,this.addContent,this.clearContent,this.preBuffer,this.play,this.stop,this.pause,this.resume,this.setLoop,this.setNext,this.setEnableAudio,this.seek,this.setPositionNotificationPeriod,this.setCGMS,this.setDestinationRect,this.setMaxVideoDecodeResolution,this.getPlaybackDuration,this.getAudioTracks,this.changeAudioTrack,this.setTimedMetadataForKeys,this.getCaptionRenderer,this.setMacrovisionLevel],ifHttpAgent:[e.addHeader,e.setHeaders,e.initClientCertificates,e.setCertificatesFile,e.setCertificatesDepth,e.enableCookies,e.getCookies,e.addCookies,e.clearCookies],ifSetMessagePort:[t.setMessagePort,t.setPort],ifGetMessagePort:[n.getMessagePort,n.getPort]})}toString(e){return"<Component: roVideoPlayer>"}equalTo(e){return D.False}getContent(){const e=[];for(const t of this.contentList){const n={url:"",streamFormat:"",audioTrack:-1};let r=t.get(new M("url"));if(r instanceof M)n.url=this.getFullUrl(r.value);else{const e=t.get(new M("stream"));e instanceof Fh&&(r=e.get(new M("url")),r instanceof M&&(n.url=this.getFullUrl(r.value)))}let i=t.get(new M("streamFormat"));i instanceof M&&(n.streamFormat=i.value.toLowerCase()),e.push(n)}return e}dispose(){for(const e of this.contentList)e.removeReference();this.port?.removeReference()}getNewEvents(){const e=[],t=Atomics.load(uh.sharedArray,ve.VSE);if(t>=0&&(this.selected=t,e.push(new Rd(ke.SELECTED,t)),Atomics.store(uh.sharedArray,ve.VSE,-1)),Atomics.load(uh.sharedArray,ve.BUF)===_e.MEDIA_TRACKS){const t=uh.readDataBuffer();try{this.audioTracks=JSON.parse(t)?.audio??[]}catch(e){this.audioTracks=[]}}const n=Atomics.load(uh.sharedArray,ve.VDO),r=Atomics.load(uh.sharedArray,ve.VDX);n===this.eventType&&r===this.eventIndex||(this.eventType=n,this.eventIndex=r,this.eventType>=0&&(e.push(new Rd(this.eventType,this.eventIndex,this.selected)),Atomics.store(uh.sharedArray,ve.VDO,-1),Atomics.store(uh.sharedArray,ve.VDX,-1)));const i=Atomics.load(uh.sharedArray,ve.VLP);if(this.progress!==i&&i>=0&&i<=1e3&&(this.progress=i,e.push(new Rd(ke.LOADING,i)),1e3===i&&e.push(new Rd(ke.START_PLAY,0))),this.notificationPeriod>=1){const t=Atomics.load(uh.sharedArray,ve.VPS);t>=0&&Math.abs(this.position-t)>=this.notificationPeriod&&(this.position=t,e.push(new Rd(ke.POSITION,t,this.selected)))}return e}getFullUrl(e){return e.startsWith("http")?uh.getCORSProxy(e):e}setContentList=new Ch("setContentList",{signature:{args:[new kh("contentList",T.Object)],returns:T.Void},impl:(e,t)=>(this.selected=0,this.position=0,this.contentList=t.getElements(),postMessage({videoPlaylist:this.getContent()}),O.Instance)});addContent=new Ch("addContent",{signature:{args:[new kh("contentItem",T.Object)],returns:T.Void},impl:(e,t)=>(this.contentList.push(t),postMessage({videoPlaylist:this.getContent()}),O.Instance)});clearContent=new Ch("clearContent",{signature:{args:[],returns:T.Void},impl:e=>(this.position=0,this.selected=0,this.contentList=new Array,postMessage({videoPlaylist:new Array}),O.Instance)});preBuffer=new Ch("preBuffer",{signature:{args:[],returns:T.Boolean},impl:e=>(this.position=0,this.contentList=new Array,postMessage("video,load"),D.True)});play=new Ch("play",{signature:{args:[],returns:T.Boolean},impl:e=>(this.position=0,postMessage("video,play"),D.True)});stop=new Ch("stop",{signature:{args:[],returns:T.Boolean},impl:e=>(this.position=0,postMessage("video,stop"),D.True)});pause=new Ch("pause",{signature:{args:[],returns:T.Boolean},impl:e=>(postMessage("video,pause"),D.True)});resume=new Ch("resume",{signature:{args:[],returns:T.Boolean},impl:e=>(postMessage("video,resume"),D.True)});setLoop=new Ch("setLoop",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>(postMessage(`video,loop,${t.toString()}`),O.Instance)});setNext=new Ch("setNext",{signature:{args:[new kh("item",T.Int32)],returns:T.Void},impl:(e,t)=>(postMessage(`video,next,${t.toString()}`),O.Instance)});setEnableAudio=new Ch("setEnableAudio",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>(postMessage(`video,mute,${!t.toBoolean()}`),O.Instance)});seek=new Ch("seek",{signature:{args:[new kh("offsetMs",T.Int32)],returns:T.Void},impl:(e,t)=>(this.position=0,postMessage(`video,seek,${t.toString()}`),O.Instance)});setPositionNotificationPeriod=new Ch("setPositionNotificationPeriod",{signature:{args:[new kh("period",T.Int32)],returns:T.Void},impl:(e,t)=>(this.notificationPeriod=t.getValue(),postMessage(`video,notify,${this.notificationPeriod}`),O.Instance)});setCGMS=new Ch("setCGMS",{signature:{args:[new kh("level",T.Int32)],returns:T.Void},impl:(e,t)=>O.Instance});setDestinationRect=new Ch("setDestinationRect",{signature:{args:[new kh("rect",T.Dynamic)],returns:T.Void},impl:(e,t)=>{const n=t.get(new M("x")),r=t.get(new M("y")),i=t.get(new M("w")),s=t.get(new M("h"));return postMessage(`video,rect,${n.getValue()},${r.getValue()},${i.getValue()},${s.getValue()}`),O.Instance}},{signature:{args:[new kh("x",T.Int32),new kh("y",T.Int32),new kh("w",T.Int32),new kh("h",T.Int32)],returns:T.Void},impl:(e,t,n,r,i)=>(postMessage(`video,rect,${t.getValue()},${n.getValue()},${r.getValue()},${i.getValue()}`),O.Instance)});setMaxVideoDecodeResolution=new Ch("setMaxVideoDecodeResolution",{signature:{args:[new kh("width",T.Int32),new kh("height",T.Int32)],returns:T.Void},impl:(e,t,n)=>O.Instance});getPlaybackDuration=new Ch("getPlaybackDuration",{signature:{args:[],returns:T.Int32},impl:e=>{const t=Atomics.load(uh.sharedArray,ve.VDR);return new vh(t>0?t:0)}});getAudioTracks=new Ch("getAudioTracks",{signature:{args:[],returns:T.Object},impl:e=>{const t=[];if(this.audioTracks.length)for(const e of this.audioTracks)if((n=e)&&"string"==typeof n.id&&"string"==typeof n.name&&"string"==typeof n.lang&&("string"==typeof n.codec||void 0===n.codec)){const n={Track:e.id,Language:e.lang,Name:e.name};t.push(nx(n))}var n;return new Kh(t)}});changeAudioTrack=new Ch("changeAudioTrack",{signature:{args:[new kh("trackId",T.String)],returns:T.Void},impl:(e,t)=>(postMessage(`video,audio,${t.value}`),O.Instance)});setTimedMetadataForKeys=new Ch("setTimedMetadataForKeys",{signature:{args:[new kh("keys",T.Dynamic)],returns:T.Void},impl:(e,t)=>O.Instance});getCaptionRenderer=new Ch("getCaptionRenderer",{signature:{args:[],returns:T.Object},impl:e=>O.Instance});setMacrovisionLevel=new Ch("setMacrovisionLevel",{signature:{args:[new kh("level",T.Int32)],returns:T.Void},impl:(e,t)=>O.Instance})}class cv extends L{kind=T.Object;roList;resizable=!0;maxSize=0;constructor(e){super("roXMLList"),this.roList=new td(e);const t=new Qh(this),n=new ed(this),r=new qh(this),i=new Xh(this),s=new Yh(this),a=new Ah(this);this.registerMethods({ifXMLList:[this.getAttributes,this.getChildElements,this.getNamedElements,this.getNamedElementsCi,this.getText,this.simplify],ifList:[t.addHead,t.addTail,t.getHead,t.getTail,t.removeHead,t.removeTail,t.resetIndex,t.getIndex,t.removeIndex],ifListToArray:[n.toArray],ifArray:[r.peek,r.pop,r.push,r.shift,r.unshift,r.delete,r.count,r.clear,r.append],ifArrayGet:[i.getEntry],ifArraySet:[s.setEntry],ifEnum:[a.isEmpty,a.isNext,a.next,a.reset]})}get listIndex(){return this.roList.listIndex}toString(e){return e?"<Component: roXMLList>":["<Component: roXMLList> =","(",...this.roList.elements.map(e=>`    ${e.toString(this)}`),")"].join("\r\n")}equalTo(e){return D.False}getValue(){return this.roList.elements}getElements(){return this.roList.elements.slice()}getAttribute(e){if(e.kind!==T.String)throw new Error("XML Element attribute must be strings");if(1===this.length()){let t=this.roList.elements[0];if(t instanceof fv)return t.getAttribute(e)}return O.Instance}deepCopy(){return new Pv}get(e){switch(JS(e)&&(e=e.unbox()),e.kind){case T.Float:return this.getElements()[Math.trunc(e.getValue())]??O.Instance;case T.Int32:return this.getElements()[e.getValue()]??O.Instance;case T.String:return this.getMethod(e.value)??this.namedElements(e.value,!0);default:return O.Instance}}set(e,t){return JS(e)&&(e=e.unbox()),e.kind!==T.Int32&&e.kind!==T.Float||(this.roList.elements[Math.trunc(e.getValue())]=t),O.Instance}hasNext(){return this.roList.hasNext()}getNext(){return this.roList.getNext()}resetNext(){this.roList.resetNext()}updateNext(){this.roList.updateNext()}add(e){this.roList.add(e)}remove(e){return this.roList.remove(e)}clear(){this.roList.clear()}length(){return this.roList.length()}getCurrent(){return this.roList.getCurrent()}resetCurrent(){return this.roList.resetCurrent()}tail(){return this.roList.tail()}namedElements(e,t){t&&(e=e.toLocaleLowerCase());let n=new cv,r=this.roList.elements[0];if(r instanceof fv){let i=r.childElements();for(let r=0;r<i.length();r++){const s=i.getElements()[r];let a;a=t?s.name().value.toLocaleLowerCase():s.name().value,a===e&&n.add(s)}}return n}getAttributes=new Ch("getAttributes",{signature:{args:[],returns:T.Object},impl:e=>{if(1===this.length()){let e=this.roList.elements[0];if(e instanceof fv)return e.attributes()}return O.Instance}});getText=new Ch("getText",{signature:{args:[],returns:T.String},impl:e=>{if(1===this.length()){let e=this.roList.elements[0];if(e instanceof fv)return e.text()}return new M("")}});getChildElements=new Ch("getChildElements",{signature:{args:[],returns:T.Object},impl:e=>{if(1===this.length()){let e=this.roList.elements[0];if(e instanceof fv)return e.childElements()}return O.Instance}});getNamedElements=new Ch("getNamedElements",{signature:{args:[new kh("name",T.String)],returns:T.Object},impl:(e,t)=>this.namedElements(t.value,!1)});getNamedElementsCi=new Ch("getNamedElementsCi",{signature:{args:[new kh("name",T.String)],returns:T.Object},impl:(e,t)=>this.namedElements(t.value,!0)});simplify=new Ch("simplify",{signature:{args:[],returns:T.Object},impl:e=>1===this.length()?this.roList.elements[0]:this})}var lv=__webpack_require__(5150);function uv(e){return"element"===e.type}function hv(e){return"text"===e.type}function dv(e){return"cdata"===e.type}class fv extends L{kind=T.Object;xmlElement;constructor(e){super("roXMLElement"),this.xmlElement=e??fv.createElement(),this.registerMethods({ifXMLElement:[this.parse,this.getBody,this.getAttributes,this.getName,this.getText,this.getChildElements,this.getChildNodes,this.getNamedElements,this.getNamedElementsCi,this.genXML,this.genXMLHdr,this.isName,this.hasAttribute,this.setBody,this.addBodyElement,this.addElement,this.addElementWithBody,this.addText,this.addAttribute,this.setName,this.clear]})}static createElement(e="_root_"){const t=new sp.XmlDocument(`<${e}></${e}>`);return fv.syncDerivedState(t),t}static syncDerivedState(e){const t=e.children??[];e.firstChild=t.length>0?t[0]:null,e.lastChild=t.length>0?t[t.length-1]:null;const n=[];for(const e of t)hv(e)?n.push(e.text):dv(e)&&n.push(e.cdata);e.val=n.join("")}static getTextFromElement(e){if(!e.children||0===e.children.length)return e.val??"";const t=[];for(const n of e.children)hv(n)?t.push(n.text):dv(n)&&t.push(n.cdata);return 0===t.length?e.val??"":t.join("")}static replaceTextContent(e,t){const n=(e.children??[]).filter(e=>!hv(e)&&!dv(e));e.children=n,t.length>0&&e.children.push(new sp.XmlTextNode(t)),fv.syncDerivedState(e)}static appendTextContent(e,t){if(0===t.length)return;const n=fv.getTextFromElement(e);fv.replaceTextContent(e,n+t)}static validateXml(e){try{const t=lv.parser(!0,{trim:!1,normalize:!1});return t.onerror=e=>{throw e},void t.write(e).close()}catch(e){return e?.message??String(e)}}getElement(){return this.xmlElement}toString(e){return"<Component: roXMLElement>"}equalTo(e){return D.False}getElements(){return this.childElements().getElements()}deepCopy(){return new Pv}get(e){if(e.kind!==T.String)throw new Error("XML Element indexes must be strings");return this.getMethod(e.value)??this.namedElements(e.value,!0)}set(e,t){if(e.kind!==T.String)throw new Error("XML Element indexes must be strings");return O.Instance}hasNext(){return this.childElements().hasNext()}getNext(){return this.childElements().getNext()}resetNext(){this.childElements().resetNext()}updateNext(){this.childElements().updateNext()}getAttribute(e){if(e.kind!==T.String)throw new Error("XML Element attribute must be strings");const t=this.getElement(),n=e.value.toLocaleLowerCase();for(const[e,r]of Object.entries(t.attr??{}))if(e.toLocaleLowerCase()===n)return new M(r);return O.Instance}attributes(){let e=new Fh([]);for(const[t,n]of Object.entries(this.getElement().attr??{}))e.set(new M(t),new M(n));return e}name(){const e=this.getElement().name;return new M("_root_"===e?"":e)}text(){return new M(fv.getTextFromElement(this.getElement()))}childElements(){let e=new cv;const t=this.getElement();for(const n of t.children??[])uv(n)&&e.add(new fv(n));return e}childNodes(){let e=new td;const t=this.getElement();for(const n of t.children??[])uv(n)?e.add(new fv(n)):hv(n)?e.add(new M(n.text)):dv(n)&&e.add(new M(n.cdata));return e}namedElements(e,t){let n=new cv;t&&(e=e.toLocaleLowerCase());const r=this.getElement();for(const i of r.children??[])uv(i)&&(t?i.name.toLocaleLowerCase():i.name)===e&&n.add(new fv(i));return n}parse=new Ch("parse",{signature:{args:[new kh("xml",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=t.value.trim();if(0===n.length)return uh.isDevMode&&uh.stderr.write("warning,Warning: Empty input was provided to parse XML."),this.xmlElement=fv.createElement(),D.False;const r=fv.validateXml(n);if(r)return uh.isDevMode&&uh.stderr.write(`error,Error parsing XML: ${r}`),this.xmlElement=fv.createElement(),D.False;try{const e=new sp.XmlDocument(t.value);return fv.syncDerivedState(e),this.xmlElement=e,D.True}catch(e){return uh.isDevMode&&uh.stderr.write(`error,Error parsing XML: ${e?.message??e}`),this.xmlElement=fv.createElement(),D.False}}});getBody=new Ch("getBody",{signature:{args:[],returns:T.Object},impl:e=>{let t=this.childElements();return t.length()>0?t:""!==this.text().value?this.text():O.Instance}});getChildElements=new Ch("getChildElements",{signature:{args:[],returns:T.Object},impl:e=>{let t=this.childElements();return t.length()>0?t:O.Instance}});getChildNodes=new Ch("getChildNodes",{signature:{args:[],returns:T.Object},impl:e=>{let t=this.childNodes();return t.length()>0?t:O.Instance}});getNamedElements=new Ch("getNamedElements",{signature:{args:[new kh("name",T.String)],returns:T.Object},impl:(e,t)=>this.namedElements(t.value,!1)});getNamedElementsCi=new Ch("getNamedElementsCi",{signature:{args:[new kh("name",T.String)],returns:T.Object},impl:(e,t)=>this.namedElements(t.value,!0)});getAttributes=new Ch("getAttributes",{signature:{args:[],returns:T.Object},impl:e=>this.attributes()});getName=new Ch("getName",{signature:{args:[],returns:T.String},impl:e=>this.name()});getText=new Ch("getText",{signature:{args:[],returns:T.String},impl:e=>this.text()});isName=new Ch("isName",{signature:{args:[new kh("name",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(this.name().value===t.value)});hasAttribute=new Ch("hasAttribute",{signature:{args:[new kh("attr",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=this.getElement();return D.from(Boolean(n.attr&&t.value in n.attr))}});setBody=new Ch("setBody",{signature:{args:[new kh("body",T.String)],returns:T.Void},impl:(e,t)=>(fv.replaceTextContent(this.getElement(),t.value),O.Instance)});addText=new Ch("addText",{signature:{args:[new kh("text",T.String)],returns:T.Void},impl:(e,t)=>(fv.appendTextContent(this.getElement(),t.value),O.Instance)});addBodyElement=new Ch("addBodyElement",{signature:{args:[],returns:T.Object},impl:e=>{const t=this.getElement(),n=fv.createElement("child");return t.children.push(n),fv.syncDerivedState(t),new fv(n)}});addElement=new Ch("addElement",{signature:{args:[new kh("name",T.String)],returns:T.Object},impl:(e,t)=>{const n=this.getElement(),r=fv.createElement(t.value);return n.children.push(r),fv.syncDerivedState(n),new fv(r)}});addElementWithBody=new Ch("addElementWithBody",{signature:{args:[new kh("name",T.String),new kh("body",T.String)],returns:T.Object},impl:(e,t,n)=>{const r=this.getElement(),i=fv.createElement(t.value);return fv.replaceTextContent(i,n.value),r.children.push(i),fv.syncDerivedState(r),new fv(i)}});addAttribute=new Ch("addAttribute",{signature:{args:[new kh("attr",T.String),new kh("value",T.String)],returns:T.Void},impl:(e,t,n)=>{const r=this.getElement();return r.attr=r.attr??{},r.attr[t.value]=n.value,O.Instance}});setName=new Ch("setName",{signature:{args:[new kh("name",T.String)],returns:T.Void},impl:(e,t)=>(this.xmlElement.name=t.value,O.Instance)});genXMLHdr=new Ch("genXMLHdr",{signature:{args:[new kh("header",T.String)],returns:T.String},impl:(e,t)=>{const n=this.xmlElement.toString({compressed:!0});return new M(t.value+n)}});genXML=new Ch("genXML",{signature:{args:[new kh("gen_header",T.Boolean)],returns:T.String},impl:(e,t)=>{const n=this.xmlElement.toString({compressed:!0}),r=t.toBoolean()?'<?xml version="1.0" encoding="UTF-8"?>':"";return new M(r+n)}});clear=new Ch("clear",{signature:{args:[],returns:T.Void},impl:e=>(this.xmlElement=fv.createElement(),O.Instance)})}var pv=__webpack_require__(1048).Buffer;class gv extends L{kind=T.Object;identity;inFile;fs;url;host;reqMethod;failureReason;xhr;freshConnection;port;outFile;postBody;user;password;customHeaders;cookiesEnabled;certificatesFile;constructor(){super("roUrlTransfer"),this.identity=Math.trunc(10*Math.random()*8),this.fs=uh.fileSystem,this.url="",this.host="",this.reqMethod="",this.failureReason="",this.xhr=new XMLHttpRequest,this.freshConnection=!1,this.cookiesEnabled=!1,this.customHeaders=new Map,this.certificatesFile=ue,this.inFile=new Array,this.outFile=new Array,this.postBody=new Array;const e=new ww(this),t=new ap(this),n=new op(this);this.registerMethods({ifUrlTransfer:[this.getIdentity,this.setUrl,this.getUrl,this.setRequest,this.getRequest,this.getToString,this.getToFile,this.asyncGetToString,this.asyncGetToFile,this.asyncCancel,this.head,this.asyncHead,this.postFromString,this.postFromFile,this.asyncPostFromString,this.asyncPostFromFile,this.asyncPostFromFileToFile,this.retainBodyOnError,this.setUserAndPassword,this.setMinimumTransferRate,this.getFailureReason,this.escape,this.unescape,this.urlEncode,this.enableEncodings,this.enableResume,this.enablePeerVerification,this.enableHostVerification,this.enableFreshConnection,this.setHttpVersion,this.getUserAgent],ifHttpAgent:[e.addHeader,e.setHeaders,e.initClientCertificates,e.setCertificatesFile,e.setCertificatesDepth,e.enableCookies,e.getCookies,e.addCookies,e.clearCookies],ifSetMessagePort:[t.setMessagePort,t.setPort],ifGetMessagePort:[n.getMessagePort,n.getPort]})}executeRequest(e){const{method:t,responseType:n,scope:r,body:i,bodyFilePath:s,onSuccess:a,errorMessage:o,logToStdout:c}=e;let l,u=-1,h="",d="";try{l=this.getConnection(t,n);let e=i;if(s){if(!this.fs.existsSync(s))throw new vw(-26,`Invalid path: ${s}`);e=this.fs.readFileSync(s)}void 0===e?l.send():l.send(e),u=l.status;const r=l.getAllResponseHeaders();h="string"==typeof r?r:h,this.failureReason=l.statusText??"",d="text"===n?l.responseText:"",a?.(l)}catch(e){if(e instanceof vw?u=e.status:l&&"number"==typeof l.status&&(u=l.status),this.failureReason=e?.message??"Unknown error",uh.isDevMode){const t=c?uh.stdout:uh.stderr,n=o?o(e):`Error transferring ${this.url}: ${this.failureReason}`;t.write(`warning,[${r}] ${n}`)}}return new Td(this.identity,this.host,d,u,this.failureReason,h)}getConnection(e,t){if(this.freshConnection&&(this.xhr=new XMLHttpRequest),this.url.toLowerCase().startsWith("https:")&&!this.fs.existsSync(this.certificatesFile))throw new vw(-77,`error setting certificate file: ${this.certificatesFile}`);const n=""===this.reqMethod?e:this.reqMethod;this.xhr.open(n,uh.getCORSProxy(this.url),!1,this.user,this.password),this.xhr.responseType=t;for(const[e,t]of this.customHeaders)this.xhr.setRequestHeader(e,t);return this.xhr.withCredentials=this.cookiesEnabled,this.xhr}getToStringEvent(){return this.executeRequest({method:"GET",responseType:"text",scope:"getToStringEvent",errorMessage:e=>`Error getting ${this.url}: ${e?.message??e}`})}getToFileEvent(e){return this.executeRequest({method:"GET",responseType:"arraybuffer",scope:"getToFileEvent",onSuccess:t=>{200===t.status&&this.saveDownloadedFile(e,t.response)},errorMessage:e=>`Error getting ${this.url}: ${e?.message??e}`})}getToFileAsync(){const e=this.outFile.shift();return e?this.getToFileEvent(e):O.Instance}postFromStringEvent(e){return this.executeRequest({method:"POST",responseType:"text",scope:"postFromStringEvent",body:e,logToStdout:!0,errorMessage:e=>`Error posting to ${this.url}: ${e?.message??e}`})}postFromStringAsync(){const e=this.postBody.shift();return e?this.postFromStringEvent(e):O.Instance}postFromFileToFileEvent(e,t){return this.executeRequest({method:"POST",responseType:"arraybuffer",scope:"postFromFileToFileEvent",bodyFilePath:e,onSuccess:e=>{200===e.status&&this.saveDownloadedFile(t,e.response)},errorMessage:e=>`Error posting to ${this.url}: ${e?.message??e}`})}postFromFileToFileAsync(){const e=this.inFile.shift(),t=this.outFile.shift();return e&&t?this.postFromFileToFileEvent(e,t):O.Instance}saveDownloadedFile(e,t){const n=t.slice(0,Mb().minimumBytes),r=Mb()(n);r&&Ae.has(r.ext)?(this.fs.writeFileSync(e,pv.from(t)),postMessage({audioPath:e,audioFormat:r.ext,audioData:t})):r&&Fe.has(r.ext)?(this.fs.writeFileSync(e,"video"),postMessage({videoPath:e,videoData:t})):this.fs.writeFileSync(e,pv.from(t))}requestHead(){return this.executeRequest({method:"HEAD",responseType:"text",scope:"requestHead",errorMessage:e=>`Error requesting from ${this.url}: ${e?.message??e}`})}toString(e){return"<Component: roUrlTransfer>"}equalTo(e){return D.False}dispose(){this.port?.removeReference()}getIdentity=new Ch("getIdentity",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.identity)});setUrl=new Ch("setUrl",{signature:{args:[new kh("url",T.String)],returns:T.Void},impl:(e,t)=>(this.url=t.value,this.host=kd(t.value),O.Instance)});getUrl=new Ch("getUrl",{signature:{args:[],returns:T.String},impl:e=>new M(this.url)});setRequest=new Ch("setRequest",{signature:{args:[new kh("reqMethod",T.String)],returns:T.Void},impl:(e,t)=>(this.reqMethod=t.value,O.Instance)});getRequest=new Ch("getRequest",{signature:{args:[],returns:T.String},impl:e=>new M(this.reqMethod)});getToString=new Ch("getToString",{signature:{args:[],returns:T.String},impl:e=>{const t=this.getToStringEvent();return new M(t.toString())}});getToFile=new Ch("getToFile",{signature:{args:[new kh("filePath",T.String)],returns:T.Int32},impl:(e,t)=>{const n=this.getToFileEvent(t.value);return new vh(n.getStatus())}});asyncGetToString=new Ch("asyncGetToString",{signature:{args:[],returns:T.Boolean},impl:e=>(this.port?(this.failureReason="",this.port.pushCallback(this.getToStringEvent.bind(this))):uh.isDevMode&&uh.stderr.write("warning,No message port assigned to this roUrlTransfer instance!"),D.True)});asyncGetToFile=new Ch("asyncGetToFile",{signature:{args:[new kh("filePath",T.String)],returns:T.Boolean},impl:(e,t)=>(this.port?(this.failureReason="",this.outFile.push(t.value),this.port.pushCallback(this.getToFileAsync.bind(this))):uh.isDevMode&&uh.stderr.write("warning,No message port assigned to this roUrlTransfer instance!"),D.True)});asyncCancel=new Ch("asyncCancel",{signature:{args:[],returns:T.Boolean},impl:e=>(this.port&&(this.failureReason="",this.outFile=[],this.postBody=[],this.port.asyncCancel()),D.True)});head=new Ch("head",{signature:{args:[],returns:T.Object},impl:e=>this.requestHead()});asyncHead=new Ch("asyncHead",{signature:{args:[],returns:T.String},impl:e=>(this.port?(this.failureReason="",this.port.pushCallback(this.requestHead.bind(this))):uh.isDevMode&&uh.stderr.write("warning,No message port assigned to this roUrlTransfer instance!"),D.True)});postFromString=new Ch("postFromString",{signature:{args:[new kh("request",T.String)],returns:T.Int32},impl:(e,t)=>{const n=this.postFromStringEvent(t.value);return new vh(n.getStatus())}});asyncPostFromString=new Ch("asyncPostFromString",{signature:{args:[new kh("request",T.String)],returns:T.Boolean},impl:(e,t)=>(this.port?(this.failureReason="",this.postBody.push(t.value),this.port.pushCallback(this.postFromStringAsync.bind(this))):uh.isDevMode&&uh.stderr.write("warning,No message port assigned to this roUrlTransfer instance!"),D.True)});postFromFile=new Ch("postFromFile",{signature:{args:[new kh("filePath",T.String)],returns:T.Int32},impl:(e,t)=>{if(this.fs.existsSync(t.value)){const e=this.fs.readFileSync(t.value),n=this.postFromStringEvent(e);return new vh(n.getStatus())}return uh.isDevMode&&uh.stderr.write(`warning,[postFromFile] Invalid path: ${t.value}`),new vh(-26)}});asyncPostFromFile=new Ch("asyncPostFromFile",{signature:{args:[new kh("filePath",T.String)],returns:T.Boolean},impl:(e,t)=>this.fs.existsSync(t.value)?(this.port?(this.failureReason="",this.postBody.push(this.fs.readFileSync(t.value,"utf8")),this.port.pushCallback(this.postFromStringAsync.bind(this))):uh.isDevMode&&uh.stderr.write("warning,No message port assigned to this roUrlTransfer instance!"),D.True):D.False});asyncPostFromFileToFile=new Ch("asyncPostFromFileToFile",{signature:{args:[new kh("fromFile",T.String),new kh("toFile",T.String)],returns:T.Boolean},impl:(e,t,n)=>this.fs.existsSync(t.value)?(this.port?(this.failureReason="",this.inFile.push(t.value),this.outFile.push(n.value),this.port.pushCallback(this.postFromFileToFileAsync.bind(this))):uh.stderr.write("warning,No message port assigned to this roUrlTransfer instance!"),D.True):D.False});retainBodyOnError=new Ch("retainBodyOnError",{signature:{args:[new kh("retain",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.True});setUserAndPassword=new Ch("setUserAndPassword",{signature:{args:[new kh("user",T.String),new kh("password",T.String)],returns:T.Boolean},impl:(e,t,n)=>(this.user=t.value,this.password=n.value,D.True)});setMinimumTransferRate=new Ch("setMinimumTransferRate",{signature:{args:[new kh("bytes_per_second",T.Int32),new kh("period_in_seconds",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>D.False});getFailureReason=new Ch("getFailureReason",{signature:{args:[],returns:T.String},impl:e=>new M(this.failureReason)});escape=new Ch("escape",{signature:{args:[new kh("text",T.String)],returns:T.String},impl:(e,t)=>new M(encodeURI(t.value))});urlEncode=new Ch("urlEncode",{signature:{args:[new kh("text",T.String)],returns:T.String},impl:(e,t)=>new M(encodeURI(t.value))});unescape=new Ch("unescape",{signature:{args:[new kh("text",T.String)],returns:T.String},impl:(e,t)=>new M(decodeURI(t.value))});enableEncodings=new Ch("enableEncodings",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.True});enableResume=new Ch("enableResume",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});enablePeerVerification=new Ch("enablePeerVerification",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});enableHostVerification=new Ch("enableHostVerification",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});enableFreshConnection=new Ch("enableFreshConnection",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>(this.freshConnection=t.toBoolean(),D.True)});setHttpVersion=new Ch("setHttpVersion",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>O.Instance});getUserAgent=new Ch("getUserAgent",{signature:{args:[],returns:T.String},impl:e=>{const t=De(uh.deviceInfo.firmwareVersion),n=`${t.get("major")}.${t.get("minor")}`,r=`${n}.${t.get("revision")}.${t.get("build")}-${t.get("plid")}`;return new M(`Roku/DVP-${n} (${r})`)}})}class mv extends L{kind=T.Object;ifHttpAgent;customHeaders;cookiesEnabled;certificatesFile;constructor(){super("roHttpAgent"),this.cookiesEnabled=!1,this.certificatesFile=ue,this.customHeaders=new Map,this.ifHttpAgent=new ww(this),this.registerMethods({ifHttpAgent:[this.ifHttpAgent.addHeader,this.ifHttpAgent.setHeaders,this.ifHttpAgent.initClientCertificates,this.ifHttpAgent.setCertificatesFile,this.ifHttpAgent.setCertificatesDepth,this.ifHttpAgent.enableCookies,this.ifHttpAgent.getCookies,this.ifHttpAgent.addCookies,this.ifHttpAgent.clearCookies]})}toString(e){return"<Component: roHttpAgent>"}equalTo(e){return D.False}}class yv extends L{kind=T.Object;audioName;audioId;maxStreams;valid;currentIndex;playing;constructor(e){super("roAudioResource"),this.maxStreams=uh.deviceInfo.maxSimulStreams,this.valid=!0;const t=uh.sfx.findIndex(t=>t===e.value.toLowerCase());if(t>-1)this.audioId=t;else try{this.valid=uh.fileSystem.existsSync(e.value),this.valid&&(this.audioId=uh.sfx.length,postMessage(`sfx,new,${e.value},${this.audioId}`),uh.sfx.push(e.value.toLowerCase()))}catch(t){uh.stderr.write(`error,Error loading audio file: ${e.value} - ${t.message}`),this.valid=!1}this.audioName=e.value,this.currentIndex=0,this.playing=!1,this.registerMethods({ifAudioResource:[this.trigger,this.isPlaying,this.stop,this.maxSimulStreams]})}toString(e){return"<Component: roAudioResource>"}equalTo(e){return D.False}isValid(){return this.valid}trigger=new Ch("trigger",{signature:{args:[new kh("volume",T.Int32),new kh("index",T.Int32,new vh(0))],returns:T.Void},impl:(e,t,n)=>{const r=n.getValue();if(r>=0&&r<this.maxStreams){const e=Ce.findIndex(e=>e===this.audioName.toLowerCase())>-1?uh.deviceInfo.audioVolume:t.getValue();Atomics.store(uh.sharedArray,ve.WAV+r,this.audioId??-1),postMessage(`sfx,trigger,${this.audioName},${e},${r}`),this.currentIndex=r,this.playing=!0}return O.Instance}});isPlaying=new Ch("isPlaying",{signature:{args:[],returns:T.Boolean},impl:e=>{if(void 0!==this.audioId){const e=Atomics.load(uh.sharedArray,ve.WAV+this.currentIndex);return this.playing=e===this.audioId,D.from(this.playing)}return D.False}});stop=new Ch("stop",{signature:{args:[],returns:T.Void},impl:e=>(postMessage(`sfx,stop,${this.audioName}`),this.playing=!1,O.Instance)});maxSimulStreams=new Ch("maxSimulStreams",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.maxStreams)})}function bv(e){const t=new yv(e);return t.isValid()?t:O.Instance}class wv extends L{kind=T.Object;locale;constructor(){super("roLocalization"),this.locale=uh.deviceInfo.locale,this.registerMethods({ifLocalization:[this.getPluralString,this.getLocalizedAsset]})}toString(e){return"<Component: roLocalization>"}equalTo(e){return D.False}getPluralString=new Ch("getPluralString",{signature:{args:[new kh("count",T.Int32),new kh("zeroString",T.String),new kh("oneString",T.String),new kh("pluralString",T.String)],returns:T.String},impl:(e,t,n,r,i)=>{let s;switch(t.getValue()){case 0:s=n.value;break;case 1:s=r.value;break;default:s=i.value.replace("^n",t.toString())}return new M(s)}});getLocalizedAsset=new Ch("getLocalizedAsset",{signature:{args:[new kh("dirName",T.String),new kh("fileName",T.String)],returns:T.String},impl:(e,t,n)=>{const r=uh.fileSystem;if(!r)return new M("");const i=`${t.value}/${n.value}`;try{let e="";return r.existsSync(`pkg:/locale/${this.locale}/${i}`)?e=`pkg:/locale/${this.locale}/${i}`:r.existsSync(`pkg:/locale/default/${i}`)?e=`pkg:/locale/default/${i}`:r.existsSync(`pkg:/locale/en_US/${i}`)&&(e=`pkg:/locale/en_US/${i}`),new M(e)}catch(e){const t=`pkg:/locale/${this.locale}/${i}`;uh.stderr.write(`error,Invalid path: ${t} ${e.message}`)}return new M("")}})}var vv=__webpack_require__(1048).Buffer;class Sv extends L{kind=T.Object;devId;constructor(){super("roRegistry"),this.devId=uh.deviceInfo.developerId,this.registerMethods({ifRegistry:[this.delete,this.flush,this.getSectionList,this.getSpaceAvailable]})}toString(e){return"<Component: roRegistry>"}equalTo(e){return D.False}delete=new Ch("delete",{signature:{args:[new kh("section",T.String)],returns:T.Boolean},impl:(e,t)=>{uh.refreshRegistry();for(const e of uh.registry.keys()){let n=`${this.devId}.${t}`;e.startsWith(n)&&uh.registry.delete(e)}return D.True}});flush=new Ch("flush",{signature:{args:[],returns:T.Boolean},impl:e=>(uh.flushRegistry(),postMessage(uh.registry),D.True)});getSectionList=new Ch("getSectionList",{signature:{args:[],returns:T.Object},impl:e=>{uh.refreshRegistry();let t=new Set;for(const e of uh.registry.keys())e.split(".")[0]===this.devId&&t.add(e.split(".")[1]);return new td([...t].map(function(e){return new M(e)}))}});getSpaceAvailable=new Ch("getSpaceAvailable",{signature:{args:[],returns:T.Int32},impl:e=>{uh.refreshRegistry();let t=32768;for(const[e,n]of uh.registry)e.split(".")[0]===this.devId&&(t-=vv.byteLength(e.substring(this.devId.length+1),"utf8"),t-=vv.byteLength(n,"utf8"));return new vh(t)}})}class xv extends L{kind=T.Object;section;devId;constructor(e){super("roRegistrySection"),this.section=e.value,this.devId=uh.deviceInfo.developerId,this.registerMethods({ifRegistrySection:[this.read,this.readMulti,this.write,this.writeMulti,this.delete,this.exists,this.flush,this.getKeyList]})}toString(e){return"<Component: roRegistrySection>"}equalTo(e){return D.False}getValue(){return this.section}read=new Ch("read",{signature:{args:[new kh("key",T.String)],returns:T.String},impl:(e,t)=>{uh.refreshRegistry();let n=uh.registry.get(`${this.devId}.${this.section}.${t.value}`);return n||(n=""),new M(n)}});readMulti=new Ch("readMulti",{signature:{args:[new kh("keysArray",T.Object)],returns:T.Dynamic},impl:(e,t)=>{uh.refreshRegistry();let n=t.getElements(),r=new Fh([]);for(const e of n){let t=`${this.devId}.${this.section}.${e.value}`,n=uh.registry.get(t);n&&r.set(e,new M(n))}return r}});write=new Ch("write",{signature:{args:[new kh("key",T.String),new kh("value",T.String)],returns:T.Boolean},impl:(e,t,n)=>(uh.refreshRegistry(),uh.registry.set(this.devId+"."+this.section+"."+t.value,n.value),D.True)});writeMulti=new Ch("writeMulti",{signature:{args:[new kh("roAA",T.Object)],returns:T.Boolean},impl:(e,t)=>{uh.refreshRegistry();const n=`${this.devId}.${this.section}.`;for(const[e,r]of t.elements)uh.registry.set(`${n}${e}`,r.toString());return D.True}});delete=new Ch("delete",{signature:{args:[new kh("key",T.String)],returns:T.Boolean},impl:(e,t)=>(uh.refreshRegistry(),D.from(uh.registry.delete(this.devId+"."+this.section+"."+t.value)))});exists=new Ch("exists",{signature:{args:[new kh("key",T.String)],returns:T.Boolean},impl:(e,t)=>(uh.refreshRegistry(),D.from(uh.registry.has(this.devId+"."+this.section+"."+t.value)))});flush=new Ch("flush",{signature:{args:[],returns:T.Boolean},impl:e=>(uh.flushRegistry(),postMessage(uh.registry),D.True)});getKeyList=new Ch("getKeyList",{signature:{args:[],returns:T.Object},impl:e=>{uh.refreshRegistry();const t=new Array;for(const e of uh.registry.keys()){const n=this.devId+"."+this.section;e.startsWith(n)&&t.push(new M(e.slice(n.length+1)))}return new td(t)}})}class Ev extends L{kind=T.Object;constructor(){super("roAppInfo"),this.registerMethods({ifAppInfo:[this.getId,this.isDev,this.getDevId,this.getVersion,this.getTitle,this.getSubtitle,this.getValue]})}toString(e){return"<Component: roAppInfo>"}equalTo(e){return D.False}getId=new Ch("getId",{signature:{args:[],returns:T.String},impl:e=>new M(e.manifest.get("id")||"dev")});isDev=new Ch("isDev",{signature:{args:[],returns:T.Boolean},impl:e=>{const t=e.manifest.get("id")||"dev";return D.from("dev"===t)}});getDevId=new Ch("getDevId",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.developerId)});getVersion=new Ch("getVersion",{signature:{args:[],returns:T.String},impl:e=>new M(e.getChannelVersion())});getTitle=new Ch("getTitle",{signature:{args:[],returns:T.String},impl:e=>new M(e.manifest.get("title")||"")});getSubtitle=new Ch("getSubtitle",{signature:{args:[],returns:T.String},impl:e=>(uh.stderr.write(`warning,BRIGHTSCRIPT: WARNING: roAppInfo.GetSubtitle: This function is deprecated: ${e.formatLocation()} `),new M(e.manifest.get("subtitle")||""))});getValue=new Ch("getValue",{signature:{args:[new kh("key",T.String)],returns:T.String},impl:(e,t)=>{const n=e.manifest.get(t.value)||"";return new M(n)}})}const Iv={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let kv;const Tv=new Uint8Array(16);function _v(){if(!kv&&(kv="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!kv))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return kv(Tv)}const Cv=[];for(let e=0;e<256;++e)Cv.push((e+256).toString(16).slice(1));const Av=function(e,t,n){if(Iv.randomUUID&&!t&&!e)return Iv.randomUUID();const r=(e=e||{}).random||(e.rng||_v)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return Cv[e[t+0]]+Cv[e[t+1]]+Cv[e[t+2]]+Cv[e[t+3]]+"-"+Cv[e[t+4]]+Cv[e[t+5]]+"-"+Cv[e[t+6]]+Cv[e[t+7]]+"-"+Cv[e[t+8]]+Cv[e[t+9]]+"-"+Cv[e[t+10]]+Cv[e[t+11]]+Cv[e[t+12]]+Cv[e[t+13]]+Cv[e[t+14]]+Cv[e[t+15]]}(r)};class Fv extends L{kind=T.Object;deviceModel;modelType;firmware;displayMode;displayModeName;displayResolution;displayAspectRatio;captionsMessageSent=!1;port;constructor(){super("roDeviceInfo"),this.deviceModel=uh.deviceInfo.deviceModel;const e=uh.deviceInfo.models?.get(this.deviceModel);this.modelType=e?e[1]:"STB",this.firmware=uh.deviceInfo.firmwareVersion,this.displayMode=uh.deviceInfo.displayMode,this.displayAspectRatio="16x9",this.displayResolution={h:720,w:1280},this.displayModeName="HD",this.displayMode.startsWith("480")?(this.displayResolution={h:480,w:720},this.displayAspectRatio="4x3",this.displayModeName="SD"):this.displayMode.startsWith("1080")&&(this.displayResolution={h:1080,w:1920},this.displayModeName="FHD");const t=new ap(this,this.getNewEvents.bind(this)),n=new op(this);this.registerMethods({ifDeviceInfo:[this.getModel,this.getModelDisplayName,this.getModelType,this.getModelDetails,this.getFriendlyName,this.getVersion,this.getOSVersion,this.getDisplayType,this.getDisplayMode,this.getVideoMode,this.getDisplayAspectRatio,this.getDisplaySize,this.getDisplayProperties,this.getSupportedGraphicsResolutions,this.getUIResolution,this.getGraphicsPlatform,this.getGraphicsFeatures,this.getSoundEffectsVolume,this.getDeviceUniqueId,this.getClientTrackingId,this.getChannelClientId,this.getAdvertisingId,this.getRIDA,this.IsAdIdTrackingDisabled,this.isRIDADisabled,this.isStoreDemoMode,this.getCountryCode,this.getUserCountryCode,this.getPreferredCaptionLanguage,this.getTimeZone,this.getCurrentLocale,this.getClockFormat,this.getUptimeMillisecondsAsLong,this.timeSinceLastKeypress,this.hasFeature,this.getDrmInfo,this.getDrmInfoEx,this.getCaptionsMode,this.setCaptionsMode,this.getCaptionsOption,this.canDecodeAudio,this.getAudioOutputChannel,this.getAudioDecodeInfo,this.getVideoDecodeInfo,this.canDecodeVideo,this.isAudioGuideEnabled,this.isAutoPlayEnabled,this.IsAutoAdjustRefreshRateEnabled,this.getRandomUUID,this.getConnectionInfo,this.getConnectionType,this.getLinkStatus,this.getInternetStatus,this.forceInternetStatusCheck,this.getIPAddrs,this.getExternalIp,this.getGeneralMemoryLevel,this.enableLinkStatusEvent,this.enableInternetStatusEvent,this.enableCodecCapChangedEvent,this.enableAudioGuideChangedEvent,this.enableLowGeneralMemoryEvent,this.enableAppFocusEvent,this.enableScreensaverExitedEvent,this.enableValidClockEvent,this.isClockValid,this.getCreationTime,t.setMessagePort,n.getMessagePort]})}toString(e){return"<Component: roDeviceInfo>"}equalTo(e){return D.False}dispose(){this.port?.unregisterCallback(this.getComponentName())}getNewEvents(){const e=[];return this.captionsMessageSent||(e.push(new Od({Mode:uh.deviceInfo.captionMode,Mute:!1})),this.captionsMessageSent=!0),e}getModel=new Ch("getModel",{signature:{args:[],returns:T.Object},impl:e=>new M(this.deviceModel)});getModelDisplayName=new Ch("getModelDisplayName",{signature:{args:[],returns:T.Object},impl:e=>{const t=this.deviceModel,n=uh.deviceInfo.models?.get(t);return new M(n?n[0].replace(/ *\([^)]*\) */g,""):`Roku (${t})`)}});getModelType=new Ch("getModelType",{signature:{args:[],returns:T.Object},impl:e=>new M(this.modelType)});getModelDetails=new Ch("getModelDetails",{signature:{args:[],returns:T.Object},impl:e=>nx({Manufacturer:"",ModelNumber:this.deviceModel,VendorName:"Roku",VendorUSBName:"Roku",SerialNumber:uh.deviceInfo.serialNumber})});getFriendlyName=new Ch("getFriendlyName",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.friendlyName)});getVersion=new Ch("getVersion",{signature:{args:[],returns:T.String},impl:e=>(uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roDeviceInfo.GetVersion: This function is deprecated"),new M("999.99E99999A"))});getOSVersion=new Ch("getOSVersion",{signature:{args:[],returns:T.Object},impl:e=>{const t={major:"0",minor:"0",revision:"0",build:"0"};if(this.firmware?.length>0){const e=De(this.firmware);t.major=e.get("major")??"0",t.minor=e.get("minor")??"0",t.revision=e.get("revision")??"0",t.build=e.get("build")??"0"}return nx(t)}});getSoundEffectsVolume=new Ch("getSoundEffectsVolume",{signature:{args:[],returns:T.Int32},impl:e=>new vh(uh.deviceInfo.audioVolume)});getDeviceUniqueId=new Ch("getDeviceUniqueId",{signature:{args:[],returns:T.String},impl:e=>(uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roDeviceInfo.GetDeviceUniqueId: This function is deprecated"),new M("000000000000"))});getClientTrackingId=new Ch("getClientTrackingId",{signature:{args:[],returns:T.String},impl:e=>(uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roDeviceInfo.GetClientTrackingId: This function is deprecated"),new M(uh.deviceInfo.clientId))});getChannelClientId=new Ch("getChannelClientId",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.clientId)});getAdvertisingId=new Ch("getAdvertisingId",{signature:{args:[],returns:T.String},impl:e=>(uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roDeviceInfo.GetAdvertisingId: This function is deprecated"),new M(uh.deviceInfo.RIDA))});getRIDA=new Ch("getRIDA",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.RIDA)});IsAdIdTrackingDisabled=new Ch("IsAdIdTrackingDisabled",{signature:{args:[],returns:T.Boolean},impl:e=>(uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roDeviceInfo.IsAdIdTrackingDisabled: This function is deprecated"),D.True)});isRIDADisabled=new Ch("isRIDADisabled",{signature:{args:[],returns:T.Boolean},impl:e=>D.True});isStoreDemoMode=new Ch("isStoreDemoMode",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});getCountryCode=new Ch("getCountryCode",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.countryCode)});getUserCountryCode=new Ch("getUserCountryCode",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.countryCode)});getPreferredCaptionLanguage=new Ch("getPreferredCaptionLanguage",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.captionLanguage)});getTimeZone=new Ch("getTimeZone",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.timeZone)});getCurrentLocale=new Ch("getCurrentLocale",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.locale)});getClockFormat=new Ch("getClockFormat",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.clockFormat)});getUptimeMillisecondsAsLong=new Ch("getUptimeMillisecondsAsLong",{signature:{args:[],returns:T.Int64},impl:e=>{const t=uh.deviceInfo.startTime;return new ph((Date.now()-t)/1e3)}});getDisplayType=new Ch("getDisplayType",{signature:{args:[],returns:T.String},impl:e=>{let t="HDTV";return"SD"===this.displayModeName&&(t="4:3 standard"),new M(t)}});getDisplayMode=new Ch("getDisplayMode",{signature:{args:[],returns:T.String},impl:e=>new M(this.displayMode)});getVideoMode=new Ch("getVideoMode",{signature:{args:[],returns:T.String},impl:e=>new M(this.displayMode)});getDisplayAspectRatio=new Ch("getDisplayAspectRatio",{signature:{args:[],returns:T.String},impl:e=>new M(this.displayAspectRatio)});getDisplaySize=new Ch("getDisplaySize",{signature:{args:[],returns:T.Object},impl:e=>nx(this.displayResolution)});getDisplayProperties=new Ch("getDisplayProperties",{signature:{args:[],returns:T.Object},impl:e=>{const t={ALLM:!1,DolbyVision:!1,Hdr10:!1,Hdr10Plus:!1,HdrSeamless:!1,HLG:!1,headless:!1,internal:!1,VRR:!1,height:72,width:129};return"TV"===this.modelType&&(t.internal=!0,t.visible=uh.displayEnabled),nx(t)}});getSupportedGraphicsResolutions=new Ch("getSupportedGraphicsResolutions",{signature:{args:[],returns:T.Object},impl:e=>{let t=[],n=this.displayModeName,r={name:"SD",height:480,width:720,preferred:!1,ui:"SD"===n};return t.push(nx(r)),r={name:"HD",height:720,width:1280,preferred:!1,ui:"HD"===n},t.push(nx(r)),r={name:"FHD",height:1080,width:1920,preferred:!0,ui:"FHD"===n},t.push(nx(r)),new Kh(t)}});getUIResolution=new Ch("getUIResolution",{signature:{args:[],returns:T.Object},impl:e=>nx({height:this.displayResolution.h,width:this.displayResolution.w,name:this.displayModeName})});getGraphicsFeatures=new Ch("getGraphicsFeatures",{signature:{args:[],returns:T.Object},impl:e=>nx({full_rotation:!0,astc_supported:!1})});getGraphicsPlatform=new Ch("getGraphicsPlatform",{signature:{args:[],returns:T.String},impl:e=>{const t=uh.deviceInfo.models?.get(this.deviceModel);return new M(t?t[2]:"opengl")}});hasFeature=new Ch("hasFeature",{signature:{args:[new kh("feature",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=["gaming_hardware","usb_hardware","simulation_engine"],r=uh.deviceInfo.customFeatures;Array.isArray(r)&&r.length>0&&n.push(...r);for(const[e,t]of Object.entries(he))t&&n.push(`platform_${e.slice(2).toLowerCase()}`);return D.from(n.includes(t.value.toLowerCase()))}});getDrmInfo=new Ch("getDrmInfo",{signature:{args:[],returns:T.Object},impl:e=>(uh.stderr.write("warning,BRIGHTSCRIPT: WARNING: roDeviceInfo.GetDrmInfo: This function is deprecated"),nx({PlayReady:" "}))});getDrmInfoEx=new Ch("getDrmInfoEx",{signature:{args:[],returns:T.Object},impl:e=>new Fh([])});getCaptionsMode=new Ch("getCaptionsMode",{signature:{args:[],returns:T.String},impl:e=>new M(uh.deviceInfo.captionMode)});setCaptionsMode=new Ch("setCaptionsMode",{signature:{args:[new kh("mode",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=le(t.value);if(n){if("When mute"===t.value&&"TV"!==this.modelType)return D.False;uh.deviceInfo.captionMode=n,this.port?.pushMessage(new Od({Mode:n,Mute:!1})),postMessage({captionMode:n})}return D.True}});getCaptionsOption=new Ch("getCaptionsOption",{signature:{args:[new kh("option",T.String)],returns:T.String},impl:(e,t)=>{const n=t.value.toLowerCase();if("mode"===n)return new M(uh.deviceInfo.captionMode);if("muted"===n)return new M("Unmuted");if(!ye.has(n))return new M("");const r=uh.deviceInfo.captionStyle.find(e=>e.id===n);return new M(r?.style??"Default")}});canDecodeAudio=new Ch("canDecodeAudio",{signature:{args:[new kh("options",T.Dynamic)],returns:T.Object},impl:(e,t)=>{if(t instanceof Fh){const e={},n=uh.deviceInfo.audioCodecs,r=t.get(new M("codec"));return r instanceof M&&n?.includes(r.value.toLowerCase())?e.result=!0:(e.result=!1,n&&(e.updated="codec",e.codec=new Kh(n.map(e=>new M(e))))),nx(e)}return O.Instance}});getAudioOutputChannel=new Ch("getAudioOutputChannel",{signature:{args:[],returns:T.String},impl:e=>new M("Stereo")});getAudioDecodeInfo=new Ch("getAudioDecodeInfo",{signature:{args:[],returns:T.Object},impl:e=>nx({AAC:"2:0:0:0:",ALAC:"6:0:0:0:",FLAC:"6:0:0:0:",LPCM:"2:0:0:1:",MPEG:"2:0:0:0:",OPUS:"6:0:0:0:",VORBIS:"6:0:0:0:",WMA:"6:0:0:0:",WMAPRO:"8:0:0:0:"})});getVideoDecodeInfo=new Ch("getVideoDecodeInfo",{signature:{args:[],returns:T.Object},impl:e=>nx({H264:"",MPEG2:"",MPEG4:""})});canDecodeVideo=new Ch("canDecodeVideo",{signature:{args:[new kh("options",T.Dynamic)],returns:T.Object},impl:(e,t)=>{if(t instanceof Fh){const e=uh.deviceInfo.videoFormats,n=e?.get("codecs")??[],r=e?.get("containers")??[],i=t.get(new M("codec")),s=t.get(new M("container")),a={};let o=!0,c="";return i instanceof M&&!n.includes(i.value.toLowerCase())&&(o=!1,c="codec"),o&&s instanceof M&&!r.includes(s.value.toLowerCase())&&(o=!1,c="container"),o||(a.updated=c,a.updated="codec"===c?new Kh(n.map(e=>new M(e))):"n.a."),a.result=o,nx(a)}return O.Instance}});enableCodecCapChangedEvent=new Ch("enableCodecCapChangedEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});isAudioGuideEnabled=new Ch("isAudioGuideEnabled",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});enableAudioGuideChangedEvent=new Ch("enableAudioGuideChangedEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Dynamic},impl:(e,t)=>D.False});isAutoPlayEnabled=new Ch("isAutoPlayEnabled",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});IsAutoAdjustRefreshRateEnabled=new Ch("isAutoAdjustRefreshRateEnabled",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});timeSinceLastKeypress=new Ch("timeSinceLastKeypress",{signature:{args:[],returns:T.Int32},impl:e=>new vh((Date.now()-uh.lastKeyTime)/1e3)});getRandomUUID=new Ch("getRandomUUID",{signature:{args:[],returns:T.String},impl:e=>new M(Av())});getConnectionType=new Ch("getConnectionType",{signature:{args:[],returns:T.String},impl:e=>{const t=uh.deviceInfo.connectionInfo;return new M(t.type)}});getConnectionInfo=new Ch("getConnectionInfo",{signature:{args:[],returns:T.String},impl:e=>{const t=uh.deviceInfo.connectionInfo,n={active:1,default:1,type:t.type,name:t.name,gateway:t.gateway,quality:t.quality};"WiFiConnection"===t.type&&t.ssid&&(n.ssid=t.ssid,n.protocol="IEEE 802.11g",n.signal=-140);const r=uh.deviceInfo.localIps;if(r.length>0&&r.some(e=>e.split(",")[0]===t.name&&(n.ip=e.split(",")[1],!0)),n.ipv6=new Kh([]),t.dns)for(const[e,r]of t.dns.entries())n[`dns.${e}`]=r;return n.mac="00:00:00:00:00:00",n.expectedThroughput=129,nx(n)}});getLinkStatus=new Ch("getLinkStatus",{signature:{args:[],returns:T.Boolean},impl:e=>{let t=!0;return"object"==typeof navigator&&"boolean"==typeof navigator.onLine&&(t=navigator.onLine),D.from(t)}});enableLinkStatusEvent=new Ch("enableLinkStatusEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});getInternetStatus=new Ch("getInternetStatus",{signature:{args:[],returns:T.Boolean},impl:e=>{let t=!0;return"object"==typeof navigator&&"boolean"==typeof navigator.onLine&&(t=navigator.onLine),D.from(t)}});enableInternetStatusEvent=new Ch("enableInternetStatusEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});forceInternetStatusCheck=new Ch("forceInternetStatusCheck",{signature:{args:[],returns:T.Boolean},impl:e=>D.True});getIPAddrs=new Ch("getIPAddrs",{signature:{args:[],returns:T.Object},impl:e=>{const t={};for(const e of uh.deviceInfo.localIps)t[e.split(",")[0]]=e.split(",")[1];return nx(t)}});getExternalIp=new Ch("getExternalIp",{signature:{args:[],returns:T.String},impl:e=>{let t="";try{t=vd()}catch(e){uh.isDevMode&&uh.stderr.write(`warning,${e.message}`)}return new M(t)}});getGeneralMemoryLevel=new Ch("getGeneralMemoryLevel",{signature:{args:[],returns:T.String},impl:e=>{const{heapSizeLimit:t,usedHeapSize:n}=e.getMemoryHeapInfo(),r=n/t*100;let i="normal";return r>90?i="critical":r>80&&(i="low"),new M(i)}});enableLowGeneralMemoryEvent=new Ch("enableLowGeneralMemoryEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Boolean},impl:(e,t)=>D.False});enableAppFocusEvent=new Ch("enableAppFocusEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Dynamic},impl:(e,t)=>D.False});enableScreensaverExitedEvent=new Ch("enableScreensaverExitedEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Dynamic},impl:(e,t)=>D.False});enableValidClockEvent=new Ch("enableValidClockEvent",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Dynamic},impl:(e,t)=>D.False});isClockValid=new Ch("isClockValid",{signature:{args:[],returns:T.Dynamic},impl:e=>D.True});getCreationTime=new Ch("getCreationTime",{signature:{args:[],returns:T.String},impl:e=>new M(e.creationTime??"")})}class Rv extends L{kind=T.Object;constructor(){super("roRemoteInfo"),this.registerMethods({ifRemoteInfo:[this.getModel,this.isAwake,this.hasFeature]})}toString(e){return"<Component: roRemoteInfo>"}equalTo(e){return D.False}getModel=new Ch("getModel",{signature:{args:[new kh("remoteIndex",T.Int32)],returns:T.Int32},impl:(e,t)=>{const n=Mv(0,t.getValue());return new vh(n.model)}});isAwake=new Ch("isAwake",{signature:{args:[new kh("remoteIndex",T.Int32)],returns:T.Boolean},impl:(e,t)=>{const n=Mv(0,t.getValue());return D.from(n.model>0)}});hasFeature=new Ch("hasFeature",{signature:{args:[new kh("feature",T.String),new kh("remoteIndex",T.Int32)],returns:T.Boolean},impl:(e,t,n)=>{const r=["muteswitch"],i=Mv(0,n.getValue());return i.features.length&&r.push(...i.features),D.from(r.includes(t.value.toLowerCase()))}})}function Mv(e,t){const n=uh.deviceInfo.remoteControls;return Array.isArray(n)&&n.length&&t<n.length?(t<0&&(t=uh.lastRemote),n[t]):{model:0,features:["wifi"]}}var Dv=__webpack_require__(6649);class Ov extends L{kind=T.Object;port;constructor(){super("roFileSystem");const e=new ap(this),t=new op(this);this.registerMethods({ifFileSystem:[this.getVolumeList,this.getVolumeInfo,this.getDirectoryListing,this.createDirectory,this.delete,this.copyFile,this.rename,this.find,this.findRecurse,this.match,this.exists,this.stat],ifSetMessagePort:[e.setMessagePort],ifGetMessagePort:[t.getMessagePort]})}toString(e){return"<Component: roFileSystem>"}equalTo(e){return D.False}findOnTree(e,t,n){try{let r=e.readdirSync(n),i=[];for(const s of r)if(t.test(s)){i.push(new M(s));let r=Ne.posix.join(n,s);e.statSync(r).isDirectory()&&(i=i.concat(this.findOnTree(e,t,r)))}return i}catch(e){return[]}}getVolumeList=new Ch("getVolumeList",{signature:{args:[],returns:T.Object},impl:e=>{try{const e=uh.fileSystem.volumesSync().map(e=>new M(e));return new td(e)}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.getVolumeList: ${e.message}`),new td([])}}});getVolumeInfo=new Ch("getVolumeInfo",{signature:{args:[new kh("path",T.String)],returns:T.Object},impl:(e,t)=>{let n={};return uh.fileSystem.existsSync(t.value)&&(n={blocks:0,blocksize:0,freeblocks:0,usedblocks:0}),nx(n)}});getDirectoryListing=new Ch("getDirectoryListing",{signature:{args:[new kh("path",T.String)],returns:T.Object},impl:(e,t)=>{const n=uh.fileSystem;try{if(sh(t.value)&&n.existsSync(t.value)){const e=n.readdirSync(t.value).map(e=>new M(e));return new td(e)}}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.getDirectoryListing: ${e.message}`),new td([])}return new td([])}});createDirectory=new Ch("createDirectory",{signature:{args:[new kh("path",T.String)],returns:T.Boolean},impl:(e,t)=>{try{const e=uh.fileSystem;return ah(t.value)?(e.mkdirSync(t.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.createDirectory: ${e.message}`),D.False}}});delete=new Ch("delete",{signature:{args:[new kh("path",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=uh.fileSystem;try{return ah(t.value)?(n.statSync(t.value).isDirectory()?n.rmdirSync(t.value):n.unlinkSync(t.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.delete: ${e.message}`),D.False}}});copyFile=new Ch("copyFile",{signature:{args:[new kh("fromPath",T.String),new kh("toPath",T.String)],returns:T.Boolean},impl:(e,t,n)=>{const r=uh.fileSystem;try{if(!ah(n.value)||!r.existsSync(t.value))return D.False;const e=r.readFileSync(t.value);return r.writeFileSync(n.value,e),D.True}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.copyFile: ${e.message}`),D.False}}});rename=new Ch("rename",{signature:{args:[new kh("fromPath",T.String),new kh("toPath",T.String)],returns:T.Boolean},impl:(e,t,n)=>{const r=uh.fileSystem;try{return ah(t.value)&&ah(n.value)&&ih(t.value)===ih(n.value)&&r.existsSync(t.value)?(r.renameSync(t.value,n.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.rename: ${e.message}`),D.False}}});exists=new Ch("exists",{signature:{args:[new kh("path",T.String)],returns:T.Boolean},impl:(e,t)=>{try{const e=uh.fileSystem;return D.from(e.existsSync(t.value))}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.exists: ${e.message}`),D.False}}});find=new Ch("find",{signature:{args:[new kh("path",T.String),new kh("regEx",T.String)],returns:T.Object},impl:(e,t,n)=>{const r=new RegExp(n.value);try{const e=uh.fileSystem;if(!sh(t.value))return new td([]);const n=e.readdirSync(t.value),i=[];for(const e of n)r.test(e)&&i.push(new M(e));return new td(i)}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.find: ${e.message}`),new td([])}}});findRecurse=new Ch("findRecurse",{signature:{args:[new kh("path",T.String),new kh("regEx",T.String)],returns:T.Object},impl:(e,t,n)=>{const r=new RegExp(n.value);try{const e=uh.fileSystem;return sh(t.value)?new td(this.findOnTree(e,r,t.value)):new td([])}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.findRecurse: ${e.message}`),new td([])}}});match=new Ch("match",{signature:{args:[new kh("path",T.String),new kh("pattern",T.String)],returns:T.Object},impl:(e,t,n)=>{try{if(!sh(t.value))return new td([]);let e=uh.fileSystem.readdirSync(t.value),r=Dv.match(e,n.value,{nocase:!0,nodupes:!0,noglobstar:!0,nonegate:!0});return r=(r||[]).map(e=>new M(e)),new td(r)}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.match: ${e.message}`),new td([])}}});stat=new Ch("stat",{signature:{args:[new kh("path",T.String)],returns:T.Object},impl:(e,t)=>{const n={},r=t.value;try{if(!sh(r))return nx(n);const e=uh.fileSystem.statSync(r);if(n.hidden=!1,e.isFile()){const e=uh.fileSystem.readFileSync(r);n.size="number"==typeof e.length?e.length:0,n.type="file"}else n.type="directory";const t=r.startsWith("tmp:")||r.startsWith("cachefs:")?"rw":"r";n.permissions=t}catch(e){uh.isDevMode&&uh.stderr.write(`warning,roFileSystem.stat: ${e.message}`)}return nx(n)}})}class Pv extends L{kind=T.Object;intrinsic;getValue(){return this.intrinsic}constructor(){super("roInvalid"),this.intrinsic=O.Instance,this.registerMethods({ifToStr:[new dh(this).toStr]})}unbox(){return this.intrinsic}copy(){return new Pv}equalTo(e){return e instanceof O||e instanceof Pv?D.True:D.False}toString(e){return"<Component: roInvalid>"}}class Nv extends L{kind=T.Object;constructor(){super("roNDK"),this.registerMethods({ifNDK:[this.start]})}toString(e){return"<Component: roNDK>"}equalTo(e){return D.False}start=new Ch("start",{signature:{args:[new kh("app",T.String),new kh("params",T.Object,new Kh([])),new kh("env",T.Object,new Kh([]))],returns:T.Int32},impl:(e,t,n,r)=>{const i=n.elements.filter(e=>$S(e)),s=r.elements.filter(e=>$S(e));if("roku_browser"===t.value||"SDKLauncher"===t.value){const e={app:t.value,params:i.map(e=>e.toString()),env:s.map(e=>e.toString())};return e.params.push("source=other-channel"),postMessage(e),new vh(0)}return new vh(211)}})}class Lv extends L{kind=T.Object;port;active;constructor(){super("roCECStatus"),this.active=1;const e=new ap(this,this.getNewEvents.bind(this)),t=new op(this);this.registerMethods({ifCECStatus:[this.isActiveSource,e.setMessagePort,t.getMessagePort]})}toString(e){return"<Component: roCECStatus>"}equalTo(e){return D.False}dispose(){this.port?.unregisterCallback(this.getComponentName())}getNewEvents(){const e=[],t=Atomics.load(uh.sharedArray,ve.CEC);return t>=0&&t!==this.active&&(this.active=t,e.push(new Pd(0!==this.active))),e}isActiveSource=new Ch("isActiveSource",{signature:{args:[],returns:T.Boolean},impl:e=>{const t=Atomics.load(uh.sharedArray,ve.CEC);return D.from(0!==t)}})}class Bv extends L{kind=T.Object;hostName;hostIP;port;valid;constructor(){super("roSocketAddress"),this.hostName="0.0.0.0",this.hostIP="0.0.0.0",this.port=0,this.valid=!0,this.registerMethods({ifSocketAddress:[this.setAddress,this.getAddress,this.setHostName,this.getHostName,this.setPort,this.getPort,this.isAddressValid]})}validateAddress(e){let t=/^(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(\d{1,5}))?$/.exec(e);if(t)return this.hostName=t[1],this.hostIP=t[1],this.port=t[2]?this.safeParsePort(t[2]):this.port,Ed(this.hostName);const n=e.split(":");if(n.length>1?(this.hostName=n[0],this.port=this.safeParsePort(n[1])):this.hostName=e,""===this.hostName.trim())return!1;try{const e=xd(this.hostName);if(e&&Ed(e))return this.hostIP=e,!0}catch(e){uh.isDevMode&&uh.stderr.write(`warning,${e.message}`)}return!1}safeParsePort(e){const t=Number.parseInt(e,10);return Uv(Number.isNaN(t)?0:t)}toString(e){return"<Component: roSocketAddress>"}equalTo(e){return D.False}setAddress=new Ch("setAddress",{signature:{args:[new kh("address",T.String)],returns:T.Boolean},impl:(e,t)=>(this.valid=this.validateAddress(t.value),D.True)});getAddress=new Ch("getAddress",{signature:{args:[],returns:T.String},impl:e=>(this.valid||uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSocketAddress.getAddress: Domain name not found: ${this.hostName}: ${e.formatLocation()}`),new M(this.valid?`${this.hostIP}:${this.port}`:""))});setHostName=new Ch("setHostName",{signature:{args:[new kh("hostname",T.String)],returns:T.Boolean},impl:(e,t)=>{if(Id(t.value)){const e=`${t.value}:${this.port}`;this.valid=this.validateAddress(e)}else this.hostName=t.value,this.valid=!1;return D.True}});getHostName=new Ch("getHostName",{signature:{args:[],returns:T.String},impl:e=>new M(this.hostName)});setPort=new Ch("setPort",{signature:{args:[new kh("port",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.port=Uv(t.getValue()),D.True)});getPort=new Ch("getPort",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.port)});isAddressValid=new Ch("isAddressValid",{signature:{args:[],returns:T.Boolean},impl:e=>(this.valid||uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSocketAddress.isAddressValid: Domain name not found: ${this.hostName}: ${e.formatLocation()}`),D.from(this.valid))})}function Uv(e){return(e%=65536)<0&&(e+=65536),e>>>0}var Vv=__webpack_require__(1048).Buffer;class jv{component;constructor(e){this.component=e}send=new Ch("send",{signature:{args:[new kh("data",T.Object),new kh("startIndex",T.Int32),new kh("length",T.Int32)],returns:T.Int32},impl:(e,t,n,r)=>{try{const e=this.component.socket?.write(t.getByteArray());return new vh(e?t.getElements().length:0)}catch(e){return this.component.errorCode=e.code,new vh(0)}}});sendStr=new Ch("sendStr",{signature:{args:[new kh("data",T.String)],returns:T.Int32},impl:(e,t)=>{try{const e=this.component.socket?.write(t.value);return new vh(e?t.value.length:0)}catch(e){return this.component.errorCode=e.code??3474,new vh(0)}}});receive=new Ch("receive",{signature:{args:[new kh("data",T.Object),new kh("startIndex",T.Int32),new kh("length",T.Int32)],returns:T.Int32},impl:(e,t,n,r)=>{let i=Vv.alloc(r.getValue());try{return i=this.component.socket?.read(r.getValue())??Vv.alloc(0),new vh(i.length)}catch(e){return this.component.errorCode=e.code??3474,new vh(0)}}});receiveStr=new Ch("receiveStr",{signature:{args:[new kh("length",T.Int32)],returns:T.Int32},impl:(e,t)=>{try{const e=this.component.socket?.read(t.getValue())??"";return new vh(e.length)}catch(e){return this.component.errorCode=e.code??3474,new vh(0)}}});close=new Ch("close",{signature:{args:[],returns:T.Void},impl:e=>(this.component.socket?.end(),P.Instance)});setAddress=new Ch("setAddress",{signature:{args:[new kh("sockAddr",T.Object)],returns:T.Boolean},impl:(e,t)=>(this.component.address=t,D.True)});getAddress=new Ch("getAddress",{signature:{args:[],returns:T.Object},impl:e=>this.component.address??O.Instance});setSendToAddress=new Ch("setSendToAddress",{signature:{args:[new kh("sockAddr",T.Object)],returns:T.Void},impl:(e,t)=>(this.component.sendToAddress=t,O.Instance)});getSendToAddress=new Ch("getSendToAddress",{signature:{args:[],returns:T.Object},impl:e=>this.component.sendToAddress??O.Instance});getReceivedFromAddress=new Ch("getReceivedFromAddress",{signature:{args:[],returns:T.Object},impl:e=>O.Instance});getCountRcvBuf=new Ch("getCountRcvBuf",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0)});getCountSendBuf=new Ch("getCountSendBuf",{signature:{args:[],returns:T.Int32},impl:e=>new vh(0)});status=new Ch("status",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.errorCode)})}class zv{component;constructor(e){this.component=e}isReadable=new Ch("isReadable",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.component.socket?.readable??!1)});isWritable=new Ch("isWritable",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.component.socket?.writable??!1)});isException=new Ch("isException",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});notifyReadable=new Ch("notifyReadable",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>P.Instance});notifyWritable=new Ch("notifyWritable",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>P.Instance});notifyException=new Ch("notifyException",{signature:{args:[new kh("enable",T.Boolean)],returns:T.Void},impl:(e,t)=>P.Instance});getID=new Ch("getID",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.identity)})}class Gv{component;constructor(e){this.component=e}eAgain=new Ch("eAgain",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(11===this.component.errorCode)});eAlready=new Ch("eAlready",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(114===this.component.errorCode)});eBadAddr=new Ch("eBadAddr",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(14===this.component.errorCode)});eDestAddrReq=new Ch("eDestAddrReq",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(39===this.component.errorCode)});eHostUnreach=new Ch("eHostUnreach",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(65===this.component.errorCode)});eInvalid=new Ch("eInvalid",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(22===this.component.errorCode)});eInProgress=new Ch("eInProgress",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(36===this.component.errorCode)});eWouldBlock=new Ch("eWouldBlock",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(35===this.component.errorCode)});eSuccess=new Ch("eSuccess",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(0===this.component.errorCode)});eOK=new Ch("eOK",{signature:{args:[],returns:T.Int32},impl:e=>D.from(0===this.component.errorCode)})}class Hv{component;constructor(e){this.component=e}getTTL=new Ch("getTTL",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.ttl)});setTTL=new Ch("setTTL",{signature:{args:[new kh("ttl",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.component.ttl=t.getValue(),D.True)});getReuseAddr=new Ch("getMulticastLoop",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.component.reuseAddr)});setReuseAddr=new Ch("setReuseAddr",{signature:{args:[new kh("reuse",T.Boolean)],returns:T.Boolean},impl:(e,t)=>(this.component.reuseAddr=t.toBoolean(),D.True)});getOOBInline=new Ch("setOOBInline",{signature:{args:[],returns:T.Boolean},impl:e=>D.from(this.component.inline)});setOOBInline=new Ch("setOOBInline",{signature:{args:[new kh("inline",T.Boolean)],returns:T.Boolean},impl:(e,t)=>(this.component.inline=t.toBoolean(),D.True)});getSendBuf=new Ch("getSendBuf",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.sendBufferSize)});setSendBuf=new Ch("setSendBuf",{signature:{args:[new kh("size",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.component.sendBufferSize=t.getValue(),D.True)});getRcvBuf=new Ch("getRcvBuf",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.recvBufferSize)});setRcvBuf=new Ch("setRcvBuf",{signature:{args:[new kh("size",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.component.recvBufferSize=t.getValue(),D.True)});getSendTimeout=new Ch("getSendTimeout",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.sendTimeout)});setSendTimeout=new Ch("setSendTimeout",{signature:{args:[new kh("timeout",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.component.sendTimeout=t.getValue(),D.True)});getReceiveTimeout=new Ch("getReceiveTimeout",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.component.recvTimeout)});setReceiveTimeout=new Ch("setReceiveTimeout",{signature:{args:[new kh("timeout",T.Int32)],returns:T.Boolean},impl:(e,t)=>(this.component.recvTimeout=t.getValue(),D.True)})}var $v=__webpack_require__(2798);class Wv extends L{kind=T.Object;socket;identity;address;sendToAddress;ttl;reuseAddr;inline;sendBufferSize;recvBufferSize;sendTimeout;recvTimeout;errorCode;constructor(){super("roStreamSocket"),this.ttl=0,this.reuseAddr=!1,this.inline=!1,this.sendBufferSize=0,this.recvBufferSize=0,this.sendTimeout=0,this.recvTimeout=0;try{this.socket=new $v.Socket,this.errorCode=0}catch(e){uh.stderr.write("warning,[roStreamSocket] Sockets are not supported in this environment."),this.errorCode=3474}this.identity=Math.floor(9e7*Math.random())+1e7;const e=new jv(this),t=new zv(this),n=new Gv(this),r=new Hv(this),i=new ap(this),s=new op(this);this.registerMethods({ifSocketConnection:[this.listen,this.isListening,this.connect,this.accept,this.isConnected],ifSocket:[e.send,e.sendStr,e.receive,e.receiveStr,e.close,e.setAddress,e.getAddress,e.setSendToAddress,e.getSendToAddress,e.getReceivedFromAddress,e.getCountRcvBuf,e.getCountSendBuf,e.status],ifSocketAsync:[t.isReadable,t.isWritable,t.isException,t.notifyReadable,t.notifyWritable,t.notifyException,t.getID],ifSocketStatus:[n.eAgain,n.eAlready,n.eBadAddr,n.eDestAddrReq,n.eHostUnreach,n.eInvalid,n.eInProgress,n.eWouldBlock,n.eSuccess,n.eOK],ifSocketOption:[r.getTTL,r.setTTL,r.getReuseAddr,r.setReuseAddr,r.getOOBInline,r.setOOBInline,r.getSendBuf,r.setSendBuf,r.getRcvBuf,r.setRcvBuf,r.getSendTimeout,r.setSendTimeout,r.getReceiveTimeout,r.setReceiveTimeout],ifSetMessagePort:[i.setMessagePort],ifGetMessagePort:[s.getMessagePort]})}toString(e){return"<Component: roStreamSocket>"}equalTo(e){return D.False}listen=new Ch("listen",{signature:{args:[new kh("backlog",T.Int32)],returns:T.Boolean},impl:(e,t)=>D.True});isListening=new Ch("isListening",{signature:{args:[],returns:T.Boolean},impl:e=>D.False});connect=new Ch("connect",{signature:{args:[new kh("address",T.Object)],returns:T.Boolean},impl:(e,t)=>(this.address=t,D.True)});accept=new Ch("accept",{signature:{args:[],returns:T.Object},impl:e=>O.Instance});isConnected=new Ch("isConnected",{signature:{args:[],returns:T.Boolean},impl:e=>{const t=!this.socket?.connecting&&!this.socket?.destroyed;return D.from(t)}})}class qv extends L{kind=T.Object;modelType;displayMode;port;active;constructor(){super("roHdmiStatus"),this.active=1;const e=uh.deviceInfo.deviceModel,t=uh.deviceInfo.models?.get(e);this.modelType=t?t[1]:"STB",this.displayMode=uh.deviceInfo.displayMode;const n=new ap(this,this.getNewEvents.bind(this)),r=new op(this);this.registerMethods({ifHdmiStatus:[this.isConnected,this.getHdcpVersion,this.isHdcpActive,n.setMessagePort,r.getMessagePort]})}toString(e){return"<Component: roHdmiStatus>"}equalTo(e){return D.False}dispose(){this.port?.unregisterCallback(this.getComponentName())}getNewEvents(){const e=[],t=Atomics.load(uh.sharedArray,ve.HDMI);return t>=0&&t!==this.active&&(this.active=t,e.push(new Nd(0!==this.active))),e}isConnected=new Ch("isConnected",{signature:{args:[],returns:T.Boolean},impl:e=>{if("TV"===this.modelType)return D.False;const t=Atomics.load(uh.sharedArray,ve.HDMI);return D.from(0!==t)}});getHdcpVersion=new Ch("getHdcpVersion",{signature:{args:[],returns:T.String},impl:e=>{const t="1080p"===this.displayMode?"2.2":"1.4";return new M(t)}});isHdcpActive=new Ch("isHdcpActive",{signature:{args:[new kh("version",T.String)],returns:T.Boolean},impl:(e,t)=>D.from(["1.4","2.2"].includes(t.value))})}class Xv extends L{kind=T.Object;constructor(){super("roUtils"),this.registerMethods({ifUtils:[this.deepCopy,this.isSameObject]})}toString(e){return"<Component: roUtils>"}equalTo(e){return D.False}deepCopy=new Ch("deepCopy",{signature:{args:[new kh("data",T.Object)],returns:T.Object},impl:(e,t)=>XS(t)?t.deepCopy():new Pv});isSameObject=new Ch("isSameObject",{signature:{args:[new kh("data1",T.Object),new kh("data2",T.Object)],returns:T.Boolean},impl:(e,t,n)=>D.from(t===n)})}const Yv=new Map([[0,"back"],[2,"up"],[3,"down"],[4,"left"],[5,"right"],[6,"OK"],[7,"replay"],[8,"rewind"],[9,"fastforward"],[10,"options"],[13,"play"]]);class Kv extends L{kind=T.Object;x=0;y=0;draw2D;maxMs;canvas;context;textureManager;fontRegistry;port;sceneType;alphaEnable;lastMessage;width;height;resolution;scaleMode;isDirty;constructor(){super("roSGScreen"),this.draw2D=new qb(this),this.textureManager=xw(),this.fontRegistry=mw(),this.alphaEnable=!0,this.scaleMode=1,this.isDirty=!1,this.lastMessage=performance.now();const e=uh.deviceInfo.maxFps;this.maxMs=Math.trunc(1/e*1e3),this.width=1280,this.height=720,this.resolution="HD",this.canvas=iw(this.width,this.height),this.context=this.canvas.getContext("2d");const t=new ap(this,this.getNewEvents.bind(this)),n=new op(this);this.registerMethods({ifSGScreen:[this.getGlobalNode,this.show,this.close,this.createScene,this.getScene,t.setMessagePort,n.getMessagePort]})}clearCanvas(e){Number.isNaN(e)&&(e=255);const t=this.context;t.clearRect(0,0,this.canvas.width,this.canvas.height),(255&e)>0&&(t.fillStyle=cw(e),t.fillRect(0,0,this.canvas.width,this.canvas.height)),this.isDirty=!0}getContext(){return this.context}getCanvas(){return this.canvas}getRgbaCanvas(e){return this.canvas}setCanvasAlpha(e){this.alphaEnable=e,this.isDirty=!0}getCanvasAlpha(){return this.alphaEnable}drawImage(e,t,n,r=1,i=1,s){return this.isDirty=!0,tw(this,e,t,n,r,i,s)}makeDirty(){this.isDirty=!0}finishDraw(){this.isDirty&&(postMessage(this.context.getImageData(0,0,this.width,this.height)),this.isDirty=!1)}equalTo(e){return D.False}toString(){return"<Component: roSGScreen>"}dispose(){sw(this.canvas)}getDebugData(){return{textures:this.textureManager.count(),fonts:this.fontRegistry.count()}}getNewEvents(e){const t=[],n=this.handleNextKey(e);if(n instanceof L&&t.push(n),eS.scene){if(this.isDirty||=eS.processTimers(),this.isDirty||=eS.processTasks(),this.isDirty||=eS.processAudio(),this.isDirty||=eS.processSFX(),this.isDirty||=eS.processVideo(),eS.scene.renderNode(e,[0,0],0,1,this.draw2D),eS.scene?.dialog?.getNodeParent()instanceof O){const t=eS.scene.dialog;t.setFieldValue("visible",D.True);const n={x:0,y:0,width:this.width,height:this.height};this.draw2D.doDrawRotatedRect(n,255,0,[0,0],.5),t.renderNode(e,[0,0],0,1,this.draw2D)}let t=Date.now();for(;t-this.lastMessage<this.maxMs;)t=Date.now();this.finishDraw(),this.lastMessage=t}return t}handleNextKey(e){const t=uh.updateKeysBuffer();if(!t||!eS?.scene)return O.Instance;this.isDirty=!0;const n=t.key-t.mod;let r;r=new M(n<32?Yv.get(n)??"":`Lit_${String.fromCharCode(n)}`);const i=D.from(0===t.mod);let s=!1;return s=eS.scene.dialog?.isVisible()?eS.scene.dialog.handleKey(r.value,i.toBoolean()):eS.scene.handleOnKeyEvent(e,r,i),i.toBoolean()&&(this.playNavigationSound(r.value,s),"back"===r.value&&!s)?new Bd(D.True):O.Instance}playNavigationSound(e,t){let n="deadend";"back"===e?n="navsingle":["OK","options"].includes(e)&&t?n="select":["rewind","fastforward"].includes(e)&&t?n="navmulti":t&&(n="navsingle"),uh.playSound(n)}getGlobalNode=new Ch("getGlobalNode",{signature:{args:[],returns:T.Dynamic},impl:e=>eS.mGlobal});show=new Ch("show",{signature:{args:[],returns:T.Boolean},impl:e=>{if(this.sceneType&&eS.scene){const t=eS.nodeDefMap.get(this.sceneType.value.toLowerCase());Lh(e,this.sceneType,t,eS.scene)}return this.isDirty=!0,D.True}});close=new Ch("close",{signature:{args:[],returns:T.Void},impl:e=>(this.port?.pushMessage(new Bd(D.True)),P.Instance)});createScene=new Ch("createScene",{signature:{args:[new kh("sceneType",T.String)],returns:T.Object},impl:(e,t)=>{const n=e.manifest,r=n.get("ui_resolutions")??"HD";if(r.length&&"HD"!==r){const e=r.split(",");"FHD"===e[0].toUpperCase()?(this.resolution="FHD",this.width=1920,this.height=1080,this.canvas.width=this.width,this.canvas.height=this.height):"SD"===e[0].toUpperCase()&&(this.resolution="SD",this.width=720,this.height=480,this.canvas.width=this.width,this.canvas.height=this.height)}let i=O.Instance;if(t.value===_h.Scene)i=new nS([],_h.Scene);else{if(!eS.nodeDefMap.has(t.value.toLowerCase()))return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGScreen.CreateScene: No such node ${t.value}: ${e.formatLocation()}`),O.Instance;i=Ph(e,t)}if(!(i instanceof nS))return uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: roSGScreen.CreateScene: Type mismatch converting from '${t.value}' to 'Scene': ${e.formatLocation()}`),O.Instance;{this.sceneType=t;const e=n.get("uri_resolution_autosub")??"";eS.setScene(i),eS.scene?.setDesignResolution(this.resolution,e)}return i}});getScene=new Ch("getScene",{signature:{args:[],returns:T.Object},impl:e=>eS.scene??O.Instance})}const Jv=new class{map=new Map;constructor(e){for(const[t,n,r]of e)this.set(t,n,r)}get(e){const t=this.map.get(e.toLowerCase());return t?t.value:void 0}set(e,t,n){return this.map.set(e.toLowerCase(),{originalKey:e,value:t,params:n??0})}has(e){return this.map.has(e.toLowerCase())}delete(e){return this.map.delete(e.toLowerCase())}clear(){return this.map.clear()}values(){return Array.from(this.map.values()).map(e=>e.value)}keys(){return Array.from(this.map.values()).map(e=>e.originalKey)}params(e){const t=this.map.get(e.toLowerCase());return t?t.params:-1}}([["roAppManager",e=>new Xf],["roAssociativeArray",e=>new Fh([])],["roArray",(e,t,n)=>new Kh(t,n),2],["roByteArray",e=>new gd],["roEVPCipher",e=>new Zf],["roEVPDigest",e=>new ep],["roHMAC",e=>new np],["roDeviceCrypto",e=>new ip],["roChannelStore",e=>new cp],["roDateTime",e=>new up],["roList",e=>new td],["roTimespan",e=>new qf],["roRegex",(e,t,n)=>new fp(t,n),2],["roString",e=>new md,-1],["roBoolean",(e,t)=>new bd(t),-1],["roDouble",(e,t)=>new gh(t),-1],["roFloat",(e,t)=>new yh(t),-1],["roInt",(e,t)=>new wh(t),-1],["roLongInteger",(e,t)=>new fh(t),-1],["roFunction",(e,t)=>new Rh(t)],["roPath",(e,t)=>new yd(t),1],["roBitmap",(e,t)=>jb(t),1],["roTextureRequest",(e,t)=>new kw(t),1],["roTextureManager",e=>xw()],["roImageMetadata",e=>new tv],["roMessagePort",e=>new pp],["roInput",e=>new gp],["roSystemLog",e=>new mp],["roFileSystem",e=>new Ov],["roLocalization",e=>new wv],["roFontRegistry",e=>mw()],["roRegistry",e=>new Sv],["roRegistrySection",(e,t)=>new xv(t),1],["roAppInfo",e=>new Ev],["roDeviceInfo",e=>new Fv],["roRemoteInfo",e=>new Rv],["roAppMemoryMonitor",e=>new lp],["roAudioPlayer",e=>new av],["roAudioResource",(e,t)=>bv(t),1],["roAudioMetadata",e=>new sv],["roVideoPlayer",e=>new ov],["roCompositor",e=>new $b],["roRegion",(e,t,n,r,i,s)=>Gb(t,n,r,i,s),5],["roScreen",(e,t,n,r)=>bw(t,n,r),-2],["roXMLElement",e=>new fv],["roURLTransfer",e=>new gv],["roHttpAgent",e=>new mv],["roInvalid",e=>new Pv,-1],["roNDK",e=>new Nv],["roCECStatus",e=>new Lv],["roHdmiStatus",e=>new qv],["roSocketAddress",e=>new Bv],["roStreamSocket",e=>new Wv],["roUtils",e=>new Xv],["roSGNode",(e,t)=>Oh(t,e),1],["roSGScreen",e=>new Kv]]);class Zv extends Bf{name;defaultFields=[{name:"ContentType",type:"string",hidden:!0},{name:"Title",type:"string",hidden:!0},{name:"TitleSeason",type:"string",hidden:!0},{name:"Description",type:"string",hidden:!0},{name:"SDPosterUrl",type:"string",hidden:!0},{name:"HDPosterUrl",type:"string",hidden:!0},{name:"FHDPosterUrl",type:"string",hidden:!0},{name:"ReleaseDate",type:"string",hidden:!0},{name:"Rating",type:"string",hidden:!0},{name:"StarRating",type:"integer",hidden:!0},{name:"UserStarRating",type:"integer",hidden:!0},{name:"ShortDescriptionLine1",type:"string",hidden:!0},{name:"ShortDescriptionLine2",type:"string",hidden:!0},{name:"EpisodeNumber",type:"string",hidden:!0},{name:"NumEpisodes",type:"integer",hidden:!0},{name:"Actors",type:"array",hidden:!0},{name:"Actors",type:"string",hidden:!0},{name:"Directors",type:"array",hidden:!0},{name:"Director",type:"string",hidden:!0},{name:"Categories",type:"array",hidden:!0},{name:"Categories",type:"string",hidden:!0},{name:"Album",type:"string",hidden:!0},{name:"Artist",type:"string",hidden:!0},{name:"TextOverlayUL",type:"string",hidden:!0},{name:"TextOverlayUR",type:"string",hidden:!0},{name:"TextOverlayBody",type:"string",hidden:!0},{name:"appData",type:"string",value:"",hidden:!0},{name:"encodingKey",type:"string",value:"",hidden:!0},{name:"encodingType",type:"string",value:"",hidden:!0},{name:"KeySystem",type:"string",value:"",hidden:!0},{name:"licenseRenewURL",type:"string",value:"",hidden:!0},{name:"licenseServerURL",type:"string",value:"",hidden:!0},{name:"serializationURL",type:"string",value:"",hidden:!0},{name:"serviceCert",type:"string",value:"",hidden:!0},{name:"Live",type:"boolean",hidden:!0},{name:"Url",type:"string",hidden:!0},{name:"SDBifUrl",type:"string",hidden:!0},{name:"HDBifUrl",type:"string",hidden:!0},{name:"FHDBifUrl",type:"string",hidden:!0},{name:"Stream",type:"assocarray",hidden:!0},{name:"Streams",type:"assocarray",hidden:!0},{name:"StreamBitrates",type:"array",hidden:!0},{name:"StreamUrls",type:"array",hidden:!0},{name:"StreamQualities",type:"array",hidden:!0},{name:"StreamContentIDs",type:"array",hidden:!0},{name:"StreamStickyHttpRedirects",type:"array",hidden:!0},{name:"StreamStartTimeOffset",type:"integer",hidden:!0},{name:"StreamFormat",type:"string",hidden:!0},{name:"Length",type:"integer",hidden:!0},{name:"BookmarkPosition",type:"integer",hidden:!0},{name:"PlayStart",type:"integer",hidden:!0},{name:"PlayDuration",type:"integer",hidden:!0},{name:"ClosedCaptions",type:"boolean",hidden:!0},{name:"HDBranded",type:"boolean",hidden:!0},{name:"IsHD",type:"boolean",hidden:!0},{name:"SubtitleColor",type:"string",hidden:!0},{name:"SubtitleConfig",type:"assocarray",hidden:!0},{name:"SubtitleTracks",type:"assocarray",hidden:!0},{name:"SubtitleUrl",type:"string",hidden:!0},{name:"VideoDisableUI",type:"boolean",hidden:!0},{name:"EncodingType",type:"string",hidden:!0},{name:"EncodingKey",type:"string",hidden:!0},{name:"SwitchingStrategy",type:"string",hidden:!0},{name:"Watched",type:"boolean",hidden:!0},{name:"ForwardQueryStringParams",type:"boolean",hidden:!0},{name:"IgnoreStreamErrors",type:"boolean",hidden:!0},{name:"AdaptiveMinStartBitrate",type:"integer",hidden:!0},{name:"AdaptiveMaxStartBitrate",type:"integer",hidden:!0},{name:"filterCodecProfiles",type:"boolean",hidden:!0},{name:"LiveBoundsPauseBehavior",type:"string",hidden:!0},{name:"ClipStart",type:"float",hidden:!0},{name:"ClipEnd",type:"float",hidden:!0},{name:"PreferredAudioCodec",type:"string",hidden:!0},{name:"CdnConfig",type:"array",hidden:!0},{name:"HttpCertificatesFile",type:"string",hidden:!0},{name:"HttpCookies",type:"array",hidden:!0},{name:"HttpHeaders",type:"array",hidden:!0},{name:"HttpSendClientCertificate",type:"boolean",hidden:!0},{name:"MinBandwidth",type:"integer",hidden:!0},{name:"MaxBandwidth",type:"integer",hidden:!0},{name:"AudioPIDPref",type:"integer",hidden:!0},{name:"FullHD",type:"boolean",hidden:!0},{name:"FrameRate",type:"integer",hidden:!0},{name:"TrackIDAudio",type:"string",hidden:!0},{name:"TrackIDVideo",type:"string",hidden:!0},{name:"TrackIDSubtitle",type:"string",hidden:!0},{name:"AudioFormat",type:"string",hidden:!0},{name:"AudioLanguageSelected",type:"string",hidden:!0},{name:"SDBackgroundImageUrl",type:"string",hidden:!0},{name:"HDBackgroundImageUrl",type:"string",hidden:!0},{name:"SourceRect",type:"assocarray",hidden:!0},{name:"TargetRect",type:"assocarray",hidden:!0},{name:"TargetTranslation",type:"assocarray",hidden:!0},{name:"TargetRotation",type:"float",hidden:!0},{name:"CompositionMode",type:"string",hidden:!0},{name:"Text",type:"string",hidden:!0},{name:"TextAttrs",type:"assocarray",hidden:!0},{name:"HideIcon",type:"boolean",hidden:!0},{name:"Color",type:"string",hidden:!0},{name:"HDListItemIconUrl",type:"string",hidden:!0},{name:"SDListItemIconUrl",type:"string",hidden:!0},{name:"HDGridPosterUrl",type:"string",hidden:!0},{name:"SDGridPosterUrl",type:"string",hidden:!0},{name:"HDListItemIconSelectedUrl",type:"string",hidden:!0},{name:"SDListItemIconSelectedUrl",type:"string",hidden:!0}];metaDataFields=new Set(this.defaultFields.map(e=>e.name.toLowerCase()));parentFields=new Set;constructor(e="ContentNode"){super([],e),this.name=e,this.registerDefaultFields(this.defaultFields),this.appendMethods([this.count,this.keys,this.items,this.hasField])}getVisibleFields(){let e=this.getNodeFields();return Array.from(e).filter(([e,t])=>!t.isHidden())}set(e,t,n=!1,r){if(this.notified=!1,super.set(e,t,n,r),this.parentFields.size&&this.notified)for(const e of this.parentFields)e.notifyObservers();return O.Instance}appendChildToParent(e){let t=!1;return e instanceof Zv?(this.children.includes(e)||(this.children.push(e),e.setNodeParent(this)),t=!0):(e instanceof Bf||e===O.Instance)&&(this.children.push(O.Instance),t=!0),this.changed||=t,t}addParentField(e){this.parentFields.add(e)}removeParentField(e){this.parentFields.delete(e)}toString(e){const t=`${this.getComponentName()}:${this.nodeSubtype}`;return e?`<Component: ${t}>`:[`<Component: ${t}> =`,"{",...this.getVisibleFields().map(([e,t])=>`    ${e=this.metaDataFields.has(e.toLowerCase())?e.toUpperCase():e}: ${t.toString(this)}`),"}"].join("\n")}getElements(){return this.getVisibleFields().map(([e,t])=>e).sort().map(e=>new M(e))}getValues(){return this.getVisibleFields().map(([e,t])=>t).sort().map(e=>e.getValue())}count=new Ch("count",{signature:{args:[],returns:T.Int32},impl:e=>new vh(this.getVisibleFields().length)});keys=new Ch("keys",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.getElements())});items=new Ch("items",{signature:{args:[],returns:T.Object},impl:e=>new Kh(this.getElements().map(e=>nx({key:e,value:this.get(e)})))});hasField=new Ch("hasField",{signature:{args:[new kh("fieldname",T.String)],returns:T.Boolean},impl:(e,t)=>{let n=this.getNodeFields().get(t.value.toLowerCase());return n?(n.setHidden(!1),D.True):D.False}})}class Qv{_mGlobal;_nodeDefMap;_scene;_focused;_taskId;_threads;_tasks;_timers;_sfx;_audio;_video;get mGlobal(){return this._mGlobal??=new Uf([]),this._mGlobal}get nodeDefMap(){return this._nodeDefMap}get scene(){return this._scene}get focused(){return this._focused}get sfx(){return this._sfx}get tasks(){return this._tasks}get timers(){return this._timers}get audio(){return this._audio}get video(){return this._video}get taskId(){return this._taskId}audioFlags=-1;audioIndex=-1;audioDuration=-1;audioPosition=-1;videoEvent=-1;videoIndex=-1;videoProgress=-1;videoDuration=-1;videoPosition=-1;constructor(){this._nodeDefMap=new Map,this._sfx=[],this._tasks=[],this._timers=[],this._threads=new Map,this._taskId=0,this._threads.set(this._taskId,{id:Se(),type:"Render"})}setNodeDefMap(e){this._nodeDefMap=e}setScene(e){this._scene=e}setFocused(e){this._focused=e}setThread(e,t=!1,n){this._threads.set(e,{id:n??Se(),type:e>0?"Task":"Render"}),t&&(this._taskId=e)}processTasks(){let e=!1;for(const t of this._tasks)e=t.updateTask(),t.active&&t.checkTask();return e}processTimers(){let e=!1;for(const t of this._timers)t.active&&t.checkFire()&&(e=!0);return e}setAudio(e){this._audio=e,this.audioFlags=-1,this.audioIndex=-1,this.audioDuration=-1,this.audioPosition=-1,Atomics.store(uh.sharedArray,ve.SND,-1),Atomics.store(uh.sharedArray,ve.SDX,-1),Atomics.store(uh.sharedArray,ve.SDR,-1),Atomics.store(uh.sharedArray,ve.SPS,-1)}processAudio(){if(!this._audio)return!1;let e=!1;const t=Atomics.load(uh.sharedArray,ve.SND);t!==this.audioFlags&&(this.audioFlags=t,this._audio.setState(t),e=!0);const n=Atomics.load(uh.sharedArray,ve.SDX);n!==this.audioIndex&&(this.audioIndex=n,this._audio.setContentIndex(n),e=!0);const r=Atomics.load(uh.sharedArray,ve.SDR);r!==this.audioDuration&&(this.audioDuration=r,this._audio.setDuration(r),e=!0);const i=Atomics.load(uh.sharedArray,ve.SPS);return i!==this.audioPosition&&(this.audioPosition=i,this._audio.setPosition(i),e=!0),e}setVideo(e){this._video=e,this.videoEvent=-1,this.videoIndex=-1,this.videoProgress=-1,this.videoDuration=-1,this.videoPosition=-1,Atomics.store(uh.sharedArray,ve.VDO,-1),Atomics.store(uh.sharedArray,ve.VDX,-1),Atomics.store(uh.sharedArray,ve.VSE,-1),Atomics.store(uh.sharedArray,ve.VDR,-1),Atomics.store(uh.sharedArray,ve.VPS,-1),Atomics.store(uh.sharedArray,ve.VAT,-1),Atomics.store(uh.sharedArray,ve.VTT,-1)}processVideo(){if(!this._video)return!1;let e=!1;const t=Atomics.load(uh.sharedArray,ve.VLP);this.videoProgress!==t&&t>=0&&t<=1e3&&(this._video.setState(ke.LOADING,Math.trunc(t/10)),console.debug(`Video Progress: ${t}`)),this.videoProgress=t;const n=Atomics.load(uh.sharedArray,ve.VDO),r=Atomics.load(uh.sharedArray,ve.VDX);n!==this.videoEvent&&(this.videoEvent=n,n>=0&&(this._video.setState(n,r),console.debug(`Video State: ${this._video.getFieldValueJS("state")}  (${n}/${r})`),Atomics.store(uh.sharedArray,ve.VDO,-1),e=!0));const i=Atomics.load(uh.sharedArray,ve.VSE);i!==this.videoIndex&&(this.videoIndex=i,i>=0&&(this._video.setContentIndex(i),Atomics.store(uh.sharedArray,ve.VSE,-1),e=!0));const s=Atomics.load(uh.sharedArray,ve.VDR);s!==this.videoDuration&&(this.videoDuration=s,this._video.setDuration(s),e=!0);const a=Atomics.load(uh.sharedArray,ve.VPS);if(a!==this.videoPosition&&(this.videoPosition=a,this._video.setPosition(a),e=!0),Atomics.load(uh.sharedArray,ve.BUF)===_e.MEDIA_TRACKS){const t=uh.readDataBuffer();let n=[],r=[];try{const e=JSON.parse(t);n=e.audio??[],r=e.text??[]}catch(e){n=[],r=[]}this._video.setAudioTracks(n),this._video.setSubtitleTracks(r),e=!0}const o=Atomics.load(uh.sharedArray,ve.VAT);o>-1&&(this._video.setCurrentAudioTrack(o),Atomics.store(uh.sharedArray,ve.VAT,-1),e=!0);const c=Atomics.load(uh.sharedArray,ve.VTT);return c>-1&&(this._video.setCurrentSubtitleTrack(c),Atomics.store(uh.sharedArray,ve.VTT,-1),e=!0),e}processSFX(){let e=!1;for(let t=0;t<this._sfx.length;t++){const n=this._sfx[t];if(!n)continue;const r=Atomics.load(uh.sharedArray,ve.WAV+t);r>=0&&r===n.getAudioId()&&"playing"!==n.getState()?(n.setState(ke.START_PLAY),e=!0):"stopped"!==n.getState()&&(n.setState(ke.FINISHED),this._sfx[t]=void 0,e=!0)}return e}inTaskThread(){return this.taskId>0}getThreadInfo(e){const t=this._threads.get(e);if(0===e&&0===this._taskId)t.name=this.scene?.nodeSubtype;else if(e>0){const n=this.tasks.find(t=>t.id===e);t.name=n?.name}return t}getCurrentThread(){return this.getThreadInfo(this._taskId)}getRenderThread(){return this.getThreadInfo(0)}}const eS=new Qv;class tS extends Bf{name;defaultFields=[{name:"visible",type:"boolean",value:"true"},{name:"opacity",type:"float",value:"1.0"},{name:"translation",type:"vector2d",value:"[0.0,0.0]"},{name:"rotation",type:"float",value:"0.0"},{name:"scale",type:"vector2d",value:"[1.0,1.0]"},{name:"scaleRotateCenter",type:"vector2d",value:"[0.0,0.0]"},{name:"childRenderOrder",type:"string",value:"renderLast"},{name:"inheritParentTransform",type:"boolean",value:"true"},{name:"inheritParentOpacity",type:"boolean",value:"true"},{name:"clippingRect",type:"rect2d",value:"[0.0,0.0,0.0,0.0]"},{name:"renderPass",type:"integer",value:"0"},{name:"muteAudioGuide",type:"boolean",value:"false"},{name:"enableRenderTracking",type:"boolean",value:"false"},{name:"renderTracking",type:"string",value:"disabled"}];sceneRect;resolution;cachedLines=[];cachedHeight=0;isDirty;constructor(e=[],t="Group"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e);const n=eS.scene?.ui;n?(this.resolution=n.resolution,this.sceneRect={x:0,y:0,width:n.width,height:n.height}):(this.resolution="HD",this.sceneRect={x:0,y:0,width:1280,height:720}),this.isDirty=!0}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase(),s=this.fields.get(i);if(s?.getType()===bf.Font&&$S(t)){const e=t.getValue(),n=new fS;t=e.startsWith("font:")&&n.setSystemFont(e.slice(5).toLowerCase())?n:O.Instance}else if(s?.getType()===bf.Color&&$S(t)){let e=t.getValue();if(!e.length)return O.Instance;t=new vh(k(e))}return this.isDirty=!0,super.set(e,t,n,r)}setFieldValue(e,t,n){this.isDirty=!0,super.setFieldValue(e,t,n)}getDimensions(){return{width:this.getFieldValueJS("width")??0,height:this.getFieldValueJS("height")??0}}isVisible(){return this.getFieldValueJS("visible")??!0}addPoster(e,t,n,r){const i=new pS;return e&&i.set(new M("uri"),new M(e)),i.setTranslation(t),void 0!==n&&i.set(new M("width"),new bh(n)),void 0!==r&&i.set(new M("height"),new bh(r)),this.appendChildToParent(i),i}addLabel(e,t,n,r,i,s,a,o){const c=new hS;if(e&&this.copyField(c,"color",e),i){const e=c.getNodeFields(),t=e.get("font")?.getValue();t instanceof fS&&t.setSize(i)}return void 0!==n&&c.set(new M("width"),new bh(n)),void 0!==r&&c.set(new M("height"),new bh(r)),c.setTranslation(t),s&&c.set(new M("vertalign"),new M(s)),a&&c.set(new M("horizalign"),new M(a)),void 0!==o&&c.set(new M("wrap"),D.from(o)),this.appendChildToParent(c),c}addScrollingLabel(e,t,n,r,i,s,a,o,c){const l=new dS;if(e&&this.copyField(l,"color",e),i){const e=l.getFieldValue("font");e instanceof fS&&e.setSystemFont(i)}return void 0!==n&&l.set(new M("maxWidth"),new bh(n)),void 0!==r&&l.set(new M("height"),new bh(r)),l.setTranslation(t),s&&l.set(new M("vertalign"),new M(s)),a&&l.set(new M("horizalign"),new M(a)),void 0!==o&&l.set(new M("scrollSpeed"),new vh(o)),void 0!==c&&l.set(new M("repeatCount"),new vh(c)),this.appendChildToParent(l),l}addRectangle(e,t,n,r){const i=new uS;return this.copyField(i,"color",e),void 0!==n&&i.set(new M("width"),new bh(n)),void 0!==r&&i.set(new M("height"),new bh(r)),i.setTranslation(t),this.appendChildToParent(i),i}getTranslation(){const e=this.getFieldValueJS("translation"),t=this.getFieldValueJS("scale"),n=this.getScaleRotateCenter(),r=n[0]*(t[0]-1),i=n[1]*(t[1]-1);return e[0]-=r,e[1]-=i,e}setTranslation(e){if(2===e.length){const t=[new bh(e[0]),new bh(e[1])];this.set(new M("translation"),new Kh(t))}}setTranslationOffset(e=0,t=0){const n=this.getFieldValueJS("translation");n[0]+=e,n[1]+=t,this.setTranslation(n)}setTranslationX(e){const t=this.getFieldValueJS("translation");t[0]=e,this.setTranslation(t)}setTranslationY(e){const t=this.getFieldValueJS("translation");t[1]=e,this.setTranslation(t)}getRotation(){return this.getFieldValueJS("rotation")??0}getScaleRotateCenter(){const e=this.getFieldValue("scaleRotateCenter"),t=[0,0];return e instanceof Kh&&2===e.elements.length&&(t[0]=cx(e.elements[0]),t[1]=cx(e.elements[1])),t}getOpacity(){return this.getFieldValueJS("opacity")??1}drawText(e,t,n,r,i,s,a,o,c,l="...",u=0){const h=t.createDrawFont();let d,f;if(this.isDirty||void 0===this.cachedLines[u]){if(0===i.width){const t=e.indexOf("\n");d=-1!==t?e.substring(0,t):e,f=h.measureText(d)}else f=h.measureText(e,i.width,l),d=f.text;this.cachedLines[u]=f}else f=this.cachedLines[u],d=f.text;let p=i.x,g=i.y;return i.width>f.width&&("center"===s?p+=(i.width-f.width)/2:"right"===s&&(p+=i.width-f.width)),i.height>f.height&&("center"===a?g+=(i.height-f.height)/2:"bottom"===a&&(g+=i.height-f.height)),c?.doDrawRotatedText(d,p,g,n,r,h,o),f}drawTextWrap(e,t,n,r,i,s,a,o,c="...",l=0,u=0,h=0,d=!1,f){const p=t.createDrawFont();this.changed&&this.refreshLines(e,p,i,c,l,u,h,d);let g=i.y;"center"===a?g+=(i.height-this.cachedHeight)/2:"bottom"===a&&(g+=i.height-this.cachedHeight);let m=!1;for(const e of this.cachedLines){let t=i.x;"center"===s?t+=(i.width-e.width)/2:"right"===s&&(t+=i.width-e.width),f?.doDrawRotatedText(e.text,t,g,n,r,p,o),g+=e.height+h,m=e.ellipsized}return{text:e,width:i.width,height:this.cachedHeight,ellipsized:m}}refreshLines(e,t,n,r,i,s,a,o){const c=this.breakTextIntoLines(e,t,n.width),l=t.measureTextHeight();let u=c,h=c.length*l;if(n.height>0){const e=Math.floor((n.height+a)/(l+a));u=this.checkEllipsis(c,e,t,n.width,r),h=!o&&u.length<c.length?u.length*l+(u.length>1?(u.length-1)*a:0):Math.min(h,n.height)}else if(i>0||s>0){const e=i>0?i:s;u=this.checkEllipsis(c,e,t,n.width,r),h=Math.min(h,e*l+(e>1?(e-1)*a:0))}this.cachedHeight=h,this.cachedLines=u}checkEllipsis(e,t,n,r,i){if(e.length>t){const s=e.slice(0,t);if(s.length>0){const e=s[s.length-1];e.text=this.ellipsizeLine(e.text,n,r,i),e.ellipsized=!0}return s}return e}breakTextIntoLines(e,t,n){const r=[];if(0===e.length||n<=0)return r;const i=e.split(/(\s|-)/);let s=t.measureText(e);if(s.width<=n)return[s];s={text:"",width:0,height:0,ellipsized:!1};for(const e of i)if("\n"===e)r.push(s),s={text:"",width:0,height:0,ellipsized:!1};else{const i=s.text+e,a=t.measureText(i);if(a.width<=n)s=a;else if(t.measureText(e).width>n){const i=this.breakLongWord(e,t,n);for(const e of i){const i=t.measureText(s.text+e);i.width<=n?s=i:(r.push(s),s=t.measureText(e))}}else r.push(s),s=t.measureText(e)}return r.push(s),r}breakLongWord(e,t,n){const r=[];let i="";for(const s of e)t.measureTextWidth(i+s).width<=n?i+=s:(r.push(i),i=s);return r.push(i),r}ellipsizeLine(e,t,n,r){if(t.measureTextWidth(e+r).width<=n)return e+r;let i="";for(const s of e){if(!(t.measureTextWidth(i+s+r).width<=n))return i+r;i+=s}return i+r}drawImage(e,t,n,r,i,s){if(e.isValid()){if(e.scaleMode=1,"number"==typeof s&&4294967295!==s&&-1!==s||(s=void 0),(r<0||r>1)&&(r=1),e.ninePatch)return i?.drawNinePatch(e,t,s,r),t;const a=this.getFieldValueJS("scale");let o=0!==t.width?t.width/e.width:1,c=0!==t.height?t.height/e.height:1;if(o*=a[0],c*=a[1],t.width=o*e.width,t.height=c*e.height,0!==n||1!==a[0]||1!==a[1]){const a=this.getScaleRotateCenter();i?.doDrawRotatedBitmap(t.x,t.y,o,c,n,e,a[0],a[1],s,r)}else i?.doDrawScaledObject(t.x,t.y,o,c,e,s,r)}return t}updateBoundingRects(e,t,n){const r=this.getTranslation();if(this.rectLocal={x:0,y:0,width:e.width,height:e.height},0!==n){const i=this.getScaleRotateCenter();this.rectToScene=x(e,n,i);const s=this.getRotation();if(0!==s&&s===n)this.rectToParent={x:this.rectToScene.x-t[0],y:this.rectToScene.y-t[1],width:this.rectToScene.width,height:this.rectToScene.height};else if(0!==s&&s!==n){const t=x({x:0,y:0,width:e.width,height:e.height},s,i);this.rectToParent={x:r[0]+t.x,y:r[1]+t.y,width:t.width,height:t.height}}else this.rectToParent={x:r[0],y:r[1],width:e.width,height:e.height}}else this.rectToScene=e,this.rectToParent={x:r[0],y:r[1],width:e.width,height:e.height}}updateParentRects(e,t){if(this.parent instanceof tS){const n=this.parent;n.rectLocal=I(n.rectLocal,this.rectToParent);const r=n.getTranslation();let i=r[0]+n.rectLocal.x,s=r[1]+n.rectLocal.y,a=n.rectLocal.width,o=n.rectLocal.height;if(0!==t){const e=x({x:0,y:0,width:a,height:o},t,n.getScaleRotateCenter());i+=e.x,s+=e.y,a=e.width,o=e.height}n.rectToParent=I(n.rectToParent,{x:i,y:s,width:a,height:o}),i+=e[0]-r[0],s+=e[1]-r[1],n.rectToScene=I(n.rectToScene,{x:i,y:s,width:a,height:o})}}handleKey(e,t){return!1}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=s.slice();a[0]+=t[0],a[1]+=t[1];const o=n+this.getRotation();this.rectLocal={x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,width:Number.POSITIVE_INFINITY,height:Number.POSITIVE_INFINITY},this.rectToScene={x:a[0],y:a[1],width:0,height:0},this.rectToParent={x:s[0],y:s[1],width:0,height:0},r*=this.getOpacity(),this.renderChildren(e,a,o,r,i),this.updateContainerBounds(s,a),this.updateParentRects(t,n),this.isDirty=!1}updateContainerBounds(e,t){if(!Number.isFinite(this.rectLocal.x))return;const n=this.rectLocal;this.rectToParent={x:e[0]+n.x,y:e[1]+n.y,width:n.width,height:n.height},this.rectToScene={x:t[0]+n.x,y:t[1]+n.y,width:n.width,height:n.height}}}class nS extends tS{name;defaultFields=[{name:"backgroundURI",type:"uri"},{name:"backgroundColor",type:bf.Color,value:"0x2F3140FF"},{name:"backExitsScene",type:bf.Boolean,value:"true"},{name:"dialog",type:bf.Node},{name:"currentDesignResolution",type:bf.AssocArray},{name:"palette",type:bf.Node},{name:"focusable",type:bf.Boolean,value:"true"}];ui={width:1280,height:720,resolution:"HD"};dialog;subSearch;subReplace;constructor(e=[],t="Scene"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.setDesignResolution("HD",""),this.subSearch="",this.subReplace=""}set(e,t,n=!1,r,i=!0){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const s=e.getValue().toLowerCase();if("dialog"===s)if(t instanceof gS||t instanceof DS)this.dialog?.set(new M("close"),D.True),this.dialog=t;else{if(!(t instanceof O))return O.Instance;this.dialog?.set(new M("close"),D.True)}const a=super.set(e,t,n,r);return i&&eS.tasks.length>0&&this.changed&&this.fields.has(s)&&(this.sendThreadUpdate(eS.taskId,"scene",s,t),eS.inTaskThread()&&(this.changed=!1)),a}cloneNode(e,t){return O.Instance}getDimensions(){return{width:this.ui.width,height:this.ui.height}}addObserver(e,t,n,r,i){return e.environment.hostNode||(e.environment.hostNode=this),super.addObserver(e,t,n,r,i)}setDesignResolution(e,t){if(["SD","HD","FHD"].includes(e.toUpperCase())&&(this.ui.resolution=e.toUpperCase(),"FHD"===this.ui.resolution?(this.ui.width=1920,this.ui.height=1080):"HD"===this.ui.resolution?(this.ui.width=1280,this.ui.height=720):"SD"===this.ui.resolution&&(this.ui.width=720,this.ui.height=480),this.rectLocal={x:0,y:0,width:this.ui.width,height:this.ui.height},this.rectToParent={x:0,y:0,width:this.ui.width,height:this.ui.height},this.rectToScene={x:0,y:0,width:this.ui.width,height:this.ui.height},this.setFieldValue("currentDesignResolution",nx(this.ui)),4===t.split(",").length)){const e=t.split(",");this.subSearch=e[0],"SD"===this.ui.resolution?this.subReplace=e[1]:"HD"===this.ui.resolution?this.subReplace=e[2]:this.subReplace=e[3]}}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=n+this.getRotation(),a=this.getFieldValueJS("backgroundColor");if(r*=this.getOpacity(),i){i.doClearCanvas(a);const e=this.getBitmap("backgroundUri");if(e?.isValid()){const t=this.ui.width/e.width,n=this.ui.height/e.height;i.doDrawScaledObject(0,0,t,n,e,void 0,r)}}this.renderChildren(e,t,s,r,i)}handleOnKeyEvent(e,t,n){if(!(eS.focused instanceof Bf))return this.handleKeyByNode(e,this,t,n);{const r=this.createPath(eS.focused,!1);for(let i of r)if(this.handleKeyByNode(e,i,t,n))return!0}return!1}handleKeyByNode(e,t,n,r){const i=eS.nodeDefMap.get(t.nodeSubtype.toLowerCase());if(void 0===i?.environment)return t instanceof tS&&t.handleKey(n.value,r.toBoolean());const s=i.environment,a=e.inSubEnv(i=>{i.environment.hostNode=t,i.environment.setRootM(t.m),i.environment.setM(t.m);let s=i.getCallableFunction("onKeyEvent");if(!(s instanceof Ch)||""===n.value)return D.False;try{const t=s?.getFirstSatisfiedSignature([n,r]);if(t){let{signature:s,impl:a}=t;i.environment.define(ne.Function,s.args[0].name.text,n,e.location),i.environment.define(ne.Function,s.args[1].name.text,r,e.location),a(i,n,r)}}catch(e){if(!(e instanceof Ud))throw e;if(e instanceof $d)return e.value??D.False}return D.False},s),o=a instanceof D&&a.toBoolean();return!o&&t instanceof tS?t.handleKey(n.value,r.toBoolean()):o}}var rS,iS;!function(e){e[e.ALPHANUMERIC=0]="ALPHANUMERIC",e[e.SYMBOLS=1]="SYMBOLS",e[e.ACCENTED=2]="ACCENTED"}(rS||(rS={}));class sS extends tS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"keyColor",type:"color",value:"0xFFFFFFFF"},{name:"focusable",type:"boolean",value:"true"},{name:"focusedKeyColor",type:"color",value:"0x000000FF"},{name:"keyboardBitmapUri",type:"uri",value:""},{name:"focusBitmapUri",type:"uri",value:""},{name:"textEditBox",type:"node"},{name:"showTextEditBox",type:"boolean",value:"true"}];textEditBox;showTextEdit;keyboardMode;capsLock;shift;keyColor;focusedKeyColor;bmpBack;bmpFocus;textEditX;iconOffsetY;iconRightX;iconOffsetX;keyLeftX;keyRightX;keyBaseY;keyWidth;keyHeight;keyFocusDelta;widthOver;heightOver;offsetX;offsetY;font;icons=["shift","space","delete","moveCursorLeft","moveCursorRight","caps_on","caps_off","alphanum_on","alphanum_off","symbols_on","symbols_off","accent_on","accent_off"];buttons=new Map;bmpIcons=new Map;keyFocus={row:0,col:0,key:"",cursor:-1};constructor(e=[],t="Keyboard"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.font=new fS,this.keyboardMode=rS.ALPHANUMERIC,this.capsLock=!1,this.shift=!1,this.setupKeyboardModes(),this.textEditBox=new oS,this.showTextEdit=!0,"FHD"===this.resolution?(this.textEditBox.setFieldValue("width",new bh(1371)),this.textEditX=12,this.iconRightX=1203,this.iconOffsetX=45,this.iconOffsetY=81,this.keyLeftX=228,this.keyRightX=897,this.keyBaseY=18,this.keyWidth=93,this.keyHeight=81,this.keyFocusDelta=15,this.offsetX=90,this.offsetY=84,this.widthOver=21,this.heightOver=90):(this.textEditBox.setFieldValue("width",new bh(914)),this.textEditX=8,this.iconRightX=802,this.iconOffsetX=30,this.iconOffsetY=54,this.keyLeftX=152,this.keyRightX=598,this.keyBaseY=12,this.keyWidth=62,this.keyHeight=54,this.keyFocusDelta=10,this.offsetX=60,this.offsetY=56,this.widthOver=12,this.heightOver=60),this.textEditBox.setTranslation([this.textEditX,0]),this.textEditBox.setFieldValue("maxTextLength",new vh(75)),this.bmpBack=this.loadBitmap(`common:/images/${this.resolution}/keyboard_full.png`),this.setFieldValue("width",new bh(this.bmpBack.width+this.widthOver)),this.setFieldValue("height",new bh(this.bmpBack.height+this.heightOver)),this.bmpFocus=this.loadBitmap("common:/images/focus_keyboard.9.png");for(const e of this.icons){const t=`common:/images/${this.resolution}/icon_${e}.png`,n=this.loadBitmap(t);n?.isValid()&&this.bmpIcons.set(e,n)}this.keyColor=this.getFieldValueJS("keyColor"),this.focusedKeyColor=this.getFieldValueJS("focusedKeyColor"),this.setFieldValue("textEditBox",this.textEditBox),this.linkField(this.textEditBox,"text"),this.appendChildToParent(this.textEditBox)}handleKey(e,t){let n=!1;return t?("left"===e||"right"===e?n=this.handleLeftRight(e):"up"===e||"down"===e?n=this.handleUpDown(e):"OK"===e?n=this.handleOK():e.startsWith("Lit_")||"replay"===e?n=this.textEditBox.handleKey(e,t):"options"===e&&(this.capsLock=!this.capsLock,this.isDirty=!0,n=!0),n):n}handleLeftRight(e){this.isDirty=!0;let t=!0;if(0===this.keyFocus.col&&3===this.keyFocus.row){if("left"===e&&1===this.keyFocus.cursor)return this.keyFocus.cursor=-1,t;if("right"===e&&-1===this.keyFocus.cursor)return this.keyFocus.cursor=1,t}else 1===this.keyFocus.col&&3===this.keyFocus.row&&"left"===e?this.keyFocus.cursor=1:11===this.keyFocus.col&&3===this.keyFocus.row&&"right"===e&&(this.keyFocus.cursor=-1);return this.keyFocus.col+="left"===e?-1:1,this.keyFocus.col>11?this.keyFocus.col=0:this.keyFocus.col<0&&(this.keyFocus.col=11),t}handleUpDown(e){let t=!1;return"up"===e&&this.keyFocus.row>0?(this.keyFocus.row--,this.isDirty=!0,t=!0):"down"===e&&this.keyFocus.row<3&&(this.keyFocus.row++,this.isDirty=!0,t=!0),t}handleOK(){let e=!0;return 0===this.keyFocus.col?0===this.keyFocus.row?this.shift=!this.shift:1===this.keyFocus.row?(this.textEditBox.handleKey("Lit_ ",!0),this.shift=!1):2===this.keyFocus.row?(this.textEditBox.handleKey("replay",!0),this.shift=!1):(this.textEditBox.moveCursor(this.keyFocus.cursor),this.shift=!1):11===this.keyFocus.col?(0===this.keyFocus.row?this.capsLock=!this.capsLock:this.keyboardMode=this.keyFocus.row-1,this.shift=!1):this.keyFocus.col>0&&this.keyFocus.col<11&&(this.keyFocus.key.length&&this.textEditBox.handleKey(`Lit_${this.keyFocus.key}`,!0),this.shift=!1),this.isDirty=e,e}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=eS.focused===this;this.textEditBox.setActive(s);const a=this.getTranslation().slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c=n+this.getRotation();r*=this.getOpacity();const l={x:a[0],y:a[1],width:o.width,height:o.height};if(this.isDirty){this.keyColor=this.getFieldValueJS("keyColor"),this.focusedKeyColor=this.getFieldValueJS("focusedKeyColor"),this.showTextEdit=this.getFieldValueJS("showTextEditBox"),this.textEditBox.setFieldValue("visible",D.from(this.showTextEdit)),this.setFieldValue("height",new bh(l.height));const e=this.getFieldValueJS("keyboardBitmapUri");e&&this.bmpBack?.getImageName()!==e&&(this.bmpBack=this.getBitmap("keyboardBitmapUri"));const t=this.getFieldValueJS("focusBitmapUri");t&&this.bmpFocus?.getImageName()!==t&&(this.bmpFocus=this.getBitmap("focusBitmapUri"))}l.height=this.showTextEdit?this.bmpBack.height+this.heightOver:this.bmpBack.height;const u=l.y+(this.showTextEdit?this.iconOffsetY:0),h={x:l.x,y:u,width:0,height:0};this.drawImage(this.bmpBack,h,0,r,i),this.renderLeftIcons(l,r,s,i),this.keyFocus.key="",this.renderKeys(7,0,l.x+this.keyLeftX,u+this.keyBaseY,r,s,i),this.renderKeys(3,28,l.x+this.keyRightX,u+this.keyBaseY,r,s,i),this.renderRightIcons(l,r,s,i),this.updateBoundingRects(l,t,c),this.renderChildren(e,a,c,r,i),this.updateParentRects(t,n),this.isDirty=!1}renderLeftIcons(e,t,n,r){for(let i=0;i<5;i++){const s=this.bmpIcons.get(this.icons[i]);if(!s?.isValid())continue;let a=n&&0===this.keyFocus.col&&this.keyFocus.row===i,o=this.offsetX;i>2&&(a=n&&0===this.keyFocus.col&&3===this.keyFocus.row&&(3===i&&-1===this.keyFocus.cursor||4===i&&1===this.keyFocus.cursor),o+=3===i?-this.iconOffsetX:this.iconOffsetX);const c=i<=3?i*this.offsetY:3*this.offsetY;let l=this.keyColor;a&&(l=this.focusedKeyColor,this.renderFocus(e,i,c,t,r)),this.renderIcon(e,s,o,c+s.height,l,t,r)}}renderKeys(e,t,n,r,i,s,a){const o=`${this.keyboardMode}${this.capsLock||this.shift?"U":"L"}`,c=this.buttons.get(o);for(let o=0;o<4;o++)for(let l=0;l<e;l++){const u=t+o*e+l,h=7===e?l+1:l+8,d=c[u]??"",f={x:n+l*this.offsetX,y:r+o*this.offsetY,width:this.keyWidth,height:this.keyHeight};let p=this.keyColor;if(s&&this.keyFocus.col===h&&this.keyFocus.row===o){p=this.focusedKeyColor,this.keyFocus.key=d;const e={x:f.x-this.keyFocusDelta,y:f.y-this.keyFocusDelta,width:f.width+2*this.keyFocusDelta,height:f.height+2*this.keyFocusDelta};this.drawImage(this.bmpFocus,e,0,i,a)}d.length&&this.drawText(d,this.font,p,i,f,"center","center",0,a,"",u)}}renderRightIcons(e,t,n,r){for(let i=0;i<4;i++){const s=this.getRightIcon(i),a=this.bmpIcons.get(s);if(!a?.isValid())continue;let o=this.keyBaseY+i*this.offsetY;const c=e.y+(this.showTextEdit?this.iconOffsetY:0);let l=this.keyColor;if(n&&11===this.keyFocus.col&&this.keyFocus.row===i){l=this.focusedKeyColor;const n={x:e.x+this.iconRightX-this.keyFocusDelta,y:c+o-this.keyFocusDelta,width:2*this.keyWidth+2*this.keyFocusDelta,height:this.keyHeight+2*this.keyFocusDelta};this.drawImage(this.bmpFocus,n,0,t,r)}this.renderIcon(e,a,this.iconRightX,o,l,t,r)}}renderFocus(e,t,n,r,i){const s=e.y+(this.showTextEdit?this.iconOffsetY:0),a=t<3?2*this.keyWidth:this.keyWidth,o={x:t<4?e.x:e.x+this.offsetX,y:s+n,width:a+2*this.keyFocusDelta,height:this.keyHeight+2*this.keyFocusDelta};this.drawImage(this.bmpFocus,o,0,r,i)}renderIcon(e,t,n,r,i,s,a){const o=e.y+(this.showTextEdit?this.iconOffsetY:0),c={x:e.x+n,y:o+r,width:t.width,height:t.height};this.drawImage(t,c,0,s,a,i)}getRightIcon(e){let t="";const n=this.keyboardMode;return 0===e?t=this.capsLock?"caps_on":"caps_off":1===e?t=n===rS.ALPHANUMERIC?"alphanum_on":"alphanum_off":2===e?t=n===rS.SYMBOLS?"symbols_on":"symbols_off":3===e&&(t=n===rS.ACCENTED?"accent_on":"accent_off"),t}setupKeyboardModes(){this.buttons.set("0L","abcdefghijklmnopqrstuvwxyz-_123456789@.0".split("")),this.buttons.set("0U","ABCDEFGHIJKLMNOPQRSTUVWXYZ-_123456789@.0".split("")),this.buttons.set("1L",'!?*#$%^&,:;"(){}[]~<>|\\/=+'.split("")),this.buttons.set("1U","".split("")),this.buttons.set("2L","".split("")),this.buttons.set("2U","".split(""))}}class aS extends tS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"keyColor",type:"color",value:"0xFFFFFFFF"},{name:"focusable",type:"boolean",value:"true"},{name:"focusedKeyColor",type:"color",value:"0x000000FF"},{name:"keyboardBitmapUri",type:"uri",value:""},{name:"focusBitmapUri",type:"uri",value:""},{name:"textEditBox",type:"node"},{name:"showTextEditBox",type:"boolean",value:"true"},{name:"lowerCase",type:"boolean",value:"true"}];textEditBox;showTextEdit;lowerCase;keyColor;focusedKeyColor;bmpBack;bmpFocus;textEditX;iconOffsetX;iconOffsetY;keyBaseX;keyBaseY;keyWidth;keyHeight;keyFocusDelta;widthOver;heightOver;offsetX;offsetY;font;icons=["clear","space","delete"];buttons;bmpIcons=new Map;keyFocus={row:0,col:0,key:""};constructor(e=[],t="Keyboard"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.font=new fS,this.lowerCase=!0,this.buttons="abcdefghijklmnopqrstuvwxyz1234567890".split(""),this.textEditBox=new oS,this.showTextEdit=!0,"FHD"===this.resolution?(this.textEditBox.setFieldValue("width",new bh(558)),this.textEditX=12,this.iconOffsetX=75,this.iconOffsetY=81,this.keyBaseX=18,this.keyBaseY=24,this.keyWidth=93,this.keyHeight=81,this.keyFocusDelta=18,this.offsetX=90,this.offsetY=84,this.widthOver=3,this.heightOver=78):(this.textEditBox.setFieldValue("width",new bh(372)),this.textEditX=8,this.iconOffsetX=50,this.iconOffsetY=54,this.keyBaseX=12,this.keyBaseY=16,this.keyWidth=62,this.keyHeight=54,this.keyFocusDelta=12,this.offsetX=60,this.offsetY=56,this.widthOver=2,this.heightOver=52),this.textEditBox.setTranslation([this.textEditX,0]),this.textEditBox.setFieldValue("maxTextLength",new vh(25)),this.bmpBack=this.loadBitmap(`common:/images/${this.resolution}/keyboard_mini.png`),this.setFieldValue("width",new bh(this.bmpBack.width+this.widthOver)),this.setFieldValue("height",new bh(this.bmpBack.height+this.heightOver)),this.bmpFocus=this.loadBitmap("common:/images/focus_keyboard.9.png");for(const e of this.icons){const t=`common:/images/${this.resolution}/icon_${e}.png`,n=this.loadBitmap(t);n?.isValid()&&this.bmpIcons.set(e,n)}this.keyColor=this.getFieldValueJS("keyColor"),this.focusedKeyColor=this.getFieldValueJS("focusedKeyColor"),this.setFieldValue("textEditBox",this.textEditBox),this.linkField(this.textEditBox,"text"),this.appendChildToParent(this.textEditBox)}handleKey(e,t){let n=!1;return t?("left"===e||"right"===e?n=this.handleLeftRight(e):"up"===e||"down"===e?n=this.handleUpDown(e):"OK"===e?n=this.handleOK():(e.startsWith("Lit_")||"replay"===e)&&(n=this.textEditBox.handleKey(e,t)),n):n}handleLeftRight(e){this.isDirty=!0;let t=!0;return this.keyFocus.col+="left"===e?-1:1,this.keyFocus.col>5?(this.keyFocus.col=5,t=!1):this.keyFocus.col<0?(this.keyFocus.col=0,t=!1):6===this.keyFocus.row&&"left"===e?(t=0!==this.keyFocus.col,this.keyFocus.col=this.keyFocus.col>2?2:0):6===this.keyFocus.row&&(t=5!==this.keyFocus.col,this.keyFocus.col=this.keyFocus.col<3?2:5),t}handleUpDown(e){let t=!1;return"up"===e&&this.keyFocus.row>0?(this.keyFocus.row--,this.isDirty=!0,t=!0):"down"===e&&this.keyFocus.row<6&&(this.keyFocus.row++,this.isDirty=!0,t=!0),t}handleOK(){let e=!1,t=this.getFieldValueJS("text");return 6===this.keyFocus.row?(this.keyFocus.col<2?t="":this.keyFocus.col<4?t+=" ":t=t.slice(0,-1),this.set(new M("text"),new M(t)),e=!0):this.keyFocus.key.length&&(t+=this.keyFocus.key,this.set(new M("text"),new M(t)),e=!0),e&&this.showTextEdit&&this.textEditBox.moveCursor(t.length),e}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=eS.focused===this;this.textEditBox.setActive(s);const a=this.getTranslation().slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c=n+this.getRotation();r*=this.getOpacity();const l={x:a[0],y:a[1],width:o.width,height:o.height};if(this.isDirty){this.keyColor=this.getFieldValueJS("keyColor"),this.focusedKeyColor=this.getFieldValueJS("focusedKeyColor"),this.showTextEdit=this.getFieldValueJS("showTextEditBox"),this.textEditBox.setFieldValue("visible",D.from(this.showTextEdit)),this.setFieldValue("height",new bh(l.height)),this.lowerCase=this.getFieldValueJS("lowerCase");const e=this.getFieldValueJS("keyboardBitmapUri");e&&this.bmpBack?.getImageName()!==e&&(this.bmpBack=this.getBitmap("keyboardBitmapUri"));const t=this.getFieldValueJS("focusBitmapUri");t&&this.bmpFocus?.getImageName()!==t&&(this.bmpFocus=this.getBitmap("focusBitmapUri"))}l.height=this.showTextEdit?this.bmpBack.height+this.heightOver:this.bmpBack.height;const u=l.y+(this.showTextEdit?this.iconOffsetY:0),h={x:l.x,y:u,width:0,height:0};this.drawImage(this.bmpBack,h,0,r,i),this.keyFocus.key="",this.renderKeys(l.x+this.keyBaseX,u+this.keyBaseY,r,s,i),this.renderBottomIcons(l.x+this.keyBaseX,u+this.keyBaseY+6*this.offsetY,r,s,i),this.updateBoundingRects(l,t,c),this.renderChildren(e,a,c,r,i),this.updateParentRects(t,n),this.isDirty=!1}renderKeys(e,t,n,r,i){for(let s=0;s<6;s++)for(let a=0;a<6;a++){const o=6*s+a;let c=this.buttons[o]??"";this.lowerCase||(c=c.toUpperCase());const l={x:e+a*this.offsetX,y:t+s*this.offsetY,width:this.keyWidth,height:this.keyHeight};let u=this.keyColor;if(r&&this.keyFocus.col===a&&this.keyFocus.row===s){u=this.focusedKeyColor,this.keyFocus.key=c;const e={x:l.x-this.keyFocusDelta,y:l.y-this.keyFocusDelta,width:l.width+2*this.keyFocusDelta,height:l.height+2*this.keyFocusDelta};this.drawImage(this.bmpFocus,e,0,n,i)}c.length&&this.drawText(c,this.font,u,n,l,"center","center",0,i,"",o)}}renderBottomIcons(e,t,n,r,i){for(let s=0;s<3;s++){const a=this.bmpIcons.get(this.icons[s]);if(a?.isValid()){let o=6===this.keyFocus.row&&Math.floor(this.keyFocus.col/2)===s;const c=this.offsetX*s*2,l={x:e+this.iconOffsetX+c,y:t+this.keyBaseY,width:a.width,height:a.height};let u=this.keyColor;if(r&&o){u=this.focusedKeyColor;const r=2*this.keyWidth,s={x:e+c-this.keyFocusDelta,y:t-this.keyFocusDelta,width:r+2*this.keyFocusDelta,height:this.keyHeight+2*this.keyFocusDelta};this.drawImage(this.bmpFocus,s,0,n,i)}this.drawImage(a,l,0,n,i,u)}}}}class oS extends tS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"hintText",type:"string",value:""},{name:"maxTextLength",type:"integer",value:"15"},{name:"cursorPosition",type:"integer",value:"0"},{name:"clearOnDownKey",type:"boolean",value:"true"},{name:"active",type:"boolean",value:"false"},{name:"secureMode",type:"boolean",value:"false"},{name:"textColor",type:"color",value:"0xFFFFFFFF"},{name:"hintTextColor",type:"color",value:"0xAAAAAAFF"},{name:"width",type:"float",value:"-1.0"},{name:"backgroundUri",type:"string",value:""},{name:"leadingEllipsis",type:"boolean",value:"false"},{name:"focusable",type:"boolean",value:"true"}];background;drawFont;cursorVisible=!0;lastCursorToggleTime=0;lastCharInputTime=0;cursor;textLabel;secureLabel;hintLabel;height;paddingX;paddingY;cursorBlinkInterval=500;secureDisplayTimeout=2500;secureChar="";backUri="common:/images/inputField.9.png";constructor(e=[],t="TextEditBox"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?(this.height=72,this.paddingX=33,this.paddingY=18):(this.height=48,this.paddingX=22,this.paddingY=12),this.background=this.loadBitmap(this.backUri);const n=`common:/images/${this.resolution}/cursor_textInput.png`;this.cursor=this.loadBitmap(n),this.setFieldValue("height",new bh(this.height)),this.textLabel=new hS,this.secureLabel=new hS,this.hintLabel=new hS,this.configureLabel(this.textLabel),this.configureLabel(this.secureLabel),this.configureLabel(this.hintLabel),this.appendChildToParent(this.textLabel),this.appendChildToParent(this.secureLabel),this.appendChildToParent(this.hintLabel),this.linkField(this.textLabel,"text"),this.linkField(this.textLabel,"color","textColor"),this.linkField(this.hintLabel,"text","hintText"),this.hintLabel.setFieldValue("color",new vh(k("0xAAAAAAFF"))),this.linkField(this.hintLabel,"color","hintTextColor"),this.lastCursorToggleTime=Date.now()}configureLabel(e){const t=this.getFieldValueJS("width"),n=t>0?t-2*this.paddingX:0;e.setTranslation([this.paddingX,this.paddingY]),e.setFieldValue("width",new bh(n)),e.setFieldValue("height",new bh(this.height-2*this.paddingY)),e.setFieldValue("vertAlign",new M("center"))}handleKey(e,t){let n=!1;if(!t)return n;const r=this.getFieldValueJS("maxTextLength");let i=this.getFieldValueJS("text"),s=this.getFieldValueJS("cursorPosition");if(e.startsWith("Lit_")){const t=e.substring(4);i.length<r&&(i=0===s?t+i:i.slice(0,s)+t+i.slice(s),s++,this.set(new M("text"),new M(i)),this.set(new M("cursorPosition"),new bh(s)),this.lastCharInputTime=Date.now(),n=!0)}else"replay"===e&&i.length&&s>0&&(i=i.slice(0,s-1)+i.slice(s),s--,this.set(new M("text"),new M(i)),this.set(new M("cursorPosition"),new bh(s)),this.lastCharInputTime=0,n=!0);return n&&(this.cursorVisible=!0,this.lastCursorToggleTime=Date.now()),n}setActive(e){this.set(new M("active"),D.from(e))}moveCursor(e){let t=this.getFieldValueJS("cursorPosition");const n=this.getFieldValueJS("text");0===e?t=0:(t+=e,t<0?t=0:t>n.length&&(t=n.length)),this.set(new M("cursorPosition"),new bh(t)),this.cursorVisible=!0,this.lastCursorToggleTime=Date.now()}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation().slice();s[0]+=t[0],s[1]+=t[1];const a=this.getDimensions(),o=n+this.getRotation(),c=r*this.getOpacity(),l=this.getFieldValueJS("text"),u=this.getFieldValueJS("secureMode"),h=Date.now();if(this.isDirty){const e=this.getFieldValueJS("width"),t=e>0?e-2*this.paddingX:0,n=new bh(t);this.textLabel.setFieldValue("width",n),this.secureLabel.setFieldValue("width",n),this.hintLabel.setFieldValue("width",n),this.copyField(this.secureLabel,"color","textColor");const r=this.getFieldValueJS("backgroundUri");r&&this.background?.getImageName()!==r&&(this.background=this.getBitmap("backgroundUri"))}const d={x:s[0],y:s[1],width:a.width,height:a.height};this.background?.isValid()&&this.drawImage(this.background,d,0,c,i);const f=0===l.length,p=this.getSecureText(l,h,u,f);this.textLabel.setFieldValue("visible",D.from(!f&&!u)),this.hintLabel.setFieldValue("visible",D.from(f)),this.secureLabel.setFieldValue("visible",D.from(!f&&u)),this.renderCursor(d,h,l,u,p,i),this.updateBoundingRects(d,t,o),this.renderChildren(e,s,o,c,i),this.updateParentRects(t,n),this.isDirty=!1}getSecureText(e,t,n,r){let i="";return n&&!r&&(i=t-this.lastCharInputTime<this.secureDisplayTimeout&&e.length>0?this.secureChar.repeat(e.length-1)+e.slice(-1):this.secureChar.repeat(e.length),this.secureLabel.setFieldValue("text",new M(i))),i}renderCursor(e,t,n,r,i,s){if(this.getFieldValueJS("active")&&this.cursor?.isValid()&&(t-this.lastCursorToggleTime>this.cursorBlinkInterval&&(this.cursorVisible=!this.cursorVisible,this.lastCursorToggleTime=t),this.cursorVisible)){const t=this.getFieldValueJS("cursorPosition");let a;if(a=r?i.substring(0,Math.min(t,i.length)):n.substring(0,Math.min(t,n.length)),void 0===this.drawFont){const e=this.textLabel.getFieldValue("font");this.drawFont=e.createDrawFont()}const o=this.drawFont.measureTextWidth(a),c={x:e.x+this.paddingX+o.width,y:e.y+(e.height-this.cursor.height)/2,width:this.cursor.width,height:this.cursor.height};this.drawImage(this.cursor,c,0,1,s)}}}class cS extends tS{name;defaultFields=[{name:"layoutDirection",type:"string",value:"vert"},{name:"horizAlignment",type:"string",value:"left"},{name:"vertAlignment",type:"string",value:"top"},{name:"itemSpacings",type:"array"},{name:"addItemSpacingAfterChild",type:"boolean",value:"true"},{name:"focusable",type:"boolean",value:"true"}];layoutDirty=!0;metricsUsedThisPass;childSizes=new WeakMap;lastSpacingSignature="";lastChildCount=0;epsilon=.25;constructor(e=[],t="LayoutGroup"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase(),s=super.set(e,t,n,r);return this.isLayoutField(i)&&(this.layoutDirty=!0),s}setFieldValue(e,t,n=!1){super.setFieldValue(e,t,n),this.isLayoutField(e)&&(this.layoutDirty=!0)}appendChildToParent(e){const t=super.appendChildToParent(e);return t&&(this.layoutDirty=!0),t}removeChildByReference(e){const t=super.removeChildByReference(e);return t&&(this.layoutDirty=!0),t}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getLayoutDirection(),a=this.getLayoutChildren(),o=this.getItemSpacingValues(),c=this.createSpacingSignature(o);c!==this.lastSpacingSignature&&(this.lastSpacingSignature=c,this.layoutDirty=!0),a.length!==this.lastChildCount&&(this.lastChildCount=a.length,this.layoutDirty=!0);const l=this.shouldAddSpacingAfterChild();this.metricsUsedThisPass=void 0,a.length&&this.layoutDirty&&(this.metricsUsedThisPass=new WeakMap,this.applyLayout(a,s,o,l,this.metricsUsedThisPass),this.layoutDirty=!1),super.renderNode(e,t,n,r,i),a.length&&this.synchronizeChildMetrics(a,s)}applyLayout(e,t,n,r,i){const s=e.map(e=>this.measureChild(e,t,i)),a="horiz"===t?this.getHorizontalPrimaryAlignment():this.getVerticalPrimaryAlignment(),o="horiz"===t?this.normalizeVertAlignment(t):this.normalizeHorizAlignment(t),c=this.calculateTotalPrimary(s,n,r);let l=this.computeStartOffset(t,c,a);const u=e.length;for(let a=0;a<u;a++){const c=e[a],h=s[a],d=this.getSpacingValue(n,a),f=this.getChildTranslation(c);let p=h.crossStart;r||(l+=d);const g=l;if("horiz"===t){if(f[0]+=g-h.primaryStart,o&&"custom"!==o){const e=this.computeCrossPosition(o,h.cross),t=e-h.crossStart;f[1]+=t,p=e}}else if(f[1]+=g-h.primaryStart,o&&"custom"!==o){const e=this.computeCrossPosition(o,h.cross),t=e-h.crossStart;f[0]+=t,p=e}this.setChildTranslation(c,f),l=g+h.primary,r&&a<u-1&&(l+=d),i&&i.set(c,{primary:h.primary,cross:h.cross,crossStart:p,primaryStart:g})}}synchronizeChildMetrics(e,t){let n=!1;for(const r of e){const e=this.measureChild(r,t),i="horiz"===t?{width:e.primary,height:e.cross}:{width:e.cross,height:e.primary},s=this.childSizes.get(r),a=this.metricsUsedThisPass?.get(r);this.childSizes.set(r,i),s&&!this.sizesClose(s,i)&&(n=!0),a&&!this.metricsClose(a,e)&&(n=!0)}n&&(this.layoutDirty=!0,this.isDirty=!0),this.metricsUsedThisPass=void 0}measureChild(e,t,n){const r=this.chooseActiveRect(e),i={primary:"horiz"===t?r.width:r.height,cross:"horiz"===t?r.height:r.width,crossStart:"horiz"===t?r.y:r.x,primaryStart:"horiz"===t?r.x:r.y};return n&&n.set(e,i),i}chooseActiveRect(e){const t=[e.rectToParent,e.rectToScene,e.rectLocal];for(const e of t)if(Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.width)&&Number.isFinite(e.height)&&e.width>0&&e.height>0)return e;const n=this.getChildTranslation(e),r=e.getDimensions(),i=this.childSizes.get(e);return{x:n[0],y:n[1],width:"number"==typeof r.width&&r.width>0?r.width:i?.width??0,height:"number"==typeof r.height&&r.height>0?r.height:i?.height??0}}calculateTotalPrimary(e,t,n){let r=0;const i=e.length;for(let s=0;s<i;s++){const a=this.getSpacingValue(t,s);n||(r+=a),r+=e[s].primary,n&&s<i-1&&(r+=a)}return r}computeCrossPosition(e,t){switch(e){case"center":return-t/2;case"bottom":case"right":return-t;default:return 0}}computeStartOffset(e,t,n){if("horiz"===e)switch(n){case"center":return-t/2;case"right":return-t;default:return 0}switch(n){case"center":return-t/2;case"bottom":return-t;default:return 0}}getChildTranslation(e){const t=e.getFieldValueJS("translation");return Array.isArray(t)&&2===t.length?[Number(t[0])||0,Number(t[1])||0]:[0,0]}setChildTranslation(e,t){const n=e.getFieldValueJS("translation");Array.isArray(n)&&2===n.length&&this.nearlyEqual(n[0],t[0])&&this.nearlyEqual(n[1],t[1])||e.setTranslation(t)}getLayoutChildren(){const e=[];for(const t of this.children)t instanceof tS&&e.push(t);return e}getLayoutDirection(){const e=this.getFieldValueJS("layoutDirection");if("string"==typeof e){const t=e.toLowerCase();if("horiz"===t||"horizontal"===t)return"horiz";if("vert"===t||"vertical"===t)return"vert"}return"vert"}normalizeHorizAlignment(e){const t=this.getFieldValueJS("horizAlignment");if("string"==typeof t){const n=t.toLowerCase();if("left"===n||"center"===n||"right"===n||"custom"===n)return"horiz"===e&&"custom"===n?"left":n}return"left"}normalizeVertAlignment(e){const t=this.getFieldValueJS("vertAlignment");if("string"==typeof t){const n=t.toLowerCase();if("top"===n||"center"===n||"bottom"===n||"custom"===n)return"vert"===e&&"custom"===n?"top":n}return"top"}getHorizontalPrimaryAlignment(){const e=this.normalizeHorizAlignment("horiz");return"custom"===e?"left":e}getVerticalPrimaryAlignment(){const e=this.normalizeVertAlignment("vert");return"custom"===e?"top":e}shouldAddSpacingAfterChild(){return!1!==this.getFieldValueJS("addItemSpacingAfterChild")}getItemSpacingValues(){const e=this.getFieldValue("itemSpacings");return e instanceof Kh?e.getElements().map(e=>{const t=cx(e);return"number"==typeof t&&Number.isFinite(t)?t:0}):[]}getSpacingValue(e,t){if(!e.length)return 0;const n=e[Math.min(t,e.length-1)];return"number"==typeof n&&Number.isFinite(n)?n:0}createSpacingSignature(e){if(0===e.length)return"";const t=e.map(e=>"number"==typeof e&&Number.isFinite(e)?e.toFixed(4):"nan");return`${e.length}:${t.join("|")}`}isLayoutField(e){const t=e.toLowerCase();return"layoutdirection"===t||"horizalignment"===t||"vertalignment"===t||"itemspacings"===t||"additemspacingafterchild"===t}nearlyEqual(e,t){return Math.abs((e||0)-(t||0))<=this.epsilon}metricsClose(e,t){return this.nearlyEqual(e.primary,t.primary)&&this.nearlyEqual(e.cross,t.cross)&&this.nearlyEqual(e.crossStart,t.crossStart)&&this.nearlyEqual(e.primaryStart,t.primaryStart)}sizesClose(e,t){return this.nearlyEqual(e.width,t.width)&&this.nearlyEqual(e.height,t.height)}}class lS extends tS{name;defaultFields=[{name:"panelSize",type:"string",value:"narrow"},{name:"leftPosition",type:"float",value:"105"},{name:"overhangTitle",type:"string",value:""},{name:"clockText",type:"string",value:""},{name:"optionsAvailable",type:"boolean",value:"false"},{name:"leftOrientation",type:"boolean",value:"false"},{name:"leftOnly",type:"boolean",value:"false"},{name:"hasNextPanel",type:"boolean",value:"false"},{name:"isFullScreen",type:"boolean",value:"false"},{name:"goBackCount",type:"integer",value:"1"},{name:"selectButtonMovesPanelForward",type:"boolean",value:"true"},{name:"isOffscreenLeft",type:"boolean",value:"false"},{name:"focusable",type:"boolean",value:"true"}];constructor(e=[],t="Panel"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}}class uS extends tS{name;defaultFields=[{name:"width",type:"float",value:"0.0"},{name:"height",type:"float",value:"0.0"},{name:"color",type:"color",value:"0xFFFFFFFF"},{name:"blendingEnabled",type:"boolean",value:"true"}];constructor(e=[],t="Rectangle"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c=n+this.getRotation(),l=this.getFieldValueJS("color");r*=this.getOpacity();const u=this.getScaleRotateCenter(),h={x:a[0],y:a[1],width:o.width,height:o.height};i?.doDrawRotatedRect(h,l,c,u,r),this.updateBoundingRects(h,t,c),this.renderChildren(e,a,c,r,i),this.updateParentRects(t,n)}}class hS extends tS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"color",type:"color",value:"0xddddddff"},{name:"font",type:"font"},{name:"horizAlign",type:"string",value:"left"},{name:"vertAlign",type:"string",value:"top"},{name:"width",type:"float",value:"0"},{name:"height",type:"float",value:"0"},{name:"numLines",type:"integer",value:"0"},{name:"maxLines",type:"integer",value:"0"},{name:"wrap",type:"boolean",value:"false"},{name:"lineSpacing",type:"float",value:"0"},{name:"displayPartialLines",type:"boolean",value:"false"},{name:"ellipsizeOnBoundary",type:"boolean",value:"false"},{name:"truncateOnDelimiter",type:"string"},{name:"wordBreakChars",type:"string"},{name:"ellipsisText",type:"string"},{name:"isTextEllipsized",type:"boolean",value:"false"}];measured;constructor(e=[],t="Label"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===eS.scene?.ui.resolution?this.setFieldValue("lineSpacing",new bh(12)):this.setFieldValue("lineSpacing",new bh(8))}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();["text","font","width","height","numlines","maxlines","wrap","linespacing"].includes(i)&&(this.setEllipsized(!1),this.measured=void 0);let s=!0;this.isDirty||"text"!==i||this.getFieldValueJS("text")!==t.toString()||(s=!1);const a=super.set(e,t,n,r);return this.isDirty=s,a}getMeasured(){if(void 0===this.measured){const e=this.getDimensions();this.measured=this.renderLabel({x:0,y:0,...e},0,1)}return this.measured}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:o.width,height:o.height},l=n+this.getRotation();r*=this.getOpacity(),this.measured=this.renderLabel(c,l,r,i),c.width=Math.max(this.measured.width,o.width),c.height=Math.max(this.measured.height,o.height),this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n),this.isDirty=!1}renderLabel(e,t,n,r){const i=this.getFieldValue("font"),s=this.getFieldValueJS("color"),a=this.getFieldValueJS("text"),o=this.getFieldValueJS("horizAlign")||"left",c=this.getFieldValueJS("vertAlign")||"top",l=this.getFieldValueJS("ellipsisText")||"...",u=this.getFieldValueJS("wrap"),h=this.getFieldValueJS("numLines"),d=this.getFieldValueJS("maxLines"),f=this.getFieldValueJS("displayPartialLines"),p=this.getFieldValueJS("lineSpacing");let g;return g=u?e.width>0?this.drawTextWrap(a,i,s,n,e,o,c,t,l,h,d,p,f,r):{text:"",width:0,height:0,ellipsized:!1}:this.drawText(a,i,s,n,e,o,c,t,r,l),this.setEllipsized(g.ellipsized),g}setEllipsized(e){this.fields.get("istextellipsized")?.setValue(D.from(e))}}!function(e){e[e.STATIC=0]="STATIC",e[e.INITIAL_PAUSE=1]="INITIAL_PAUSE",e[e.SCROLLING=2]="SCROLLING",e[e.END_PAUSE=3]="END_PAUSE",e[e.FINISHED=4]="FINISHED"}(iS||(iS={}));class dS extends hS{name;defaultFields=[{name:"scrollSpeed",type:"float",value:"100"},{name:"repeatCount",type:"float",value:"-1"},{name:"maxWidth",type:"integer",value:"500"}];scrollState=iS.STATIC;scrollOffset=0;elapsedTime=0;currentRepeat=0;needsScrolling=!1;fullTextWidth=0;truncatedText="";ellipsisWidth=0;lastUpdateTime=0;constructor(e=[],t="ScrollingLabel"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.lastUpdateTime=Date.now(),this.checkForScrolling()}set(e,t,n=!1){const r=this.getFieldValueJS("visible"),i=super.set(e,t,n);if(this.isDirty&&$S(e)){const t=e.getValue().toLowerCase();(["text","font","maxwidth","scrollspeed","repeatcount","ellipsistext"].includes(t)||r!==this.getFieldValueJS("visible"))&&(this.resetScrollingState(),this.checkForScrolling())}return i}checkForScrolling(){const e=this.getFieldValueJS("text"),t=this.getFieldValue("font"),n=t.createDrawFont(),r=this.getFieldValueJS("maxWidth"),i=this.getFieldValueJS("ellipsisText")||"...";if(!e||!t||r<=0)return this.needsScrolling=!1,void(this.scrollState=iS.STATIC);if(this.fullTextWidth=n.measureTextWidth(e).width,this.ellipsisWidth=n.measureTextWidth(i).width,this.fullTextWidth>r){this.needsScrolling=!0;let t=0,s=0;const a=r-this.ellipsisWidth;for(let r=0;r<e.length;r++){const i=n.measureTextWidth(e[r]).width;if(!(t+i<=a))break;t+=i,s=r+1}this.truncatedText=e.substring(0,s)+i,this.scrollState===iS.STATIC&&this.resetScrollingState()}else this.needsScrolling=!1,this.scrollState=iS.STATIC,this.scrollOffset=0}resetScrollingState(){this.scrollState=this.needsScrolling?iS.INITIAL_PAUSE:iS.STATIC,this.scrollOffset=0,this.elapsedTime=0,this.currentRepeat=0,this.lastUpdateTime=Date.now(),this.measured=void 0}renderLabel(e,t,n,r){const i=this.getFieldValueJS("text");(this.isDirty||0===this.fullTextWidth&&i)&&this.checkForScrolling();const s=Date.now(),a=s-this.lastUpdateTime;this.lastUpdateTime=s,this.elapsedTime+=a;const o=this.getFieldValueJS("scrollSpeed"),c=this.getFieldValueJS("repeatCount"),l=this.getFieldValueJS("maxWidth"),u=this.getFieldValue("font").createDrawFont(),h=u.measureTextHeight();e.width=l>0?l:e.width,e.height=h;const d=this.getFieldValueJS("color"),f=this.getFieldValueJS("vertAlign")||"top";let p=i,g=0,m=!1;if(this.needsScrolling&&this.scrollState!==iS.FINISHED){const e=this.fullTextWidth-l,t=e>0&&o>0?e/o*1e3:0;switch(this.scrollState){case iS.INITIAL_PAUSE:p=this.truncatedText,m=!0,this.elapsedTime>=2500&&(this.scrollState=iS.SCROLLING,this.elapsedTime=0);break;case iS.SCROLLING:p=i,this.scrollOffset=Math.min(e,this.elapsedTime/t*e),g=-this.scrollOffset,this.elapsedTime>=t&&(this.scrollState=iS.END_PAUSE,this.elapsedTime=0,this.scrollOffset=e,g=-this.scrollOffset);break;case iS.END_PAUSE:p=i,g=-e,this.elapsedTime>=2500&&(this.currentRepeat++,-1!==c&&this.currentRepeat>=c?(this.scrollState=iS.FINISHED,p=this.truncatedText,g=0,m=!0):(this.scrollState=iS.INITIAL_PAUSE,this.elapsedTime=0,this.scrollOffset=0,p=this.truncatedText,g=0,m=!0))}}else this.scrollState===iS.FINISHED?(p=this.truncatedText,m=!0):p=i;const y={...e,width:l};let b=e.x+g,w=e.y;return"center"===f?w+=(e.height-h)/2:"bottom"===f&&(w+=e.height-h),r?.pushClip(y),r?.doDrawRotatedText(p,b,w,d,n,u,t),r?.popClip(),this.setEllipsized(m),{text:p,width:this.needsScrolling?l:this.fullTextWidth,height:h,ellipsized:m}}}class fS extends Bf{name;defaultFields=[{name:"uri",type:"uri"},{name:"size",type:"integer",value:"24"},{name:"fallbackGlyph",type:"string"}];static DrawFontCache=new Map;defaultSize;resolution;fontRegistry;systemFont;constructor(e=[],t="Font"){super([],t),this.name=t,this.resolution=eS.scene?.ui.resolution??"HD",this.defaultSize="HD"===this.resolution?24:36,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.setFieldValue("size",new vh(this.defaultSize)),this.systemFont="MediumSystemFont",this.fontRegistry=mw()}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");return"uri"===e.getValue().toLowerCase()&&$S(t)&&mw().registerFont(t.getValue(),!0),super.set(e,t,n,r)}getUri(){return this.getFieldValueJS("uri")??""}getSize(){return this.getFieldValueJS("size")??this.defaultSize}setSize(e){this.setFieldValue("size",new vh(e))}setSystemFont(e){const t=this.fontRegistry.getSystemFont(e);return!!t&&(this.systemFont=e,this.setSize("HD"===this.resolution?t.hd:t.fhd),!0)}createDrawFont(){let e=this.fontRegistry.getSystemFont(this.systemFont)?.family??"";const t=this.getUri();""!==t&&(e=this.fontRegistry.getFontFamily(t)??e);const n=`${e}-${this.getSize()}`;let r=fS.DrawFontCache.get(n);return r||(r=this.fontRegistry.createFont(new M(e),new vh(this.getSize()),D.False,D.False),fS.DrawFontCache.set(n,r)),r}}class pS extends tS{name;defaultFields=[{name:"uri",type:"uri"},{name:"width",type:"float",value:"0.0"},{name:"height",type:"float",value:"0.0"},{name:"loadSync",type:"boolean",value:"false"},{name:"loadWidth",type:"float",value:"0.0"},{name:"loadHeight",type:"float",value:"0.0"},{name:"loadDisplayMode",type:"string",value:"noScale"},{name:"loadStatus",type:"string",value:"none"},{name:"bitmapWidth",type:"float",value:"0.0"},{name:"bitmapHeight",type:"float",value:"0.0"},{name:"bitmapMargins",type:"assocarray"},{name:"blendColor",type:"color",value:"0xFFFFFFFF"},{name:"loadingBitmapUri",type:"uri"},{name:"loadingBitmapOpacity",type:"float",value:"1.0"},{name:"failedBitmapUri",type:"uri"},{name:"failedBitmapOpacity",type:"float",value:"1.0"},{name:"audioGuideText",type:"string"}];uri="";bitmap;constructor(e=[],t="Poster"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");if("uri"===e.getValue().toLowerCase()){const e=cx(t);if("string"==typeof e&&""!==e.trim()&&this.uri!==e){this.uri=e;const t=this.loadUri(e);"ready"!==t&&this.loadUri("failedBitmapUri"),super.set(new M("loadStatus"),new M(t))}else if("string"!=typeof e||""===e.trim()){this.uri="",this.bitmap=void 0,super.set(new M("loadStatus"),new M("none")),super.set(new M("bitmapWidth"),new bh(0)),super.set(new M("bitmapHeight"),new bh(0));const e={left:0,right:0,top:0,bottom:0};super.set(new M("bitmapMargins"),rx(e))}}return super.set(e,t,n,r)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:o.width,height:o.height},l=n+this.getRotation(),u=this.getFieldValueJS("loadDisplayMode");if(r*=this.getOpacity(),this.bitmap instanceof Vb&&this.bitmap.isValid()){const e=this.getFieldValueJS("loadStatus");let t=this.getFieldValueJS("blendColor"),n=r;"failed"===e&&(t=4294967295,n=r*this.getFieldValueJS("loadingBitmapOpacity")),"scaletofit"===u.trim().toLowerCase()?this.drawImage(this.bitmap,this.scaleToFit(c),l,n,i,t):"scaletozoom"===u.trim().toLowerCase()?(this.bitmap.scaleMode=1,i?.doDrawCroppedBitmap(this.bitmap,this.scaleToZoom(c),c,t,n)):this.drawImage(this.bitmap,c,l,n,i,t)}this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n)}loadUri(e){let t="failed";if(this.bitmap=this.loadBitmap(e),this.bitmap?.isValid()){const e={left:0,right:0,top:0,bottom:0};if(this.bitmap.ninePatch){const t=this.bitmap.getPatchSizes();e.left=t.horizontal,e.right=t.horizontal,e.top=t.vertical,e.bottom=t.vertical}else{const e=this.getFieldValueJS("loadWidth"),t=this.getFieldValueJS("loadHeight");e>0&&t>0&&(this.bitmap=xw().resizeTexture(this.bitmap,e,t))}super.set(new M("bitmapWidth"),new bh(this.bitmap.width)),super.set(new M("bitmapHeight"),new bh(this.bitmap.height)),super.set(new M("bitmapMargins"),rx(e)),t="ready"}return t}scaleToFit(e){const t=this.bitmap.width/this.bitmap.height,n=e.width/e.height,r={...e};return t<n?(r.width=e.height*t,r.x+=(e.width-r.width)/2):(r.height=e.width/t,r.y+=(e.height-r.height)/2),r}scaleToZoom(e){const t=e.width/this.bitmap.width,n=e.height/this.bitmap.height,r=Math.max(t,n),i=e.width/r,s=e.height/r;return{x:(this.bitmap.width-i)/2,y:(this.bitmap.height-s)/2,width:i,height:s}}}class gS extends tS{name;defaultFields=[{name:"title",type:"string"},{name:"titleColor",type:"color",value:"0xddddddff"},{name:"titleFont",type:"font"},{name:"message",type:"string"},{name:"messageColor",type:"color",value:"0xddddddff"},{name:"messageFont",type:"font"},{name:"numberedBullets",type:"boolean",value:"false"},{name:"bulletText",type:"array"},{name:"bulletTextColor",type:"color",value:"0xddddddff"},{name:"bulletTextFont",type:"font"},{name:"buttons",type:"array"},{name:"buttonGroup",type:"node"},{name:"graphicUri",type:"uri",value:""},{name:"graphicWidth",type:"float",value:"0.0"},{name:"graphicHeight",type:"float",value:"0.0"},{name:"buttonSelected",type:"integer",value:"0",alwaysNotify:!0},{name:"buttonFocused",type:"integer",value:"0",alwaysNotify:!0},{name:"focusButton",type:"integer",value:"0"},{name:"optionsDialog",type:"boolean",value:"false"},{name:"backgroundUri",type:"uri",value:""},{name:"iconUri",type:"uri",value:""},{name:"dividerUri",type:"uri",value:""},{name:"close",type:"boolean",value:"false"},{name:"wasClosed",type:"boolean",value:"false",alwaysNotify:!0},{name:"width",type:"float",value:"-1.0"},{name:"maxHeight",type:"float",value:"-1.0"}];background;icon;divider;title;message;gap;vertOffset;minHeight;buttonGroup;lineHeight;lastFocus;width;height;dialogTrans;iconSize;iconTrans;backUri="common:/images/dialog_background.9.png";dividerUri="common:/images/dividerHorizontal.9.png";focusIndex=0;hasButtons=!1;constructor(e=[],t="Dialog"){let n,r,i,s,a,o,c,l,u,h;super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.buttonGroup=new MS;const d=`common:/images/${this.resolution}/icon_dialog_info.png`;"FHD"===this.resolution?(this.width=1050,this.minHeight=216,this.gap=18,this.vertOffset=30,this.lineHeight=4.5,this.dialogTrans=[(this.sceneRect.width-this.width)/2,(this.sceneRect.height-this.minHeight)/2],this.iconSize=60,this.iconTrans=[this.dialogTrans[0]+447,this.dialogTrans[1]+36],n=this.width-228,r=46,a=42,i=(this.sceneRect.width-n)/2,s=this.dialogTrans[1]+45,o=this.dialogTrans[1]+105,c=this.width-177,l=(this.sceneRect.width-c)/2,u=s+111,h=34,this.buttonGroup.setFieldValue("minWidth",new bh(900)),this.buttonGroup.setFieldValue("maxWidth",new bh(900))):(this.width=700,this.minHeight=144,this.gap=12,this.vertOffset=20,this.lineHeight=3,this.dialogTrans=[(this.sceneRect.width-this.width)/2,(this.sceneRect.height-this.minHeight)/2],this.iconSize=40,this.iconTrans=[this.dialogTrans[0]+298,this.dialogTrans[1]+24],n=this.width-152,r=30,a=28,i=(this.sceneRect.width-n)/2,s=this.dialogTrans[1]+30,o=this.dialogTrans[1]+70,c=this.width-118,l=(this.sceneRect.width-c)/2,u=s+74,h=24,this.buttonGroup.setFieldValue("minWidth",new bh(600)),this.buttonGroup.setFieldValue("maxWidth",new bh(600))),this.height=this.minHeight,this.setFieldValue("iconUri",new M(d)),this.background=this.addPoster(this.backUri,this.dialogTrans,this.width,this.height),this.title=this.addLabel("titleColor",[i,s],n,r,a,"top","center"),this.icon=this.addPoster(d,this.iconTrans,this.iconSize,this.iconSize),this.divider=this.addPoster(this.dividerUri,[i,o],n,this.lineHeight),this.message=this.addLabel("messageColor",[l,u],c,0,h,"top","left",!0),this.setFieldValue("width",new bh(this.width)),this.setFieldValue("backgroundUri",new M(this.backUri)),this.setFieldValue("dividerUri",new M(this.dividerUri)),this.setFieldValue("buttonGroup",this.buttonGroup),this.linkField(this.buttonGroup,"buttons"),this.linkField(this.buttonGroup,"buttonSelected"),this.linkField(this.buttonGroup,"buttonFocused"),this.linkField(this.buttonGroup,"focusButton"),this.appendChildToParent(this.buttonGroup)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("focusbutton"===i){const e=this.getFieldValueJS("buttons"),n=cx(t);"number"==typeof n&&n>=0&&n<e.length&&(this.focusIndex=n,super.set(new M("buttonFocused"),t))}else if("close"===i)e=new M("wasClosed"),t=D.True,this.set(new M("visible"),D.False),eS.scene?.dialog===this&&(eS.scene.dialog=void 0),this.lastFocus instanceof tS&&(eS.setFocused(this.lastFocus),this.lastFocus.isDirty=!0,this.lastFocus=void 0);else if("buttons"===i)return this.buttonGroup.set(e,t),O.Instance;return super.set(e,t,n,r)}setNodeFocus(e,t){return t&&this.hasButtons&&eS.focused&&void 0===this.lastFocus&&(this.lastFocus=eS.focused,eS.setFocused(this.buttonGroup),this.isDirty=!0),!0}handleKey(e,t){const n=this.getFieldValueJS("optionsDialog");let r=!1;return t&&("back"===e||"options"===e&&n)?(this.set(new M("close"),D.True),r=!0):this.hasButtons&&(r=this.buttonGroup.handleKey(e,t)),r}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:this.width,height:o.height};this.isDirty&&this.updateChildren(),this.setNodeFocus(e,!0);const l=n+this.getRotation();r*=this.getOpacity(),this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n)}updateChildren(){this.height=this.minHeight;const e=this.getFieldValueJS("width");e&&(this.background.set(new M("width"),new bh(e)),this.width=e),this.copyField(this.background,"uri","backgroundUri"),this.copyField(this.title,"text","title"),this.copyField(this.title,"color","titleColor"),this.copyField(this.title,"font","titleFont");const t=this.copyField(this.icon,"uri","iconUri").toString();if(t){const e=this.title.getMeasured();if(e.width>0){const t=(this.sceneRect.width-e.width)/2;this.iconTrans[0]=t-this.iconSize-this.gap}}this.copyField(this.divider,"uri","dividerUri");const n=this.copyField(this.message,"text","message");if($S(n)&&""!==n.getValue()){const e=this.message.getMeasured();this.height+=e.height+this.vertOffset}this.copyField(this.message,"color","messageColor"),this.copyField(this.message,"font","messageFont");const r=this.getFieldValueJS("buttons"),i=this.buttonGroup.getFieldValueJS("buttonHeight");r?.length?(this.height+=i*r.length,this.hasButtons=!0):(this.height+=this.vertOffset,this.hasButtons=!1);const s=(this.sceneRect.height-this.height)/2,a=s-this.dialogTrans[1];if(this.dialogTrans[1]=s,this.background.setTranslation(this.dialogTrans),this.background.set(new M("height"),new bh(this.height)),t&&(this.iconTrans[1]+=a,this.icon.setTranslation(this.iconTrans)),this.title.setTranslationOffset(0,a),this.divider.setTranslationOffset(0,a),this.message.setTranslationOffset(0,a),this.hasButtons){const e=[this.message.getFieldValueJS("translation")[0],this.dialogTrans[1]+this.height-i*r.length-this.vertOffset];this.buttonGroup.setTranslation(e)}this.isDirty=!1}}class mS extends gS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"keyboard",type:"node"}];minHeight;keyboard;keyboardY;focus;constructor(e=[],t="KeyboardDialog"){let n,r,i,s,a,o;super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.keyboard=new sS,this.setFieldValue("keyboard",this.keyboard),"FHD"===this.resolution?(this.width=1530,this.minHeight=645,this.height=this.minHeight,this.dialogTrans=[(this.sceneRect.width-this.width)/2,(this.sceneRect.height-this.height)/2],n=this.width-177,r=(this.sceneRect.width-n)/2,i=[r,this.dialogTrans[1]+45],s=[r,this.dialogTrans[1]+105],a=[r,i[1]+111],this.keyboardY=219,o=[264,this.dialogTrans[1]+this.keyboardY]):(this.width=1020,this.minHeight=430,this.height=this.minHeight,this.dialogTrans=[(this.sceneRect.width-this.width)/2,(this.sceneRect.height-this.height)/2],n=this.width-118,r=(this.sceneRect.width-n)/2,i=[r,this.dialogTrans[1]+30],s=[r,this.dialogTrans[1]+70],a=[r,i[1]+74],this.keyboardY=146,o=[177,this.dialogTrans[1]+this.keyboardY]),this.background.setFieldValue("width",new bh(this.width)),this.background.setFieldValue("height",new bh(this.minHeight)),this.background.setTranslation(this.dialogTrans),this.title.setFieldValue("width",new bh(n)),this.divider.setFieldValue("width",new bh(n)),this.title.setTranslation(i),this.divider.setTranslation(s),this.message.setTranslation(a),this.message.setFieldValue("width",new bh(n)),this.keyboard.setTranslation(o),this.appendChildToParent(this.keyboard),this.buttonGroup.setFieldValue("minWidth",new bh(n)),this.buttonGroup.setFieldValue("maxWidth",new bh(n)),this.setFieldValue("width",new bh(this.width)),this.setFieldValue("iconUri",new M("")),this.linkField(this.keyboard,"text"),this.icon.setFieldValue("visible",D.False),this.focus=""}setNodeFocus(e,t){return t&&eS.focused&&void 0===this.lastFocus&&(this.lastFocus=eS.focused,eS.setFocused(this.hasButtons?this.buttonGroup:this.keyboard),this.isDirty=!0),!0}handleKey(e,t){const n=this.getFieldValueJS("optionsDialog");let r=!1;return t&&("back"===e||"options"===e&&n)?(this.set(new M("close"),D.True),this.focus="",this.keyboard.textEditBox.setActive(!1),this.keyboard.textEditBox.moveCursor(0),r=!0):this.hasButtons&&"buttons"===this.focus?r=this.buttonGroup.handleKey(e,t):"keyboard"===this.focus&&(r=this.keyboard.handleKey(e,t)),!!r||(t&&"up"===e&&"buttons"===this.focus?(eS.setFocused(this.keyboard),this.focus="keyboard",this.isDirty=!0,r=!0):t&&"down"===e&&"keyboard"===this.focus&&(eS.setFocused(this.buttonGroup),this.focus="buttons",this.isDirty=!0,r=!0),r)}updateChildren(){this.height=this.minHeight;const e=this.getFieldValueJS("width");e&&(this.background.set(new M("width"),new bh(e)),this.width=e),this.copyField(this.background,"uri","backgroundUri"),this.copyField(this.title,"text","title"),this.copyField(this.title,"color","titleColor"),this.copyField(this.title,"font","titleFont");const t=this.copyField(this.icon,"uri","iconUri").toString();if(t){const e=this.title.getMeasured();if(e.width>0){const t=(this.sceneRect.width-e.width)/2;this.iconTrans[0]=t-this.iconSize-this.gap}}this.copyField(this.divider,"uri","dividerUri");const n=this.copyField(this.message,"text","message");if($S(n)&&""!==n.getValue()){const e=this.message.getMeasured();this.height+=e.height+this.vertOffset,this.keyboard.setTranslationY(this.dialogTrans[1]+this.keyboardY)}else this.height+=this.vertOffset,this.keyboard.setTranslationY(this.dialogTrans[1]+this.keyboardY-this.vertOffset);this.copyField(this.message,"color","messageColor"),this.copyField(this.message,"font","messageFont");const r=this.getFieldValueJS("buttons"),i=this.buttonGroup.getFieldValueJS("buttonHeight");r?.length?(this.height+=i*r.length,this.hasButtons=!0):(this.height+=this.vertOffset,this.hasButtons=!1),""===this.focus&&(this.focus=this.hasButtons?"buttons":"keyboard");const s=(this.sceneRect.height-this.height)/2,a=s-this.dialogTrans[1];if(this.dialogTrans[1]=s,this.background.setTranslation(this.dialogTrans),this.background.set(new M("height"),new bh(this.height)),t&&(this.iconTrans[1]+=a,this.icon.setTranslation(this.iconTrans)),this.title.setTranslationOffset(0,a),this.divider.setTranslationOffset(0,a),this.message.setTranslationOffset(0,a),this.keyboard.setTranslationOffset(0,a),this.hasButtons){const e=[this.message.getFieldValueJS("translation")[0],this.dialogTrans[1]+this.height-i*r.length-this.vertOffset];this.buttonGroup.setTranslation(e)}this.isDirty=!1}}class yS extends tS{name;defaultFields=[{name:"content",type:"node"},{name:"itemSize",type:"vector2d",value:"[0,0]"},{name:"itemSpacing",type:"vector2d",value:"[0,0]"},{name:"numRows",type:"integer",value:"0"},{name:"numColumns",type:"integer",value:"0"},{name:"focusable",type:"boolean",value:"true"},{name:"focusRow",type:"integer",value:"0",alwaysNotify:!0},{name:"focusColumn",type:"integer",value:"0",alwaysNotify:!0},{name:"horizFocusAnimationStyle",type:"string",value:"floatingFocus"},{name:"vertFocusAnimationStyle",type:"string",value:"floatingFocus"},{name:"drawFocusFeedbackOnTop",type:"boolean",value:"false"},{name:"drawFocusFeedback",type:"boolean",value:"true"},{name:"fadeFocusFeedbackWhenAutoScrolling",type:"boolean",value:"false"},{name:"currFocusFeedbackOpacity",type:"float",value:"0"},{name:"focusBitmapUri",type:"string",value:""},{name:"focusFootprintBitmapUri",type:"string",value:""},{name:"focusBitmapBlendColor",type:"color",value:"0xFFFFFFFF"},{name:"focusFootprintBlendColor",type:"color",value:"0xFFFFFFFF"},{name:"wrapDividerBitmapUri",type:"string",value:""},{name:"wrapDividerWidth",type:"float",value:"0"},{name:"wrapDividerHeight",type:"float",value:"36"},{name:"fixedLayout",type:"boolean",value:"false"},{name:"numRenderPasses",type:"integer",value:"1"},{name:"rowHeights",type:"floatarray",value:"[]"},{name:"columnWidths",type:"floatarray",value:"[]"},{name:"rowSpacings",type:"floatarray",value:"[]"},{name:"columnSpacings",type:"array",value:"[]"},{name:"sectionDividerBitmapUri",type:"string",value:""},{name:"sectionDividerFont",type:"font",value:"font:SmallestSystemFont"},{name:"sectionDividerTextColor",type:"color",value:"0xddddddff"},{name:"sectionDividerSpacing",type:"float",value:"0.0"},{name:"sectionDividerWidth",type:"float",value:"0.0"},{name:"sectionDividerHeight",type:"float",value:"40"},{name:"sectionDividerMinWidth",type:"float",value:"0.0"},{name:"sectionDividerLeftOffset",type:"float",value:"0.0"},{name:"itemClippingRect",type:"rect2d",value:"[0.0,0.0,0.0,0.0]"},{name:"itemSelected",type:"integer",value:"-1",alwaysNotify:!0},{name:"itemFocused",type:"integer",value:"-1",alwaysNotify:!0},{name:"itemUnfocused",type:"integer",value:"-1",alwaysNotify:!0},{name:"jumpToItem",type:"integer",value:"-1",alwaysNotify:!0},{name:"animateToItem",type:"integer",value:"-1",alwaysNotify:!0},{name:"currFocusRow",type:"float",value:"0.0"},{name:"currFocusColumn",type:"float",value:"0.0"},{name:"currFocusSection",type:"float",value:"0.0"}];dividerUri="common:/images/dividerHorizontal.9.png";content=[];metadata=[];itemComps=[];marginX;marginY;gap;lineHeight;focusIndex=0;numRows=0;numCols=0;currRow=0;topRow=0;wrap=!1;lastPressHandled;hasNinePatch;focusField;constructor(e=[],t="ArrayGrid"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.setFieldValue("content",new Zv),"FHD"===this.resolution?(this.marginX=36,this.marginY=6,this.lineHeight=4.5,this.setFieldValue("wrapDividerHeight",new bh(36)),this.setFieldValue("sectionDividerHeight",new bh(60)),this.setFieldValue("sectionDividerMinWidth",new bh(126)),this.setFieldValue("sectionDividerSpacing",new bh(15))):(this.marginX=24,this.marginY=4,this.lineHeight=3,this.setFieldValue("wrapDividerHeight",new bh(24)),this.setFieldValue("sectionDividerHeight",new bh(40)),this.setFieldValue("sectionDividerMinWidth",new bh(117)),this.setFieldValue("sectionDividerSpacing",new bh(10))),this.gap=this.marginX/2,this.setFieldValue("wrapDividerBitmapUri",new M(this.dividerUri)),this.setFieldValue("sectionDividerBitmapUri",new M(this.dividerUri));const n=this.getFieldValueJS("vertFocusAnimationStyle");this.wrap="fixedfocuswrap"===n.toLowerCase(),this.lastPressHandled="",this.hasNinePatch=!1,this.focusField="listHasFocus"}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("content"===i&&t instanceof Zv){super.set(e,t,n,r),this.itemComps.length=0,this.refreshContent();const i=this.getFieldValueJS("itemFocused");return t.getNodeChildren().length&&i<0&&this.setFocusedItem(0),O.Instance}if(["jumptoitem","animatetoitem"].includes(i)&&jS(t))this.setFocusedItem(cx(t));else if("numrows"===i&&jS(t))this.numRows=cx(t);else if("numcolumns"===i&&jS(t))this.numCols=cx(t);else if("vertfocusanimationstyle"===i&&$S(t)){const e=t.toString().toLowerCase();if(!["fixedfocuswrap","floatingfocus","fixedfocus"].includes(e))return O.Instance;this.wrap="fixedfocuswrap"===e}else if("horizfocusanimationstyle"===i&&$S(t)&&!["fixedfocuswrap","floatingfocus"].includes(t.toString().toLowerCase()))return O.Instance;return super.set(e,t,n,r),["vertfocusanimationstyle","numrows","focusrow"].includes(i)&&(this.currRow=this.updateCurrRow()),O.Instance}setFocusedItem(e){const t=this.findContentIndex(e);if(-1===t)return;const n=this.getFieldValueJS("itemFocused"),r=eS.focused===this;this.updateItemFocus(this.focusIndex,!1,r),super.set(new M("itemUnfocused"),new vh(n)),this.focusIndex=t,this.updateItemFocus(this.focusIndex,!0,r),super.set(new M("itemFocused"),new vh(e))}findContentIndex(e){return e<0||e>=this.content.length?-1:this.metadata.length>0?this.metadata.findIndex(t=>t.index===e):e}updateItemFocus(e,t,n){const r=this.itemComps[e];r&&(r.set(new M("itemHasFocus"),D.from(t)),r.set(new M(this.focusField),D.from(n)),r.set(new M("focusPercent"),new bh(t?1:0)))}handleKey(e,t){if(!t&&this.lastPressHandled===e)return this.lastPressHandled="",!0;let n=!1;return"up"===e||"down"===e?n=!!t&&this.handleUpDown(e):"left"===e||"right"===e?n=!!t&&this.handleLeftRight(e):"rewind"===e||"fastforward"===e?n=!!t&&this.handlePageUpDown(e):"OK"===e&&(n=this.handleOK(t)),this.lastPressHandled=n&&"OK"!==e?e:"",n}handleUpDown(e){return!1}handleLeftRight(e){return!1}handlePageUpDown(e){return!1}handleOK(e){if(e){const e=this.metadata[this.focusIndex]?.index??this.focusIndex;this.set(new M("itemSelected"),new vh(e))}return!1}getContentItem(e){return this.content[e]instanceof Zv?this.content[e]:new Zv}getContentChildren(e){return e.getNodeChildren().map(e=>e instanceof Zv?e:new Zv)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],...o},l=n+this.getRotation();r*=this.getOpacity(),this.renderContent(e,c,l,r,i),this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n),this.isDirty=!1}renderContent(e,t,n,r,i){}renderItemComponent(e,t,n,r,i,s){const a=this.getContentItem(t),o=eS.focused===this,c=t===this.focusIndex;if(!this.itemComps[t]){const r=this.createItemComponent(e,n,a);r instanceof tS&&(this.itemComps[t]=r)}a.changed&&(this.itemComps[t].set(new M("itemContent"),a,!0),a.changed=!1),this.updateItemFocus(t,c,o);const l=this.getFieldValueJS("drawFocusFeedback"),u=this.getFieldValueJS("drawFocusFeedbackOnTop");c&&l&&!u&&this.renderFocus(n,i,o,s);const h=[n.x,n.y];this.itemComps[t].renderNode(e,h,r,i,s),c&&l&&u&&this.renderFocus(n,i,o,s)}renderFocus(e,t,n,r){const i=n?"focusBitmapUri":"focusFootprintBitmapUri",s=this.getBitmap(i);if(!s?.isValid())return;this.hasNinePatch=s.ninePatch;let a=s.ninePatch?{x:e.x-this.marginX,y:e.y-this.marginY,width:e.width+2*this.marginX,height:e.height+2*this.marginY}:e;this.drawImage(s,a,0,t,r)}renderSectionDivider(e,t,n,r,i){const s=this.getFieldValueJS("sectionDividerHeight"),a=this.getFieldValueJS("sectionDividerSpacing"),o={...t,height:s};let c=0;if(0!==e.length){const t=this.getFieldValue("sectionDividerFont"),s=this.getFieldValueJS("sectionDividerTextColor");c=this.drawText(e,t,s,n,o,"left","center",0,i,"...",r).width+a}const l=this.getBitmap("sectionDividerBitmapUri");if(l?.isValid()){const e=l.ninePatch?this.lineHeight:l.height,t={x:o.x+c,y:o.y+Math.round((s-e)/2),width:o.width-c,height:e};this.drawImage(l,t,0,n,i)}return s}renderWrapDivider(e,t,n){const r=this.getBitmap("wrapDividerBitmapUri"),i=this.getFieldValueJS("wrapDividerHeight");if(r?.isValid()){const s=r.ninePatch?this.lineHeight:r.height,a=Math.round((i-s)/2),o={...e,y:e.y+a,height:s};this.drawImage(r,o,0,t,n)}return i}refreshContent(){this.content.length=0,this.metadata.length=0;const e=this.getFieldValue("content");if(!(e instanceof Zv))return;const t=this.getContentChildren(e);let n=0;for(const e of t)"section"===e.getFieldValueJS("ContentType")?.toLowerCase()&&(n=this.processSection(e,n));0===this.content.length&&t.length>0&&this.content.push(...t)}processSection(e,t){const n=this.getContentChildren(e),r=this.numCols||1;if(0===n.length)return t;for(const[r,i]of n.entries()){const n={index:t,divider:!1,sectionTitle:""};0===r&&(n.divider=!0,n.sectionTitle=e.getFieldValueJS("title")??""),this.metadata.push(n),t++}this.content.push(...n);const i=n.length%r;if(i>0){const e=new Zv("_placeholder_"),t={index:-1,divider:!1,sectionTitle:""};for(let n=0;n<r-i;n++)this.content.push(e),this.metadata.push(t)}return t}createItemComponent(e,t,n){if("_placeholder_"===n.name)return new tS;const r=this.getFieldValueJS("itemComponentName")??"",i=Oh(new M(r),e);return i instanceof tS&&(i.setFieldValue("width",rx(t.width)),i.setFieldValue("height",rx(t.height)),i.set(new M("itemContent"),n,!0)),i}updateCurrRow(){const e=this.numCols||1,t=this.getFieldValueJS("focusRow");if(!this.wrap){const n=Math.floor(this.focusIndex/e),r=this.getFieldValueJS("numRows");if(n>=0&&n<r)return n;const i=Math.min(this.currRow,r-1),s=Math.max(0,i),a=Math.max(s,t);return Math.min(a,n)}return t}updateListCurrRow(){if(this.wrap)return this.topRow=0,this.updateCurrRow();const e=this.numCols||1;if(e<=0)return this.topRow=0,0;const t=Math.ceil(this.content.length/e);if(t<=0)return this.topRow=0,0;const n=Number.isFinite(this.numRows)&&this.numRows>0?Math.floor(this.numRows):t,r=Math.max(1,Math.min(n,t));let i=Math.floor(this.focusIndex/e);i=Math.max(0,Math.min(i,t-1)),i<this.topRow?this.topRow=i:i>this.topRow+(r-1)&&(this.topRow=i-(r-1));const s=Math.max(0,t-r);return this.topRow=Math.max(0,Math.min(this.topRow,s)),Math.max(0,i-this.topRow)}clampTopRow(){const e=this.numCols||1;if(e<=0)return void(this.topRow=0);const t=Math.ceil(this.content.length/e);if(t<=0)return void(this.topRow=0);const n=Number.isFinite(this.numRows)&&this.numRows>0?Math.floor(this.numRows):t,r=Math.max(1,Math.min(n,t)),i=Math.max(0,t-r);this.topRow=Math.max(0,Math.min(this.topRow,i))}updateRect(e,t,n){const r=this.numCols||1;e.x=e.x-(this.hasNinePatch?this.marginX:0),e.y=e.y-(this.hasNinePatch?this.marginY:0),e.width=r*(n[0]+(this.hasNinePatch?2*this.marginX:0)),e.height=t*(n[1]+(this.hasNinePatch?2*this.marginY:0))}getIndex(e=0,t){t=t??this.focusIndex;const n=this.numCols||1,r=Math.floor(t/n),i=Math.ceil(this.content.length/n);let s=r+e;return this.wrap?s=(s+i)%i:s>=i?s=i-1:s<0&&(s=0),s*n}resolveBoolean(e,t,n){return Array.isArray(e)&&0!==e.length?t<e.length?Boolean(e[t]):Boolean(e.at(-1)):n}resolveVector(e,t,n){if(!Array.isArray(e)||0===e.length)return n;if(2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1])return[Number(e[0])||0,Number(e[1])||0];const r=t<e.length?e[t]:e.at(-1);return Array.isArray(r)&&r.length>=2?[Number(r[0])||0,Number(r[1])||0]:n}resolveNumber(e,t,n){if(!Array.isArray(e)||0===e.length)return n;if(t<e.length){const r=Number(e[t]);return Number.isFinite(r)&&r>0?r:n}const r=Number(e.at(-1));return Number.isFinite(r)&&r>0?r:n}resolveColor(e,t,n){return Array.isArray(e)&&0!==e.length?t<e.length?Number(e[t])||n:Number(e.at(-1))||n:n}}class bS extends yS{name;defaultFields=[{name:"itemComponentName",type:"string",value:""},{name:"rowTitleComponentName",type:"string",value:""},{name:"numRows",type:"integer",value:"1"},{name:"numColumns",type:"integer",value:"1"},{name:"rowItemSize",type:"array",value:"[]"},{name:"rowItemSpacing",type:"array",value:"[]"},{name:"rowItemSelected",type:"array",value:"[]"},{name:"rowItemFocused",type:"array",value:"[]"},{name:"jumpToRowItem",type:"array",value:"[]"},{name:"focusXOffset",type:"array",value:"[0,0]"},{name:"rowLabelOffset",type:"array",value:"[[0,0]]"},{name:"rowLabelColor",type:"color",value:"0xffffffff"},{name:"rowLabelFont",type:"font"},{name:"showRowLabel",type:"boolarray",value:"[]"},{name:"rowCounterRightOffset",type:"float",value:"0"},{name:"showRowCounter",type:"boolarray",value:"[]"},{name:"showRowCounterForShortRows",type:"bool",value:"true"},{name:"indefiniteRowItemCount",type:"boolarray",value:"[]"},{name:"variableWidthItems",type:"boolarray",value:"[]"},{name:"rowFocusAnimationStyle",type:"string",value:"floatingFocus"},{name:"vertFocusAnimationStyle",type:"string",value:"fixedFocus"}];focusUri="common:/images/focus_grid.9.png";marginX;marginY;gap;rowItemComps=[[]];rowFocus;rowScrollOffset=[];titleHeight;constructor(e=[],t="RowList"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?(this.marginX=33,this.marginY=33):(this.marginX=22,this.marginY=22),this.gap=0,this.setFieldValue("focusBitmapUri",new M(this.focusUri)),this.setFieldValue("wrapDividerBitmapUri",new M(this.dividerUri));const n=this.getFieldValueJS("vertFocusAnimationStyle");this.wrap="fixedfocuswrap"===n.toLowerCase(),this.numRows=this.getFieldValueJS("numRows"),this.numCols=this.getFieldValueJS("numColumns"),this.rowFocus=[],this.rowScrollOffset=[],this.hasNinePatch=!0,this.focusField="rowListHasFocus";const r=this.getFieldValue("rowLabelFont").createDrawFont();this.titleHeight=r.measureTextHeight(),this.focusIndex=0,this.rowFocus[0]=0,this.rowScrollOffset[0]=0}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("rowfocusanimationstyle"===i){const e=t.toString().toLowerCase();if(!["fixedfocuswrap","floatingfocus","fixedfocus"].includes(e))return O.Instance}else if("jumptorowitem"===i&&t instanceof Kh){const e=cx(t);"number"==typeof e[0]&&"number"==typeof e[1]&&this.setFocusedItem(e[0],e[1])}else if(["horizfocusanimationstyle","numcolumns"].includes(i))return O.Instance;return super.set(e,t,n,r)}setFocusedItem(e,t=-1){if(e<0||e>=this.content.length)return;-1===t&&(t=this.rowFocus[e]??0);const n=this.focusIndex,r=n!==e;r&&super.set(new M("itemUnfocused"),new vh(n)),this.focusIndex=e,this.rowFocus[e]=t;const i=this.getFieldValueJS("rowFocusAnimationStyle").toLowerCase(),s=void 0===this.rowScrollOffset[e]||null===this.rowScrollOffset[e];s&&(this.rowScrollOffset[e]=0);const a=this.getFieldValueJS("itemSize"),o=this.getRowItemSpacing(e),c=this.getFieldValueJS("rowItemSize"),l=c[0]?.[0]??a[0],u=this.content[e]?.getNodeChildren(),h=u?.length??0;if(h*l+(h-1)*o[0]<=this.sceneRect.width&&"fixedfocus"!==i)this.rowScrollOffset[e]=0;else if("fixedfocuswrap"===i)this.rowScrollOffset[e]=0;else if("fixedfocus"===i)this.rowScrollOffset[e]=t;else if("floatingfocus"===i){const n=Math.floor(this.sceneRect.width/(l+o[0]));r&&s?this.rowScrollOffset[e]=0===t||t<n?0:Math.max(0,t-n+1):r||(t<this.rowScrollOffset[e]?this.rowScrollOffset[e]=t:t>=this.rowScrollOffset[e]+n&&(this.rowScrollOffset[e]=t-n+1))}super.set(new M("itemFocused"),new vh(e)),super.set(new M("rowItemFocused"),new Kh([new vh(e),new vh(t)]))}handleUpDown(e){let t,n=!1;if("up"===e)t=-1;else if("down"===e)t=1;else if("rewind"===e)t=-Math.min(Math.ceil(this.content.length/this.numCols)-1,6);else{if("fastforward"!==e)return!1;t=Math.min(Math.ceil(this.content.length/this.numCols)-1,6)}let r=this.focusIndex+t;if(this.wrap&&(r%=this.content.length,r<0&&(r+=this.content.length)),r>=0&&r<this.content.length){const e=this.getFieldValueJS("rowFocusAnimationStyle").toLowerCase(),i=this.focusIndex,s=(this.rowFocus[i]??0)-(this.rowScrollOffset[i]??0);let a;if("floatingfocus"===e){a=(this.rowScrollOffset[r]??0)+s;const e=this.content[r]?.getNodeChildren(),t=e?.length??0;t>0&&(a=Math.max(0,Math.min(a,t-1)))}else a=this.rowFocus[r]??0;const o=new Kh([new vh(r),new vh(a)]);this.currRow+=this.wrap?0:t,this.set(new M("jumpToRowItem"),o),n=!0}return n}handlePageUpDown(e){return this.handleUpDown(e)}handleLeftRight(e){const t="left"===e?-1:1,n=this.focusIndex,r=this.content[n]?.getNodeChildren(),i=r?.length??0;if(i<=1)return!1;this.rowScrollOffset[n]??=0;const s=this.getRowItemWidth(n),a=this.checkIfAllItemsFitOnScreen(i,s),o=this.getFieldValueJS("rowFocusAnimationStyle").toLowerCase();return a&&"fixedfocus"!==o?this.handleAllItemsFit(n,i,t):"fixedfocuswrap"===o?this.handleFixedFocusWrap(n,i,t):"fixedfocus"===o?this.handleFixedFocus(n,i,t):this.handleFloatingFocus(n,i,s,t)}handleOK(e){if(e&&this.focusIndex>=0&&this.focusIndex<this.rowFocus.length){const e=this.focusIndex,t=this.rowFocus[e];t>=0&&this.set(new M("rowItemSelected"),rx([e,t]))}return!1}getRowItemWidth(e){const t=this.getFieldValueJS("itemSize"),n=this.getFieldValueJS("rowItemSize");let r=e-this.currRow;return this.wrap&&r<0&&(r+=this.content.length),n[r]?.[0]??t[0]}getRowItemSpacing(e){let t=[0,0];const n=this.getFieldValueJS("itemSpacing");return 2===n?.length&&(t=n),this.resolveVector(this.getFieldValueJS("rowItemSpacing"),e,t)}checkIfAllItemsFitOnScreen(e,t){return e*t+(e-1)*this.getRowItemSpacing(this.focusIndex)[0]<=this.sceneRect.width}handleAllItemsFit(e,t,n){let r=this.rowFocus[e]+n;return r=Math.max(0,Math.min(r,t-1)),r!==this.rowFocus[e]&&(this.rowFocus[e]=r,super.set(new M("rowItemFocused"),new Kh([new vh(e),new vh(r)])),!0)}handleFixedFocusWrap(e,t,n){let r=this.rowFocus[e]+n;return r<0?r=t-1:r>=t&&(r=0),this.rowFocus[e]=r,super.set(new M("rowItemFocused"),new Kh([new vh(e),new vh(r)])),!0}handleFixedFocus(e,t,n){let r=this.rowFocus[e]+n;return r=Math.max(0,Math.min(r,t-1)),r!==this.rowFocus[e]&&(this.rowFocus[e]=r,this.rowScrollOffset[e]=r,super.set(new M("rowItemFocused"),new Kh([new vh(e),new vh(r)])),!0)}handleFloatingFocus(e,t,n,r){const i=this.getRowItemSpacing(e),s=Math.floor(this.sceneRect.width/(n+i[0])),a=this.rowFocus[e],o=this.rowScrollOffset[e],c=a-o;let l=!1;return r>0?l=this.handleFloatingFocusRight(e,t,s,a,o,c):a>0&&(l=this.handleFloatingFocusLeft(e,a,o,c)),l&&super.set(new M("rowItemFocused"),new Kh([new vh(e),new vh(this.rowFocus[e])])),l}handleFloatingFocusRight(e,t,n,r,i,s){return!(r>=t-1||(s<Math.max(0,n-1)?this.rowFocus[e]=r+1:i+n<t?(this.rowScrollOffset[e]=i+1,this.rowFocus[e]=r+1):this.rowFocus[e]=t-1,0))}handleFloatingFocusLeft(e,t,n,r){return r>0?this.rowFocus[e]=t-1:n>0?(this.rowScrollOffset[e]=n-1,this.rowFocus[e]=t-1):this.rowFocus[e]=0,!0}renderContent(e,t,n,r,i){if(!this.validateRenderPrerequisites())return;const s=this.initializeRenderContext(t,e,n,r,i);this.currRow=this.focusIndex;for(let e=0;e<s.displayRows;e++){const t=this.calculateActualRowIndex(e);if(-1===t)break;if(!this.renderSingleRow(t,e,s))break}this.updateRect(t,s.displayRows,s.itemSize)}validateRenderPrerequisites(){if(0===this.content.length)return!1;this.focusIndex<0&&(this.focusIndex=0);const e=this.getFieldValueJS("itemComponentName");if(!Nh(new M(e)))return uh.stderr.write(`warning,[sg.rowlist.create.fail] Failed to create markup item ${e}`),!1;const t=this.getFieldValueJS("itemSize");return!!(t[0]&&t[1]&&this.numRows)}initializeRenderContext(e,t,n,r,i){const s=this.getFieldValueJS("itemSize");return{itemSize:s,globalSpacing:this.getFieldValueJS("itemSpacing"),rowItemSize:this.getFieldValueJS("rowItemSize"),rowHeights:this.getFieldValueJS("rowHeights"),rowSpacings:this.getFieldValueJS("rowSpacings"),displayRows:Math.min(this.content.length,this.numRows),rowItemWidth:s[0],rowItemHeight:s[1],showRowLabel:!0,itemRect:{...e,width:s[0],height:s[1]},interpreter:t,rect:e,rotation:n,opacity:r,draw2D:i}}renderSingleRow(e,t,n){const r=this.content[e],i=this.getContentChildren(r),s=i.length;n.rowItemWidth=n.rowItemSize[t]?.[0]??n.rowItemWidth,n.rowItemHeight=n.rowItemSize[t]?.[1]??n.rowItemHeight;const a=this.getRowItemSpacing(e),o=s*n.rowItemWidth+(s-1)*a[0];if(n.itemRect.width=n.rowItemWidth,n.itemRect.height=n.rowHeights[t]??n.rowItemHeight,this.wrap&&0===e&&t>0){n.itemRect.y=n.itemRect.y-a[1];const e={...n.itemRect,width:o},t=this.renderWrapDivider(e,n.opacity,n.draw2D);n.itemRect.y+=t+a[1]}const c=r.getFieldValueJS("title")??"";if(n.showRowLabel=this.getFieldValueJS("showRowLabel")?.[e]??n.showRowLabel,0!==c.length&&n.showRowLabel){const e={...n.itemRect,width:o},r=this.renderRowDivider(c,e,n.opacity,t,n.draw2D);n.itemRect.y+=r}const l=this.getRowXOffset(t);n.itemRect.x=n.rect.x+l,this.renderRowContent(e,i,s,n.rowItemWidth,a,n.itemRect,n),n.itemRect.x=n.rect.x;const u=this.calculateRowSpacing(t,n.rowSpacings,n.globalSpacing);return n.itemRect.y+=n.itemRect.height+u,lw(this.sceneRect,n.itemRect)}getRowXOffset(e){const t=this.getFieldValueJS("focusXOffset");return t&&0!==t.length?t[Math.min(e,t.length-1)]??0:0}renderRowContent(e,t,n,r,i,s,a){const o=n*r+(n-1)*i[0]<=this.sceneRect.width,c=this.getFieldValueJS("rowFocusAnimationStyle").toLowerCase();this.rowScrollOffset[e]??=0;const l=this.determineRenderMode(o,c);this.renderRowItems(e,t,s,i,r,l,a)}calculateRowSpacing(e,t,n){const r=t[e]??n[1],i="FHD"===this.resolution?60:40;return void 0!==r&&0!==r?r:i}calculateActualRowIndex(e){let t=this.currRow+e;if(this.wrap)t>=this.content.length&&(t%=this.content.length),t<0&&(t+=this.content.length);else if(t>=this.content.length||t<0)return-1;return t}determineRenderMode(e,t){return e&&"fixedfocus"!==t?"allItemsFit":"fixedfocuswrap"===t?"wrapMode":"scrollMode"}renderRowItems(e,t,n,r,i,s,a){const o=t.length;let c;c="allItemsFit"===s?0:"wrapMode"===s?this.rowFocus[e]??0:this.rowScrollOffset[e]??0;const l=Math.ceil((this.sceneRect.width+r[0])/(i+r[0])),u="wrapMode"===s?o:Math.min(c+l,o);for(let i=0;i<("wrapMode"===s?o:u-c);i++){let l=c+i;if("wrapMode"===s&&l>=o&&(l%=o),l>=t.length)break;if(this.renderRowItemComponent(a.interpreter,e,l,t,n,a.rotation,a.opacity,a.draw2D),n.x+=n.width+r[0],n.x>this.sceneRect.x+this.sceneRect.width)break}}renderRowItemComponent(e,t,n,r,i,s,a,o){const c=r[n],l=eS.focused===this,u=r.length,h=i.width,d=this.getRowItemSpacing(t),f=i.x-n*(h+d[0])+(u-1)*(h+d[0])+h<=this.sceneRect.width;let p=!1;if(p="fixedfocuswrap"!==this.getFieldValueJS("rowFocusAnimationStyle").toLowerCase()||f?this.focusIndex===t&&this.rowFocus[t]===n:this.focusIndex===t&&n===this.rowFocus[t],!this.rowItemComps[t]?.[n]){const r=this.createItemComponent(e,i,c);this.rowItemComps[t]??=[],r instanceof tS&&(this.rowItemComps[t][n]=r)}c.changed&&(this.rowItemComps[t][n].set(new M("itemContent"),c,!0),c.changed=!1);const g=this.rowItemComps[t][n];g&&(g.set(new M("itemHasFocus"),D.from(p)),g.set(new M("focusPercent"),new bh(p?1:0)),g.set(new M("rowHasFocus"),D.from(this.focusIndex===t)),g.set(new M("rowFocusPercent"),new bh(this.focusIndex===t?1:0)),g.set(new M(this.focusField),D.from(l)));const m=this.getFieldValueJS("drawFocusFeedback"),y=this.getFieldValueJS("drawFocusFeedbackOnTop");p&&m&&!y&&this.renderFocus(i,a,l,o);const b=[i.x,i.y];this.rowItemComps[t][n].renderNode(e,b,s,a,o),p&&m&&y&&this.renderFocus(i,a,l,o)}renderRowDivider(e,t,n,r,i){const s=this.resolveVector(this.getFieldValueJS("rowLabelOffset"),r,[0,0]),a={...t,x:t.x+(s[0]??0),height:this.titleHeight};if(0!==e.length){const t=this.getFieldValue("rowLabelFont"),s=this.getFieldValueJS("rowLabelColor");this.drawText(e,t,s,n,a,"left","center",0,i,"...",r)}return this.titleHeight+(s[1]??0)}refreshContent(){this.content.length=0;const e=this.getFieldValue("content");if(!(e instanceof Zv))return;const t=this.getContentChildren(e);let n=0;for(const e of t)0!==e.getNodeChildren().length&&(this.rowFocus[n]=0,this.rowScrollOffset[n]=0,n++,this.content.push(e))}}class wS extends yS{name;defaultFields=[{name:"itemComponentName",type:"string",value:""},{name:"numRows",type:"integer",value:"12"},{name:"numColumns",type:"integer",value:"1"},{name:"rowWidth",type:"float",value:"0.0"},{name:"rowHeight",type:"floatarray",value:"[]"},{name:"rowZoomHeight",type:"floatarray",value:"[]"},{name:"spacingAfterRow",type:"float",value:"0.0"},{name:"rowItemYOffset",type:"array",value:"[]"},{name:"rowItemZoomYOffset",type:"array",value:"[]"},{name:"rowItemHeight",type:"floatarray",value:"[]"},{name:"rowItemZoomHeight",type:"floatarray",value:"[]"},{name:"rowItemAspectRatio",type:"floatarray",value:"[]"},{name:"spacingAfterRowItem",type:"floatarray",value:"[]"},{name:"useDefaultAspectRatio",type:"boolarray",value:"[]"},{name:"showRowTitle",type:"boolarray",value:"[]"},{name:"rowTitleOffset",type:"array",value:"[]"},{name:"rowTitleFont",type:"font",value:"font:SmallestSystemFont"},{name:"rowTitleColor",type:"array",value:"[]"},{name:"showRowCounter",type:"boolarray",value:"[]"},{name:"rowCounterOffset",type:"array",value:"[]"},{name:"rowCounterFont",type:"font",value:"font:SmallestSystemFont"},{name:"rowCounterColor",type:"array",value:"[]"},{name:"showRowCounterForShortRows",type:"bool",value:"true"},{name:"rowDecorationComponentName",type:"array",value:"[]"},{name:"rowFocusAnimationStyle",type:"string",value:"fixedFocusWrap"},{name:"wrap",type:"boolean",value:"true"},{name:"drawFocusFeedbackOnTop",type:"boolean",value:"true"},{name:"rowSelected",type:"integer",value:"-1",alwaysNotify:!0},{name:"rowFocused",type:"integer",value:"-1",alwaysNotify:!0},{name:"rowUnfocused",type:"integer",value:"-1",alwaysNotify:!0},{name:"rowItemSelected",type:"array",value:"[]",alwaysNotify:!0},{name:"rowItemFocused",type:"array",value:"[]",alwaysNotify:!0},{name:"scrollingStatus",type:"boolean",value:"false",alwaysNotify:!0},{name:"rowsRendered",type:"array",value:"[]",alwaysNotify:!0},{name:"rowItemsRendered",type:"array",value:"[]",alwaysNotify:!0},{name:"currFocusRow",type:"float",value:"-1.0",alwaysNotify:!0},{name:"jumpToRow",type:"integer",value:"-1",alwaysNotify:!0},{name:"jumpToRowItem",type:"array",value:"[]",alwaysNotify:!0},{name:"animateToRow",type:"integer",value:"-1",alwaysNotify:!0},{name:"remainZoomedAboveFocus",type:"string",value:"focusIsAtTop"},{name:"fadeOutAboveFocus",type:"string",value:"focusIsAtTop"}];focusUri="common:/images/focus_grid.9.png";marginX;marginY;gap;rowItemComps=[[]];rowFocus=[];defaultAspectRatio=16/9;defaultRowHeight;defaultRowZoomHeight;defaultItemSpacing;defaultRowSpacing;defaultItemYOffset;defaultItemZoomYOffset;nodeWidth;rowWidth;constructor(e=[],t="ZoomRowList"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.setFieldValue("focusBitmapUri",new M(this.focusUri)),this.setFieldValue("wrapDividerBitmapUri",new M(this.dividerUri)),"FHD"===this.resolution?(this.marginX=18,this.marginY=18,this.defaultRowHeight=204,this.defaultRowZoomHeight=321,this.defaultRowSpacing=80,this.defaultItemSpacing=21,this.setFieldValue("wrapDividerHeight",new bh(54))):(this.marginX=12,this.marginY=12,this.defaultRowHeight=214,this.defaultRowZoomHeight=136,this.defaultRowSpacing=53,this.defaultItemSpacing=14,this.setFieldValue("wrapDividerHeight",new bh(36))),this.gap=this.marginX/2,this.defaultItemYOffset=0,this.defaultItemZoomYOffset=0,this.hasNinePatch=!0,this.focusField="zoomRowListHasFocus",this.wrap=!0,this.focusIndex=0,this.rowFocus[0]=0,this.nodeWidth=this.sceneRect.width,this.rowWidth=0}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("content"===i){super.set(e,t,n,r),this.rowItemComps.length=0,this.rowItemComps.push([]),this.refreshContent();const i=this.getFieldValueJS("rowFocused");return this.setFocusedRow(i),O.Instance}if(["jumptorow","animatetorow"].includes(i)&&jS(t)){const e=cx(t);Number.isFinite(e)&&e>=0&&this.setFocusedRow(Math.floor(e))}else if("jumptorowitem"===i&&t instanceof Kh){const e=cx(t);"number"==typeof e[0]&&"number"==typeof e[1]&&this.setFocusedItem(e[0],e[1])}else"wrap"===i&&t instanceof D?this.wrap=t.toBoolean():"rowwidth"===i&&jS(t)&&(this.rowWidth=cx(t));return super.set(e,t,n,r)}setFocusedRow(e){e<0||e>=this.content.length||this.setFocusedItem(e,this.rowFocus[e]??0)}setFocusedItem(e,t=-1){if(0===this.content.length)return;if(e<0||e>=this.content.length)return;const n=this.getRowContent(e).length;-1===t&&(t=this.rowFocus[e]??0),t=n>0?Math.max(0,Math.min(t,n-1)):0;const r=this.focusIndex;r!==e&&super.set(new M("rowUnfocused"),new vh(r)),this.focusIndex=e,this.rowFocus[e]=t,this.currRow=e,super.set(new M("rowFocused"),new vh(e)),super.set(new M("rowItemFocused"),new Kh([new vh(e),new vh(t)])),super.set(new M("currFocusRow"),new bh(e))}handleUpDown(e){let t=!1,n=0;if("up"===e)n=-1;else if("down"===e)n=1;else if("rewind"===e)n=-Math.min(this.content.length-1,6);else{if("fastforward"!==e)return!1;n=Math.min(this.content.length-1,6)}let r=this.focusIndex+n;if(this.wrap){if(0===this.content.length)return!1;r=(r+this.content.length)%this.content.length}return r>=0&&r<this.content.length&&(super.set(new M("scrollingStatus"),D.True),this.focusIndex=r,this.rowFocus[r]??=0,this.setFocusedItem(r,this.rowFocus[r]),super.set(new M("currFocusRow"),new bh(r)),t=!0),super.set(new M("scrollingStatus"),D.False),t}handlePageUpDown(e){return this.handleUpDown(e)}handleLeftRight(e){const t="left"===e?-1:1,n=this.focusIndex,r=this.getRowContent(n).length;if(0===r)return!1;this.rowFocus[n]??=0;let i=this.rowFocus[n]+t;const s=this.canWrapItems(r,this.getRowMetrics(n),this.nodeWidth);return i<0?i=s?(r+i)%r:0:i>=r&&(i=s?i%r:r-1),i!==this.rowFocus[n]&&(this.rowFocus[n]=i,super.set(new M("rowItemFocused"),new Kh([new vh(n),new vh(i)])),super.set(new M("scrollingStatus"),D.True),super.set(new M("scrollingStatus"),D.False),!0)}handleOK(e){if(e&&this.focusIndex>=0&&this.focusIndex<this.rowFocus.length){const e=this.focusIndex,t=this.rowFocus[e]??0;super.set(new M("rowItemSelected"),rx([e,t])),super.set(new M("rowSelected"),new vh(e))}return!1}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation().slice();s[0]+=t[0],s[1]+=t[1];const a=n+this.getRotation();r*=this.getOpacity();const o={x:s[0],y:s[1],...this.getDimensions()};this.renderContent(e,o,a,r,i),this.updateBoundingRects(o,t,a),this.renderChildren(e,s,a,r,i),this.updateParentRects(t,n),this.isDirty=!1}renderContent(e,t,n,r,i){if(!this.validateRenderPrerequisites())return;const s=this.content.length;if(0===s)return;const a=this.canWrapRows(s),o=a?this.normalizeRowIndex(this.focusIndex):this.clampRowIndex(this.focusIndex);this.currRow=o;let c=t.y,l=-1,u=-1;const h=[];for(let d=0;d<s;d++){let f=a?this.normalizeRowIndex(o+d):o+d;if(!a&&f>=s)break;const p=this.getRowMetrics(f),g=this.sceneRect.x+this.sceneRect.width;this.nodeWidth=g-t.x,this.rowWidth<=0&&this.refreshRowWidth(this.nodeWidth);let m=c;if(a&&0===f&&d>0){m-=.3*p.spacingY;const e={x:t.x,y:m,width:this.rowWidth,height:Math.max(p.spacingY,1)};m+=this.renderWrapDivider(e,r,i)+.3*p.spacingY}const y={x:t.x,y:m,width:this.rowWidth,height:p.rowHeight},b=this.renderRow(e,f,y,p,n,r,i);if(b&&h.push(new vh(b[0]),new vh(b[1]),new vh(b[2])),l=-1===l?f:l,u=f,c=m+p.rowHeight+p.spacingY,this.sceneRect.height>0&&c>this.sceneRect.y+this.sceneRect.height)break}if(-1!==l){const e=new Kh([new vh(l),new vh(u)]);this.setFieldValue("rowsRendered",e)}h.length&&this.setFieldValue("rowItemsRendered",new Kh(h))}validateRenderPrerequisites(){if(0===this.content.length)return!1;this.focusIndex<0&&(this.focusIndex=0);const e=this.getFieldValueJS("itemComponentName");return!!Nh(new M(e))||(uh.stderr.write(`warning,[sg.zoomrowlist.create.fail] Failed to create item ${e}`),!1)}refreshContent(){this.content.length=0;const e=this.getFieldValue("content");if(!(e instanceof Zv))return;const t=this.getContentChildren(e);for(const[e,n]of t.entries())0!==n.getNodeChildren().length&&(this.rowFocus[e]??=0,this.content.push(n));if(0===this.content.length)return this.focusIndex=0,void(this.currRow=0);this.focusIndex>=this.content.length&&(this.focusIndex=this.content.length-1);const n=this.canWrapRows(this.content.length);this.currRow=n?this.normalizeRowIndex(this.focusIndex):this.clampRowIndex(this.focusIndex)}renderRow(e,t,n,r,i,s,a){const o=this.getRowContent(t);if(0===o.length)return;const c=this.renderRowTitle(t,n,this.nodeWidth,s,a),l=this.renderRowCounter(t,n,r,this.nodeWidth,s,a),u=n.y+Math.max(c,l)+r.itemYOffset,h={x:n.x,y:u,width:r.itemWidth,height:r.itemHeight},d=this.canWrapItems(o.length,r,this.nodeWidth);let f=d?this.rowFocus[t]??0:0;const p=this.getMaxVisibleItems(r.itemWidth,r.spacingX,this.nodeWidth),g=d?o.length:Math.min(f+p,o.length);let m=-1,y=-1;for(let c=0;c<(d?o.length:g-f);c++){let l=f+c;if(d&&l>=o.length&&(l%=o.length),l>=o.length)break;if(this.renderRowItemComponent(e,[t,l],o,h,i,s,a),m=-1===m?l:m,y=l,h.x+=h.width+r.spacingX,h.x>n.x+this.nodeWidth)break}return-1!==m?[t,m,y]:void 0}getRowContent(e){const t=this.content[e];return this.getContentChildren(t)}getMaxVisibleItems(e,t,n,r=!0){if(e<=0)return 1;const i=n>0?n:this.sceneRect.width;return i<=0?1:r?Math.ceil((i+t)/(e+t)):Math.floor((i+t)/(e+t))}canWrapRows(e){return this.wrap&&e>0&&this.content.length>=e}canWrapItems(e,t,n){const r=n>0?n:this.sceneRect.width,i=e*t.itemWidth+(e-1)*t.spacingX;return!(r>0&&i<=r)}normalizeRowIndex(e){const t=this.content.length;if(0===t)return 0;let n=e%t;return n<0&&(n+=t),n}clampRowIndex(e){return 0===this.content.length?0:Math.max(0,Math.min(e,this.content.length-1))}getRowItemSpacing(e){const t=this.defaultItemSpacing,n=this.getFieldValueJS("spacingAfterRowItem");if(Array.isArray(n)&&n.length>0){const t=Math.min(e,n.length-1),r=Number(n[t]);if(Number.isFinite(r)&&r>0)return r}return t}refreshRowWidth(e){const t=this.getFieldValueJS("rowWidth");if("number"==typeof t&&t>0)return this.rowWidth=t,t;const n=this.resolveNumber(this.getFieldValueJS("rowItemHeight"),0,this.defaultRowHeight)*this.resolveNumber(this.getFieldValueJS("rowItemAspectRatio"),0,this.defaultAspectRatio),r=this.getRowItemSpacing(0),i=this.getMaxVisibleItems(n,r,e,!1);return this.rowWidth=(n+r)*i,this.rowWidth}getRowMetrics(e){const t=this.focusIndex===e?1:0,n=this.resolveNumber(this.getFieldValueJS("rowHeight"),e,this.defaultRowHeight),r=this.resolveNumber(this.getFieldValueJS("rowZoomHeight"),e,this.defaultRowZoomHeight),i=this.lerp(n,r,t),s=this.resolveNumber(this.getFieldValueJS("rowItemHeight"),e,this.defaultRowHeight),a=this.resolveNumber(this.getFieldValueJS("rowItemZoomHeight"),e,this.defaultRowZoomHeight),o=this.lerp(s,a,t),c=o>0?o:Math.max(s,1),l=this.resolveNumber(this.getFieldValueJS("rowItemAspectRatio"),e,this.defaultAspectRatio),u=this.getRowItemSpacing(e),h=this.getFieldValueJS("spacingAfterRow"),d=h>0?h:this.defaultRowSpacing,f=this.resolveNumber(this.getFieldValueJS("rowItemYOffset"),e,this.defaultItemYOffset),p=this.resolveNumber(this.getFieldValueJS("rowItemZoomYOffset"),e,this.defaultItemZoomYOffset),g=this.lerp(f,p,t);let m=l>0?l:this.defaultAspectRatio;if(!this.resolveBoolean(this.getFieldValueJS("useDefaultAspectRatio"),e,!0)){const t=this.getRowContent(e);if(t.length){const e=t[0].getFieldValueJS("aspectRatio");"number"==typeof e&&e>0&&(m=e)}}const y=c*m;return{rowHeight:Math.max(i,g+c),itemHeight:c,itemWidth:y,spacingX:u,spacingY:d,itemYOffset:g,focusPercent:t}}renderRowItemComponent(e,t,n,r,i,s,a){const o=t[0],c=t[1],l=n[c],u=eS.focused===this,h=this.focusIndex===o&&this.rowFocus[o]===c;if(!this.rowItemComps[o]?.[c]){const t=this.createItemComponent(e,r,l);this.rowItemComps[o]??=[],t instanceof tS&&(this.rowItemComps[o][c]=t)}l.changed&&(this.rowItemComps[o][c].set(new M("itemContent"),l,!0),l.changed=!1);const d=this.rowItemComps[o][c];d&&(d.set(new M("itemHasFocus"),D.from(h)),d.set(new M("focusPercent"),new bh(h?1:0)),d.set(new M("rowHasFocus"),D.from(this.focusIndex===o)),d.set(new M("rowFocusPercent"),new bh(this.focusIndex===o?1:0)),d.set(new M(this.focusField),D.from(u)),d.setFieldValue("width",rx(r.width)),d.setFieldValue("height",rx(r.height)));const f=this.getFieldValueJS("drawFocusFeedback"),p=this.getFieldValueJS("drawFocusFeedbackOnTop");h&&f&&!p&&this.renderFocus(r,s,u,a);const g=[r.x,r.y];this.rowItemComps[o][c].renderNode(e,g,i,s,a),h&&f&&p&&this.renderFocus(r,s,u,a)}renderRowTitle(e,t,n,r,i){if(!this.resolveBoolean(this.getFieldValueJS("showRowTitle"),e,!0))return 0;const s=this.content[e].getFieldValueJS("title")??"";if(!s)return 0;const a=this.getFieldValueJS("rowTitleOffset"),o=this.resolveVector(a,e,[0,0]),c=this.resolveColor(this.getFieldValueJS("rowTitleColor"),e,4294967295),l=this.getFieldValue("rowTitleFont");if(!(l instanceof fS))return 0;const u=l.createDrawFont(),h={x:t.x+o[0],y:t.y+o[1],width:n,height:u.measureTextHeight()+this.gap};return this.drawText(s,l,c,r,h,"left","top",0,i,"",e+1),h.height+o[1]}renderRowCounter(e,t,n,r,i,s){const a=this.resolveBoolean(this.getFieldValueJS("showRowCounter"),e,!1),o=this.content[e].getNodeChildren().length;if(!a&&e!==this.focusIndex)return 0;if(0===o)return 0;const c=this.getFieldValueJS("showRowCounterForShortRows")??!0,l=o*n.itemWidth+(o-1)*n.spacingX;if(!c&&l<r)return 0;const u=this.getFieldValueJS("rowCounterOffset"),h=this.resolveVector(u,e,[0,0]),d=this.resolveColor(this.getFieldValueJS("rowCounterColor"),e,4294967295),f=this.getFieldValue("rowCounterFont");let p;if(f instanceof fS)p=f;else{const e=this.getFieldValue("rowTitleFont");e instanceof fS&&(p=e)}if(!p)return 0;const g=p.createDrawFont(),m=`${this.rowFocus[e]+1} of ${o}`,y={x:t.x,y:t.y+h[1],width:h[0]||this.rowWidth,height:g.measureTextHeight()+this.gap};return this.drawText(m,p,d,i,y,"right","top",0,s,"",0),y.height+h[1]}lerp(e,t,n){return!Number.isFinite(e)&&Number.isFinite(t)?t:Number.isFinite(e)&&!Number.isFinite(t)?e:Number.isFinite(e)||Number.isFinite(t)?e+(t-e)*n:0}}class vS extends yS{name;defaultFields=[{name:"itemComponentName",type:"string",value:""},{name:"drawFocusFeedbackOnTop",type:"boolean",value:"true"},{name:"vertFocusAnimationStyle",type:"string",value:"fixedFocusWrap"},{name:"numRows",type:"integer",value:"12"},{name:"numColumns",type:"integer",value:"1"}];focusUri="common:/images/focus_grid.9.png";marginX;marginY;gap;constructor(e=[],t="MarkupGrid"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?(this.marginX=15,this.marginY=15):(this.marginX=10,this.marginY=10),this.gap=0,this.setFieldValue("focusBitmapUri",new M(this.focusUri)),this.setFieldValue("wrapDividerBitmapUri",new M(this.dividerUri));const n=this.getFieldValueJS("vertFocusAnimationStyle");this.wrap="fixedfocuswrap"===n.toLowerCase(),this.numRows=this.getFieldValueJS("numRows"),this.numCols=this.getFieldValueJS("numColumns"),this.hasNinePatch=!0,this.focusField="gridHasFocus"}handleUpDown(e){let t,n=!1;const r=this.numCols;if("up"===e)t=-1;else if("down"===e)t=1;else if("rewind"===e)t=-Math.min(Math.ceil(this.content.length/r)-1,6);else{if("fastforward"!==e)return!1;t=Math.min(Math.ceil(this.content.length/r)-1,6)}let i=this.focusIndex+t*r;if(this.wrap){const e=this.focusIndex%r;if(i=this.getIndex(t)+e,this.metadata.length>0){let n=this.content[i];for(;n instanceof Zv&&"_placeholder_"===n.name;)i=this.getIndex(t,i)+e,n=this.content[i]}}if(i>=0&&i<this.content.length){const e=this.metadata[i]?.index??i;this.set(new M("animateToItem"),new vh(e)),n=!0,this.currRow+=this.wrap?0:t}return n}handlePageUpDown(e){return this.handleUpDown(e)}handleLeftRight(e){let t=!1;const n="left"===e?-1:1,r=this.focusIndex+n;if(r>=0&&r<this.content.length&&this.itemComps?.[r]){const e=cx(this.getFieldValue("numColumns")),n=Math.floor(this.focusIndex/e),i=Math.floor(r/e),s=this.itemComps[r];if(n===i&&"Group"!==s.nodeSubtype){const e=this.metadata[r]?.index??r;this.set(new M("animateToItem"),new vh(e)),t=!0}}return t}renderContent(e,t,n,r,i){if(0===this.content.length)return;this.focusIndex<0&&(this.focusIndex=0);const s=this.metadata.length>0,a=this.getFieldValueJS("itemComponentName");if(!Nh(new M(a)))return void uh.stderr.write(`warning,[sg.markupgrid.create.fail] Failed to create markup item ${a}`);const o=this.getFieldValueJS("itemSize");if(!(o?.[0]&&o?.[1]&&this.numRows&&this.numCols))return;const c={...t,width:o[0],height:o[1]},l=this.getFieldValueJS("itemSpacing"),u=this.getFieldValueJS("columnWidths"),h=this.getFieldValueJS("columnSpacings"),d=this.getFieldValueJS("rowHeights"),f=this.getFieldValueJS("rowSpacings");this.currRow=this.updateCurrRow();let p=-1;const g=Math.min(Math.ceil(this.content.length/this.numCols),this.numRows);let m=0;const y=this.numCols*o[0]+(this.numCols-1)*l[0];for(let a=0;a<g;a++){const g=this.getIndex(a-this.currRow);if(c.height=d[g/this.numCols]??o[1],!s&&this.wrap&&g<p&&a>0){const e={...c,width:y},t=this.renderWrapDivider(e,r,i);c.y+=t+l[1]}else if(s&&this.wrap&&this.metadata[g]?.divider&&a>0){const e={...c,width:y},t=this.metadata[g].sectionTitle,n=this.renderSectionDivider(t,e,r,m,i);m++,c.y+=n+l[1]}for(let t=0;t<this.numCols;t++){c.width=u[t]??o[0];const s=g+t;if(s>=this.content.length)break;if(this.renderItemComponent(e,s,c,n,r,i),c.x+=c.width+(h[t]??l[0]),p=s,!lw(this.sceneRect,c))break}if(c.x=t.x,c.y+=c.height+(f[a]??l[1]),!lw(this.sceneRect,c))break}this.updateRect(t,g,o)}}class SS extends yS{name;defaultFields=[{name:"itemComponentName",type:"string",value:""},{name:"numRows",type:"integer",value:"12"},{name:"numColumns",type:"integer",value:"1"},{name:"vertFocusAnimationStyle",type:"string",value:"fixedFocusWrap"}];focusUri="common:/images/focus_list.9.png";footprintUri="common:/images/focus_footprint.9.png";gap;wrap;constructor(e=[],t="MarkupList"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.gap=0,this.setFieldValue("focusBitmapUri",new M(this.focusUri)),this.setFieldValue("focusFootprintBitmapUri",new M(this.footprintUri)),this.setFieldValue("wrapDividerBitmapUri",new M(this.dividerUri));const n=this.getFieldValueJS("vertFocusAnimationStyle");this.wrap="fixedfocuswrap"===n.toLowerCase(),this.numRows=this.getFieldValueJS("numRows"),this.numCols=this.getFieldValueJS("numColumns"),this.hasNinePatch=!0}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("vertfocusanimationstyle"===i){if(!["fixedfocuswrap","floatingfocus"].includes(t.toString().toLowerCase()))return O.Instance}else if(["horizfocusanimationstyle","numcolumns"].includes(i))return O.Instance;const s=super.set(e,t,n,r);return"content"===i||"vertfocusanimationstyle"===i?this.topRow=0:"numrows"===i&&this.clampTopRow(),s}handleUpDown(e){let t,n=!1;if("up"===e)t=-1;else if("down"===e)t=1;else if("rewind"===e)t=-Math.min(Math.ceil(this.content.length)-1,6);else{if("fastforward"!==e)return!1;t=Math.min(Math.ceil(this.content.length)-1,6)}let r=this.focusIndex+t;if(this.wrap&&(r=this.getIndex(t)),r>=0&&r<this.content.length){const e=this.metadata[r]?.index??r;this.set(new M("animateToItem"),new vh(e)),n=!0,this.currRow+=this.wrap?0:t}return n}handlePageUpDown(e){return this.handleUpDown(e)}renderContent(e,t,n,r,i){if(0===this.content.length)return;this.focusIndex<0&&(this.focusIndex=0);const s=this.metadata.length>0,a=this.getFieldValueJS("itemComponentName");if(!Nh(new M(a)))return void uh.stderr.write(`warning,[sg.markuplist.create.fail] Failed to create markup item ${a}`);const o=this.getFieldValueJS("itemSize");if(0===o[0]||0===o[1]||0===this.numRows)return;const c={...t,width:o[0],height:o[1]},l=this.getFieldValueJS("itemSpacing"),u=this.getFieldValueJS("rowHeights"),h=this.getFieldValueJS("rowSpacings");this.currRow=this.updateListCurrRow();let d=-1,f=0;const p=Math.min(Math.ceil(this.content.length),this.numRows),g=o[0];for(let a=0;a<p;a++){const p=this.getIndex(a-this.currRow);if(c.height=u[p]??o[1],!s&&this.wrap&&p<d&&a>0){const e={...c,width:g},t=this.renderWrapDivider(e,r,i);c.y+=t+l[1]}else if(s&&this.wrap&&this.metadata[p]?.divider&&a>0){const e={...c,width:g},t=this.metadata[p].sectionTitle,n=this.renderSectionDivider(t,e,r,f,i);f++,c.y+=n+l[1]}c.width=o[0];const m=p;if(m>=this.content.length)break;if(this.renderItemComponent(e,m,c,n,r,i),d=m,c.x=t.x,c.y+=c.height+(h[a]??l[1]),!lw(this.sceneRect,c))break}this.updateRect(t,p,o)}}class xS extends tS{name;defaultFields=[{name:"color",type:"color",value:"0x00000000"},{name:"backgroundUri",type:"uri"},{name:"logoUri",type:"uri"},{name:"logoBaselineOffset",type:"float",value:"0.0"},{name:"title",type:"string"},{name:"titleColor",type:"color",value:"0xfefefeff"},{name:"showClock",type:"boolean",value:"true"},{name:"clockColor",type:"color",value:"0xfefefeff"},{name:"clockText",type:"string"},{name:"showOptions",type:"boolean",value:"false"},{name:"optionsColor",type:"color",value:"0xfefefeff"},{name:"optionsDimColor",type:"color",value:"0xfefefe99"},{name:"optionsIconColor",type:"color"},{name:"optionsIconDimColor",type:"color"},{name:"optionsAvailable",type:"boolean",value:"false"},{name:"optionsText",type:"string"},{name:"optionsMaxWidth",type:"float",value:"0.0"},{name:"leftDividerUri",type:"uri"},{name:"leftDividerVertOffset",type:"float",value:"0.0"},{name:"rightDividerUri",type:"uri"},{name:"rightDividerVertOffset",type:"float",value:"0.0"},{name:"height",type:"float",value:"115"}];backRect;backPoster;optionsIcon;optionsText;logo;leftDivider;rightDivider;title;clockText;optionsOn="common:/images/icon_options.png";optionsOff="common:/images/icon_options_off.png";width;height;realign;constructor(e=[],t="Overhang"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e);const n=`common:/images/${this.resolution}/logo_roku.png`,r=`common:/images/${this.resolution}/divider_vertical.png`;"FHD"===this.resolution?(this.width=1920,this.height=172,this.setFieldValue("width",new bh(this.width)),this.setFieldValue("height",new bh(this.height)),this.backRect=this.addRectangle("color",[0,0],this.width,this.height),this.backPoster=this.addPoster("",[0,0],this.width,this.height),this.logo=this.addPoster(n,[102,63]),this.leftDivider=this.addPoster(r,[261,59],12,51),this.title=this.addLabel("titleColor",[297,58],0,50,45,"bottom"),this.optionsIcon=this.addPoster(this.optionsOff,[1421,67],30,30),this.optionsText=this.addLabel("optionsColor",[1460,64],0,40,33,"center","right"),this.rightDivider=this.addPoster(r,[1646,59],12,51),this.clockText=this.addLabel("clockColor",[1682,64],0,40,33,"center")):(this.width=1280,this.height=115,this.setFieldValue("width",new bh(this.width)),this.setFieldValue("height",new bh(this.height)),this.backRect=this.addRectangle("color",[0,0],this.width,this.height),this.backPoster=this.addPoster("",[0,0],this.width,this.height),this.logo=this.addPoster(n,[68,42]),this.leftDivider=this.addPoster(r,[174,39],8,34),this.title=this.addLabel("titleColor",[196,39],0,35,30,"bottom"),this.optionsIcon=this.addPoster(this.optionsOff,[959,46],20,20),this.optionsText=this.addLabel("optionsColor",[985,44],0,27,22,"center","right"),this.rightDivider=this.addPoster(r,[1109,39],8,34),this.clockText=this.addLabel("clockColor",[1133,44],0,27,22,"center")),this.backRect.setFieldValue("visible",D.False),this.optionsText.set(new M("text"),new M(uh.getTerm("for Options"))),this.clockText.set(new M("text"),new M(uh.getTime()));const i=new ES;i.setCallback(()=>{this.clockText.set(new M("text"),new M(uh.getTime()))}),i.set(new M("repeat"),D.True),i.set(new M("control"),new M("start")),this.appendChildToParent(i),this.realign=!1}updateChildren(){this.copyField(this.backPoster,"height");const e=this.getFieldValueJS("backgroundUri");e&&this.backPoster.set(new M("uri"),new M(e));const t=this.getFieldValueJS("color"),n=this.getFieldValueJS("logoUri");n?this.setLogoUri(n):t?(this.copyField(this.backRect,"color"),this.backRect.setFieldValue("visible",D.True)):this.backRect.setFieldValue("visible",D.False),this.copyField(this.backRect,"height");const r=this.getFieldValueJS("title");r?(this.title.set(new M("text"),new M(r)),this.copyField(this.title,"color","titleColor"),this.leftDivider.set(new M("visible"),D.True)):this.leftDivider.set(new M("visible"),D.False);const i=this.getFieldValueJS("showOptions"),s=this.getFieldValueJS("optionsAvailable"),a=i&&s;this.optionsIcon.set(new M("visible"),D.from(a)),this.optionsText.set(new M("visible"),D.from(a));const o=this.getFieldValueJS("showClock");this.clockText.set(new M("visible"),D.from(o)),s?(this.optionsIcon.set(new M("uri"),new M(this.optionsOn)),this.copyField(this.optionsIcon,"blendColor","optionsIconColor"),this.copyField(this.optionsText,"color","optionsColor")):(this.optionsIcon.set(new M("uri"),new M(this.optionsOff)),this.copyField(this.optionsText,"color","optionsDimColor")),o&&a?this.rightDivider.set(new M("visible"),D.True):this.rightDivider.set(new M("visible"),D.False);const c=this.getFieldValueJS("optionsText");c&&this.optionsText.set(new M("text"),new M(c));const l=this.getFieldValueJS("leftDividerUri");l&&this.leftDivider.set(new M("uri"),new M(l));const u=this.getFieldValueJS("rightDividerUri");u&&this.rightDivider.set(new M("uri"),new M(u)),this.isDirty=!1}setLogoUri(e){this.logo.set(new M("uri"),new M(e));const t=this.logo.getFieldValueJS("loadStatus")??"",n=eS.scene?.subSearch??"",r=""!==n&&e.includes(n);if("ready"===t&&this.resolution!==uh.getDisplayMode()&&!r){const e=this.logo.getFieldValueJS("bitmapHeight"),t=this.logo.getFieldValueJS("bitmapWidth");"FHD"===this.resolution?(this.logo.set(new M("height"),new bh(1.5*e)),this.logo.set(new M("width"),new bh(1.5*t))):(this.logo.set(new M("height"),new bh(e/1.5)),this.logo.set(new M("width"),new bh(t/1.5)))}}alignChildren(){const e="FHD"===this.resolution,t="FHD"===uh.getDisplayMode(),n=e?102:68,r=e?60:40,i=this.logo.rectLocal.width,s=this.optionsText.rectLocal.width??(e?168:112),a=this.getFieldValueJS("showClock"),o=a?this.clockText.rectLocal.width:0,c=a?s+(e?60:40):s,l=this.width-n-o;e?(this.logo.setTranslation([n,r+3]),this.leftDivider.setTranslation([n+i+24,r]),this.title.setTranslation([n+i+56,r]),this.optionsIcon.setTranslation([l-c-36,r+9]),this.optionsText.setTranslation([l-c,r+3]),this.rightDivider.setTranslation([l-36,r]),this.clockText.setTranslation([l,r+3])):(this.logo.setTranslation([n,r]),this.leftDivider.setTranslation([n+i+16,r]),this.title.setTranslation([n+i+38,r-2]),this.optionsIcon.setTranslation([l-c-24,r+6]),this.optionsText.setTranslation([l-c,r+2]),this.rightDivider.setTranslation([l-24,r]),this.clockText.setTranslation([l,r+2])),t!==e&&this.logo.setTranslation([n,r]),this.realign=!1}set(e,t,n=!1,r){return this.realign=!0,"height"===(e instanceof M?e.value:"")&&jS(t)&&(this.height=cx(t)),super.set(e,t,n,r)}renderNode(e,t,n,r,i){if(!this.isVisible())return;this.isDirty&&this.updateChildren();const s=this.getDimensions(),a={x:t[0],y:t[1],width:s.width,height:s.height};r*=this.getOpacity(),this.updateBoundingRects(a,t,n),this.renderChildren(e,t,n,r,i),this.updateParentRects(t,n),this.realign&&this.alignChildren()}}class ES extends Bf{name;defaultFields=[{name:"control",type:"string"},{name:"repeat",type:"boolean",value:"false"},{name:"duration",type:"time",value:"1.0"},{name:"fire",type:"object",alwaysNotify:!0}];active;lastFireTime;jsCallback;constructor(e=[],t="Timer"){super([],t),this.name=t,this.lastFireTime=0,this.active=!1,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),eS.timers.push(this)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase(),s=this.fields.get(i);if(s&&"control"===i&&$S(t)){let e=t.getValue().toLowerCase();return"start"===e?(this.lastFireTime=performance.now(),this.active=!0):"stop"===e?this.active=!1:e="none",s.setValue(new M(e)),this.fields.set(i,s),O.Instance}return super.set(e,t,n,r)}setCallback(e){this.jsCallback=e}checkFire(){const e=performance.now(),t=this.getFieldValueJS("duration"),n=this.getFieldValueJS("repeat");return!!(this.active&&(e-this.lastFireTime)/1e3>=t)&&(this.lastFireTime=e,this.active=n,this.fields.get("fire")?.setValue(O.Instance),this.jsCallback&&this.jsCallback(),!0)}}class IS extends Bf{name;defaultFields=[{name:"content",type:"node"},{name:"contentIsPlaylist",type:"boolean",value:"false"},{name:"nextContentIndex",type:"integer",value:"-1"},{name:"loop",type:"boolean",value:"false"},{name:"bufferingStatus",type:"assocarray"},{name:"control",type:"string",value:"none",alwaysNotify:!0},{name:"notificationInterval",type:"time",value:"0.5"},{name:"seek",type:"time"},{name:"contentIndex",type:"integer",value:"-1",alwaysNotify:!0},{name:"state",type:"string",value:"none",alwaysNotify:!0},{name:"position",type:"time",value:"0",alwaysNotify:!0},{name:"duration",type:"time",value:"0",alwaysNotify:!0},{name:"errorCode",type:"integer",value:"0"},{name:"errorMsg",type:"string",value:""},{name:"audioFormat",type:"string",value:""},{name:"autoplayAfterSeek",type:"boolean",value:"true"},{name:"mute",type:"boolean",value:"false"},{name:"streamInfo",type:"assocarray"},{name:"timeToStartStreaming",type:"time",value:"0"}];constructor(e=[],t="Audio"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),postMessage({audioPlaylist:new Array}),postMessage("audio,loop,false"),postMessage("audio,next,-1"),postMessage("audio,mute,false"),eS.setAudio(this)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("control"===i&&$S(t)){const e=["start","play","pause","resume","stop"],n=t.getValue().toLowerCase();e.includes(n)?(this.checkContentChanged(),postMessage(`audio,${n}`)):t=new M("none")}else if("seek"===i&&jS(t)){this.checkContentChanged();const e=cx(t);postMessage("audio,seek,"+1e3*e)}else if("notificationInterval"===i&&jS(t))postMessage(`audio,notify,${Math.round(1e3*cx(t))}`);else if("loop"===i&&WS(t))postMessage(`audio,loop,${t.toBoolean()}`);else if("mute"===i&&WS(t))postMessage(`audio,mute,${t.toBoolean()}`);else if(i==="contentIsPlaylist".toLowerCase()&&WS(t)){const e=this.getFieldValueJS("contentIsPlaylist"),n=t.toBoolean(),r=this.getFieldValue("content");e!==n&&r instanceof Zv&&postMessage({audioPlaylist:this.formatContent(r)})}else"content"===i&&t instanceof Zv&&postMessage({audioPlaylist:this.formatContent(t)});return super.set(e,t,n,r)}setState(e){let t="none";switch(e){case ke.LOADING:t="buffering";break;case ke.START_PLAY:case ke.START_STREAM:case ke.SELECTED:case ke.RESUMED:t="playing";break;case ke.PAUSED:t="paused";break;case ke.FULL:t="finished";break;case ke.FAILED:t="failed"}super.set(new M("state"),new M(t))}setContentIndex(e){super.set(new M("contentIndex"),new vh(e))}setDuration(e){super.set(new M("duration"),new mh(Math.round(e/1e3)))}setPosition(e){super.set(new M("position"),new mh(e/1e3))}checkContentChanged(){const e=this.getFieldValue("content");e instanceof Zv&&e.changed&&(postMessage({audioPlaylist:this.formatContent(e)}),e.changed=!1)}formatContent(e){const t=new Array;if(this.getFieldValueJS("contentIsPlaylist")){const n=e.getNodeChildren().filter(e=>e instanceof Bf);for(const e of n){const n=e.getFieldValueJS("url");n?.length&&n.startsWith("http")?t.push(uh.getCORSProxy(n)):n?.length&&t.push(n)}}else{const n=e.getFieldValueJS("url");n?.length&&n.startsWith("http")?t.push(uh.getCORSProxy(n)):n?.length&&t.push(n)}return t}}class kS extends Bf{name;defaultFields=[{name:"uri",type:"uri"},{name:"control",type:"string",value:"none",alwaysNotify:!0},{name:"state",type:"string",value:"none",alwaysNotify:!0},{name:"loadStatus",type:"string",value:"none",alwaysNotify:!0},{name:"volume",type:"integer",value:"50"}];uri;state;stream;audioId;constructor(e=[],t="SoundEffect"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.uri="",this.state="none",this.stream=-1,this.audioId=-1}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("control"===i&&$S(t)){const i=["play","stop"],s=t.getValue().toLowerCase();if(!i.includes(s)||this.audioId<0)return t=new M("none"),super.set(e,t,n,r);"play"===s?this.play():"stop"===s&&this.stop()}else if("uri"===i&&$S(t)){"playing"===this.state&&this.stop();const e=t.getValue().toLowerCase();this.setUri(e)}else if("volume"===i&&jS(t)&&(cx(t)<0||cx(t)>100))return O.Instance;return super.set(e,t,n,r)}getAudioId(){return this.audioId}getState(){return this.state}setState(e){switch(this.state="none",e){case ke.START_PLAY:this.state="playing";break;case ke.PARTIAL:this.state="stopped",this.stream=-1;break;case ke.FINISHED:this.state="finished",this.stream=-1;break;case ke.FAILED:this.state="notready";break;case ke.TOO_MANY:this.state="toomanysounds"}super.set(new M("state"),new M(this.state))}setUri(e){if(e.startsWith("pkg:")&&uh.fileSystem.existsSync(e)||e.startsWith("http")){this.uri=e;const t=uh.sfx.findIndex(t=>t===e);t>-1?this.audioId=t:(this.audioId=uh.sfx.length,postMessage(`sfx,new,${e},${this.audioId}`),uh.sfx.push(e)),super.set(new M("loadStatus"),new M("ready"))}else uh.isDevMode&&uh.stderr.write(`warning,Invalid sound effect URI: ${e}`),this.uri="",this.audioId=-1,super.set(new M("loadStatus"),new M("failed")),this.setState(ke.FAILED)}play(){const e=this.getFieldValueJS("volume");this.stream=uh.getSfxStream(this.audioId),-1===this.stream?(uh.isDevMode&&uh.stderr.write(`warning,No available sound effect streams for ${this.uri}`),this.setState(ke.TOO_MANY)):(eS.sfx[this.stream]=this,postMessage(`sfx,trigger,${this.uri},${e},${this.stream}`),this.setState(ke.START_PLAY))}stop(){postMessage(`sfx,stop,${this.uri}`),eS.sfx[this.stream]===this&&(eS.sfx[this.stream]=void 0),this.setState(ke.PARTIAL)}}class TS extends tS{name;defaultFields=[{name:"currentTimeMarkerBlendColor",type:"color",value:"0xffffffff"},{name:"textColor",type:"color",value:"0xfefefeff"},{name:"thumbBlendColor",type:"color",value:"0xffffffff"},{name:"filledBarBlendColor",type:"color",value:"0xffffffff"},{name:"liveFilledBarBlendColor",type:"color",value:"0xffffffff"},{name:"filledBarImageUri",type:"uri"},{name:"trackBlendColor",type:"color",value:"0xffffffff"},{name:"trackImageUri",type:"uri"}];barW;barH;backBack;barProgress;barTicker;position;remaining;bmpIcons;stateIcon;stateIconTimeout=-1;constructor(e=[],t="TrickPlayBar"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?(this.barH=18,this.barW=1716,this.remaining=this.addLabel("textColor",[1542,36],174,36,36,"top","right")):(this.barH=12,this.barW=1144,this.remaining=this.addLabel("textColor",[1028,24],116,24,24,"top","right"));const n=`common:/images/${this.resolution}/trickplaybar.9.png`;this.backBack=this.addPoster(n,[0,0],this.barW,this.barH),this.barProgress=this.addPoster(n,[0,0],1,this.barH),this.barTicker=this.addPoster(`common:/images/${this.resolution}/trickplayticker.png`,[0,0]),this.position=this.addLabel("textColor",[0,2*this.barH],0,2*this.barH),this.backBack.setFieldValue("opacity",new bh(.3)),this.barProgress.setFieldValue("visible",D.False),this.barProgress.setFieldValue("blendColor",new vh(1730004479)),this.barTicker.setFieldValue("visible",D.False),this.linkField(this.backBack,"blendColor","trackBlendColor"),this.linkField(this.backBack,"uri","trackImageUri"),this.linkField(this.barProgress,"blendColor","filledBarBlendColor"),this.linkField(this.barProgress,"uri","filledBarImageUri"),this.linkField(this.barTicker,"blendColor","currentTimeMarkerBlendColor"),this.setFieldValue("width",new vh(this.barW)),this.bmpIcons=new Map([["skip-right",this.loadBitmap(`common:/images/${this.resolution}/icon_skipAhead.png`)],["skip-left",this.loadBitmap(`common:/images/${this.resolution}/icon_skipBack.png`)],["replay",this.loadBitmap(`common:/images/${this.resolution}/icon_replay.png`)],["ff-x1",this.loadBitmap(`common:/images/${this.resolution}/icon_FFx1.png`)],["ff-x2",this.loadBitmap(`common:/images/${this.resolution}/icon_FFx2.png`)],["ff-x3",this.loadBitmap(`common:/images/${this.resolution}/icon_FFx3.png`)],["rw-x1",this.loadBitmap(`common:/images/${this.resolution}/icon_RWx1.png`)],["rw-x2",this.loadBitmap(`common:/images/${this.resolution}/icon_RWx2.png`)],["rw-x3",this.loadBitmap(`common:/images/${this.resolution}/icon_RWx3.png`)]])}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();return"textcolor"===i?(this.position.set(new M("color"),t),this.remaining.set(new M("color"),t)):"visible"===i&&t instanceof D&&this.getFieldValueJS("visible")!==t.toBoolean()&&postMessage({trickPlayBarVisible:t.toBoolean()}),super.set(e,t,n,r)}setPosition(e,t){if(this.position&&e>=0&&t>0){const n=t-e,r=e=>{const t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%60),i=`${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return t>0?`${t}:${i}`:i},i=r(e),s=r(n);this.position.setFieldValue("text",new M(i)),this.remaining.setFieldValue("text",new M(s));const a=e/t*this.backBack.getFieldValueJS("width");this.barProgress.setFieldValue("visible",D.from(a>this.barH)),this.barProgress.setFieldValue("width",new vh(a)),this.barTicker.setFieldValue("visible",D.True),this.barTicker.setTranslationX(Math.max(a-this.barH,0))}else this.barProgress.setFieldValue("visible",D.False),this.barTicker.setFieldValue("visible",D.False)}setStateIcon(e,t=-1){0===t&&(this.stateIcon=void 0,this.stateIconTimeout=0),this.stateIcon=this.bmpIcons.get(e),this.stateIcon&&(this.stateIconTimeout=t>0?Date.now()+t:-1)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation();s[0]+=t[0],s[1]+=t[1];const a=this.getDimensions(),o={x:s[0],y:s[1],width:a.width,height:a.height};if(r*=this.getOpacity(),this.updateBoundingRects(o,t,n),this.renderChildren(e,s,n,r,i),this.stateIcon&&(-1===this.stateIconTimeout||this.stateIconTimeout>Date.now())){const e={x:o.x+(a.width-this.stateIcon.width)/2,y:o.y+this.barH,width:this.stateIcon.width,height:this.stateIcon.height};this.drawImage(this.stateIcon,e,n,r,i)}this.updateParentRects(t,n)}}class _S extends tS{name;defaultFields=[{name:"content",type:"node"},{name:"playStartInfo",type:"assocarray"},{name:"licenseStatus",type:"assocarray"},{name:"contentIsPlaylist",type:"boolean",value:"false"},{name:"contentIndex",type:"integer",value:"-1",alwaysNotify:!0},{name:"nextContentIndex",type:"integer",value:"-1"},{name:"control",type:"string",value:"none"},{name:"asyncStopSemantics",type:"boolean",value:"false"},{name:"state",type:"string",value:"none"},{name:"errorCode",type:"integer",value:"0"},{name:"errorMsg",type:"string",value:""},{name:"errorStr",type:"string",value:""},{name:"errorInfo",type:"assocarray"},{name:"decoderStats",type:"assocarray"},{name:"enableDecoderStats",type:"boolean",value:"false"},{name:"playbackActionButtons",type:"array"},{name:"playbackActionButtonSelected",type:"integer",value:"0",alwaysNotify:!0},{name:"playbackActionButtonFocused",type:"integer",value:"0",alwaysNotify:!0},{name:"playbackActionButtonFocusedTextFont",type:"font",value:"font:SmallBoldSystemFont"},{name:"playbackActionButtonUnfocusedTextFont",type:"font",value:"font:SmallSystemFont"},{name:"playbackActionButtonFocusedTextColor",type:"color",value:"0x121212FF"},{name:"playbackActionButtonUnfocusedTextColor",type:"color",value:"0xEFEFEFFF"},{name:"playbackActionButtonFocusIndicatorBlendColor",type:"color"},{name:"subtitleSelectionPreferences",type:"assocarray"},{name:"audioSelectionPreferences",type:"assocarray"},{name:"duration",type:"time",value:"0",alwaysNotify:!0},{name:"loop",type:"boolean",value:"false"},{name:"position",type:"time",value:"0",alwaysNotify:!0},{name:"positionInfo",type:"assocarray"},{name:"clipId",type:"integer",value:"0"},{name:"notificationInterval",type:"time",value:"0.5"},{name:"seek",type:"time"},{name:"seekMode",type:"string",value:"default"},{name:"autoPlayAfterSeek",type:"boolean",value:"true"},{name:"timedMetaData",type:"assocarray"},{name:"timedMetaData2",type:"assocarray"},{name:"timedMetaDataSelectionKeys",type:"array"},{name:"streamInfo",type:"assocarray"},{name:"completedStreamInfo",type:"assocarray"},{name:"timeToStartStreaming",type:"time",value:"0"},{name:"bufferingStatus",type:"assocarray"},{name:"videoFormat",type:"string",value:""},{name:"pauseBufferStart",type:"time",value:"0"},{name:"pauseBufferEnd",type:"time",value:"0"},{name:"pauseBufferPosition",type:"time",value:"0"},{name:"pauseBufferOverflow",type:"boolean",value:"false"},{name:"pauseBufferEpochOffset",type:"double"},{name:"streamingSegment",type:"assocarray"},{name:"downloadedSegment",type:"assocarray"},{name:"enableLiveAvailabilityWindow",type:"boolean",value:"false"},{name:"enableThumbnailTilesDuringLive",type:"boolean",value:"false"},{name:"thumbnailTiles",type:"assocarray"},{name:"trickPlayBackgroundOverlay",type:"uri",value:""},{name:"enableUI",type:"boolean",value:"true"},{name:"enableTrickPlay",type:"boolean",value:"true"},{name:"bifDisplay",type:"node"},{name:"trickPlayBar",type:"node"},{name:"bufferingBar",type:"node"},{name:"bufferingTextColor",type:"color"},{name:"retrievingBar",type:"node"},{name:"retrievingTextColor",type:"color"},{name:"pivotNode",type:"node"},{name:"globalCaptionMode",type:"string",value:"Off"},{name:"suppressCaptions",type:"boolean",value:"false"},{name:"subtitleTrack",type:"string",value:""},{name:"currentSubtitleTrack",type:"string",value:""},{name:"availableSubtitleTracks",type:"array"},{name:"captionStyle",type:"assocarray"},{name:"mute",type:"boolean",value:"false"},{name:"audioTrack",type:"string",value:""},{name:"currentAudioTrack",type:"string",value:""},{name:"availableAudioTracks",type:"array"},{name:"seamlessAudioTrackSelection",type:"boolean",value:"false"},{name:"audioFormat",type:"string",value:""},{name:"supplementaryAudioVolume",type:"integer",value:"50"},{name:"cdnSwitch",type:"array"},{name:"MaxVideoDecodeResolution",type:"vector2d",value:"[0, 0]"},{name:"cgms",type:"integer",value:"0"},{name:"enableScreenSaverWhilePlaying",type:"boolean",value:"false"},{name:"disableScreenSaver",type:"boolean",value:"false"},{name:"contentBlocked",type:"boolean",value:"false"}];titleText;contentTitles;audioTracks=[];subtitleTracks=[];clockText;spinner;pausedIcon;trickPlayBar;backgroundOverlay;lastPressHandled;enableUI;enableTrickPlay;showHeader;showPaused;showTrickPlay;trickPlayPos;seekMode;seekLevel;seekTimeout;statusChanged;seeking;constructor(e=[],t="Video"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.enableUI=!0,this.enableTrickPlay=!0,this.backgroundOverlay=this.addPoster("common:/images/video_trickplay_overlay.png",[0,0],this.sceneRect.width,this.sceneRect.height),this.backgroundOverlay.setFieldValue("visible",D.False),this.linkField(this.backgroundOverlay,"uri","trickPlayBackgroundOverlay"),this.trickPlayBar=new TS,this.trickPlayBar.set(new M("visible"),D.False),this.spinner=new BS,this.spinner.setPosterUri(`common:/images/${this.resolution}/spinner.png`),this.spinner.setFieldValue("spinInterval",new bh(1)),this.spinner.setFieldValue("visible",D.False),this.spinner.set(new M("control"),new M("start")),this.appendChildToParent(this.spinner),"FHD"===this.resolution?(this.titleText=this.addScrollingLabel("",[102,60],1020,0,"LargeSystemFont"),this.clockText=this.addLabel("",[1644,60],174,36,36,"top","right"),this.spinner.setTranslation([900,480]),this.pausedIcon=this.addPoster("common:/images/FHD/video_pause.png",[902,483]),this.trickPlayBar.setTranslation([102,948])):(this.titleText=this.addScrollingLabel("",[68,40],680,0,"LargeSystemFont"),this.clockText=this.addLabel("",[1096,40],116,24,24,"top","right"),this.spinner.setTranslation([600,320]),this.pausedIcon=this.addPoster("common:/images/HD/video_pause.png",[602,322]),this.trickPlayBar.setTranslation([68,632])),this.contentTitles=[],this.clockText.setFieldValue("text",new M(uh.getTime()));const n=new ES;n.setCallback(()=>{this.clockText.set(new M("text"),new M(uh.getTime()))}),n.set(new M("repeat"),D.True),n.set(new M("control"),new M("start")),this.appendChildToParent(n),this.setFieldValue("trickPlayBar",this.trickPlayBar),this.appendChildToParent(this.trickPlayBar),this.showHeader=0,this.showPaused=0,this.showTrickPlay=0,this.seekMode="off",this.seekLevel=0,this.seekTimeout=0,this.trickPlayPos=-1,this.seeking=!1,this.statusChanged=!1,this.lastPressHandled="",this.showUI(!1),postMessage("video,loop,false"),postMessage("video,next,-1"),postMessage("video,mute,false"),postMessage("video,notify,500"),postMessage({videoPlaylist:new Array}),postMessage({supportCaptions:!0}),postMessage({captionMode:uh.deviceInfo.captionMode}),postMessage({captionStyle:new Array}),eS.setVideo(this)}get(e){if(!$S(e))throw new Error("RoSGNode indexes must be strings");return e.getValue().toLowerCase()==="globalCaptionMode".toLowerCase()?new M(uh.deviceInfo.captionMode):super.get(e)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("control"===i&&$S(t)){const e=["play","pause","resume","stop","replay","prebuffer","skipcontent"],n=t.getValue().toLowerCase();if(!e.includes(n))return uh.stderr.write(`warning,${Oe()} [sg.video.cntrl.bad] control field set to invalid value`),O.Instance;this.checkContentChanged(),postMessage(`video,${n}`)}else if("seek"===i&&jS(t)){this.checkContentChanged();const e=cx(t);postMessage("video,seek,"+1e3*e)}else if("notificationinterval"===i&&jS(t))postMessage(`video,notify,${Math.round(1e3*cx(t))}`);else if("loop"===i&&WS(t))postMessage(`video,loop,${t.toBoolean()}`);else if("mute"===i&&WS(t))postMessage(`video,mute,${t.toBoolean()}`);else if("audiotrack"===i&&$S(t))postMessage(`video,audio,${t.getValue()}`);else if("subtitletrack"===i&&$S(t))postMessage(`video,subtitle,${t.getValue()}`);else{if("contentisplaylist"===i&&WS(t)){const i=this.getFieldValueJS("contentIsPlaylist"),s=t.toBoolean();super.set(e,t,n,r);const a=this.getFieldValue("content");return i!==s&&a instanceof Zv&&this.resetContent(a),O.Instance}if("content"===i&&t instanceof Zv)this.resetContent(t);else if("enableui"===i&&WS(t))this.enableUI=t.toBoolean(),this.statusChanged=this.enableUI,this.enableUI||(this.spinner.setFieldValue("visible",D.False),this.showUI(!1));else if("enabletrickplay"===i&&WS(t))this.enableTrickPlay=t.toBoolean();else if("globalcaptionmode"===i&&$S(t)){const e=le(t.getValue());if(!e)return uh.stderr.write(`warning,${Oe()} [sg.video.mode.set.bad] globalCaptionMode set to bad value '${e}'`),O.Instance;uh.deviceInfo.captionMode=e,postMessage({captionMode:e})}else"captionstyle"===i&&t instanceof Fh&&this.setCaptionStyle(sx(t))}return super.set(e,t,n,r)}setState(e,t){const n=Date.now();this.statusChanged=!0;let r="none";switch(e){case ke.LOADING:return this.showUI(!1),this.resetSeeking(),this.showHeader=n+5e3,this.spinner.setFieldValue("visible",D.from(this.enableUI)),void this.setBufferingStatus(t);case ke.START_STREAM:case ke.RESUMED:r="playing",this.resetSeeking(),this.spinner.setFieldValue("visible",D.False),this.showUI(!1);break;case ke.PAUSED:r="paused",this.spinner.setFieldValue("visible",D.False),-1===this.trickPlayPos&&(this.showHeader=n+5e3,this.showTrickPlay=n+5e3,this.showPaused=n+2e3);break;case ke.PARTIAL:r="stopped";break;case ke.FINISHED:case ke.FULL:this.spinner.setFieldValue("visible",D.False),this.showUI(!1),r="finished";break;case ke.FAILED:this.setErrorFields(t),r="error",postMessage("video,error")}this.getFieldValue("bufferingStatus")instanceof Fh&&this.set(new M("bufferingStatus"),O.Instance),super.set(new M("state"),new M(r))}resetContent(e){postMessage({videoPlaylist:this.formatContent(e)}),this.contentTitles.length>0?this.setContentIndex(0):this.titleText.setFieldValue("text",new M("")),this.resetSeeking(),this.setFieldValue("currentAudioTrack",new M("")),this.setFieldValue("availableAudioTracks",new Kh([])),this.setFieldValue("currentSubtitleTrack",new M("")),this.setFieldValue("availableSubtitleTracks",new Kh([]))}setContentIndex(e){e>-1&&e<this.contentTitles.length&&(console.debug(`Video.setContentIndex: ${e}`,this.contentTitles[e]),this.titleText.set(new M("text"),new M(this.contentTitles[e]))),super.set(new M("contentIndex"),new vh(e))}setDuration(e){super.set(new M("duration"),new mh(e))}setPosition(e){const t=this.getFieldValueJS("duration")??0;e>=0&&t>0&&(this.trickPlayBar.setPosition(e,t),this.seeking&&(this.spinner.setFieldValue("visible",D.False),this.setState(ke.RESUMED,0),this.seeking=!1)),super.set(new M("position"),new mh(e))}setCurrentAudioTrack(e){if(e>=0&&e<this.audioTracks.length){const t=this.audioTracks[e];this.set(new M("currentAudioTrack"),new M(t.id))}}setAudioTracks(e){const t=[];if(this.audioTracks.length=0,e.length)for(const n of e){this.audioTracks.push(n);const e={Track:n.id,Language:n.lang,Name:n.name,Format:n.codec,HasAccessibilityDescription:!1,HasAccessibilityEAI:!1};t.push(nx(e))}this.set(new M("availableAudioTracks"),new Kh(t))}setCurrentSubtitleTrack(e){if(e>=0&&e<this.subtitleTracks.length){const t=this.subtitleTracks[e];this.set(new M("currentSubtitleTrack"),new M(t.id))}}setSubtitleTracks(e){const t=[];if(this.subtitleTracks.length=0,e.length)for(const n of e){this.subtitleTracks.push(n);const e={TrackName:n.id,Language:n.lang,Description:n.name,HasAccessibilityDescription:!1,HasAccessibilityCaption:!1,HasAccessibilitySign:!1};t.push(nx(e))}this.set(new M("availableSubtitleTracks"),new Kh(t))}setCaptionStyle(e){const t=[];for(const n in e){const r=n.toLowerCase();if(r.includes("/")&&ye.has(r)){const i=e[n];"string"==typeof i&&ye.get(r)?.includes(i.toLowerCase())?t.push({id:r,style:i.toLowerCase()}):uh.stderr.write(`warning,${Oe()} [sg.video.cap.val.err] caption style '${i}' is not a valid '${n}'. Using default.`)}else uh.stderr.write(`warning,${Oe()} [sg.video.cap.attr.err] caption style '${n}' is invalid`)}t.length>0?postMessage({captionStyle:t}):uh.stderr.write(`warning,${Oe()} [sg.video.cap.empty] caption style is empty or invalid. Using default.`)}setBufferingStatus(e){super.set(new M("state"),new M("buffering"));const t={percentage:e,isUnderrun:!1,prebufferDone:e>33,actualStart:0};this.set(new M("bufferingStatus"),nx(t))}setErrorFields(e){let t="",n={clipId:this.getFieldValueJS("contentIndex"),ignored:!1,source:"buffer:reader",category:"",errCode:e,dbgmsg:"",drmerrcode:0};switch(e){case Te.Http:t="Network or HTTP error",n.category="http";break;case Te.TimeOut:t="Connection timed out",n.category="http";break;case Te.Unknown:t="Unknown/unspecified or generic error",n.category="mediaplayer";break;case Te.EmptyList:t="Empty list; no streams were specified to play",n.category="mediaplayer";break;case Te.Unsupported:t="Media error; the media format is unknown or unsupported",n.category="mediaerror";break;case Te.DRM:t="DRM error",n.category="drm"}if(e<0&&t.length){n.dbgmsg=t;const r=`category:${n.category}:error:${e}:ignored:0:source:buffer:reader:message:${t}`;super.set(new M("errorCode"),new vh(e)),super.set(new M("errorMsg"),new M(t)),super.set(new M("errorStr"),new M(r)),super.set(new M("errorInfo"),nx(n))}}showUI(e){e||(this.showHeader=0,this.showPaused=0,this.showTrickPlay=0);const t=Date.now();this.backgroundOverlay.setFieldValue("visible",D.from(this.showHeader>t)),this.titleText.set(new M("visible"),D.from(this.showHeader>t)),this.clockText.setFieldValue("visible",D.from(this.showHeader>t)),this.pausedIcon.setFieldValue("visible",D.from(this.showPaused>t)),this.trickPlayBar.set(new M("visible"),D.from(this.showTrickPlay>t))}handleKey(e,t){if(!t&&this.lastPressHandled===e)return this.lastPressHandled="",!0;let n=!1;if("play"===e&&this.enableTrickPlay){const e=this.getFieldValueJS("state");"paused"===e?(this.trickPlayPos>=0?(postMessage("video,seek,"+1e3*this.trickPlayPos),this.trickPlayPos=-1,this.spinner.setFieldValue("visible",D.from(this.enableUI)),this.seeking=!0,this.showUI(!1)):postMessage("video,resume"),n=!0):"playing"===e&&(postMessage("video,pause"),n=!0)}else if("OK"===e&&this.enableTrickPlay){const e=Date.now();this.showHeader<e&&(this.showHeader=e+5e3,n=!0),this.trickPlayPos>=0&&(postMessage("video,seek,"+1e3*this.trickPlayPos),this.trickPlayPos=-1,this.spinner.setFieldValue("visible",D.from(this.enableUI)),this.showUI(!1),this.seeking=!0,n=!0)}else if("replay"===e&&this.enableTrickPlay){if("playing"===this.getFieldValueJS("state")){const e=this.getFieldValueJS("position");if(e>0){const t=Date.now();postMessage("video,seek,"+1e3*Math.max(0,e-20)),this.showHeader=t+1e3,this.showTrickPlay=t+1e3,this.trickPlayBar.setStateIcon("replay",500),n=!0}}}else"left"!==e&&"right"!==e||!this.enableTrickPlay?"rewind"!==e&&"fastforward"!==e||!this.enableTrickPlay||(n=this.handleRewFastForward(e)):n=this.handleLeftRight(e);return this.lastPressHandled=n?e:"",n}handleLeftRight(e){const t=this.getFieldValueJS("duration");if(t<=0)return!1;if("paused"!==this.getFieldValueJS("state")&&postMessage("video,pause"),this.trickPlayPos<0)this.seekMode="skip",this.seekLevel=1,this.seekTimeout=0,this.trickPlayPos=this.getFieldValueJS("position");else if("skip"!==this.seekMode)return this.seekMode="skip",this.seekLevel=1,this.seekTimeout=0,this.trickPlayBar.setStateIcon("",0),!0;return this.updateSeekStep("right"===e,t),this.trickPlayBar.setStateIcon(`skip-${e}`,500),!0}handleRewFastForward(e){const t=this.getFieldValueJS("duration");if(t<=0)return!1;"paused"!==this.getFieldValueJS("state")&&postMessage("video,pause");const n="rewind"===e?"rw":"ff";if(this.trickPlayPos<0)console.debug(`Video.handleRewFastForward: ${n} - start`),this.seekMode=n,this.seekLevel=1,this.trickPlayPos=this.getFieldValueJS("position");else if("skip"===this.seekMode)console.debug(`Video.handleRewFastForward: ${n} - from skip`),this.seekMode=n,this.seekLevel=1;else{if(this.seekMode!==n)return console.debug(`Video.handleRewFastForward: ${n} - different mode`),this.seekMode="skip",this.seekLevel=1,this.seekTimeout=0,this.trickPlayBar.setStateIcon("",0),!0;console.debug(`Video.handleRewFastForward: ${n} - same mode`),this.seekLevel=Math.min(3,this.seekLevel+1)}return this.updateSeekStep("ff"===n,t,Math.trunc(1e3/this.seekLevel)),this.trickPlayBar.setStateIcon(`${this.seekMode}-x${this.seekLevel}`),!0}updateSeekStep(e,t,n=0){const r=Date.now(),i=Math.min(10,Math.max(1,Math.trunc(t/30)))*Math.max(1,3*this.seekLevel-3);this.showHeader=r+3e4,this.showTrickPlay=r+3e4;const s=e?this.trickPlayPos+i:this.trickPlayPos-i;this.trickPlayPos=Math.max(0,Math.min(s,t)),this.trickPlayBar.setPosition(this.trickPlayPos,t),n>0&&(this.seekTimeout=r+n)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:o.width||this.sceneRect.width,height:o.height||this.sceneRect.height},l=n+this.getRotation();if(r*=this.getOpacity(),this.isDirty&&(postMessage(`video,rect,${c.x},${c.y},${c.width},${c.height}`),this.isDirty=!1),i?.doDrawClearedRect(c),this.statusChanged){if(this.seekTimeout>0&&this.seekTimeout<Date.now()&&["rw","ff"].includes(this.seekMode)){const e=this.getFieldValueJS("duration");this.updateSeekStep("ff"===this.seekMode,e,Math.trunc(1e3/this.seekLevel))}this.showUI(this.enableUI)}this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n)}resetSeeking(){this.seekMode="off",this.trickPlayPos=-1,this.seeking=!1,this.seekLevel=0,this.seekTimeout=0,this.trickPlayBar.setStateIcon("",0)}checkContentChanged(){const e=this.getFieldValue("content");e instanceof Zv&&e.changed&&(this.resetContent(e),e.changed=!1)}formatContent(e){const t=[];if(this.contentTitles.length=0,this.getFieldValueJS("contentIsPlaylist")){const n=e.getNodeChildren().filter(e=>e instanceof Bf);for(const e of n){const n=e.getFieldValueJS("url");if(n?.length){const r={url:n,streamFormat:e.getFieldValueJS("streamFormat"),audioTrack:-1};n.startsWith("http")&&(r.url=uh.getCORSProxy(n)),this.contentTitles.push(e.getFieldValueJS("title")??""),t.push(r)}}}else{const n=e.getFieldValueJS("url");if(n?.length){const r={url:n,streamFormat:e.getFieldValueJS("streamFormat"),audioTrack:-1};n.startsWith("http")&&(r.url=uh.getCORSProxy(n)),this.contentTitles.push(e.getFieldValueJS("title")??""),t.push(r)}}return t}}class CS extends yS{name;defaultFields=[{name:"textHorizAlign",type:"string",value:"left"},{name:"color",type:"color",value:"0xddddddff"},{name:"focusedColor",type:"color",value:"0x262626ff"},{name:"font",type:"font"},{name:"focusedFont",type:"font",value:"font:MediumBoldSystemFont"},{name:"numRows",type:"integer",value:"12"},{name:"numColumns",type:"integer",value:"1"},{name:"vertFocusAnimationStyle",type:"string",value:"fixedFocusWrap"}];focusUri="common:/images/focus_list.9.png";footprintUri="common:/images/focus_footprint.9.png";constructor(e=[],t="LabelList"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?this.setFieldValue("itemSize",rx([510,72])):this.setFieldValue("itemSize",rx([340,48])),this.setFieldValue("focusBitmapUri",new M(this.focusUri)),this.setFieldValue("focusFootprintBitmapUri",new M(this.footprintUri));const n=this.getFieldValueJS("vertFocusAnimationStyle");this.wrap="fixedfocuswrap"===n.toLowerCase(),this.numRows=this.getFieldValueJS("numRows"),this.numCols=this.getFieldValueJS("numColumns"),this.hasNinePatch=!0}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("vertfocusanimationstyle"===i){if(!["fixedfocuswrap","floatingfocus"].includes(t.toString().toLowerCase()))return O.Instance}else if(["horizfocusanimationstyle","numcolumns"].includes(i))return O.Instance;const s=super.set(e,t,n,r);return"content"===i||"vertfocusanimationstyle"===i?this.topRow=0:"numrows"===i&&this.clampTopRow(),s}handleUpDown(e){let t=!1;const n="up"===e?-1:1,r=this.getIndex(n);return r!==this.focusIndex&&(this.set(new M("animateToItem"),new vh(r)),t=!0,this.currRow+=this.wrap?0:n),t}handlePageUpDown(e){let t,n=!1;if(this.wrap){const n=Math.max(1,this.numRows-2),r="rewind"===e?-n:n;t=this.getIndex(r)}else t="rewind"===e?0:this.content.length-1,this.currRow="rewind"===e?0:this.numRows-1;return t!==this.focusIndex&&(this.set(new M("animateToItem"),new vh(t)),n=!0),n}renderContent(e,t,n,r,i){if(0===this.content.length)return;const s=this.metadata.length>0,a=eS.focused===this;this.currRow=this.updateListCurrRow();let o=-1;const c=Math.min(this.content.length,this.numRows),l=this.getFieldValueJS("itemSize"),u={...t,width:l[0],height:l[1]};let h=c+1;for(let e=0;e<c;e++){const t=this.getIndex(e-this.currRow),n=t===this.focusIndex,c=this.getContentItem(t);if(!s&&this.wrap&&t<o&&e>0)u.y+=this.renderWrapDivider(u,r,i);else if(s&&this.wrap&&this.metadata[t]?.divider&&e>0){const e=this.metadata[t].sectionTitle;u.y+=this.renderSectionDivider(e,u,r,h,i),h++}if(this.renderItem(t,c,u,r,a,n,i),u.y+=l[1]+1,o=t,!lw(this.sceneRect,u))break}this.updateRect(t,c,l)}renderItem(e,t,n,r,i,s,a){const o=["HDListItemIconUrl","HDListItemIconSelectedUrl"],c=t.getIconSize(o),l=t.getFieldValueJS("title"),u=c[0]>0?c[0]+this.gap:0,h=s?1:0,d=u>0?t.getBitmap(o[h]):void 0;s?this.renderFocused(e,l,n,r,i,u,!1,d,a):this.renderUnfocused(e,l,n,r,u,!1,d,a)}renderUnfocused(e,t,n,r,i,s,a,o){const c=this.getFieldValue("font"),l=this.getFieldValueJS("color"),u=this.getFieldValueJS("textHorizAlign"),h={...n,x:n.x+i,width:n.width-(i?this.gap:0)};a&&this.renderIcon(a,n,r,o,s?l:void 0),this.drawText(t,c,l,r,h,u,"center",0,o,"...",e)}renderFocused(e,t,n,r,i,s,a,o,c){const l=this.getFieldValue(i?"focusedFont":"font"),u=this.getFieldValueJS(i?"focusedColor":"color"),h=this.getFieldValueJS("textHorizAlign"),d={...n,x:n.x+s,width:n.width-(s?this.gap:0)},f=this.getFieldValueJS("drawFocusFeedback"),p=this.getFieldValueJS("drawFocusFeedbackOnTop");f&&!p&&this.renderFocus(n,r,i,c),o&&this.renderIcon(o,n,r,c,a?u:void 0),this.drawText(t,l,u,r,d,h,"center",0,c,"...",e),f&&p&&this.renderFocus(n,r,i,c),this.hasNinePatch=this.hasNinePatch&&f}renderIcon(e,t,n,r,i){const s=t.y+(t.height/2-e.height/2),a={...t,y:s,width:e.width,height:e.height};this.drawImage(e,a,0,n,r,i)}}class AS extends CS{name;defaultFields=[{name:"checkedState",type:"array"},{name:"checkOnSelect",type:"boolean",value:"true"},{name:"checkedIconUri",type:"uri",value:""},{name:"uncheckedIconUri",type:"uri",value:""},{name:"focusedCheckedIconUri",type:"uri",value:""},{name:"focusedUncheckedIconUri",type:"uri",value:""}];constructor(e=[],t="CheckList"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e);const n=`common:/images/${this.resolution}/icon_checkboxON.png`,r=`common:/images/${this.resolution}/icon_checkboxOFF.png`;this.setFieldValue("checkedIconUri",new M(n)),this.setFieldValue("uncheckedIconUri",new M(r)),this.setFieldValue("focusedCheckedIconUri",new M(n)),this.setFieldValue("focusedUncheckedIconUri",new M(r)),this.setFieldValue("checkedState",new Kh([]))}get(e){if(!$S(e))throw new Error("RoSGNode indexes must be strings");return"checkedstate"===e.getValue().toLowerCase()?this.refreshCheckedState():super.get(e)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");if("checkedstate"===e.getValue().toLowerCase()){let e=[],n=this.getFieldValue("checkedState");if(n instanceof Kh&&(e=cx(n)),!(t instanceof Kh&&t.elements.length))return O.Instance;for(let n=0;n<t.elements.length;n++){const r=t.elements[n];r.kind===T.Boolean&&(e[n]=r.getValue())}t=rx(e)}return super.set(e,t,n,r)}handleOK(e){if(!e)return!1;const t=this.getFieldValueJS("checkOnSelect"),n=this.getFieldValue("checkedState");if(t&&n instanceof Kh){const e=cx(n);e[this.focusIndex]=!e[this.focusIndex],this.set(new M("checkedState"),rx(e))}return this.set(new M("itemSelected"),new vh(this.focusIndex)),!0}renderItem(e,t,n,r,i,s,a){const o=this.getFieldValueJS("checkedState"),c=t.getFieldValueJS("hideIcon"),l=o[e]?["checkedIconUri","focusedCheckedIconUri"]:["uncheckedIconUri","focusedUncheckedIconUri"],u=this.getIconSize(l),h=t.getFieldValueJS("title"),d=u[0]>0?u[0]+this.gap:0,f=s?1:0,p=!c&&d>0?this.getBitmap(l[f]):void 0;s?this.renderFocused(e,h,n,r,i,d,!0,p,a):this.renderUnfocused(e,h,n,r,d,!0,p,a)}refreshCheckedState(){let e=[],t=this.getFieldValue("checkedState");t instanceof Kh&&(e=cx(t));const n=this.getFieldValue("content");if(n instanceof Zv){const t=n.getNodeChildren().length;e.length<t?e.length=t:e.length>t&&e.splice(t)}const r=rx(e);return this.setFieldValue("checkedState",r),r}}class FS extends CS{name;defaultFields=[{name:"checkedItem",type:"integer",value:"-1"},{name:"checkOnSelect",type:"boolean",value:"true"},{name:"checkedIconUri",type:"uri",value:""},{name:"focusedCheckedIconUri",type:"uri",value:""}];constructor(e=[],t="RadioButtonList"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e);const n=`common:/images/${this.resolution}/icon_checkmark.png`;this.setFieldValue("checkedIconUri",new M(n)),this.setFieldValue("focusedCheckedIconUri",new M(n))}handleOK(e){return!!e&&(cx(this.getFieldValue("checkOnSelect"))&&this.set(new M("checkedItem"),new vh(this.focusIndex)),this.set(new M("itemSelected"),new vh(this.focusIndex)),!0)}renderItem(e,t,n,r,i,s,a){const o=cx(t.getFieldValue("title")),c=cx(this.getFieldValue("checkedItem")),l=["checkedIconUri","focusedCheckedIconUri"],u=this.getIconSize(l),h=u[0]>0?u[0]+this.gap:0,d=s?1:0,f=e===c&&h>0?this.getBitmap(l[d]):void 0;s?this.renderFocused(e,o,n,r,i,h,!0,f,a):this.renderUnfocused(e,o,n,r,h,!0,f,a)}}class RS extends tS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"textColor",type:"color",value:"0xddddddff"},{name:"focusedTextColor",type:"color",value:"0x262626ff"},{name:"textFont",type:"font"},{name:"focusedTextFont",type:"font",value:"font:MediumBoldSystemFont"},{name:"focusBitmapUri",type:"uri",value:""},{name:"focusFootprintBitmapUri",type:"uri",value:""},{name:"iconUri",type:"uri",value:""},{name:"focusedIconUri",type:"uri",value:""},{name:"minWidth",type:"float",value:"250"},{name:"maxWidth",type:"float",value:"32767"},{name:"height",type:"float",value:"64"},{name:"showFocusFootprint",type:"boolean",value:"false"},{name:"buttonSelected",type:"boolean",value:"false",alwaysNotify:!0},{name:"focusable",type:"boolean",value:"true"}];static focusUri="common:/images/focus_list.9.png";static footprintUri="common:/images/focus_footprint.9.png";static iconUriHD="common:/images/HD/icon_generic.png";static iconUriFHD="common:/images/FHD/icon_generic.png";background;textLabel;icon;margin;gap;width;iconWidth;iconHeight;labelWidth;iconSize=[0,0];constructor(e=[],t="Button"){if(super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution){this.margin=36,this.gap=18,this.width=375,this.iconWidth=36,this.iconHeight=36,this.labelWidth=this.width-2*this.margin-this.iconWidth-this.gap,this.setFieldValue("height",new bh(96)),this.setFieldValue("minWidth",new bh(375)),this.setFieldValue("iconUri",new M(RS.iconUriFHD)),this.setFieldValue("focusedIconUri",new M(RS.iconUriFHD)),this.background=this.addPoster("",[0,0],this.width,96),this.icon=this.addPoster(RS.iconUriFHD,[this.margin,30],this.iconWidth,this.iconHeight);const e=[this.margin+this.iconWidth+this.gap,30];this.textLabel=this.addLabel("textColor",e,this.labelWidth,void 0,void 0,"center","right")}else{this.margin=24,this.gap=12,this.width=250,this.iconWidth=24,this.iconHeight=24,this.labelWidth=this.width-2*this.margin-this.iconWidth-this.gap,this.setFieldValue("height",new bh(64)),this.setFieldValue("minWidth",new bh(250)),this.setFieldValue("iconUri",new M(RS.iconUriHD)),this.setFieldValue("focusedIconUri",new M(RS.iconUriHD)),this.background=this.addPoster("",[0,0],this.width,64),this.icon=this.addPoster(RS.iconUriHD,[this.margin,20],this.iconWidth,this.iconHeight);const e=[this.margin+this.iconWidth+this.gap,20];this.textLabel=this.addLabel("textColor",e,this.labelWidth,void 0,void 0,"center","right")}this.setFieldValue("focusBitmapUri",new M(RS.focusUri)),this.setFieldValue("focusFootprintBitmapUri",new M(RS.footprintUri))}updateChildren(e){const t=this.getFieldValueJS("minWidth"),n=this.getFieldValueJS("maxWidth"),r=this.getFieldValueJS(e?"focusedIconUri":"iconUri");this.updateIconSize(r);const i=Math.max(this.iconWidth,this.iconSize[0]),s=i>0?i+this.gap:0,a=t-2*this.margin-s,o=n-2*this.margin-s,c=this.getFieldValueJS("text"),l=this.getFieldValue(e?"focusedTextFont":"textFont"),u=l.createDrawFont().measureText(c,o),h=Math.max(u.width,a);this.width=Math.max(h+2*this.margin+s,t),this.labelWidth=this.width-2*this.margin-s+1;const d=this.getFieldValueJS("height"),f=[this.margin+s,d/2-u.height/2],p=this.getFieldValueJS("showFocusFootprint")?"focusFootprintBitmapUri":"";if(e||p){const t=this.getFieldValue(e?"focusBitmapUri":p);this.background.set(new M("uri"),t)}else this.background.set(new M("uri"),new M(""));this.background.set(new M("width"),new bh(this.width)),this.background.set(new M("height"),new bh(d));const g=this.getFieldValue(e?"focusedTextColor":"textColor");this.textLabel.setTranslation(f),this.textLabel.set(new M("width"),new bh(this.labelWidth)),this.textLabel.set(new M("color"),g),this.textLabel.set(new M("font"),l),this.textLabel.set(new M("text"),new M(c));const m=[this.margin,d/2-this.iconHeight/2];this.icon.setTranslation(m),this.icon.set(new M("width"),new bh(this.iconWidth)),this.icon.set(new M("height"),new bh(this.iconHeight)),this.icon.set(new M("uri"),new M(r)),this.icon.set(new M("blendColor"),g)}updateIconSize(e){let t=0,n=0;if(e){const r=this.loadBitmap(e);r&&(t=r.width,n=r.height)}this.iconWidth=t,this.iconHeight=n}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=eS.focused===this,a=this.getTranslation(),o=0!==n?E(a,n):a.slice();o[0]+=t[0],o[1]+=t[1];const c=this.getDimensions(),l={x:o[0],y:o[1],width:c.width,height:Math.max(c.height,this.iconSize[1])},u=n+this.getRotation();r*=this.getOpacity(),this.isDirty&&(this.updateChildren(s),this.isDirty=!1),this.updateBoundingRects(l,t,n),this.renderChildren(e,o,u,r,i),this.updateParentRects(t,n)}}class MS extends cS{name;defaultFields=[{name:"textColor",type:"color",value:"0xddddddff"},{name:"focusedTextColor",type:"color",value:"0x262626ff"},{name:"textFont",type:"font"},{name:"focusedTextFont",type:"font",value:"font:MediumBoldSystemFont"},{name:"focusBitmapUri",type:"uri",value:""},{name:"focusFootprintBitmapUri",type:"string",value:""},{name:"iconUri",type:"uri",value:""},{name:"focusedIconUri",type:"uri",value:""},{name:"minWidth",type:"float",value:"0.0"},{name:"maxWidth",type:"float",value:"32767"},{name:"buttonHeight",type:"float",value:"0.0"},{name:"rightJustify",type:"boolean",value:"false"},{name:"buttonSelected",type:"integer",value:"0",alwaysNotify:!0},{name:"buttonFocused",type:"integer",value:"0",alwaysNotify:!0},{name:"focusButton",type:"integer",value:"0",alwaysNotify:!0},{name:"buttons",type:"array"}];margin;gap;vertOffset;width;iconSize=[0,0];lastPressHandled;focusIndex=0;wasFocused=!1;constructor(e=[],t="ButtonGroup"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.width=0,"FHD"===this.resolution?(this.margin=36,this.gap=18,this.vertOffset=18,this.iconSize=[36,36],this.setFieldValue("buttonHeight",new bh(75)),this.setFieldValue("iconUri",new M(RS.iconUriFHD)),this.setFieldValue("focusedIconUri",new M(RS.iconUriFHD))):(this.margin=24,this.gap=12,this.vertOffset=12,this.iconSize=[24,24],this.setFieldValue("buttonHeight",new bh(50)),this.setFieldValue("iconUri",new M(RS.iconUriHD)),this.setFieldValue("focusedIconUri",new M(RS.iconUriHD))),this.setFieldValue("focusBitmapUri",new M(RS.focusUri)),this.setFieldValue("focusFootprintBitmapUri",new M(RS.footprintUri)),this.setFieldValue("buttons",new Kh([])),this.lastPressHandled=""}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("focusbutton"===i){const e=this.getFieldValueJS("buttons"),n=cx(t);"number"==typeof n&&n>=0&&n<e.length&&(this.focusIndex=n,super.set(new M("buttonFocused"),t))}else"buttons"!==i||t instanceof Kh||(t=new Kh([]));return super.set(e,t,n,r),"buttons"===i&&(this.refreshButtons(),this.refreshFocus()),O.Instance}setNodeFocus(e,t){const n=super.setNodeFocus(e,t);return n&&this.refreshFocus(),n}handleKey(e,t){if(!t&&this.lastPressHandled===e)return this.lastPressHandled="",!0;let n=!1;if("up"===e||"down"===e){const r=this.getIndex("up"===e?-1:1);t&&r!==this.focusIndex&&(this.set(new M("focusButton"),new vh(r)),n=!0)}else"OK"===e&&t&&(this.set(new M("buttonSelected"),new vh(this.focusIndex)),n=!0);return this.lastPressHandled=n?e:"",n}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:this.width,height:o.height};this.refreshFocus(),this.isDirty&&(this.refreshButtons(),this.isDirty=!1);const l=n+this.getRotation();r*=this.getOpacity(),this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n)}refreshButtons(){const e=cx(this.getFieldValue("buttons"));if(!e)return;const t=Math.max(e.length,this.children.length),n=this.getFieldValue("focusedTextFont"),r=this.getFieldValueJS("buttonHeight");this.width=this.calculateButtonWidth(e,n.createDrawFont());for(let n=0;n<t;n++){const t=e[n];if(!t)break;{let e=this.children[n];e||(e=this.createButton()),e.iconSize=this.iconSize,e.setFieldValue("text",new M(t)),this.copyField(e,"textColor"),this.copyField(e,"focusedTextColor"),this.copyField(e,"textFont"),this.copyField(e,"focusedTextFont"),this.copyField(e,"focusBitmapUri"),this.copyField(e,"focusFootprintBitmapUri"),this.copyField(e,"iconUri"),this.copyField(e,"focusedIconUri"),this.copyField(e,"height","buttonHeight"),e.setFieldValue("minWidth",new bh(this.width)),this.copyField(e,"maxWidth"),e.setFieldValue("showFocusFootprint",D.from(this.focusIndex===n));const i=n*(Math.max(r,this.iconSize[1])-this.vertOffset),s=Math.max((this.iconSize[1]-r)/2,0);e.setFieldValue("translation",new Kh([new bh(0),new bh(i+s)]))}}this.children.splice(e.length)}createButton(){const e=new RS;for(let t of e.getNodeChildren())if(t instanceof hS){t.setFieldValue("horizAlign",new M("left"));break}return this.appendChildToParent(e),e}refreshFocus(){const e=eS.focused;if(this.children.length&&e instanceof Wh&&(e===this||e.getNodeParent()===this)){const t=this.children[this.focusIndex];e!==t&&t instanceof Wh&&eS.setFocused(t),this.wasFocused=!0}else this.wasFocused&&(this.wasFocused=!1,this.isDirty=!0)}calculateButtonWidth(e,t){const n=this.getFieldValueJS("minWidth"),r=this.getFieldValueJS("maxWidth");this.iconSize=this.getIconSize(["iconUri","focusedIconUri"]);const i=this.iconSize[0]>0?this.iconSize[0]+this.gap:0,s=r-2*this.margin-i;let a=n-2*this.margin-i;for(let n of e){const e=t.measureTextWidth(n,s);a=Math.max(e.width,a)}return Math.min(r,a+2*this.margin+i)}getIndex(e=0){const t=this.getFieldValueJS("buttonFocused")+e,n=this.getFieldValueJS("buttons");return t>=n.length?n.length-1:t<0?0:t}}class DS extends tS{name;defaultFields=[{name:"width",type:"float",value:"0.0"},{name:"height",type:"float",value:"0.0"},{name:"buttonSelected",type:"integer",value:"0",alwaysNotify:!0},{name:"buttonFocused",type:"integer",value:"0",alwaysNotify:!0},{name:"palette",type:"node"},{name:"close",type:"boolean",value:"false"},{name:"wasClosed",type:"boolean",value:"false",alwaysNotify:!0}];dialogBackgroundUri="common:/images/standard_dialog_background.9.png";dialogDividerUri="common:/images/dialog_divider.9.png";background;minHeight;maxWidth;width;height;dialogTrans;constructor(e=[],t="StandardDialog"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?(this.width=1038,this.maxWidth=1380,this.minHeight=270,this.dialogTrans=[531,492],this.background=this.addPoster(this.dialogBackgroundUri,[-90,-60],this.width,this.minHeight)):(this.width=692,this.maxWidth=920,this.minHeight=180,this.dialogTrans=[354,328],this.background=this.addPoster(this.dialogBackgroundUri,[-60,-40],this.width,this.minHeight)),this.height=this.minHeight,this.setTranslation(this.dialogTrans)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();return"close"===i?(e=new M("wasClosed"),t=D.True,this.set(new M("visible"),D.False),eS.scene?.dialog===this&&(eS.scene.dialog=void 0)):"width"===i&&(cx(t)>this.maxWidth&&(t=new M(this.maxWidth.toString())),this.width=cx(t),this.background.set(new M("width"),t)),super.set(e,t,n,r)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:this.width,height:o.height},l=this.getPaletteColors().get(new M("DialogBackgroundColor"));$S(l)&&this.background.set(new M("blendColor"),l),r*=this.getOpacity(),this.updateBoundingRects(c,t,n),this.renderChildren(e,a,n,r,i),this.updateParentRects(t,n)}getPaletteColors(){let e=this.getFieldValue("palette");if(e instanceof US||!eS.scene||(e=eS.scene.getFieldValue("palette")),e instanceof US){const t=e.getFieldValue("colors");if(t instanceof Fh)return t}return nx({DialogBackgroundColor:"0x6C6278FF"})}}class OS extends DS{name;defaultFields=[{name:"title",type:"string",value:""},{name:"message",type:"string",value:""}];progressItem;margin;screenWidth;constructor(e=[],t="StandardProgressDialog"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),"FHD"===this.resolution?(this.margin=180,this.screenWidth=1920):(this.margin=120,this.screenWidth=1280);const n=new NS;this.appendChildToParent(n);const r=new PS;this.progressItem=new LS,r.appendChildToParent(this.progressItem),this.appendChildToParent(r),this.linkField(this.progressItem,"text","message")}renderNode(e,t,n,r,i){const s=cx(this.getFieldValue("title")),a=cx(this.getFieldValue("message"));if(""===s){const e=cx(this.progressItem.getFieldValue("width"));this.set(new M("width"),new bh(e+this.margin)),this.setTranslationX((this.screenWidth-e)/2)}""===a&&this.set(new M("message"),new M(uh.getTerm("Please wait..."))),super.renderNode(e,t,n,r,i)}}class PS extends tS{name;constructor(e=[],t="StdDlgContentArea"){super([],t),this.name=t,this.registerInitializedFields(e)}}class NS extends tS{name;defaultFields=[{name:"primaryTitle",type:"string",value:""},{name:"primaryIcon",type:"uri"},{name:"primaryIconVertOffset",type:"float",value:"0.0"},{name:"secondaryIcon",type:"uri"},{name:"secondaryIconVertOffset",type:"float",value:"0.0"}];constructor(e=[],t="StdDlgTitleArea"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}}class LS extends tS{name;defaultFields=[{name:"text",type:"string",value:""},{name:"scrollable",type:"boolean",value:"false"}];spinner;label;gap;constructor(e=[],t="StdDlgProgressItem"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.spinner=new BS,this.gap="FHD"===this.resolution?30:20,this.spinner.setPosterUri(`common:/images/${this.resolution}/spinner.png`),this.spinner.set(new M("control"),new M("start")),this.appendChildToParent(this.spinner),this.label=new hS,this.appendChildToParent(this.label),this.linkField(this.label,"text")}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:o.width,height:o.height},l=this.getPaletteColors(),u=l.get(new M("DialogItemColor"));u instanceof M&&this.spinner.setBlendColor(u);const h=l.get(new M("DialogTextColor"));h instanceof M&&this.label.setFieldValue("color",h);const d=this.spinner.getDimensions(),f=this.label.getMeasured();if(d.width>0&&d.height>0){const e=[d.width+this.gap,(d.height-f.height)/2];this.label.setTranslation(e),c.width=d.width+f.width+this.gap,this.set(new M("width"),new bh(c.width))}else f.width>0&&f.height>0&&(c.width=f.width,this.set(new M("width"),new bh(c.width)));r*=this.getOpacity(),this.updateBoundingRects(c,t,n),this.renderChildren(e,a,n,r,i),this.updateParentRects(t,n)}getPaletteColors(){const e=this.getNodeParent();if(e instanceof PS){const t=e.getNodeParent();if(t instanceof DS)return t.getPaletteColors()}return new Fh([])}}class BS extends tS{name;defaultFields=[{name:"poster",type:"node"},{name:"control",type:"string",value:"none"},{name:"clockwise",type:"boolean",value:"true"},{name:"spinInterval",type:"float",value:"2.0"}];poster;active=!0;lastRenderTime=0;currentRotation=0;constructor(e=[],t="BusySpinner"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.poster=this.addPoster("",[0,0]),this.setFieldValue("poster",this.poster)}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("control"===i){let e=t.toString();"start"===e?(this.active=!0,this.lastRenderTime=Date.now()):"stop"===e?this.active=!1:t=new M("none")}else if("poster"===i){if(!(t instanceof pS))return O.Instance;this.removeChildByReference(this.poster),this.appendChildToParent(t),this.poster=t}return super.set(e,t,n,r)}setPosterUri(e){this.poster.set(new M("uri"),new M(e))}setBlendColor(e){e instanceof M&&this.poster.set(new M("blendColor"),e)}renderNode(e,t,n,r,i){if(!this.isVisible())return;const s=this.getTranslation(),a=0!==n?E(s,n):s.slice();a[0]+=t[0],a[1]+=t[1];const o=this.getDimensions(),c={x:a[0],y:a[1],width:o.width,height:o.height},l=n+this.getRotation();r*=this.getOpacity();const u=this.poster.getBitmap("uri");if(u?.isValid()&&(this.poster.setFieldValue("scaleRotateCenter",new Kh([new bh(u.width/2),new bh(u.height/2)])),o.width!==u.width&&(c.width=u.width,this.setFieldValue("width",new bh(u.width))),o.height!==u.height&&(c.height=u.height,this.setFieldValue("height",new bh(u.height))),this.active)){0===this.lastRenderTime&&(this.lastRenderTime=Date.now());const e=Date.now(),t=this.getFieldValueJS("spinInterval"),n=this.getFieldValueJS("clockwise")?-1:1,r=(e-this.lastRenderTime)/1e3,i=2*Math.PI*r/(t??2);this.currentRotation+=n*i;const s=this.currentRotation+l;this.poster.set(new M("rotation"),new bh(s)),this.lastRenderTime=e}this.updateBoundingRects(c,t,l),this.renderChildren(e,a,l,r,i),this.updateParentRects(t,n)}}class US extends Bf{name;defaultFields=[{name:"colors",type:"assocarray"}];constructor(e=[],t="RSGPalette"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e)}}class VS extends Bf{name;defaultFields=[{name:"command",type:"string"},{name:"requestedUserData",type:"string",value:"all"},{name:"requestedUserDataInfo",type:"node"},{name:"userData",type:"node",alwaysNotify:!0},{name:"userRegionData",type:"node",alwaysNotify:!0},{name:"order",type:"node"},{name:"deltaOrder",type:"assocarray"},{name:"requestPartnerOrder",type:"node"},{name:"confirmPartnerOrder",type:"node"},{name:"orderStatus",type:"node",alwaysNotify:!0},{name:"purchases",type:"node",alwaysNotify:!0},{name:"catalog",type:"node",alwaysNotify:!0},{name:"storeCatalog",type:"node",alwaysNotify:!0},{name:"requestPartnerOrderStatus",type:"node",alwaysNotify:!0},{name:"confirmPartnerOrderStatus",type:"node",alwaysNotify:!0},{name:"fakeServer",type:"boolean",value:"false"},{name:"nonce",type:"string"},{name:"deviceAttestationToken",type:"node",alwaysNotify:!0}];channelStore;constructor(e=[],t="ChannelStore"){super([],t),this.name=t,this.registerDefaultFields(this.defaultFields),this.registerInitializedFields(e),this.channelStore=new cp}set(e,t,n=!1,r){if(!$S(e))throw new Error("RoSGNode indexes must be strings");const i=e.getValue().toLowerCase();if("order"===i){const e=[];t instanceof Zv&&e.push(ox(t)),this.channelStore.setNewOrder(e)}else if("deltaorder"===i){if(t instanceof Fh){const e=t.get(new M("delta")),n=t.get(new M("qty"));$S(e)&&jS(n)&&this.channelStore.setDeltaOrder(e.getValue(),cx(n))}}else i==="fakeServer".toLowerCase()&&WS(t)&&this.channelStore.setFakeServer(t.toBoolean());return super.set(e,t,n,r),"command"===i&&$S(t)&&""!==t.getValue()&&this.handleCommand(t.getValue().toLowerCase()),O.Instance}handleCommand(e){switch(e){case"getuserdata":case"getuserregiondata":this.setUserData(e,"getuserdata"===e?"userData":"userRegionData");break;case"getcatalog":case"getstorecatalog":this.setStoreData("GetCatalog","getcatalog"===e?"catalog":"storeCatalog");break;case"getpurchases":case"getallpurchases":this.setStoreData("GetPurchases","purchases");break;case"doorder":this.doOrder();break;case"getdeviceattestationtoken":{const e=new Zv;e.setFieldValue("status",new vh(1)),e.setFieldValue("nonce",this.getFieldValue("nonce")),e.setFieldValue("token",this.channelStore.getAttestationToken()),super.set(new M("deviceAttestationToken"),e);break}default:uh.stderr.write(`warning,[ChannelStore] Invalid or unhandled 'command': ${e}`)}}setStoreData(e,t){const n=new Zv,r={code:-4,message:"Empty List"},i=this.channelStore.getProductData(e,r);n.setFieldValue("status",new vh(r.code)),n.setFieldValue("message",new M(r.message));for(const e of i)n.appendChildToParent(ax(e));super.set(new M(t),n)}setUserData(e,t){const n=new Zv,r=this.getFieldValueJS("fakeServer");r?("getuserdata"===e?(n.setFieldValue("email",new M("johm.doe@email.com")),n.setFieldValue("firstName",new M("John")),n.setFieldValue("lastName",new M("Doe")),n.setFieldValue("gender",new M("Male")),n.setFieldValue("birth",new M("1970-01")),n.setFieldValue("phone",O.Instance)):r&&"getuserregiondata"===e&&(n.setFieldValue("state",new M("CA")),n.setFieldValue("zip",new M("90210")),n.setFieldValue("country",new M("USA"))),super.set(new M(t),n)):super.set(new M(t),O.Instance)}doOrder(){const e=new Zv,t={code:-3,message:"Invalid Order"},n=this.channelStore.placeOrder(t);e.setFieldValue("status",new vh(t.code)),e.setFieldValue("message",new M(t.message));for(const t of n)e.appendChildToParent(ax(t));super.set(new M("orderStatus"),e)}}function jS(e){return e instanceof vh||e instanceof ph||e instanceof bh||e instanceof mh}const zS=new Set([T.Int32,T.Float,T.Double,T.Int64]);function GS(e){return zS.has(e)}const HS=new Set([T.Uninitialized,T.Invalid,T.Boolean,...zS,T.String,T.Callable]);function $S(e){return e?.kind===T.String||e instanceof md}function WS(e){return e?.kind===T.Boolean||e instanceof bd}function qS(e){return e?.kind===T.Callable}function XS(e){return"get"in e&&"getElements"in e&&"set"in e&&"hasNext"in e&&"getNext"in e&&"resetNext"in e}function YS(e){return jS(e)||JS(e)||e instanceof _d}function KS(e){return $S(e)||e instanceof yd||e instanceof Td}function JS(e){return e instanceof wh||e instanceof yh||e instanceof gh||e instanceof fh}function ZS(e){return jS(e)||JS(e)}function QS(e){return e instanceof Td||e instanceof _d||e instanceof Cd||e instanceof Ad||e instanceof Fd||e instanceof Rd||e instanceof Md||e instanceof Dd||e instanceof Od||e instanceof Pd||e instanceof Nd||e instanceof Ld||e instanceof Bd}function ex(e){return WS(e)||$S(e)||jS(e)||e===O.Instance||e instanceof L||e instanceof N||e instanceof Ch||e instanceof P}const tx=["YYYY-MM-DDTHH:mm:ss.SSS[Z]","YYYY-MM-DDTHH:mm:ss.SSS","YYYY-MM-DDTHH:mm:ss[Z]","YYYY-MM-DDTHH:mm:ss","YYYY-MM-DDTHH:mm[Z]","YYYY-MM-DDTHH:mm","YYYY-MM-DDTHH[Z]","YYYY-MM-DDTHH","YYYY-MM-DDT","YYYY-MM-DD[Z]","YYYY-MM-DD","YYYY-MM[Z]","YYYY-MM","YYYY[Z]","YYYY"];function nx(e,t,n){const r=new Fh([],t);if(e instanceof Map)for(const[i,s]of e)r.set(new M(i),rx(s,t,n),!0);else{if("object"!=typeof e||null===e)throw new Error("Unsupported input type: "+typeof e);for(const i in e)e.hasOwnProperty(i)&&r.set(new M(i),rx(e[i],t,n),!0)}return r}function rx(e,t,n){if(null==e)return O.Instance;const r=2147483648,i=typeof e;switch(i){case"boolean":return D.from(e);case"string":return new M(e);case"number":return Number.isInteger(e)?e>=-r&&e<r?new vh(e):new ph(e):Number.isNaN(e)||e>=-34e37&&e<=34e37?new bh(e):new mh(e);case"object":return function(e,t,n){if(ex(e))return e;if(null===e)return O.Instance;if(e instanceof Uint8Array)return new gd(e);if(Array.isArray(e))return new Kh(e.map(function(e){return rx(e,t,n)}));if(e._node_||e._circular_){const t=e._node_?e._node_.split(":"):e._circular_.split(":");return 2===t.length?ix(e,t[0],t[1],n):O.Instance}if(e._component_){const t=e._component_,n=Jv.get(t);if(n)try{return n()}catch(e){return O.Instance}return O.Instance}return e._interface_?O.Instance:e._callable_?new Ch(e._callable_,{signature:{args:[new kh("arg",T.Dynamic,O.Instance)],variadic:!0,returns:T.Void},impl:(e,...t)=>P.Instance}):nx(e,t,n)}(e,t,n);case"undefined":return P.Instance;default:throw new Error(`brsValueOf not implemented for: ${e} <${i}>`)}}function ix(e,t,n,r){if(r??=new Map,e._circular_&&e._address_)return r.get(e._address_)||O.Instance;const i=Dh.createNode(t,n)??new Bf([],n);i.address=e._address_||i.address,i.owner=e._owner_??i.owner,r.set(i.address,i);for(const t in e)t.startsWith("_")&&t.endsWith("_")&&t.length>2||i.setFieldValue(t,rx(e[t],void 0,r));if(e._children_)for(const t of e._children_)if(t._node_||t._circular_){const e=t._node_?t._node_.split(":"):t._circular_.split(":"),n=ix(t,e[0],e[1],r);i.appendChildToParent(n)}else void 0!==t._invalid_&&i.appendChildToParent(O.Instance);return i}function sx(e,t=!0){const n={};for(const[r,i]of e.elements)ae(i)?n[r]=cx(i.unbox(),t):n[r]=cx(i,t);return n}function ax(e){const t=new Zv;for(const[n,r]of e.elements)t.setFieldValue(n,r);return t}function ox(e){const t=new Fh([],!0);for(const[n,r]of e.getNodeFields())t.set(new M(n),r.getValue(!1));return t}function cx(e,t=!0,n){switch(ae(e)&&(e=e.unbox()),e.kind){case T.Invalid:return null;case T.Uninitialized:return;case T.Boolean:return e.toBoolean();case T.String:return e.value;case T.Int32:case T.Float:case T.Double:return e.getValue();case T.Int64:return e.getValue().toNumber();case T.Interface:case T.Object:if(e instanceof Kh||e instanceof td)return e.elements.map(e=>cx(e,t,n));if(e instanceof gd)return e.elements;if(e instanceof Bf)return lx(e,t,n);if(e instanceof Fh)return sx(e,t);if(e instanceof L)return{_component_:e.getComponentName()};if(e instanceof N)return{_interface_:e.getInterfaceName()};break;case T.Callable:return{_callable_:e.name}}}function lx(e,t=!0,n){if(n??=new WeakSet,n.has(e))return{_circular_:`${$h(e.nodeSubtype)}:${e.nodeSubtype}`,_address_:e.address};n.add(e);const r={},i=e.getNodeFields(),s=[];r._node_=`${$h(e.nodeSubtype)}:${e.nodeSubtype}`,r._address_=e.address,r._owner_=e.owner;for(const[a,o]of i)if(!o.isHidden()){let i=o.getValue(!1);if(ae(i)&&(i=i.unbox()),e instanceof Vf&&o.isPortObserved(e)&&s.push(a),i instanceof Bf){r[a]=lx(i,t,n);continue}r[a]=cx(i,t,n)}s.length&&(r._observed_=s);const a=e.getNodeChildren();return t&&a.length>0&&(r._children_=a.map(e=>e instanceof Bf?lx(e,t,n):{_invalid_:null})),r}function ux(e){return e.equalTo(O.Instance).toBoolean()}function hx(e){const t=e.trim();if(!t)return null;const n=/^([+-]?)(\d+\.?\d*|\.\d+)([eE][+-]?\d+)?$/.exec(t);if(!n)return null;const[,r,i,s]=n,a=Number.parseFloat(t);if(!Number.isFinite(a))return null;if(!i.includes(".")&&!s)return 0;let o=i,c=0,l=!1;for(const e of o)"."!==e&&("0"!==e||l)&&(c++,l=!0);return c}const dx=new Ch("RebootSystem",{signature:{args:[],returns:T.Void},impl:()=>(postMessage("reset"),O.Instance)}),fx=new Ch("RunGarbageCollector",{signature:{args:[],returns:T.Object},impl:()=>nx({COUNT:0,ORPHANED:0,ROOT:0})}),px=new Ch("GetInterface",{signature:{args:[new kh("object",T.Object),new kh("ifname",T.String)],returns:T.Interface},impl:(e,t,n)=>t.interfaces.get(n.value.toLowerCase())||O.Instance}),gx=new Ch("FindMemberFunction",{signature:{args:[new kh("object",T.Object),new kh("funName",T.String)],returns:T.Interface},impl:(e,t,n)=>{if(t instanceof L)for(let[e,r]of t.interfaces)if(r.hasMethod(n.value))return r;return O.Instance}},{signature:{args:[new kh("object",T.Interface),new kh("funName",T.String)],returns:T.Interface},impl:(e,t,n)=>t.hasMethod(n.value)?t:O.Instance}),mx=new Ch("ObjFun",{signature:{args:[new kh("object",T.Object),new kh("iface",T.Interface),new kh("funName",T.String)],variadic:!0,returns:T.Dynamic},impl:(e,t,n,r,...i)=>{for(let[s,a]of t.interfaces)if(n.name===a.name&&n.hasMethod(r.value)){const n=t.getMethod(r.value);return n?.call(e,...i)||O.Instance}e.addError(new J(Z.MemberFunctionNotFound,e.location,e.stack.slice(0,-1)))}}),yx=new Ch("CreateObject",{signature:{args:[new kh("objName",T.String)],variadic:!0,returns:T.Dynamic},impl:(e,t,...n)=>{const r=Jv.get(t.value.toLowerCase());if(void 0===r){const n=`BRIGHTSCRIPT: ERROR: Runtime: unknown classname "${t.value}": ${e.formatLocation()}`;uh.stderr.write(`warning,${n}`)}else{const i=Jv.params(t.value.toLowerCase());if(-1===i)n=[];else{if(i>0&&0===n.length)return uh.stderr.write(`error,BRIGHTSCRIPT: ERROR: Runtime: "${t.value}": invalid number of parameters: ${e.formatLocation()}`),O.Instance;i>=0&&n.length!==i&&e.addError(new J(Z.RoWrongNumberOfParams,e.location,e.stack.slice(0,-1)))}try{return r(e,...n)}catch(t){uh.stderr.write(`error,${t.message} ${e.formatLocation()}`)}}return O.Instance}}),bx=new Ch("CopyFile",{signature:{args:[new kh("source",T.String),new kh("destination",T.String)],returns:T.Boolean},impl:(e,t,n)=>{const r=uh.fileSystem;try{if(!ah(n.value)||!r.existsSync(t.value))return D.False;const e=r.readFileSync(t.value);return r.writeFileSync(n.value,e),D.True}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Copying '${t.value}' to '${n.value}': ${e.message}`),D.False}}}),wx=new Ch("MoveFile",{signature:{args:[new kh("source",T.String),new kh("destination",T.String)],returns:T.Boolean},impl:(e,t,n)=>{const r=uh.fileSystem;try{return ah(t.value)&&ah(n.value)&&ih(t.value)===ih(n.value)&&r.existsSync(t.value)?(r.renameSync(t.value,n.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Moving '${t.value}' to '${n.value}': ${e.message}`),D.False}}}),vx=new Ch("DeleteFile",{signature:{args:[new kh("file",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=uh.fileSystem;try{return ah(t.value)?(n.unlinkSync(t.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Deleting '${t.value}': ${e.message}`),D.False}}}),Sx=new Ch("DeleteDirectory",{signature:{args:[new kh("dir",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=uh.fileSystem;try{return ah(t.value)?(n.rmdirSync(t.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Deleting '${t.value}': ${e.message}`),D.False}}}),xx=new Ch("CreateDirectory",{signature:{args:[new kh("dir",T.String)],returns:T.Boolean},impl:(e,t)=>{const n=uh.fileSystem;try{return ah(t.value)?(n.mkdirSync(t.value),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Creating '${t.value}': ${e.message}`),D.False}}}),Ex=new Ch("FormatDrive",{signature:{args:[new kh("drive",T.String),new kh("fs_type",T.String)],returns:T.Boolean},impl:(e,t)=>(uh.isDevMode&&uh.stderr.write("warning,`FormatDrive` is not implemented in `brs-engine`."),D.False)}),Ix=new Ch("ListDir",{signature:{args:[new kh("path",T.String)],returns:T.Object},impl:(e,t)=>{const n=uh.fileSystem;try{if(sh(t.value)){if(n.existsSync(t.value)){const e=n.readdirSync(t.value).map(e=>new M(e));return new td(e)}}else uh.stderr.write(`warning,*** ERROR: Missing or invalid PHY: '${t.value}'`)}catch(e){uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Listing '${t.value}': ${e.message}`)}return new td([])}}),kx=new Ch("ReadAsciiFile",{signature:{args:[new kh("filepath",T.String)],returns:T.String},impl:(e,t)=>{const n=uh.fileSystem;try{return sh(t.value)?new M(n.readFileSync(t.value,"utf8")):new M("")}catch(n){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Reading '${t.value}': ${n.message}`),uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: ReadAsciiFile: file open for read failed: ${e.formatLocation()}`),new M("")}}}),Tx=new Ch("WriteAsciiFile",{signature:{args:[new kh("filepath",T.String),new kh("text",T.String)],returns:T.Boolean},impl:(e,t,n)=>{const r=uh.fileSystem;try{return ah(t.value)?(r.writeFileSync(t.value,n.value,"utf8"),D.True):D.False}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Writing '${t.value}': ${e.message}`),D.False}}}),_x=new Ch("MatchFiles",{signature:{args:[new kh("path",T.String),new kh("pattern_in",T.String)],returns:T.Object},impl:(e,t,n)=>{const r=uh.fileSystem;try{if(!sh(t.value))return new td([]);let e=r.readdirSync(t.value),i=Dv.match(e,n.value,{nocase:!0,nodupes:!0,noglobstar:!0,nonegate:!0});return i=(i||[]).map(e=>new M(e)),new td(i)}catch(e){return uh.isDevMode&&uh.stderr.write(`warning,*** ERROR: Matching '${t.value}' with '${n.value}': ${e.message}`),new td([])}}});function Cx(e,t=0,n=""){switch(e.kind){case T.Invalid:return"null";case T.String:return function(e,t){return t?`"${e.replace(/[\u007F-\uFFFF]/g,e=>`\\u${e.charCodeAt(0).toString(16).padStart(4,"0").toUpperCase()}`)}"`:`"${e}"`}(e.toString(),!(1&t));case T.Boolean:case T.Double:case T.Float:case T.Int32:case T.Int64:return e.toString();case T.Object:if(e instanceof Fh)return`{${e.getElements().map(r=>`"${n=r.toString()}":${Cx(e.get(r),t,n)}`).join(",")}}`;if(e instanceof Kh)return`[${e.getElements().map(e=>Cx(e,t,n)).join(",")}]`;if(ae(e))return Cx(e.unbox(),t,n);case T.Callable:case T.Uninitialized:case T.Interface:}let r=e instanceof L?e.getComponentName():e;if(256&t)return"null";if(512&t)return`"<${r}>"`;let i=`Value type not supported: ${r}`;throw""!==n&&(i=`${n}: ${i}`),new Error(i)}function Ax(e,t,n){uh.stderr.write(`warning,BRIGHTSCRIPT: ERROR: ${t}: ${n.message}: ${e.formatLocation()}`)}const Fx=new Ch("FormatJson",{signature:{returns:T.String,args:[new kh("x",T.Dynamic),new kh("flags",T.Int32,new vh(0))]},impl:(e,t,n)=>{try{return new M(Cx(t,n.getValue()))}catch(t){return t instanceof RangeError&&(t=new Error("Nested object reference")),Ax(e,"FormatJSON",t),new M("")}}}),Rx=new Ch("ParseJson",{signature:{returns:T.Dynamic,args:[new kh("jsonString",T.String),new kh("flags",T.String,new M(""))]},impl:(e,t,n)=>{try{const r=t.value.trim();if(""===r)throw new Error("Data is empty");const i=n.value;i.length>0&&!["i","d","id","di"].includes(i)&&Ax(e,"ParseJSON",new Error(`Invalid options in '${i}'`));const s=JSON.parse(r,(t,n,r)=>"number"!=typeof n?n:"number"!=typeof n||Number.isFinite(n)?function(e,t,n){const r=0x8000000000000000n,i=hx(n.source)??0;if(Number.isInteger(e)&&!Number.isSafeInteger(e)){if(/[.eE]/.test(n.source))return mh.fromString(n.source);{const e=BigInt(n.source);return e>=-r&&e<r?ph.fromString(n.source):bh.fromString(n.source)}}return"number"==typeof e&&i>0?i>6&&t.includes("d")?mh.fromString(n.source):bh.fromString(n.source):e}(n,i,r):(Ax(e,"ParseJSON",new Error(`Invalid number: ${n}`)),new Pv));return rx(s,!i.includes("i"))}catch(t){return Ax(e,"ParseJSON",t),O.Instance}}}),Mx=new Ch("Abs",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.abs(t.getValue()))}),Dx=new Ch("Cdbl",{signature:{args:[new kh("x",T.Int32)],returns:T.Float},impl:(e,t)=>new bh(t.getValue())}),Ox=new Ch("Cint",{signature:{args:[new kh("x",T.Dynamic)],returns:T.Int32},impl:(e,t)=>{if(ae(t)&&(t=t.unbox()),jS(t))return Bx(t,"round");e.addError(new J(Z.TypeMismatch,e.location,e.stack.slice(0,-1)))}}),Px=new Ch("Csng",{signature:{args:[new kh("x",T.Int32)],returns:T.Float},impl:(e,t)=>new bh(t.getValue())}),Nx=new Ch("Fix",{signature:{args:[new kh("x",T.Dynamic)],returns:T.Int32},impl:(e,t)=>{if(ae(t)&&(t=t.unbox()),jS(t))return Bx(t,"trunc");e.addError(new J(Z.TypeMismatch,e.location,e.stack.slice(0,-1)))}}),Lx=new Ch("Int",{signature:{args:[new kh("x",T.Dynamic)],returns:T.Int32},impl:(e,t)=>{if(ae(t)&&(t=t.unbox()),jS(t))return Bx(t);e.addError(new J(Z.TypeMismatch,e.location,e.stack.slice(0,-1)))}});function Bx(e,t="floor"){if(e.kind===T.Float||e.kind===T.Double)return new vh("round"===t?Math.round(e.getValue()):"trunc"===t?Math.trunc(e.getValue()):Math.floor(e.getValue()));if(e.kind===T.Int64){const t=2147483648;return e.getValue().lessThan(t)&&e.getValue().greaterThan(-t)?new vh(e.getValue()):e.getValue().greaterThan(t-1)?new vh(t-1):new vh(-t)}return e}function Ux(e,t){let n=t.getValue();return new vh(n>0?1:n<0?-1:0)}const Vx=new Ch("Sgn",{signature:{args:[new kh("x",T.Float)],returns:T.Int32},impl:Ux},{signature:{args:[new kh("x",T.Int32)],returns:T.Int32},impl:Ux}),jx=new Ch("Atn",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.atan(t.getValue()))}),zx=new Ch("Cos",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.cos(t.getValue()))}),Gx=new Ch("Sin",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.sin(t.getValue()))}),Hx=new Ch("Tan",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.tan(t.getValue()))}),$x=new Ch("Exp",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.exp(t.getValue()))}),Wx=new Ch("Log",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.log(t.getValue()))}),qx=new Ch("Sqr",{signature:{args:[new kh("x",T.Float)],returns:T.Float},impl:(e,t)=>new bh(Math.sqrt(t.getValue()))}),Xx=new Ch("Rnd",{signature:{args:[new kh("range",T.Int32)],returns:T.Dynamic},impl:(e,t)=>0===t.getValue()?new bh(Math.random()):new vh(Math.floor(Math.random()*t.getValue()+1))}),Yx=new Ch("Tab",{signature:{args:[new kh("position",T.Int32)],returns:T.String},impl:(e,t)=>{const n=t.getValue(),r=uh.stdout.position();if(n<0||n<r)return new M("");const i=n-r;return new M(i<=0?"":" ".repeat(i))}}),Kx=new Ch("Pos",{signature:{args:[new kh("dummy",T.Dynamic)],returns:T.Int32},impl:e=>new vh(uh.stdout.position())});function Jx(e,t,n){try{const r=new RE(e.options);for(const[t,n]of e.manifest)r.manifest.set(t,n);const i=new Map;for(const e of t)uh.fileSystem.existsSync(e.value)&&i.set(e.value,uh.fileSystem.readFileSync(e.value,"utf8"));if(0!==i.size){const e=GE(uh.fileSystem,r.manifest,i);return r.exec(e.statements,i,...n)[0]||O.Instance}}catch(e){}return O.Instance}const Zx=new Ch("Run",...Ch.variadic({signature:{args:[new kh("filename",T.String)],returns:T.Dynamic},impl:(e,t,...n)=>Jx(e,[t],n)}),...Ch.variadic({signature:{args:[new kh("filenameArray",T.Object)],returns:T.Dynamic},impl:(e,t,...n)=>t instanceof Kh&&t.getElements().every($S)?Jx(e,t.getElements(),n):O.Instance})),Qx=new Ch("UCase",{signature:{args:[new kh("s",T.String)],returns:T.String},impl:(e,t)=>new M(t.value.toUpperCase())}),eE=new Ch("LCase",{signature:{args:[new kh("s",T.String)],returns:T.String},impl:(e,t)=>new M(t.value.toLowerCase())}),tE=new Ch("Asc",{signature:{args:[new kh("letter",T.String)],returns:T.Int32},impl:(e,t)=>0===t.value.length?new vh(0):new vh(t.value.codePointAt(0)??0)}),nE=new Ch("Chr",{signature:{args:[new kh("ch",T.Int32)],returns:T.String},impl:(e,t)=>{const n=t.getValue(),r=n<=0||n>1114111?"":String.fromCodePoint(n);return new M(r)}}),rE=new Ch("Left",{signature:{args:[new kh("s",T.String),new kh("n",T.Int32)],returns:T.String},impl:(e,t,n)=>n.getValue()<=0?new M(""):new M(t.value.slice(0,n.getValue()))}),iE=new Ch("Right",{signature:{args:[new kh("s",T.String),new kh("n",T.Int32)],returns:T.String},impl:(e,t,n)=>n.getValue()<=0?new M(""):new M(t.value.slice(-n.getValue()))}),sE=new Ch("Instr",{signature:{args:[new kh("start",T.Int32),new kh("str",T.String),new kh("search",T.String)],returns:T.String},impl:(e,t,n,r)=>new vh(n.value.indexOf(r.value,t.getValue()-1)+1)},{signature:{args:[new kh("str",T.String),new kh("search",T.String)],returns:T.String},impl:(e,t,n)=>new vh(t.value.indexOf(n.value)+1)}),aE=new Ch("Len",{signature:{args:[new kh("s",T.String)],returns:T.Int32},impl:(e,t)=>new vh(t.value.length)}),oE=new Ch("Mid",{signature:{args:[new kh("s",T.String),new kh("p",T.Int32)],returns:T.String},impl:(e,t,n)=>{let r=n.getValue()-1;return new M(t.value.substring(r))}},{signature:{args:[new kh("s",T.String),new kh("p",T.Int32),new kh("n",T.Int32)],returns:T.String},impl:(e,t,n,r)=>{const i=n.getValue()-1,s=r.getValue();return new M(s<=0?"":t.value.substring(i,i+s))}}),cE=new Ch("Str",{signature:{args:[new kh("value",T.Float)],returns:T.String},impl:(e,t)=>{const n=t.getValue();return new M((n>=0?" ":"")+String(n))}}),lE=new Ch("StrI",{signature:{args:[new kh("value",T.Int32),new kh("radix",T.Int32,new vh(10))],returns:T.String},impl:(e,t,n)=>{let r=n.getValue();if(r<2||r>36)return new M("");const i=t.getValue();return new M((i>=0&&10===r?" ":"")+i.toString(r))}}),uE=new Ch("String",{signature:{args:[new kh("n",T.Int32),new kh("str",T.String)],returns:T.String},impl:(e,t,n)=>{const r=t.getValue();return new M(r<=0?"":n.value.repeat(r))}}),hE=new Ch("StringI",{signature:{args:[new kh("n",T.Int32),new kh("ch",T.Int32)],returns:T.String},impl:(e,t,n)=>{const r=t.getValue();if(r<=0)return new M("");const i=n.getValue(),s=i<=0||i>1114111?"":String.fromCodePoint(i);return new M(s.repeat(r))}}),dE=new Ch("Substitute",{signature:{args:[new kh("str",T.String),new kh("arg0",T.String),new kh("arg1",T.String,new M("")),new kh("arg2",T.String,new M("")),new kh("arg3",T.String,new M(""))],returns:T.String},impl:(e,t,n,r,i,s)=>{let a=[n,r,i,s].reduce((e,t,n)=>{const r=new RegExp(`\\{${n}\\}|\\^${n}`,"g");return e.replace(r,t.value)},t.value);return new M(a)}}),fE=new Ch("Val",{signature:{args:[new kh("s",T.String),new kh("radix",T.Int32,O.Instance)],returns:T.Dynamic},impl:(e,t,n)=>{if(t.value.includes(".")||n instanceof O){const e=Number(t.value);return Number.isNaN(e)?new bh(0):new bh(e)}{const e=Number.parseInt(t.value,n.getValue());return Number.isNaN(e)?new vh(0):new vh(e)}}}),pE=new Ch("StrToI",{signature:{args:[new kh("s",T.String)],returns:T.Int32},impl:(e,t)=>{let n=Number.parseInt(t.value);return Number.isNaN(n)?new vh(0):new vh(n)}}),gE=new Ch("type",{signature:{args:[new kh("variable",T.Dynamic),new kh("version",T.Int32,new vh(2))],returns:T.String},impl:(e,t,n)=>{switch(t.kind){case T.Object:return new M(t.getComponentName());case T.Interface:return new M(t.name);default:{const e=3!==n.getValue()&&se(t)&&t.inArray;return new M(T.toString(t.kind,e))}}}}),mE=new Ch("Box",{signature:{args:[new kh("value",T.Dynamic)],returns:T.Object},impl:(e,t)=>se(t)?t.box():t}),yE=new Ch("UpTime",{signature:{args:[new kh("dummy",T.Int32)],returns:T.Float},impl:e=>{const t=uh.deviceInfo.startTime,n=(Date.now()-t)/1e3;return new bh(Math.round(100*n+Number.EPSILON)/100)}}),bE=new Ch("GetGlobalAA",{signature:{args:[],returns:T.Dynamic},impl:e=>e.environment.getRootM()}),wE=new Ch("Sleep",{signature:{args:[new kh("timeout",T.Int32)],returns:T.Void},impl:(e,t)=>{let n=t.getValue();for(n+=performance.now();performance.now()<n;);return O.Instance}}),vE=new Ch("Wait",{signature:{args:[new kh("timeout",T.Int32),new kh("port",T.Object)],returns:T.Dynamic},impl:(e,t,n)=>n.wait(e,t.getValue())}),SE=new Ch("Tr",{signature:{args:[new kh("source",T.String)],returns:T.String},impl:(e,t)=>{let n=e.translations.get(t.value);return n?new M(n):t}});function xE(e,t="[Function]"){const n=new Ch(t,{signature:{args:e.parameters,returns:e.returns},impl:(t,...n)=>{t.environment.gotoLabel="";let r=e.location,i=!1;for(;!i;)try{for(const n of e.body.statements)t.execute(n);i=!0}catch(e){if(!(e instanceof Hd))throw e;t.environment.gotoLabel=e.label.toLowerCase(),r=e.location}if(""!==t.environment.gotoLabel&&t.addError(new J(Z.MissingLineNumber,r,t.stack.slice(0,-1))),e.returns!==T.Void&&e.returns!==T.Dynamic){const n=Sh(new vh(0),e.returns);return n||t.addError(new ee({message:"Unable to cast",left:{type:e.returns,location:e.location},right:{type:T.Int32,location:e.location},cast:!0})),n}return O.Instance}});return n.setLocation(e.location),n}function EE(e,t,n,r,i){for(function(e,t,n,r,i){const s=Me(e.sourceMap.get(t.file))??[""];let a="BrightScript Micro Debugger.\r\n",o=t.start.line;if(e.stepMode){const e=s[o-1]?.trimEnd()??"";uh.stdout.write(`print,${o.toString().padStart(3,"0")}: ${e}\r\n`)}else{postMessage("debug,stop"),a+="Enter any BrightScript statement, debug commands, or HELP\r\n\r\n",a+="\r\nCurrent Function:\r\n";let t=Math.max(o-8,1),c=Math.min(o+5,s.length);for(let e=t;e<c;e++){const t=e===o?"*":" ",n=s[e-1]?.trimEnd()??"";a+=`${e.toString().padStart(3,"0")}:${t} ${n}\r\n`}a+="Source Digest(s):\r\n",a+=`pkg: dev ${e.getChannelVersion()} 5c04534a `,a+=`${e.manifest.get("title")||"brs"}\r\n\r\n`,a+=`${r??"STOP"} (runtime error &h${i?Re(i):"f7"}) in ${e.formatLocation()}`,a+="\r\nBacktrace: \r\n",uh.stdout.write(`print,${a}`),uh.stdout.write(`print,${e.formatBacktrace(n)}`),uh.stdout.write("print,Local variables:\r\n"),uh.stdout.write(`print,${e.formatVariables()}`)}}(e,n,t,r,i);;){let i="";i=IE();const s=CE(i);if(s.cmd!==Ie.EXPR){switch(s.cmd){case Ie.CONT:if(r){uh.stdout.write("print,Can't continue");continue}return e.stepMode=!1,e.debugMode=!1,postMessage("debug,continue"),!0;case Ie.STEP:if(r){uh.stdout.write("print,Can't continue");continue}return e.stepMode=!0,e.debugMode=!0,!0;case Ie.EXIT:return!1}_E(e,t,n,s.cmd)}else kE(e,s.expr)}}function IE(e){let t="";uh.stdout.write("print,\r\nBrightscript Debugger> "),Atomics.wait(uh.sharedArray,ve.DBG,-1);const n=Atomics.load(uh.sharedArray,ve.DBG);return Atomics.store(uh.sharedArray,ve.DBG,-1),n===Ie.EXPR&&(t=uh.readDataBuffer()),t}async function kE(e,t){const n=new Ff,r=new Lf;if(e.debugMode=!1,0===t.trim().length)return;const i=n.scan(`${t}\n`,"debug");if(i.errors.length>0)return void uh.stderr.write(`error,${i.errors[0].message}\r\n`);const s=r.parse(i.tokens);if(s.errors.length>0)uh.stderr.write(`error,${s.errors[0].message}\r\n`);else for(const t of s.statements)TE(e,t)}function TE(e,t){try{t instanceof Wd?e.visitAssignment(t):t instanceof ff?e.visitDottedSet(t):t instanceof pf?e.visitIndexedSet(t):t instanceof rf?e.visitPrint(t):t instanceof Yd?e.visitExpression(t):t instanceof nf?e.visitIncrement(t):t instanceof tf?e.visitIf(t):t instanceof uf?e.visitFor(t):t instanceof hf?e.visitForEach(t):t instanceof df?e.visitWhile(t):t instanceof ef?e.visitNamedFunction(t):uh.stderr.write("warning,Debug command/expression not supported!\r\n")}catch(e){let t=e.message;e instanceof K&&(t=e.format()),uh.stderr.write(`error,${t}\r\n`)}}function _E(e,t,n,r){const i=e.stack,s=Me(e.sourceMap.get(n.file))??[""],a=Me(e.sourceMap.get(t.file))??[""];let o=n.start.line,c=t.start.line,l="",u="";switch(r){case Ie.BT:u=`print,${e.formatBacktrace(t)}`;break;case Ie.HELP:u=`print,${function(){let e="";return e+="Command List:\r\n",e+="   bt              Print backtrace of call function context frames\r\n",e+="   classes         List public classes\r\n",e+="   cont|c          Continue script execution\r\n",e+="   exit|quit|q     Exit shell\r\n",e+="   last|l          Show last line that executed\r\n",e+="   next|n          Show the next line to execute\r\n",e+="   list            List current function\r\n",e+="   bscs            Summarize BrightScript Component instances\r\n",e+="   stats           Shows statistics\r\n",e+="   step|s|t        Step one program statement\r\n",e+="   thread|th       Show selected thread\r\n",e+="   threads|ths     List all threads of execution\r\n",e+="   over|v          Step over one program statement (for now act as step)\r\n",e+="   out|o           Step out from current function (for now act as step)\r\n",e+="   var             Display local variables and their types/values\r\n",e+="   print|p|?       Print variable value or expression\r\n\r\n",e+="   Type any expression for a live compile and run, in the context\r\n",e+="   of the current function.  Put the 'stop' statement in your code\r\n",e+="   to trigger a breakpoint.  Then use 'c', 's', or other commands.\r\n","Command List:\r\n   bt              Print backtrace of call function context frames\r\n   classes         List public classes\r\n   cont|c          Continue script execution\r\n   exit|quit|q     Exit shell\r\n   last|l          Show last line that executed\r\n   next|n          Show the next line to execute\r\n   list            List current function\r\n   bscs            Summarize BrightScript Component instances\r\n   stats           Shows statistics\r\n   step|s|t        Step one program statement\r\n   thread|th       Show selected thread\r\n   threads|ths     List all threads of execution\r\n   over|v          Step over one program statement (for now act as step)\r\n   out|o           Step out from current function (for now act as step)\r\n   var             Display local variables and their types/values\r\n   print|p|?       Print variable value or expression\r\n\r\n   Type any expression for a live compile and run, in the context\r\n   of the current function.  Put the 'stop' statement in your code\r\n   to trigger a breakpoint.  Then use 'c', 's', or other commands.\r\n"}()}`;break;case Ie.LAST:l=s[o-1]?.trimEnd()??"",u=`print,${o.toString().padStart(3,"0")}: ${l}\r\n`;break;case Ie.LIST:u=`print,${function(e,t,n){let r="";if(e.length>0){const i=e[e.length-1],s=i.functionLocation.start.line,a=Math.min(i.functionLocation.end.line,t.length);for(let e=s;e<=a;e++){const i=e===n?"*":" ",s=t[e-1].trimEnd();r+=`${e.toString().padStart(3,"0")}:${i} ${s}\r\n`}}return r}(i,a,t.file===n.file?o:c)}`;break;case Ie.NEXT:l=a[c-1]?.trimEnd()??"",u=`print,${c.toString().padStart(3,"0")}: ${l}\r\n`;break;case Ie.THREAD:l=s[o-1]?.trim()??"",u="print,Thread selected: ",u+=` 0*   ${e.formatLocation(t).padEnd(40)}${l}\r\n`;break;case Ie.THREADS:l=s[o-1]?.trim()??"",u="print,ID    Location                                Source Code\r\n",u+=` 0*   ${e.formatLocation(t).padEnd(40)}${l}\r\n`,u+="  *selected\r\n";break;case Ie.BSCS:{const e=Array.from(zI.keys()).sort();let t=0;u="print,";for(const n of e){const e=zI.get(n);e&&(u+=`${n}: `.padStart(27),u+=`count=${e}\r\n`,t+=e)}u+="Total # components: ".padStart(27),u+=`${t}\r\n`;break}case Ie.STATS:u=`print,${e.formatStats()}`;break;case Ie.CLASSES:u=`print,${Jv.keys().sort().join("\r\n")}\r\n`;break;case Ie.VAR:u=`print,${e.formatVariables()}`;break;case Ie.BREAK:u="warning,Micro Debugger already running!\r\n";break;case Ie.PAUSE:break;default:u="warning,Invalid Debug command/expression!\r\n"}u.length&&uh.stdout.write(u)}function CE(e){let t={cmd:Ie.EXPR,expr:""};if(e?.length){const n=new Map([["bscs",Ie.BSCS],["bt",Ie.BT],["classes",Ie.CLASSES],["cont",Ie.CONT],["c",Ie.CONT],["exit",Ie.EXIT],["q",Ie.EXIT],["quit",Ie.EXIT],["help",Ie.HELP],["last",Ie.LAST],["l",Ie.LAST],["list",Ie.LIST],["next",Ie.NEXT],["n",Ie.NEXT],["over",Ie.STEP],["out",Ie.STEP],["step",Ie.STEP],["stats",Ie.STATS],["s",Ie.STEP],["t",Ie.STEP],["thread",Ie.THREAD],["th",Ie.THREAD],["threads",Ie.THREADS],["ths",Ie.THREADS],["var",Ie.VAR],["break",Ie.BREAK],["pause",Ie.PAUSE]]);let r=e.trim().split(/(?<=^\S+)\s/),i=n.get(r[0].toLowerCase());if(void 0!==i&&1===r.length)t.cmd=i;else{let n=e.toString().trim();"p"===r[0].toLowerCase()&&(n="? "+n.slice(1)),t.expr=n}}return t}var AE=__webpack_require__(9907);const FE={entryPoint:!1,stopOnCrash:!1,stdout:AE.stdout,stderr:AE.stderr,post:!0};class RE{_stack=new Array;_startTime=Date.now();_creationTime="2025-11-15T00:21:16.289Z";_environment;_sourceMap=new Map;_runParams;_tryMode=!1;_dotLevel=0;_printed=!1;location={file:"",start:{line:0,column:0},end:{line:0,column:0}};static InternalLocation={file:"(internal)",start:{line:-1,column:-1},end:{line:-1,column:-1}};options=FE;manifest=new Map;translations=new Map;events=new v.EventEmitter;errors=[];get environment(){return this._environment}get sourceMap(){return this._sourceMap}get runParams(){return this._runParams}get stack(){return this._stack}get startTime(){return this._startTime}get creationTime(){return this._creationTime}debugMode=!1;stepMode=!1;lastStmt=null;addToStack(e){this._stack.push(e)}setManifest(e){uh.singleKeyEvents=!0,uh.useCORSProxy=!0;for(const[t,n]of e.entries())this.manifest.set(t,n),"multi_key_events"===t.toLowerCase()?uh.singleKeyEvents="1"!==n.trim():"cors_proxy"===t.toLowerCase()&&(uh.useCORSProxy="0"!==n.trim());uh.sfx.length=0,uh.sfx.push(...Ce.slice())}onError(e){return this.events.on("err",e),{dispose:()=>{this.events.removeListener("err",e)}}}onErrorOnce(e){this.events.once("err",e)}constructor(e){this._environment=new ie(new Fh([])),Object.assign(this.options,e),uh.stdout=new ch(this.options.stdout,this.options.post),uh.stderr=new ch(this.options.stderr,this.options.post),this.options.root&&uh.fileSystem.setRoot(this.options.root),this.options.ext&&uh.fileSystem.setExt(this.options.ext);const t=new Set,n=Object.keys(y).map(e=>y[e]).filter(e=>e instanceof Ch).filter(e=>{if(!e.name)throw new Error("Unnamed standard library function detected!");return!!e.name});for(const e of n)this._environment.define(ne.Global,e.name??"",e),e.name&&kf.has(e.name)&&t.add(e.name);this._environment.define(ne.Global,"global",new N("ifGlobal",t))}inSubEnv(e,t){let n,r=this._environment,i=t??this._environment.createSubEnvironment();try{this._environment=i;const t=e(this);return this._environment=r,t}catch(e){throw this._tryMode||!this.options.stopOnCrash||e instanceof Ud?e instanceof $d&&e.value instanceof L&&(n=e.value,n.setReturn(!0)):r=this._environment,this._environment=r,e}finally{i.removeReferences(),n?.setReturn(!1)}}exec(e,t,...n){t&&(this._sourceMap=t);let r=e.map(e=>this.execute(e));try{let e="RunUserInterface",t=this.getCallableFunction(e.toLowerCase());if(t.kind!==T.Callable&&(e="Main",t=this.getCallableFunction(e.toLowerCase())),t.kind===T.Callable){let i=new Y({kind:wf.Identifier,text:e.toLowerCase(),isReserved:!1,location:RE.InternalLocation});n.length>0&&n[0]instanceof Fh&&(this._runParams=n[0]),0===t.signatures[0].signature.args.length&&(n=[]),postMessage(`start,${i.name.text}`),r=[this.visitCall(new U(i,i.name,n.map(e=>new $(e,i.location))))]}else this.options.entryPoint&&!this._printed&&postMessage("warning,WARNING! No entry point found! You may need to define a function Main() or RunUserInterface()")}catch(e){if(!(e instanceof $d)){if(e instanceof K){const t=this.formatBacktrace(e.location,!0,e.backTrace);throw new Error(`${e.format()}\nBackTrace:\n${t}`,{cause:e})}throw e}r=[e.value??O.Instance]}return r}execTask(e){const t=e.taskData,n=Bh(this,t),r=t.m?.top?.functionname;if(!(n instanceof Vf&&r))return;t.buffer&&n.setTaskBuffer(t.buffer);const i=eS.nodeDefMap.get(n.nodeSubtype.toLowerCase()),s=i?.environment;if(s)try{const e=n.m;this.inSubEnv(i=>{const s=i.getCallableFunction(r);if(i.environment.hostNode=n,i.environment.setM(e),i.environment.setRootM(e),s instanceof Ch){console.debug("[Worker] Task function called: ",t.name,r),s.call(i),console.debug("[Worker] Task function finished: ",t.name,r);const e={id:n.id,type:"task",field:"control",value:"stop"};postMessage(e),t.state=be.STOP,postMessage(t)}else this.addError(new K(`Cannot found the Task function '${r}'`,this.location));return O.Instance},s)}catch(e){if(!(e instanceof $d)){if(e instanceof K){const t=this.formatBacktrace(e.location,!0,e.backTrace);throw new Error(`${e.format()}\nBackTrace:\n${t}`,{cause:e})}throw e}}}getCallableFunction(e,t){let n=new Y({kind:wf.Identifier,text:e,isReserved:!1,location:t??RE.InternalLocation}),r=this.evaluate(n);return r.kind===T.Callable?r:O.Instance}visitLibrary(e){return O.Instance}visitNamedFunction(e){if(e.name.isReserved&&this.addError(new K(`Cannot create a named function with reserved name '${e.name.text}'`,e.name.location)),this.environment.has(e.name,[ne.Module])){const t=this.environment.getDefinedLocation(e.name.text);t&&!Ef.equalTo(t,e.location)&&this.addError(new K(`Attempting to declare function '${e.name.text}' at ${e.location.file}, but it already exists in this scope from ${t.file}`,e.name.location))}else this.environment.define(ne.Module,e.name.text,xE(e.func,e.name.text),e.location);return O.Instance}visitReturn(e){if(!e.value)throw new $d(e.tokens.return.location);const t=this.evaluate(e.value);throw new $d(e.tokens.return.location,t)}visitExpression(e){return this.evaluate(e.expression)}visitPrint(e){this._printed=!0,this.environment.define(ne.Function,"Tab",Yx);let t="";for(const[n,r]of e.expressions.entries())if(If(r))switch(r.kind){case wf.Comma:{const e=" ".repeat(16-uh.stdout.position()%16);t+=e,uh.stdout.position(e);break}case wf.Semicolon:break;default:this.addError(new K(`Found unexpected print separator '${r.text}'`,r.location))}else{const e=this.evaluate(r),n=YS(e)&&this.isPositive(e.getValue())?" "+e.toString():e.toString();t+=n,uh.stdout.position(n)}const n=e.expressions.at(-1);return n&&If(n)&&n.kind===wf.Semicolon||(t+="\r\n"),uh.stdout.write(`print,${t}`),this.environment.remove("Tab"),O.Instance}visitStop(e){return this.debugMode=!0,this.stepMode=!1,this.checkDebugger(e),O.Instance}visitAssignment(e){e.name.isReserved&&this.addError(new K(`Cannot assign a value to reserved name '${e.name.text}'`,e.name.location));let t=this.evaluate(e.value),n=e.name.text;const r={$:T.String,"%":T.Int32,"!":T.Float,"#":T.Double,"&":T.Int64}[n.at(-1)??""];if(r){const n=Sh(t,r);n?t=n:this.addError(new ee({message:"Unable to cast",left:{type:r,location:e.name.location},right:{type:t,location:e.value.location},cast:!0}))}try{this.environment.define(ne.Function,e.name.text,t,e.name.location)}catch(e){this.addError(e)}return O.Instance}visitDim(e){if(e.name.isReserved)return this.addError(new K(`Cannot assign a value to reserved name '${e.name.text}'`,e.name.location)),O.Instance;let t=[];for(const n of e.dimensions){let e=this.evaluate(n);JS(e)&&(e=e.unbox()),e.kind!==T.Int32&&e.kind!==T.Float&&this.addError(new J(Z.NonNumericArrayIndex,n.location)),t.push(e.getValue()+1)}let n=(e=0)=>{let r=[],i=t[e];for(let s=0;s<i;s++)if(e<t.length){let t=n(e+1);void 0!==t&&r.push(t)}return new Kh(r)},r=n();try{this.environment.define(ne.Function,e.name.text,r,e.name.location)}catch(e){this.addError(e)}return O.Instance}visitBinary(e){let t=e.token.kind,n=this.evaluate(e.left),r=O.Instance;function i(e,t,n){return e.kind===T.Invalid||n.kind===T.Invalid?t===wf.Equal||t===wf.LessGreater:(e.kind<T.Dynamic||ae(e)||R(e))&&(n.kind<T.Dynamic||ae(n)||R(n))}switch(t!==wf.And&&t!==wf.Or&&(r=this.evaluate(e.right)),ae(n)&&(n=n.unbox()),ae(r)&&(r=r.unbox()),t){case wf.LeftShift:case wf.LeftShiftEqual:return jS(n)&&jS(r)&&this.isPositive(r.getValue())&&this.lessThan(r.getValue(),32)?n.leftShift(r):jS(n)&&jS(r)?this.addError(new J(Z.BadBitShift,e.right.location)):this.addError(new ee({message:'Operator "<<" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.RightShift:case wf.RightShiftEqual:return jS(n)&&jS(r)&&this.isPositive(r.getValue())&&this.lessThan(r.getValue(),32)?n.rightShift(r):jS(n)&&jS(r)?this.addError(new J(Z.BadBitShift,e.right.location)):this.addError(new ee({message:'Operator ">>" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Minus:case wf.MinusEqual:return jS(n)&&jS(r)?n.subtract(r):this.addError(new ee({message:'Operator "-" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Star:case wf.StarEqual:return jS(n)&&jS(r)?n.multiply(r):this.addError(new ee({message:'Operator "*" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Caret:return jS(n)&&jS(r)?n.pow(r):this.addError(new ee({message:'Operator "^" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Slash:case wf.SlashEqual:return jS(n)&&jS(r)?n.divide(r):this.addError(new ee({message:'Operator "/" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Mod:return jS(n)&&jS(r)?n.modulo(r):this.addError(new ee({message:'Operator "mod" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Backslash:case wf.BackslashEqual:return jS(n)&&jS(r)?n.intDivide(r):this.addError(new ee({message:'Operator "\\" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Plus:case wf.PlusEqual:return jS(n)&&jS(r)?n.add(r):KS(n)&&KS(r)?n.concat(r):this.addError(new ee({message:'Operator "+" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Greater:return YS(n)&&YS(r)||KS(n)&&KS(r)?n.greaterThan(r):this.addError(new ee({message:'Operator ">" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.GreaterEqual:return YS(n)&&YS(r)||KS(n)&&KS(r)?n.greaterThan(r).or(n.equalTo(r)):this.addError(new ee({message:'Operator ">=" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Less:return YS(n)&&YS(r)||KS(n)&&KS(r)?n.lessThan(r):this.addError(new ee({message:'Operator "<" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.LessEqual:return YS(n)&&YS(r)||KS(n)&&KS(r)?n.lessThan(r).or(n.equalTo(r)):this.addError(new ee({message:'Operator "<=" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Equal:return i(n,t,r)?n.equalTo(r):this.addError(new ee({message:'Operator "=" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.LessGreater:return i(n,t,r)?n.equalTo(r).not():this.addError(new ee({message:'Operator "<>" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.And:return WS(n)&&!n.toBoolean()?D.False:WS(n)?(r=this.evaluate(e.right),ae(r)&&(r=r.unbox()),r instanceof D||jS(r)?n.and(r):this.addError(new ee({message:'Operator "and" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}))):jS(n)?(r=this.evaluate(e.right),ae(r)&&(r=r.unbox()),jS(r)||r instanceof D?n.and(r):this.addError(new ee({message:'Operator "and" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}))):this.addError(new ee({message:'Operator "and" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));case wf.Or:return WS(n)&&n.toBoolean()?D.True:WS(n)?(r=this.evaluate(e.right),ae(r)&&(r=r.unbox()),r instanceof D||jS(r)?n.or(r):this.addError(new ee({message:'Operator "or" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}))):jS(n)?(r=this.evaluate(e.right),ae(r)&&(r=r.unbox()),jS(r)||r instanceof D?n.or(r):this.addError(new ee({message:'Operator "or" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}))):this.addError(new ee({message:'Operator "or" can\'t be applied to',left:{type:n,location:e.left.location},right:{type:r,location:e.right.location}}));default:this.addError(new K(`Received unexpected token kind '${e.token.kind}'`,e.token.location))}}visitTryCatch(e){let t=this._tryMode;try{this._tryMode=!0,this.visitBlock(e.tryBlock),this._tryMode=t}catch(n){if(this._tryMode=t,!(n instanceof K)||n instanceof Hd||n instanceof $d)throw n;this.environment.define(ne.Function,e.errorBinding.name.text,this.formatErrorVariable(n)),this.visitBlock(e.catchBlock)}return O.Instance}visitThrow(e){let t=Z.UserDefined;t.message="";let n=this.evaluate(e.value);if(KS(n))throw t.message=n.getValue(),new J(t,e.location,this._stack.slice());if(!(n instanceof Fh))throw t=Z.MalformedThrow,t.message="Thrown value neither string nor roAssociativeArray.",new J(t,e.location,this._stack.slice());const r=new Map;for(const[e,a]of n.elements)if("number"===e.toLowerCase()?t=i(a,t):"message"===e.toLowerCase()?t=s(a,t):"backtrace"===e.toLowerCase()?a instanceof Kh?(r.set("backtrace",a),r.set("rethrown",D.True)):(t=Z.MalformedThrow,t.message='Thrown "backtrace" is not an object.'):"rethrown"!==e.toLowerCase()&&r.set(e,a),t.errno===Z.MalformedThrow.errno){r.clear();break}throw new J(t,e.location,this._stack.slice(),r);function i(e,t){if(e instanceof vh){if(t.errno=e.getValue(),""===t.message){const n=function(e){for(const[t,n]of Object.entries(Z))if(n.errno===e)return n;return null}(e.getValue());t.message=n?n.message:"UNKNOWN ERROR"}}else if(!(e instanceof O))return{errno:Z.MalformedThrow.errno,message:'Thrown "number" is not an integer.'};return t}function s(e,t){if(e instanceof M)t.message=e.toString();else if(!(e instanceof O))return{errno:Z.MalformedThrow.errno,message:'Thrown "message" is not a string.'};return t}}visitBlock(e){for(const t of e.statements)this.execute(t);return O.Instance}visitGoto(e){throw new Hd(e.location,e.tokens.label.text)}visitContinueFor(e){throw new Vd(e.location)}visitExitFor(e){throw new jd(e.location)}visitContinueWhile(e){throw new zd(e.location)}visitExitWhile(e){throw new Gd(e.location)}visitCall(e){let t="[anonymous function]";(e.callee instanceof Y||e.callee instanceof z)&&(t=e.callee.name.text);const n=this.evaluate(e.callee),r=n instanceof Rh?n.unbox():n;let i=e.args.map(this.evaluate,this);if(!qS(r)){if(r instanceof O&&e.optional)return r;this.addError(new J(Z.NotAFunction,e.closingParen.location))}t=r.getName();let s=r.getFirstSatisfiedSignature(i);if(s)try{let n=this._environment.getRootM(),a=s.signature;return i=i.map((e,t)=>a.args[t]?.type.kind===T.Object&&se(e)?e.box():e),(e.callee instanceof z||e.callee instanceof G)&&(n=r.getContext()??n),this.inSubEnv(s=>{s.environment.setM(n,!1),this._stack.push({functionName:t,functionLocation:r.getLocation()??this.location,callLocation:e.callee.location,signature:a});try{let e=r.call(this,...i);return this._stack.pop(),e}catch(e){if(this._stack.pop(),!this._tryMode&&this.options.stopOnCrash&&e instanceof J&&!HI.includes(e.message)){const t=e.errorDetail.errno;EE(this,this.location,this.location,e.message,t),this.options.stopOnCrash=!1}throw e}})}catch(e){if(!(e instanceof Ud)){if(HI.includes(e.message))throw new Error(e.message);if(e instanceof K)throw e;if(uh.isDevMode&&e.message.length>0)throw console.error(e),new Error("");throw new Error(e.message)}if(HI.includes(e.message))throw new Error(e.message);let t=e.value,n=e.location;const r=s.signature.returns;if(t&&r===T.Void&&this.addError(new J(Z.ReturnWithValue,n)),t||r===T.Void||this.addError(new J(Z.ReturnWithoutValue,n)),t){const e=Sh(t,r);if(e)return e}return t&&r!==T.Dynamic&&r!==t.kind&&this.addError(new ee({message:"Unable to cast",left:{type:r,location:n},right:{type:t,location:n},cast:!0})),t??O.Instance}else this.addError(Eh(r,i,e.closingParen.location))}visitAtSignGet(e){let t=this.evaluate(e.obj);if(t instanceof O&&e.optional)return t;if(XS(t)&&(t instanceof fv||t instanceof cv))try{return t.getAttribute(new M(e.name.text))}catch(t){this.addError(new K(t.message,e.name.location))}else this.addError(new ee({message:'Expected "roXMLList" or "roXMLElement" not',left:{type:t,location:e.location}}))}visitDottedGet(e){e.obj instanceof z&&this._dotLevel++;let t=this.evaluate(e.obj),n=se(t)?t.box():t;if(n instanceof L){if(n.hasInterface(e.name.text))return this._dotLevel>0?n:this.addError(new J(Z.BadSyntax,e.name.location));let t="";if(e.obj instanceof z){const r=e.obj.name.text;t=n.hasInterface(r)?r:""}n.setFilter(t)}else if(n instanceof N&&"ifGlobal"===n.name&&n.hasMethod(e.name.text))for(const t in y)if(t.toLowerCase()===e.name.text.toLowerCase()){const e=y[t];if(e instanceof Ch)return e;break}if(this._dotLevel=0,XS(t))try{const n=t.get(new M(e.name.text));return qS(n)&&t instanceof Fh&&n.setContext(t),n}catch(t){this.addError(new K(t.message,e.name.location))}let r=Z.DotOnNonObject;if(n instanceof L){const i=O.Instance.equalTo(t).toBoolean();if(i&&e.optional)return t;const s=n.getMethod(e.name.text);if(s)return s;i||(r=Z.MemberFunctionNotFound)}this.addError(new J(r,e.name.location))}visitIndexedGet(e){let t=this.evaluate(e.obj);if(!XS(t)){if(t instanceof O&&e.optional)return t;this.addError(new J(Z.UndimmedArray,e.location))}if(t instanceof Fh||t instanceof fv||t instanceof Wh){1!==e.indexes.length&&this.addError(new J(Z.WrongNumberOfParams,e.closingSquare.location));let n=this.evaluate(e.indexes[0]);$S(n)||this.addError(new ee({message:'"String" should be used as key, but received',left:{type:n,location:e.indexes[0].location}}));try{const e=t.get(n,!0);return qS(e)&&t instanceof Fh&&e.setContext(t),e}catch(t){this.addError(new K(t.message,e.closingSquare.location))}}t instanceof gd&&1!==e.indexes.length&&this.addError(new J(Z.BadNumberOfIndexes,e.closingSquare.location));let n=t;for(let t of e.indexes){let r=this.evaluate(t);if(ZS(r)||this.addError(new J(Z.NonNumericArrayIndex,t.location)),n instanceof Kh||n instanceof gd||n instanceof td||n instanceof cv)try{n=n.get(r)}catch(e){this.addError(new K(e.message,t.location))}else this.addError(new J(Z.BadNumberOfIndexes,e.location))}return n}visitGrouping(e){return this.evaluate(e.expression)}visitFor(e){let t=this.evaluate(e.increment);t instanceof bh&&(t=new vh(Math.trunc(t.getValue())));const n=e.counterDeclaration.name,r=new Wd({equals:e.tokens.for},n,new B(new Y(n),{kind:wf.Plus,text:"+",isReserved:!1,location:RE.InternalLocation},new $(t,e.increment.location)));let i;this.environment.continueFor?(this.execute(r),i=this.evaluate(new Y(n)),this.environment.continueFor=!1):(this.execute(e.counterDeclaration),i=this.evaluate(e.counterDeclaration.value));const s=this.evaluate(e.finalValue);if(i.getValue()>s.getValue()&&t.getValue()>0||i.getValue()<s.getValue()&&t.getValue()<0)return O.Instance;if(t.getValue()>0)for(;this.evaluate(new Y(n)).greaterThan(s).not().toBoolean();){try{this.execute(e.body)}catch(e){if(e instanceof jd)break;if(!(e instanceof Vd))throw e}this.execute(r)}else for(;this.evaluate(new Y(n)).lessThan(s).not().toBoolean();){try{this.execute(e.body)}catch(e){if(e instanceof jd)break;if(!(e instanceof Vd))throw e}this.execute(r)}return O.Instance}visitForEach(e){let t=this.evaluate(e.target);if(!XS(t)){const n=`BRIGHTSCRIPT: ERROR: Runtime: FOR EACH value is ${T.toString(t.kind)}`,r=`${e.item.location.file}(${e.item.location.start.line})`;return uh.stderr.write(`warning,${n}: ${r}`),O.Instance}let n=0;this.environment.continueFor&&(n=this.environment.continueForEach,this.environment.continueFor=!1,this.environment.continueForEach=0);let r=0;for(t.resetNext();t.hasNext()===D.True;){const i=t.getNext();this.environment.define(ne.Function,e.item.text,i);try{n<=r&&this.execute(e.body)}catch(e){if(e instanceof jd)break;if(!(e instanceof Vd))throw e instanceof Hd?(this.environment.continueForEach=r+1,e):e}r++}return O.Instance}visitWhile(e){for(;this.evaluate(e.condition).equalTo(D.True).toBoolean();)try{this.execute(e.body)}catch(e){if(e instanceof Gd)break;if(!(e instanceof zd))throw e}return O.Instance}visitIf(e){if(this.evaluate(e.condition).equalTo(D.True).toBoolean())return this.execute(e.thenBranch),O.Instance;for(const t of e.elseIfs||[])if(this.evaluate(t.condition).equalTo(D.True).toBoolean())return this.execute(t.thenBranch),O.Instance;return e.elseBranch&&this.execute(e.elseBranch),O.Instance}visitAnonymousFunction(e){return xE(e)}visitLiteral(e){return e.value}visitArrayLiteral(e){return new Kh(e.elements.map(e=>this.evaluate(e)))}visitAALiteral(e){return new Fh(e.elements.map(e=>({name:e.name,value:this.evaluate(e.value)})))}visitDottedSet(e){let t=this.evaluate(e.value),n=this.evaluate(e.obj);XS(n)||this.addError(new J(Z.BadLHS,e.name.location));try{n.set(new M(e.name.text),t)}catch(t){this.addError(new K(t.message,e.name.location))}return O.Instance}visitIndexedSet(e){let t=this.evaluate(e.value),n=this.evaluate(e.obj);if(XS(n)||this.addError(new J(Z.BadLHS,e.obj.location)),n instanceof Fh||n instanceof fv||n instanceof Wh){1!==e.indexes.length&&this.addError(new J(Z.WrongNumberOfParams,e.closingSquare.location));let r=this.evaluate(e.indexes[0]);$S(r)||this.addError(new ee({message:'"String" should be used as key, but received',left:{type:r,location:e.indexes[0].location}}));try{n.set(r,t,!0)}catch(t){this.addError(new K(t.message,e.closingSquare.location))}return O.Instance}n instanceof gd&&1!==e.indexes.length&&this.addError(new J(Z.BadNumberOfIndexes,e.closingSquare.location));let r=n;for(let n=0;n<e.indexes.length;n++){let i=this.evaluate(e.indexes[n]);if(jS(i)||this.addError(new J(Z.NonNumericArrayIndex,e.indexes[n].location)),n<e.indexes.length-1)if(r instanceof Kh||r instanceof gd||r instanceof td||r instanceof cv)try{r=r.get(i)}catch(t){this.addError(new K(t.message,e.closingSquare.location))}else this.addError(new J(Z.BadNumberOfIndexes,e.location));else if(r instanceof Kh||r instanceof gd||r instanceof td||r instanceof cv)try{r.set(i,t)}catch(t){this.addError(new K(t.message,e.closingSquare.location))}else this.addError(new J(Z.BadNumberOfIndexes,e.location))}return O.Instance}visitIncrement(e){let t,n=this.evaluate(e.value);if(JS(n)&&(n=n.unbox()),!jS(n)){let t=e.token.kind===wf.PlusPlus?"increment":"decrement";this.addError(new ee({message:`Attempting to ${t} value of non-numeric type`,left:{type:n,location:e.location}}))}return t=e.token.kind===wf.PlusPlus?n.add(new vh(1)):n.subtract(new vh(1)),e.value instanceof Y?this.environment.define(ne.Function,e.value.name.text,t):e.value instanceof z?this.execute(new ff(e.value.obj,e.value.name,new $(t,e.location))):e.value instanceof G&&this.execute(new pf(e.value.obj,e.value.indexes,new $(t,e.location),e.value.closingSquare)),O.Instance}visitUnary(e){let t=this.evaluate(e.right);switch(ae(t)&&(t=t.unbox()),e.operator.kind){case wf.Minus:return jS(t)?t.multiply(new vh(-1)):this.addError(new ee({message:'Operator "-" can\'t be applied to',left:{type:t,location:e.operator.location}}));case wf.Plus:return t;case wf.Not:if(t instanceof D||jS(t))return t.not();this.addError(new ee({message:'Operator "not" can\'t be applied to',left:{type:t,location:e.operator.location}}))}return O.Instance}visitVariable(e){try{return this.environment.get(e.name)}catch(e){if(e instanceof re)return P.Instance;throw e}}evaluate(e){return-1!==e.location.start.line&&(this.location=e.location),e.accept(this)}execute(e){return""!==this.environment.gotoLabel?this.searchLabel(e):(this.lastStmt instanceof lf||this.checkDebugger(e),eS.inTaskThread()&&eS.tasks[0]?.updateTask(),this.location=e.location,this.lastStmt=e,e.accept(this))}checkDebugger(e){const t=uh.checkBreakCommand(this.debugMode);if(t===Ie.BREAK){if(this.debugMode=!0,!(e instanceof Xd||EE(this,e.location,this.location)))throw this.options.stopOnCrash=!1,new Ud("debug-exit",e.location)}else if(t===Ie.EXIT)throw this.options.stopOnCrash=!1,new Ud("debug-exit",e.location)}searchLabel(e){if(e instanceof af)return e.tokens.identifier.text.toLowerCase()===this.environment.gotoLabel&&(this.environment.gotoLabel=""),O.Instance;if(e instanceof tf)return this.visitBlock(e.thenBranch),""!==this.environment.gotoLabel&&e.elseBranch&&this.visitBlock(e.elseBranch),O.Instance;if(e instanceof mf)return this.visitBlock(e.catchBlock),O.Instance;if(e instanceof uf||e instanceof hf)try{this.visitBlock(e.body),this.environment.continueFor=""===this.environment.gotoLabel}catch(e){if(this.environment.continueFor=!1,e instanceof jd)return O.Instance;if(!(e instanceof Vd))throw e;this.environment.continueFor=!0}else if(e instanceof df)try{this.visitBlock(e.body)}catch(e){if(e instanceof Gd)return O.Instance;if(!(e instanceof zd))throw e}return""===this.environment.gotoLabel?e.accept(this):O.Instance}getMemoryHeapInfo(){let e=874299,t=26229;const n=Atomics.load(uh.sharedArray,ve.MHSL),r=Atomics.load(uh.sharedArray,ve.MUHS);return n>0&&r>0&&(e=n,t=r),{heapSizeLimit:e,usedHeapSize:t}}formatBacktrace(e,t=!0,n){const r=n??this._stack;let i="";const s=[];for(let n=r.length-1;n>=0;n--){const a=r[n],o=T.toString(a.signature.returns);let c="";for(const e of a.signature.args)c+=""===c?"":",",c+=`${e.name.text} As ${T.toString(e.type.kind)}`;const l=`${a.functionName}(${c}) As ${o}`;if(t)i+=`#${n}  Function ${l}\r\n`,i+=`   file/line: ${this.formatLocation(e)}\r\n`;else{const t=e.start.line,n={filename:e?.file??"()",function:l,line_number:t};s.unshift(nx(n))}e=a.callLocation}return t?i:new Kh(s)}formatVariables(e=ne.Function){let t=e===ne.Function?`${"global".padEnd(16)} Interface:ifGlobal\r\n`:"",n=this.environment.getList(e);for(const[e,r]of n){const n=e.padEnd(17);if(r.kind===T.Uninitialized)t+=`${n}${T.toString(r.kind)}\r\n`;else if(HS.has(r.kind))t+=`${n}${T.toString(r.kind)} val:${this.formatValue(r)}`;else if(XS(r)){const e=r.getElements().length;t+=`${n}${r.getComponentName()} refcnt=${r.getReferenceCount()} count:${e}\r\n`}else if(r instanceof L&&ae(r)){const e=r.unbox();t+=`${n}${r.getComponentName()} refcnt=${r.getReferenceCount()} val:${this.formatValue(e)}`}else r.kind===T.Object?t+=`${n}${r.getComponentName()} refcnt=${r.getReferenceCount()}\r\n`:r.kind===T.Callable?t+=`${n}${T.toString(r.kind)} val:${r.getName()}\r\n`:t+=`${n}${r.toString().substring(0,94)}\r\n`}return t}formatValue(e){let t=e.toString(),n=t.length<=94?"\r\n":"...\r\n";return e instanceof M?t=`"${t.substring(0,94)}"`:e instanceof vh?t=`${t} (&h${Re(e.getValue()).toUpperCase()})`:e instanceof ph&&(t=`${t} (&h${Re(e.getValue().toNumber()).toUpperCase()})`),`${t}${n}`}formatLocation(e=this.location){let t;const n=e.file.startsWith("pkg:")?e.file:`pkg:/${e.file}`;return t=e.start.line?`${n}(${e.start.line})`:`${n}(??)`,t}formatStats(){let e="Sub Context Data:\r\n";e+=`  Variables:      ${this.environment.getList(ne.Function).size+2}\r\n`;let t=0;for(const e of this.sourceMap.values())t+=Me(e).length;e+="Module Constant Table Sizes:\r\n",e+=`  Source Lns:     ${t}\r\n`;for(const[t,n]of GI.entries())e+=`  ${(wf[t]+":").padEnd(15)} ${n}\r\n`;return e}getChannelVersion(){return`${Number.parseInt(this.manifest.get("major_version")??"0")||0}.${Number.parseInt(this.manifest.get("minor_version")??"0")||0}.${Number.parseInt(this.manifest.get("build_version")??"0")||0}`}addError(e){throw e.backTrace??=this._stack.slice(),this._tryMode||(this.errors.push(e),this.events.emit("err",e)),e}formatErrorVariable(e){const t=this.formatBacktrace(e.location,!1,e.backTrace);let n=Z.Internal,r=e.message;e instanceof J&&(n=e.errorDetail);const i=nx({backtrace:t,message:r,number:n.errno,rethrown:!1});if(e instanceof J&&e.extraFields?.size)for(const[n,r]of e.extraFields)i.set(new M(n),r),"rethrown"===n&&WS(r)&&r.toBoolean()&&i.set(new M("rethrow_backtrace"),t);return i}isPositive(e){return e instanceof C()?e.isPositive():Number.isNaN(e)||e>=0}lessThan(e,t){return e instanceof C()?e.lessThan(t):e<t}}async function ME(e){try{return{status:"fulfilled",value:await e,isFulfilled:!0,isRejected:!1}}catch(e){return{status:"rejected",reason:e,isFulfilled:!1,isRejected:!0}}}var DE=__webpack_require__(308);async function OE(e,t={}){const{concurrency:n=Number.POSITIVE_INFINITY,mapper:r}=t;if(r&&"function"!=typeof r)throw new TypeError("Mapper must be a function");const i=DE(n);return Promise.all(e.map((e,t)=>r?ME(i(()=>r(e,t))):e&&"function"==typeof e.then?ME(e):ME("function"==typeof e?i(()=>e()):Promise.resolve(e))))}class PE{tokens;constructor(e){this.tokens=e}accept(e){return e.visitBrightScript(this)}}class NE{name;value;constructor(e,t){this.name=e,this.value=t}accept(e){return e.visitDeclaration(this)}}class LE{condition;isNegated;thenChunks;elseIfs;elseChunks;constructor(e,t,n,r,i){this.condition=e,this.isNegated=t,this.thenChunks=n,this.elseIfs=r,this.elseChunks=i}accept(e){return e.visitIf(this)}}class BE{hashError;message;constructor(e,t){this.hashError=e,this.message=t}accept(e){return e.visitError(this)}}class UE{events=new v.EventEmitter;parse(e){let t=0,n=e,r=[];const i=e=>{throw r.push(e),this.events.emit("err",e),e};try{return{chunks:s(),errors:r}}catch(e){return{chunks:[],errors:r}}function s(){let e=[];for(;;){let t=a();t&&e.push(t);let n=h()?new PE([d()]):void 0;if(n){e.push(n);break}if(!t)break}return e}function a(){if(o(wf.HashConst)){let e=l();c("Expected '=' after #const (name)",wf.Equal);let t=l();return o(wf.Newline),new NE(e,t)}return function(){if(o(wf.HashIf)){let e,t=f().location.start.line,n=o(wf.Not),r=l();u(wf.Newline)||i(new Rf(d(),"Invalid #If/#ElseIf expression (True | False | <CONST-NAME>) (compile error &h93)")),o(wf.Newline);let a=s(),h=[];for(;o(wf.HashElseIf);){let e=o(wf.Not),t=l();u(wf.Newline)||i(new Rf(d(),"Invalid #If/#ElseIf expression (True | False | <CONST-NAME>) (compile error &h93)")),o(wf.Newline),h.push({condition:t,isNegated:e,thenChunks:s()})}return o(wf.HashElse)&&(o(wf.Newline),e=s()),c(`Expected '#else if' to close '#if' conditional compilation statement starting on line ${t}`,wf.HashEndIf),o(wf.Newline),new LE(r,n,a,h,e)}return function(){if(u(wf.HashError)){let e=l(),t=l();return new BE(e,t.text||"")}return function(){let e=[];for(;!u(wf.HashIf,wf.HashElseIf,wf.HashElse,wf.HashEndIf,wf.HashConst,wf.HashError)&&(e.push(l()),!h()););return e.length>0?new PE(e):void 0}()}()}()}function o(...e){for(let t of e)if(u(t))return l(),!0;return!1}function c(e,...t){return t.map(e=>d().kind===e).reduce((e,t)=>e||t,!1)?l():i(new Rf(d(),e))}function l(){return h()||t++,f()}function u(...e){return!h()&&e.some(e=>d().kind===e)}function h(){return d().kind===wf.Eof}function d(){return n[t]}function f(){return n[t-1]}}}class VE{constants=new Map;events=new v.EventEmitter;errors=[];addError(e){throw this.errors.push(e),this.events.emit("err",e),e}filter(e,t){return this.constants=new Map(t),{processedTokens:e.map(e=>e.accept(this)).reduce((e,t)=>[...e,...t],[]),errors:this.errors}}visitBrightScript(e){return e.tokens}visitDeclaration(e){if(this.constants.has(e.name.text))return this.addError(new K(`Attempting to re-declare #const with name '${e.name.text}'`,e.name.location));let t;switch(e.value.kind){case wf.True:t=!0;break;case wf.False:t=!1;break;case wf.Identifier:if(this.constants.has(e.value.text)){t=this.constants.get(e.value.text);break}return this.addError(new K(`Attempting to create #const alias of '${e.value.text}', but no such #const exists`,e.value.location));default:return this.addError(new K("#const declarations can only have values of `true`, `false`, or other #const names",e.value.location))}return this.constants.set(e.name.text,t),[]}visitError(e){return this.addError(new Rf(e.hashError,e.message))}visitIf(e){let t=this.evaluateCondition(e.condition);if(e.isNegated&&(t=!t),t)return e.thenChunks.map(e=>e.accept(this)).reduce((e,t)=>[...e,...t],[]);for(const t of e.elseIfs){let e=this.evaluateCondition(t.condition);if(t.isNegated&&(e=!e),e)return t.thenChunks.map(e=>e.accept(this)).reduce((e,t)=>[...e,...t],[])}return e.elseChunks?e.elseChunks.map(e=>e.accept(this)).reduce((e,t)=>[...e,...t],[]):[]}evaluateCondition(e){switch(e.kind){case wf.True:return!0;case wf.False:return!1;case wf.Identifier:return this.constants.has(e.text)?this.constants.get(e.text):this.addError(new K(`Invalid #If/#ElseIf expression (<CONST-NAME> not defined) '${e.text}' (compile error &h92)`,e.location));default:return this.addError(new K("#Invalid #If/#ElseIf expression (True | False | <CONST-NAME>) (compile error &h93)",e.location))}}}class jE{parser=new UE;_preprocessor=new VE;events=new v.EventEmitter;onError(e){return this.events.on("err",e),{dispose:()=>{this.events.removeListener("err",e)}}}onErrorOnce(e){this.events.once("err",e)}constructor(){this.parser.events.on("err",e=>this.events.emit("err",e)),this._preprocessor.events.on("err",e=>this.events.emit("err",e))}preprocess(e,t){let n=this.parser.parse(e);return n.errors.length>0?{processedTokens:[],errors:n.errors}:this._preprocessor.filter(n.chunks,zE(t))}}function zE(e){if(!e.has("bs_const"))return new Map;let t=e.get("bs_const");if("string"!=typeof t)throw new Error("Invalid bs_const right-hand side.  bs_const must be a string of ';'-separated 'key=value' pairs");let n=t.split(";").filter(e=>!!e).map(e=>{let t=e.indexOf("=");if(-1===t)throw new Error(`No '=' detected for key ${e}.  bs_const constants must be of the form 'key=value'.`);return[e.slice(0,t),e.slice(t+1)]}).map(([e,t])=>[e.trim(),t.trim()]).map(([e,t])=>{if("true"===t.toLowerCase())return[e,!0];if("false"===t.toLowerCase())return[e,!1];throw new Error(`Invalid value for bs_const key '${e}'.  Values must be either 'true' or 'false'.`)});return new Map(n)}function GE(e,t,n,r="",i){const s=new Ff,a=new Lf,o=new jE,c=new Array,l=new Map;let u=[];s.onError(Q),a.onError(Q),o.onError(Q);let h=we.FINISHED;try{for(let[i,d]of n){const n=s.scan(d,i);if(n.errors.length>0){h=we.CRASHED;break}const f=o.preprocess(n.tokens,t);if(f.errors.length>0){h=we.CRASHED;break}if(r.length>0){u=u.concat(f.processedTokens);continue}const p=a.parse(f.processedTokens);if(p.errors.length>0){h=we.CRASHED;break}HE(e,p,l,t),c.push(...p.statements)}if(0===r.length)for(const[e,t]of l)if(""!==t){n.set(e,t);const r=s.scan(t,e),i=a.parse(r.tokens);c.push(...i.statements)}if(i)for(const[e,t]of a.stats)i.set(e,t.size)}catch(e){h=we.CRASHED}return{exitReason:h,tokens:u,statements:c}}function HE(e,t,n,r){n.has("v30/bslDefender.brs")||(n.set("v30/bslDefender.brs",""),n.set("v30/bslCore.brs",""),n.set("Roku_Ads.brs",""),n.set("IMA3.brs",""),n.set("Roku_Event_Dispatcher.brs",""),n.set("RokuBrowser.brs","")),!0===t.libraries.get("v30/bslDefender.brs")&&""===n.get("v30/bslDefender.brs")?(n.set("v30/bslDefender.brs",e.readFileSync("common:/LibCore/v30/bslDefender.brs","utf8")),n.set("v30/bslCore.brs",e.readFileSync("common:/LibCore/v30/bslCore.brs","utf8"))):!0===t.libraries.get("v30/bslCore.brs")&&""===n.get("v30/bslCore.brs")&&n.set("v30/bslCore.brs",e.readFileSync("common:/LibCore/v30/bslCore.brs","utf8")),!0===t.libraries.get("Roku_Ads.brs")&&""===n.get("Roku_Ads.brs")&&r.get("bs_libs_required")?.includes("roku_ads_lib")&&n.set("Roku_Ads.brs",e.readFileSync("common:/roku_ads/Roku_Ads.brs","utf8")),!0===t.libraries.get("IMA3.brs")&&""===n.get("IMA3.brs")&&r.get("bs_libs_required")?.includes("googleima3")&&n.set("IMA3.brs",e.readFileSync("common:/roku_ads/IMA3.brs","utf8")),!0===t.libraries.get("Roku_Event_Dispatcher.brs")&&""===n.get("Roku_Event_Dispatcher.brs")&&r.get("sg_component_libs_required")?.includes("roku_analytics")&&n.set("Roku_Event_Dispatcher.brs",e.readFileSync("common:/roku_analytics/Roku_Event_Dispatcher.brs","utf8")),!0===t.libraries.get("RokuBrowser.brs")&&""===n.get("RokuBrowser.brs")&&r.get("bs_libs_required")?.includes("Roku_Browser")&&n.set("RokuBrowser.brs",e.readFileSync("common:/roku_browser/RokuBrowser.brs","utf8"))}class $E{componentMap;parserLexerFn;excludedNames=["init"];constructor(e,t){this.componentMap=e,this.parserLexerFn=t}async resolve(e){let t=await OE(Array.from(this.getStatements(e))),n=t.filter(e=>e.isRejected);return n.length>0?(n.forEach(e=>e.reason.messages.forEach(e=>console.error(e))),Promise.reject(`Unable to resolve scope for component ${e.name}`)):this.flatten(t.map(e=>e.isFulfilled?e.value:[]))}flatten(e){let t=e.shift()||[],n=new Set(t.filter(e=>!0).map(e=>e.name.text.toLowerCase()));for(;e.length>0;){let r=e.shift()||[];t=t.concat(r.filter(e=>!0).filter(e=>{let t=e.name.text.toLowerCase(),r=n.has(t);return r||n.add(t),!r&&!this.excludedNames.includes(t)}))}return t}*getStatements(e){yield this.parserLexerFn(e.scripts);let t=e;for(;t.extends;){if(Dh.canResolveNodeType(t.extends))return Promise.resolve();let e=t;if(t=this.componentMap.get(t.extends.toLowerCase()),!t)return console.error(`Warning: XML component '${e.name}' extends unknown component '${e.extends}'. Ignoring extension.`),Promise.resolve();yield this.parserLexerFn(t.scripts)}return Promise.resolve()}}var WE=__webpack_require__(9907);let qE;class XE{xmlPath;contents;xmlNode;name;processed=!1;fields={};functions={};children=[];scripts=[];environment;constructor(e){this.xmlPath=e}async parse(){try{return void 0===qE?Promise.reject("FileSystem not set"):(this.contents=qE.readFileSync(this.xmlPath,"utf-8"),this.xmlNode=new sp.XmlDocument(this.contents??""),this.name=this.xmlNode.attr.name,Promise.resolve(this))}catch(e){return Promise.reject(this)}}get extends(){return this.xmlNode?.attr?.extends??""}get initialFocus(){return this.xmlNode?.attr?.initialFocus??""}}async function YE(e,t=[],n){qE=e;const r=[],i=["components",...t];for(const e of i){const t=Ne.join("pkg:/",e);qE?.existsSync(t)&&r.push(...qE.findSync(t,"xml"))}return async function(e,t){const n=await e,r=new Map;if(0===n.length)return r;n.map(e=>{if(e.isFulfilled&&!e.isRejected){let n=e.value?.name?.toLowerCase();t&&(n=`${t.toLowerCase()}:${n}`),n&&r.set(n,e.value)}});let i=[];for(const e of r.values()){if(e&&!1===e.processed){let t=e.xmlNode;for(i.push(e);t&&t.attr.extends;){let e=r.get(t.attr.extends?.toLowerCase());e?(i.push(e),t=e.xmlNode):t=void 0}let n={};for(;i.length>0;){let e=i.pop();if(e)if(e.processed)n=e.functions;else{let t=JE(e.xmlNode);n={...n,...t.functions},e.functions=n,e.fields=t.fields,e.processed=!0}}}e?.xmlNode&&(e.children=ZE(e.xmlNode),e.scripts=await eI(e.xmlNode,e))}return r}(OE(r.map(e=>new XE(e)).map(async e=>e.parse())),n)}async function KE(e,t,n){if(!qE)throw new Error("FileSystem not set");const r=new RE(n),i=function(e,t){let n=new Map;return async function(r){async function i(n){let r,i;if(void 0!==n.uri){i=n.uri.replace(/[\/\\]+/g,Ne.posix.sep);try{r=e.readFileSync(i,"utf-8"),n.content=r}catch(e){let t=e?.errno||-4858;return Promise.reject({message:`brs: can't open file '${i}': [Errno ${t}]`})}}else{if(void 0===n.content)return Promise.reject({message:"brs: invalid script object"});r=n.content,i=n.xmlPath||"xml"}const s=new Ff,a=new jE,o=new Lf;for(const e of[s,a,o])e.onError(Q);const c=s.scan(r,i);if(c.errors.length>0)return Promise.reject({message:"Error occurred during lexing"});const l=a.preprocess(c.tokens,t);if(l.errors.length>0)return Promise.reject({message:"Error occurred during pre-processing"});const u=o.parse(l.processedTokens);return u.errors.length>0?Promise.reject({message:"Error occurred parsing"}):Promise.resolve(u.statements)}const s=[];for(const e of r)if(void 0!==e.uri){const t=n.get(e.uri);if(t)s.push(t);else{const t=i(e);n.has(e.uri)||n.set(e.uri,t),s.push(t)}}else void 0!==e.content&&s.push(i(e));let a=await OE(s);return a.some(e=>e.isRejected)?Promise.reject({messages:a.filter(e=>e.isRejected).map(e=>e.reason.message)}):a.map(e=>e.isFulfilled?e.value:[]).reduce((e,t)=>[...e,...t],[])}}(qE,t),s=n.entryPoint??!1;let a=new $E(e,i);return await OE(Array.from(e).map(async e=>{let[t,n]=e;n.environment=r.environment.createSubEnvironment(!1);let i=await a.resolve(n);r.inSubEnv(e=>{let t=new Fh([]);return e.options.entryPoint=!1,e.environment.setM(t),e.environment.setRootM(t),e.exec(i),O.Instance},n.environment)})),r.options.entryPoint=s,r}function JE(e){const t=e.childNamed("interface"),n={},r={};return t?(t.eachChild(e=>{"field"===e.name?n[e.attr.id]={type:e.attr.type,id:e.attr.id,alias:e.attr.alias,onChange:e.attr.onChange,alwaysNotify:e.attr.alwaysNotify,value:e.attr.value}:"function"===e.name&&(r[e.attr.name]={name:e.attr.name})}),{fields:n,functions:r}):{fields:n,functions:r}}function ZE(e){const t=e.childNamed("children");if(!t)return[];const n=[];return QE(t,n),n}function QE(e,t){e.eachChild(e=>{const n={name:e.name,fields:e.attr,children:[]};e.children.length>0&&QE(e,n.children),t.push(n)})}async function eI(e,t){const n=e.childrenNamed("script"),r=[];for(const e of n){if(e.attr.uri&&e.val)return Promise.reject({message:K.format("<script> element cannot contain both internal and external source",nI(t,e)).trim()});if(e.attr?.uri){let n=await tI(e,t);r.push({type:e.attr.type,uri:n})}else"string"==typeof e.val&&r.push({type:e.attr.type,content:e.val,xmlPath:t.xmlPath})}return r}async function tI(e,t){let n;try{if(e.attr.uri.startsWith("pkg:/"))n=e.attr.uri;else{let r=Ne.dirname(t.xmlPath.replace(/[\/\\]+/g,Ne.posix.sep));"win32"===WE.platform&&(r=r.replace(/^[a-zA-Z]:/,"")),n=Ne.join(r,e.attr.uri)}}catch(n){return Promise.reject({message:K.format(`Invalid path '${e.attr.uri}' found in <script/> tag`,nI(t,e)).trim()})}return n}function nI(e,t){const n=(e.contents?.substring(t.startTagPosition,t.position)??"").split("\n"),r=e.contents?.substring(0,t.startTagPosition).split("\n")??[],i={line:r.length,column:rI(r)};return{file:e.xmlPath,start:i,end:{line:i.line+n.length-1,column:i.column+rI(n)}}}function rI(e){return e[e.length-1].length+e.length-1}var iI=4294967295;function sI(e,t,n){var r=Math.floor(n/4294967296),i=n;e.setUint32(t,r),e.setUint32(t+4,i)}function aI(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var oI,cI,lI,uI=__webpack_require__(9907),hI=(void 0===uI||"never"!==(null===(oI=null==uI?void 0:uI.env)||void 0===oI?void 0:oI.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function dI(e){for(var t=e.length,n=0,r=0;r<t;){var i=e.charCodeAt(r++);if(4294967168&i)if(4294965248&i){if(i>=55296&&i<=56319&&r<t){var s=e.charCodeAt(r);56320==(64512&s)&&(++r,i=((1023&i)<<10)+(1023&s)+65536)}n+=4294901760&i?4:3}else n+=2;else n++}return n}var fI=hI?new TextEncoder:void 0,pI=hI?void 0!==uI&&"force"!==(null===(cI=null==uI?void 0:uI.env)||void 0===cI?void 0:cI.TEXT_ENCODING)?200:0:iI,gI=(null==fI?void 0:fI.encodeInto)?function(e,t,n){fI.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(fI.encode(e),n)};function mI(e,t,n){for(var r=t,i=r+n,s=[],a="";r<i;){var o=e[r++];if(128&o)if(192==(224&o)){var c=63&e[r++];s.push((31&o)<<6|c)}else if(224==(240&o)){c=63&e[r++];var l=63&e[r++];s.push((31&o)<<12|c<<6|l)}else if(240==(248&o)){var u=(7&o)<<18|(c=63&e[r++])<<12|(l=63&e[r++])<<6|63&e[r++];u>65535&&(u-=65536,s.push(u>>>10&1023|55296),u=56320|1023&u),s.push(u)}else s.push(o);else s.push(o);s.length>=4096&&(a+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(a+=String.fromCharCode.apply(String,s)),a}var yI,bI=hI?new TextDecoder:null,wI=hI?void 0!==uI&&"force"!==(null===(lI=null==uI?void 0:uI.env)||void 0===lI?void 0:lI.TEXT_DECODER)?200:0:iI,vI=function(e,t){this.type=e,this.data=t},SI=(yI=function(e,t){return yI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},yI(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}yI(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),xI=function(e){function t(n){var r=e.call(this,n)||this,i=Object.create(t.prototype);return Object.setPrototypeOf(r,i),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return SI(t,e),t}(Error),EI={type:-1,encode:function(e){var t,n,r,i;return e instanceof Date?function(e){var t,n=e.sec,r=e.nsec;if(n>=0&&r>=0&&n<=17179869183){if(0===r&&n<=4294967295){var i=new Uint8Array(4);return(t=new DataView(i.buffer)).setUint32(0,n),i}var s=n/4294967296,a=4294967295&n;return i=new Uint8Array(8),(t=new DataView(i.buffer)).setUint32(0,r<<2|3&s),t.setUint32(4,a),i}return i=new Uint8Array(12),(t=new DataView(i.buffer)).setUint32(0,r),sI(t,4,n),i}((r=1e6*((t=e.getTime())-1e3*(n=Math.floor(t/1e3))),{sec:n+(i=Math.floor(r/1e9)),nsec:r-1e9*i})):null},decode:function(e){var t=function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:aI(t,4),nsec:t.getUint32(0)};default:throw new xI("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}},II=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(EI)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var i=1+t;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++)if(null!=(r=this.builtInEncoders[n])&&null!=(i=r(e,t)))return new vI(-1-n,i);for(n=0;n<this.encoders.length;n++){var r,i;if(null!=(r=this.encoders[n])&&null!=(i=r(e,t)))return new vI(n,i)}return e instanceof vI?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new vI(t,e)},e.defaultCodec=new e,e}();function kI(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var TI=function(){function e(e,t,n,r,i,s,a,o){void 0===e&&(e=II.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=100),void 0===r&&(r=2048),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=r,this.sortKeys=i,this.forceFloat32=s,this.ignoreUndefined=a,this.forceIntegerToFloat=o,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>pI){var t=dI(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),gI(e,this.bytes,this.pos),this.pos+=t}else t=dI(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var r=e.length,i=n,s=0;s<r;){var a=e.charCodeAt(s++);if(4294967168&a){if(4294965248&a){if(a>=55296&&a<=56319&&s<r){var o=e.charCodeAt(s);56320==(64512&o)&&(++s,a=((1023&a)<<10)+(1023&o)+65536)}4294901760&a?(t[i++]=a>>18&7|240,t[i++]=a>>12&63|128,t[i++]=a>>6&63|128):(t[i++]=a>>12&15|224,t[i++]=a>>6&63|128)}else t[i++]=a>>6&31|192;t[i++]=63&a|128}else t[i++]=a}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=kI(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var r=0,i=e;r<i.length;r++){var s=i[r];this.doEncode(s,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,r=0,i=t;r<i.length;r++)void 0!==e[i[r]]&&n++;return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var r=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(r<16)this.writeU8(128+r);else if(r<65536)this.writeU8(222),this.writeU16(r);else{if(!(r<4294967296))throw new Error("Too large map object: ".concat(r));this.writeU8(223),this.writeU32(r)}for(var i=0,s=n;i<s.length;i++){var a=s[i],o=e[a];this.ignoreUndefined&&void 0===o||(this.encodeString(a),this.doEncode(o,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var r=n/4294967296,i=n;e.setUint32(t,r),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),sI(this.view,this.pos,e),this.pos+=8},e}(),_I={};function CI(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var AI=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var r=0,i=this.caches[n-1];r<i.length;r++){for(var s=i[r],a=s.bytes,o=0;o<n;o++)if(a[o]!==e[t+o])continue e;return s.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var i=mI(e,t,n),s=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(s,i),i},e}(),FI=function(e,t){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},RI=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,(t=e[n](t)).done,t.value)})}}},MI=function(e){return this instanceof MI?(this.v=e,this):new MI(e)},DI=new DataView(new ArrayBuffer(0)),OI=new Uint8Array(DI.buffer),PI=function(){try{DI.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),NI=new PI("Insufficient data"),LI=new AI,BI=function(){function e(e,t,n,r,i,s,a,o){void 0===e&&(e=II.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=iI),void 0===r&&(r=iI),void 0===i&&(i=iI),void 0===s&&(s=iI),void 0===a&&(a=iI),void 0===o&&(o=LI),this.extensionCodec=e,this.context=t,this.maxStrLength=n,this.maxBinLength=r,this.maxArrayLength=i,this.maxMapLength=s,this.maxExtLength=a,this.keyDecoder=o,this.totalPos=0,this.pos=0,this.view=DI,this.bytes=OI,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=kI(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=kI(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=kI(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return FI(this,function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}})},e.prototype.decodeAsync=function(e){var t,n,r,i,s,a,o;return s=this,o=function(){var s,a,o,c,l,u,h,d;return FI(this,function(f){switch(f.label){case 0:s=!1,f.label=1;case 1:f.trys.push([1,6,7,12]),t=RI(e),f.label=2;case 2:return[4,t.next()];case 3:if((n=f.sent()).done)return[3,5];if(o=n.value,s)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o);try{a=this.doDecodeSync(),s=!0}catch(e){if(!(e instanceof PI))throw e}this.totalPos+=this.pos,f.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=f.sent(),r={error:c},[3,12];case 7:return f.trys.push([7,,10,11]),n&&!n.done&&(i=t.return)?[4,i.call(t)]:[3,9];case 8:f.sent(),f.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(s){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,a]}throw u=(l=this).headByte,h=l.pos,d=l.totalPos,new RangeError("Insufficient data in parsing ".concat(CI(u)," at ").concat(d," (").concat(h," in the current buffer)"))}})},new((a=void 0)||(a=Promise))(function(e,t){function n(e){try{i(o.next(e))}catch(e){t(e)}}function r(e){try{i(o.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof a?i:new a(function(e){e(i)})).then(n,r)}i((o=o.apply(s,[])).next())})},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){s.push([e,t,n,r])>1||o(e,t)})})}function o(e,t){try{(n=i[e](t)).value instanceof MI?Promise.resolve(n.value.v).then(c,l):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function c(e){o("next",e)}function l(e){o("throw",e)}function u(e,t){e(t),s.shift(),s.length&&o(s[0][0],s[0][1])}}(this,arguments,function(){var n,r,i,s,a,o,c,l,u;return FI(this,function(h){switch(h.label){case 0:n=t,r=-1,h.label=1;case 1:h.trys.push([1,13,14,19]),i=RI(e),h.label=2;case 2:return[4,MI(i.next())];case 3:if((s=h.sent()).done)return[3,12];if(a=s.value,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a),n&&(r=this.readArraySize(),n=!1,this.complete()),h.label=4;case 4:h.trys.push([4,9,,10]),h.label=5;case 5:return[4,MI(this.doDecodeSync())];case 6:return[4,h.sent()];case 7:return h.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((o=h.sent())instanceof PI))throw o;return[3,10];case 10:this.totalPos+=this.pos,h.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=h.sent(),l={error:c},[3,19];case 14:return h.trys.push([14,,17,18]),s&&!s.done&&(u=i.return)?[4,MI(u.call(i))]:[3,16];case 15:h.sent(),h.label=16;case 16:return[3,18];case 17:if(l)throw l.error;return[7];case 18:return[7];case 19:return[2]}})})},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(r=e-128)){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){if(0!=(r=e-144)){this.pushArrayState(r),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)n=this.lookU8(),t=this.decodeUtf8String(n,1);else if(218===e)n=this.lookU16(),t=this.decodeUtf8String(n,2);else if(219===e)n=this.lookU32(),t=this.decodeUtf8String(n,4);else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue e}t={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue e}t={}}else if(196===e){var r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===e)r=this.lookU16(),t=this.decodeBinary(r,2);else if(198===e)r=this.lookU32(),t=this.decodeBinary(r,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)r=this.lookU8(),t=this.decodeExtension(r,1);else if(200===e)r=this.lookU16(),t=this.decodeExtension(r,2);else{if(201!==e)throw new xI("Unrecognized type byte: ".concat(CI(e)));r=this.lookU32(),t=this.decodeExtension(r,4)}this.complete();for(var i=this.stack;i.length>0;){var s=i[i.length-1];if(0===s.type){if(s.array[s.position]=t,s.position++,s.position!==s.size)continue e;i.pop(),t=s.array}else{if(1===s.type){if("string"!=(a=typeof t)&&"number"!==a)throw new xI("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new xI("The key __proto__ is not allowed");s.key=t,s.type=2;continue e}if(s.map[s.key]=t,s.readCount++,s.readCount!==s.size){s.key=null,s.type=1;continue e}i.pop(),t=s.map}}return t}var a},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new xI("Unrecognized array type byte: ".concat(CI(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new xI("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new xI("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new xI("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw NI;var r,i=this.pos+t;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,i,e):e>wI?function(e,t,n){var r=e.subarray(t,t+n);return bI.decode(r)}(this.bytes,i,e):mI(this.bytes,i,e),this.pos+=t+e,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new xI("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw NI;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new xI("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e=function(e,t){return 4294967296*e.getUint32(t)+e.getUint32(t+4)}(this.view,this.pos);return this.pos+=8,e},e.prototype.readI64=function(){var e=aI(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),UI={};const VI=JSON.parse('{"rE":"2.0.0-alpha.25"}');var jI=__webpack_require__(1048).Buffer;const zI=new Map,GI=new Map,HI=["debug-exit","end-statement"],$I="aes-256-ctr";async function WI(e,t){const n={entryPoint:e.device.entryPoint??!0,stopOnCrash:e.device.debugOnCrash??!1,root:e.root,ext:e.extZip?void 0:e.ext,...t};zI.clear(),GI.clear(),uh.setDeviceInfo(e.device);try{await oh(e.device.assets,uh.getTmpVolume(),uh.getCacheFS(),e.pkgZip,e.extZip),n.root&&uh.fileSystem.setRoot(n.root),n.ext&&uh.fileSystem.setExt(n.ext),uh.loadLocaleTerms()}catch(e){return postMessage(`error,Error mounting File System: ${e.message}`),{exitReason:we.CRASHED}}const r=await YE(uh.fileSystem,[]);let i;r.size>0?(i=await KE(r,e.manifest,n),eS.setNodeDefMap(r)):i=new RE(n);const s=function(e,t){return e.setManifest(t.manifest),t.device.registryBuffer?uh.setRegistry(t.device.registryBuffer):t.device.registry?.size&&uh.setRegistry(t.device.registry),XI(e),function(e){const t={sourceMap:new Map},n=uh.fileSystem;if(!n||!Array.isArray(e.paths))return t;for(let r of e.paths)try{const i=`pkg:/${r.url}`;if("pcode"===r.type&&n.existsSync(i)){if(0===r.id){t.pcode=n.readFileSync(i);continue}t.iv=n.readFileSync(i,"utf8")}else"source"===r.type&&Array.isArray(e.source)?t.sourceMap.set(i,e.source[r.id]):"source"===r.type&&n.existsSync(`pkg:/${r.url}`)&&t.sourceMap.set(i,n.readFileSync(i,"utf8"))}catch(e){postMessage(`error,Error accessing file ${r.url} - ${e.message}`)}return t}(t)}(i,e);let a;return uh.lastKeyTime=Date.now(),a=s.pcode&&s.iv?await async function(e,t,n){const r=n.password??"";let i;try{if(!(r.length>0&&t.pcode&&t.iv))return{exitReason:we.PASSWORD};{const e=Kf._7($I,r,t.iv),n=function(e,t){return void 0===t&&(t=UI),new BI(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}((s=jI.concat([e.update(t.pcode),e.final()]),Cu(s.subarray(Gu(s,a),-4),{i:2},a,a)));if(!n)return{exitReason:we.INVALID};i=new Map(Object.entries(n.pcode))}}catch(e){return postMessage(`error,Error unpacking the app: ${e.message}`),{exitReason:we.UNPACK}}var s,a;try{const t=function(e,t,n){const r=new Ff,i=new Lf,s=new Array,a=new Map;r.onError(Q),i.onError(Q);let o=[];for(let[,r]of n){const n=r;if(n.literal)if("Integer"===n.kind){const e=n.literal.value;n.literal=new vh(e)}else if("LongInteger"===n.kind){const e=n.literal.value;n.literal=new ph(e)}else if("Double"===n.kind){const e=n.literal.value;n.literal=new mh(e)}else if("Float"===n.kind){const e=n.literal.value;n.literal=new bh(e)}else if("String"===n.kind){const e=n.literal.value;n.literal=new M(e)}if(o.push(n),"Eof"===n.kind){const n=i.parse(o);if(n.errors.length>0||0===n.statements.length)throw new Error("Error parsing the tokens!");HE(e,n,a,t),s.push(...n.statements),o=[]}}for(const[e,t]of a)if(""!==t){const n=r.scan(t,e),a=i.parse(n.tokens);s.push(...a.statements)}return s}(uh.fileSystem,e.manifest,i);return{exitReason:await YI(e,t,n)}}catch(e){return postMessage(`error,Error executing the app: ${e.message}`),{exitReason:we.CRASHED}}}(i,s,e):await async function(e,t,n){const r=n.password??"",i=GE(uh.fileSystem,e.manifest,t,r,GI);let s=i.exitReason;if(s!==we.CRASHED){if(r.length>0){const e=i.tokens,t=Kf.po(12).toString("base64"),n=Kf.Tt($I,r,t),s=function(e,t){t||(t={});var n=Uu();n.p(e);var r=Vu(e,t,t.dictionary?6:2,4);return zu(r,t),ju(r,r.length-4,n.d()),r}(function(e,t){return void 0===t&&(t=_I),new TI(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encodeSharedRef(e)}({pcode:e})),a=jI.from(s),o=jI.concat([n.update(a),n.final()]);return{exitReason:we.PACKAGED,cipherText:o,iv:t}}if(eS.nodeDefMap?.size){const e=eS.nodeDefMap;for(const n of e.values())for(const e of n.scripts){const n=e.uri??e.xmlPath;n&&e.content?.length&&t.set(n,e.content)}}s=await YI(e,i.statements,n,t)}return{exitReason:s}}(i,s.sourceMap,e),a.cipherText||postMessage(`end,${a.exitReason}`),a}async function qI(e,t){const n={entryPoint:!1,stopOnCrash:e.device.debugOnCrash??!1,root:e.root,ext:e.extZip?void 0:e.ext,...t};GI.clear(),uh.setDeviceInfo(e.device);try{await oh(e.device.assets,e.taskData.tmp,e.taskData.cacheFS,e.pkgZip,e.extZip),n.root&&uh.fileSystem.setRoot(n.root),n.ext&&uh.fileSystem.setExt(n.ext),uh.loadLocaleTerms()}catch(e){return void postMessage(`error,Error mounting File System: ${e.message}`)}const r=await YE(uh.fileSystem,[]);let i;if(r.size>0){i=await KE(r,e.manifest,n),eS.setNodeDefMap(r),i.setManifest(e.manifest),e.device.registryBuffer?uh.setRegistry(e.device.registryBuffer):e.device.registry?.size&&uh.setRegistry(e.device.registry),XI(i),console.debug("Calling Task in new Worker: ",e.taskData.name,e.taskData.m.top.functionname);try{i.execTask(e),uh.isDevMode&&postMessage(`debug,Task ${e.taskData.name} is done.`)}catch(e){HI.includes(e.message)||(i.options.post??1?postMessage(`error,${e.message}`):i.options.stderr.write(e.message))}}else postMessage("warning,No SceneGraph components found!")}function XI(e){let t="",n="",r="";const i=uh.deviceInfo.locale;try{const s=uh.fileSystem;if(s?.existsSync(`pkg:/locale/${i}/translations.ts`)?(t=s.readFileSync(`pkg:/locale/${i}/translations.ts`,"utf8"),n="TS",r="translation"):s?.existsSync(`pkg:/locale/${i}/translations.xml`)&&(t=s.readFileSync(`pkg:/locale/${i}/translations.xml`,"utf8"),n="xliff",r="target"),""!==n){if(0===t.trim().length)return void postMessage("error,Error parsing translation XML: Empty input");try{const i=new sp.XmlDocument(t);if("TS"===n){const t=i.childrenNamed("context");for(const n of t){const t=n.childrenNamed("message");for(const n of t){const t=n.childNamed("source"),i=n.childNamed(r),s=t?.val??"";s&&e.translations.set(s,i?.val??"")}}}else{const t=i.childrenNamed("file");for(const n of t){const t=n.childNamed("body"),i=t?.childrenNamed("trans-unit")??[];for(const t of i){const n=t.childNamed("source"),i=t.childNamed(r),s=n?.val??"";s&&e.translations.set(s,i?.val??"")}}}}catch(e){postMessage(`error,Error parsing XML: ${e?.message??e}`)}}}catch(e){postMessage(`error,Invalid path: pkg:/locale/${i}/ - ${e.message}`)}}async function YI(e,t,n,r){let i=we.FINISHED;try{let i=Number.parseInt(n.manifest.get("splash_min_time")??"");Number.isNaN(i)&&(i=1600);let s=Date.now()-n.launchTime;s<i&&(await new Promise(e=>setTimeout(e,i-s)),s=i);const a=function(e,t){const n=new Map([["instant_on_run_mode","foreground"],["lastExitOrTerminationReason",we.UNKNOWN],["source","auto-run-dev"],["splashTime",t.toString()]]);for(const[t,r]of e)n.set(t,r);return nx(n)}(n.deepLink,s);e.exec(t,r,a)}catch(t){if(i=we.FINISHED,!HI.includes(t.message)){e.options.post??1?postMessage(`error,${t.message}`):e.options.stderr.write(t.message),i=we.CRASHED;const n=t.cause;n&&n instanceof J&&n.errorDetail===Z.MemberFunctionNotFound&&(i=we.UNKFUNC)}}return i}"undefined"!=typeof onmessage&&(onmessage=function(e){var t;!((t=e.data)&&"object"==typeof t.device&&"number"==typeof t.launchTime&&t.manifest instanceof Map&&t.deepLink instanceof Map&&Array.isArray(t.paths)&&Array.isArray(t.source)&&(t.pkgZip instanceof ArrayBuffer||void 0===t.pkgZip)&&(t.extZip instanceof ArrayBuffer||void 0===t.extZip))||"string"!=typeof t.password&&void 0!==t.password||"string"!=typeof t.root&&void 0!==t.root||"string"!=typeof t.ext&&void 0!==t.ext?function(e){return e&&"object"==typeof e.device&&e.manifest instanceof Map&&function(e){return e&&"number"==typeof e.id&&"string"==typeof e.name&&Object.values(be).includes(e.state)&&(e.buffer instanceof SharedArrayBuffer||void 0===e.buffer)&&("object"==typeof e.m||void 0===e.m)&&("object"==typeof e.scene||void 0===e.scene)&&("string"==typeof e.render||void 0===e.render)}(e.taskData)&&(e.pkgZip instanceof ArrayBuffer||void 0===e.pkgZip)&&(e.extZip instanceof ArrayBuffer||void 0===e.extZip)&&("string"==typeof e.root||void 0===e.root)&&("string"==typeof e.ext||void 0===e.ext)}(e.data)?(console.debug("[Worker] Task payload received: ",e.data.taskData.name),qI(e.data)):"string"==typeof e.data&&"getVersion"===e.data?postMessage(`version,${VI.rE}`):e.data instanceof ArrayBuffer||e.data instanceof SharedArrayBuffer?uh.setSharedArray(new Int32Array(e.data)):postMessage(`warning,[worker] Invalid message received: ${e.data}`):WI(e.data)})})(),__webpack_exports__})());